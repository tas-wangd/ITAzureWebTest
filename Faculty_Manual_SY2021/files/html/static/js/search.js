var FBPublication=FBPublication||{};FBPublication.search=function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=116)}({116:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.HighlighterPresenter=e.HighlighterModel=e.LocalSearchProvider=void 0;var n=r(117),o=i(n),s=r(118),a=i(s),l=r(120),u=i(l);e.LocalSearchProvider=u["default"],e.HighlighterModel=o["default"],e.HighlighterPresenter=a["default"]},117:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e,r,i){var n,o,s,a,l,u,h,c="R"===t[1];c?(n=t[2]/10,o=t[3]/10,s=t[4]/1e3,a=t[5]/10):(n=t[1]/10,o=t[2]/10,s=t[3]/1e3,a=t[4]/10),l=r+(i-1),u=0===r?0:e[r-1]/10,h=e[l]/10-u,this.y=o,this.x=n+u-(c?h:0),this.width=h,this.height=a,this.angle=s,this.rotatePadding=u-(c?h:0)}function o(t,e){this.pageModel=t,this.searchCharactersLimit=e,this._data=null}Object.defineProperty(e,"__esModule",{value:!0});var s=r(31),a=i(s),l=window.FBPublication.build,u=l.fbUtils,h=l._;o.prototype.getQueryHighlights=function(t,e){var r=this;h.isNull(this._data)?this._loadHighlightIndex(function(i,n){i?e(i):(r._data=n,r._parseHighlightData(t,e))}):this._parseHighlightData(t,e)},o.prototype._loadHighlightIndex=function(t){u.loadXML([this.pageModel.getSearchInfoUrl()],function(e){t(null,e)},function(e){t(e)})},o.prototype._parseHighlightData=function(t,e){var r=[];try{var i,o,s,l,c;i=this._data.split("\n"),t=t.toLowerCase()||"",t=u.split(t,0);for(var f=1,d=i.length;f<d;f++){o=i[f],s=0;for(var p=0,g=t.length;p<g;p++){if(l=t[p],c=o.split(String.fromCharCode(2)),l.length<this.searchCharactersLimit){var y=h.isUndefined(i[f-1])?"":i[f-1].split(String.fromCharCode(2))[0],v=h.isUndefined(i[f])?"":i[f].split(String.fromCharCode(2))[0],m=h.isUndefined(i[f+1])?"":i[f+1].split(String.fromCharCode(2))[0],_=y+" "+v,x=v+" "+m,b=t[p-1]||"",w=t[p],C=t[p+1]||"",S=b+" "+w,L=w+" "+C,I=!1;""!==b&&a["default"].findIndexes(_,S)&&(I=!0),""!==C&&a["default"].findIndexes(x,L)&&(I=!0)}else I=!0;var F=a["default"].findIndexes(c[0],l);if(s=F?F[0]:-1,s!==-1&&I){var P=o.split(String.fromCharCode(4)),M=[],R=[];if(P.length>1){for(var z=0,O=P.length;z<O;z++)M[z]=P[z].split(String.fromCharCode(2)),z>0&&M[z].unshift(M[0][0]),R[z]=M[z][5].split(String.fromCharCode(3));for(var T=s,q=s+l.length,B=0,j=M.length;B<j;B++){var E;R[B].length<=T?(T-=R[B].length,q-=R[B].length):(q>R[B].length?(E=R[B].length,q-=R[B].length):(E=q,q=0),T>0&&(E-=T),r.push(new n(M[B],R[B],T,E)),T=0)}}else R="R"===c[1]?c[6].split(String.fromCharCode(3)):c[5].split(String.fromCharCode(3)),r.push(new n(c,R,s,l.length))}}}}catch(H){e(H)}e(null,r)},e["default"]=o},118:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.model=t,this._cancelled=!1}Object.defineProperty(e,"__esModule",{value:!0});var o=r(119),s=i(o),a=window.FBPublication.build,l=a._;n.prototype.getSearchHighlightViews=function(t,e){var r=this;this.model.getQueryHighlights(t,function(t,i){r._cancelled||(t?e(t):(r.views=l.map(i,function(t){return new s["default"](this).init(t)}),e(null,l.map(r.views,function(t){return t.getViewDOMElement()}))))})},n.prototype.offset=function(t){l.each(this.views,function(e){e.offset(t)})},n.prototype.scale=function(t){l.each(this.views,function(e){e.scale(t)})},n.prototype.cancelAllRequests=function(){this._cancelled=!0},e["default"]=n},119:function(t,e,r){"use strict";function i(t){this.presenter=t}Object.defineProperty(e,"__esModule",{value:!0});var n=window.FBPublication.build,o=n.html5Lib,s=n._,a=n.el;i.prototype.init=function(t,e){var r={offsetFactor:0,scaleFactor:1};return s.extend(r,e),this.offsetFactor=r.offsetFactor,this.scaleFactor=r.scaleFactor,this.item=t,this.view=a.createElement("div",{"class":"highlight-element",styles:{position:"absolute"}}),this._place(),this},i.prototype.getViewDOMElement=function(){return this.view},i.prototype.offset=function(t){this.offsetFactor=t,this._place()},i.prototype.scale=function(t){this.scaleFactor=t,this._place()},i.prototype._place=function(){a.css(this.view,{top:this.item.y*this.scaleFactor+"px",left:(this.item.x+this.offsetFactor)*this.scaleFactor+"px",width:this.item.width*this.scaleFactor+"px",height:this.item.height*this.scaleFactor+"px"}),this.item.angle&&(o.origin(this.view,0,0),o.rotate(this.view,this.item.angle+"rad",0,0,1,!0))},e["default"]=i},120:function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.normalized={},t=t||{},this.searchCharactersLimit=t.searchCharactersLimit,this.exactMatch=t.exactMatch,this.maxTextResultLength=t.maxTextResultLength||90,this.chunkSize=66,this.searchInterval=33,this.currentQuery="",this.searchIndex=null,this.result=null,this.indexLoadStarted=!1,this._pageTable=e;var r=this;this.on("change:query",function(){r.set("result",null)})}Object.defineProperty(e,"__esModule",{value:!0});var o=r(121),s=i(o),a=r(31),l=i(a),u=window.FBPublication.build,h=u._,c=u.FBRouter,f=u.FBLocator,d=u.fbUtils;n.prototype=new s["default"],n.prototype.constructor=n,n.prototype.getResultsAsync=function(t,e,r){var i=this;if(h.isEmpty(this.query)||!this.isQueryValid())return[];if(!h.isNull(this.result)){if(this.query===this.currentQuery)return void r(this.result.slice(t*e,t*e+e),!0);this.result=null}var n=function(){h.defer(function(){i._run_search(function(n){r(i.result.slice(t*e,t*e+e),n)})})};this.loadSearchIndex(function(){n()})},n.prototype.getResultsCountSync=function(){return h.isNull(this.result)?void 0:this.result.length},n.prototype._getBold=function(t,e){var r=l["default"].findIndexes(t,e);return r?t.substring(0,r[0])+"<b>"+t.substring(r[0],r[1]+1)+"</b>"+t.substring(r[1]+1,t.length):t},n.prototype.loadSearchIndex=function(t){function e(t,e){for(var r=[];t.length;)r.push(t.splice(0,e));return r}var r=this;return this.callback=t||function(){},this.isIndexLoaded()?void this.callback():void(this.indexLoadStarted||(this.indexLoadStarted=!0,d.loadJSON([c().translatePath("assets/common/search/searchtext.js")],function(t){r.searchIndex=e(t.pages.page,r.chunkSize),r.callback()})))},n.prototype._sendSearchEvent=h.debounce(function(t,e){f().get(f.API).trigger("search",{query:t,success:e.length>0,quantity:e.length})},2500),n.prototype.normalize=function(t,e){if(!this.normalized.hasOwnProperty(t)){var r=l["default"].toLowerCase(l["default"].normalize(e));this.normalized[t]=null!==e?r:null}return this.normalized[t]},n.prototype._run_search=function(t){function e(t){for(var e in t)if(h.has(t,e)){var o=t[e],s=o["#text"],l=r._searchFullCoincidence(a,s,o["@ID"],!0);h.isNull(l)||i.push(l),h.isNull(l)&&null!==s&&(r.exactMatch||(c>1?(l=r._searchPartiallyCoincidence(u,s,o["@ID"],c,a.length),h.isNull(l)||i.push(l)):1===c&&(l=r._searchFullCoincidence(u[0],s,o["@ID"],!1),h.isNull(l)||i.push(l))))}n++}var r=this,i=[],n=0,o=0,s=this.query,a=l["default"].toLowerCase(l["default"].normalize(this.query)),u=d.split(a,this.searchCharactersLimit),c=u.length;this.currentQuery=s,h.isUndefined(this.searchTimer)||clearTimeout(this.searchTimer),this.searchTimer=setTimeout(function f(){r.currentQuery===s&&(n>0&&(r.result=i.sort(r._sortFunc.bind(r)),t(n===r.searchIndex.length)),n<r.searchIndex.length?(h.defer(e,r.searchIndex[o]),o++,r.searchTimer=setTimeout(f,r.searchInterval)):r._sendSearchEvent(a,i))},0)},n.prototype._buildSearchText=function(t,e,r){r=r||[];var i=e-this.maxTextResultLength/2;i=i<0?0:i;var n=l["default"].normalize(t.substr(i,parseInt(this.maxTextResultLength,10)+6));if(n="..."+n+"...",n=d.screening(n),r.length>0)for(var o=0;o<r.length;o++)n=this._getBold(n,r[o]);else n=this._getBold(n,this.query);return n},n.prototype._buildIndexes=function(t,e,r){for(var i=[],n=0;n<e;n++){for(var o=[],s=t[n],a=0,l=-2;l!==-1;)l>=0&&o.push(l),l=r.indexOf(s,a),a=l+this.searchCharactersLimit;o.length>0&&i.push(o)}return i},n.prototype._searchFullCoincidence=function(t,e,r,i){for(var n=-1,o=-1,a=this.normalize(r,e);(n=a.indexOf(t,n+1))>=0;)if(o=n,n!==-1&&(0===n||d.isSplitter(a.charAt(n-1)))&&(n+t.length===a.length||d.isSplitter(a.charAt(n+t.length))))return new s["default"].SearchResult(r,this._buildSearchText(e,n,[t]),i?0:1,n,n+t.length,i);return o>=0&&!this.exactMatch?new s["default"].SearchResult(r,this._buildSearchText(e,o,[t]),i?2:3,o,o+t.length,i):null},n.prototype._searchPartiallyCoincidence=function(t,e,r,i){var n=this.normalize(r,e),o=this._buildIndexes(t,i,n);if(null===o||0===o.length)return null;for(var a=0,l=new Array(o.length),u=0;u<o.length;u++)l[u]=o[u][0];for(var h=0;h<o.length-1;h++){var c=1e3,f=o[h],d=o[h+1];if(null===f||null===d)break;for(var p=f.length,g=d.length,y=0;y<p;y++)for(var v=0;v<g;v++){var m=f[y],_=d[v],x=_>m?1:2,b=_>m?_-m:m-_,w=b*x;w<c&&(l[h]=m,l[h+1]=_,c=w)}a+=c}for(var C=1e4,S=0,L=0;null!==l&&L<l.length;L++)C=Math.min(C,l[L]),S=Math.max(S,l[L]);return a+=1e3*(i-o.length),n=null,new s["default"].SearchResult(r,this._buildSearchText(e,C,t),a+4,C,S,(!1))},n.prototype._sortFunc=function(t,e){return t.relevance!==e.relevance?t.relevance-e.relevance:t.pageId-e.pageId},n.prototype.getMinimumQueryLength=function(){return this.searchCharactersLimit},n.prototype.isIndexLoaded=function(){return!h.isNull(this.searchIndex)},n.prototype.deleteIndex=function(){this.searchIndex=null,this.indexLoadStarted=!1},e["default"]=n},121:function(t,e,r){"use strict";function i(){this.query=null}Object.defineProperty(e,"__esModule",{value:!0});var n=window.FBPublication.build,o=n.Events;i.prototype=new o,i.prototype.constructor=i,i.prototype.getResultsSync=function(t,e){throw new Error("is an abstract method")},i.prototype.getResultsAsync=function(t,e,r){throw new Error("is an abstract method")},i.prototype.getResultsCountSync=function(){throw new Error("is an abstract method")},i.prototype.getResultsCountAsync=function(t){throw new Error("is an abstract method")},i.prototype.setQuery=function(t){this.set("query",t)},i.prototype.isQueryValid=function(){return!!this.query&&this.query.length>=this.getMinimumQueryLength()},i.prototype.getMinimumQueryLength=function(){return 1},i.prototype.isIndexLoaded=function(){return!1},i.SearchResult=function(t,e,r,i,n,o){this.pageId=t,this.text=e,this.relevance=r,this.startPos=i,this.stopPos=n,this.fullText=o},e["default"]=i},31:function(t,e,r){"use strict";function i(){}Object.defineProperty(e,"__esModule",{value:!0});var n=/[\u0300-\u036f]/g,o={"ı":"i","ё":"е"},s=new RegExp(Object.keys(o).join("|"),"gi");i.normalize=function(t){return String.prototype.normalize||console.error("String does'nt have normalize function"),t.normalize("NFKD")},i.toLowerCase=function(t){return t.toLowerCase().replace(n,"").replace(s,function(t){return o[t]})},i.findIndexes=function(t,e){for(var r=0,n=0,o=!1,s=0;s<t.length;s++)if(0!==i.toLowerCase(t.charAt(s)).length){if(o)break;i.toLowerCase(i.normalize(t.charAt(s)))===i.toLowerCase(i.normalize(e.charAt(n)))?n++:(r=s+1,n=0),n===e.length&&(o=!0)}return n===e.length?[r,s-1]:null},e["default"]=i}});