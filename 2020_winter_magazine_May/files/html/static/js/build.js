var FBPublication=FBPublication||{};FBPublication.build=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=20)}([function(t,e,i){"use strict";var n,o;Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=window,s=Array.prototype,l=Object.prototype,d="undefined"!=typeof Symbol?Symbol.prototype:null,h=s.push,u=s.slice,c=l.toString,p=l.hasOwnProperty,f=Array.isArray,g=Object.keys,m=Object.create,v=function(){},y=function $(t){return t instanceof $?t:this instanceof $?void(this._wrapped=t):new $(t)};y.VERSION="1.8.3";var b,w=function(t,e,i){if(void 0===e)return t;switch(null==i?3:i){case 1:return function(i){return t.call(e,i)};case 3:return function(i,n,o){return t.call(e,i,n,o)};case 4:return function(i,n,o,r){return t.call(e,i,n,o,r)}}return function(){return t.apply(e,arguments)}},_=function(t,e,i){return y.iteratee!==b?y.iteratee(t,e):null==t?y.identity:y.isFunction(t)?w(t,e,i):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=b=function(t,e){return _(t,e,1/0)};var P=function(t,e){return e=null==e?t.length-1:+e,function(){for(var i=Math.max(arguments.length-e,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var r=Array(e+1);for(o=0;o<e;o++)r[o]=arguments[o];return r[e]=n,t.apply(this,r)}},E=function(t){if(!y.isObject(t))return{};if(m)return m(t);v.prototype=t;var e=new v;return v.prototype=null,e},T=function(t){return function(e){return null==e?void 0:e[t]}},C=Math.pow(2,53)-1,A=T("length"),x=function(t){var e=A(t);return"number"==typeof e&&e>=0&&e<=C};y.each=y.forEach=function(t,e,i){e=w(e,i);var n,o;if(x(t))for(n=0,o=t.length;n<o;n++)e(t[n],n,t);else{var r=y.keys(t);for(n=0,o=r.length;n<o;n++)e(t[r[n]],r[n],t)}return t},y.map=y.collect=function(t,e,i){e=_(e,i);for(var n=!x(t)&&y.keys(t),o=(n||t).length,r=Array(o),a=0;a<o;a++){var s=n?n[a]:a;r[a]=e(t[s],s,t)}return r};var S=function(t){var e=function(e,i,n,o){var r=!x(e)&&y.keys(e),a=(r||e).length,s=t>0?0:a-1;for(o||(n=e[r?r[s]:s],s+=t);s>=0&&s<a;s+=t){var l=r?r[s]:s;n=i(n,e[l],l,e)}return n};return function(t,i,n,o){var r=arguments.length>=3;return e(t,w(i,o,4),n,r)}};y.reduce=y.foldl=y.inject=S(1),y.reduceRight=y.foldr=S(-1),y.find=y.detect=function(t,e,i){var n=x(t)?y.findIndex:y.findKey,o=n(t,e,i);if(void 0!==o&&o!==-1)return t[o]},y.filter=y.select=function(t,e,i){var n=[];return e=_(e,i),y.each(t,function(t,i,o){e(t,i,o)&&n.push(t)}),n},y.reject=function(t,e,i){return y.filter(t,y.negate(_(e)),i)},y.every=y.all=function(t,e,i){e=_(e,i);for(var n=!x(t)&&y.keys(t),o=(n||t).length,r=0;r<o;r++){var a=n?n[r]:r;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,i){e=_(e,i);for(var n=!x(t)&&y.keys(t),o=(n||t).length,r=0;r<o;r++){var a=n?n[r]:r;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,i,n){return x(t)||(t=y.values(t)),("number"!=typeof i||n)&&(i=0),y.indexOf(t,e,i)>=0},y.invoke=P(function(t,e,i){var n=y.isFunction(e);return y.map(t,function(t){var o=n?e:t[e];return null==o?o:o.apply(t,i)})}),y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,i){var n,o,a=-(1/0),s=-(1/0);if(null==e||"number"==typeof e&&"object"!=r(t[0])&&null!=t){t=x(t)?t:y.values(t);for(var l=0,d=t.length;l<d;l++)n=t[l],null!=n&&n>a&&(a=n)}else e=_(e,i),y.each(t,function(t,i,n){o=e(t,i,n),(o>s||o===-(1/0)&&a===-(1/0))&&(a=t,s=o)});return a},y.min=function(t,e,i){var n,o,a=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=r(t[0])&&null!=t){t=x(t)?t:y.values(t);for(var l=0,d=t.length;l<d;l++)n=t[l],null!=n&&n<a&&(a=n)}else e=_(e,i),y.each(t,function(t,i,n){o=e(t,i,n),(o<s||o===1/0&&a===1/0)&&(a=t,s=o)});return a},y.shuffle=function(t){return y.sample(t,1/0)},y.sample=function(t,e,i){if(null==e||i)return x(t)||(t=y.values(t)),t[y.random(t.length-1)];var n=x(t)?y.clone(t):y.values(t),o=A(n);e=Math.max(Math.min(e,o),0);for(var r=o-1,a=0;a<e;a++){var s=y.random(a,r),l=n[a];n[a]=n[s],n[s]=l}return n.slice(0,e)},y.sortBy=function(t,e,i){var n=0;return e=_(e,i),y.pluck(y.map(t,function(t,i,o){return{value:t,index:n++,criteria:e(t,i,o)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index-e.index}),"value")};var k=function(t,e){return function(i,n,o){var r=e?[[],[]]:{};return n=_(n,o),y.each(i,function(e,o){var a=n(e,o,i);t(r,e,a)}),r}};y.groupBy=k(function(t,e,i){y.has(t,i)?t[i].push(e):t[i]=[e]}),y.indexBy=k(function(t,e,i){t[i]=e}),y.countBy=k(function(t,e,i){y.has(t,i)?t[i]++:t[i]=1});var I=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(t){return t?y.isArray(t)?u.call(t):y.isString(t)?t.match(I):x(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:x(t)?t.length:y.keys(t).length},y.partition=k(function(t,e,i){t[i?0:1].push(e)},!0),y.first=y.head=y.take=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,i){return u.call(t,0,Math.max(0,t.length-(null==e||i?1:e)))},y.last=function(t,e,i){if(!(null==t||t.length<1))return null==e||i?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,i){return u.call(t,null==e||i?1:e)},y.compact=function(t){return y.filter(t,Boolean)};var L=function J(t,e,i,n){n=n||[];for(var o=n.length,r=0,a=A(t);r<a;r++){var s=t[r];if(x(s)&&(y.isArray(s)||y.isArguments(s)))if(e)for(var l=0,d=s.length;l<d;)n[o++]=s[l++];else J(s,e,i,n),o=n.length;else i||(n[o++]=s)}return n};y.flatten=function(t,e){return L(t,e,!1)},y.without=P(function(t,e){return y.difference(t,e)}),y.uniq=y.unique=function(t,e,i,n){y.isBoolean(e)||(n=i,i=e,e=!1),null!=i&&(i=_(i,n));for(var o=[],r=[],a=0,s=A(t);a<s;a++){var l=t[a],d=i?i(l,a,t):l;e?(a&&r===d||o.push(l),r=d):i?y.contains(r,d)||(r.push(d),o.push(l)):y.contains(o,l)||o.push(l)}return o},y.union=P(function(t){return y.uniq(L(t,!0,!0))}),y.intersection=function(t){for(var e=[],i=arguments.length,n=0,o=A(t);n<o;n++){var r=t[n];if(!y.contains(e,r)){var a;for(a=1;a<i&&y.contains(arguments[a],r);a++);a===i&&e.push(r)}}return e},y.difference=P(function(t,e){return e=L(e,!0,!0),y.filter(t,function(t){return!y.contains(e,t)})}),y.unzip=function(t){for(var e=t&&y.max(t,A).length||0,i=Array(e),n=0;n<e;n++)i[n]=y.pluck(t,n);return i},y.zip=P(y.unzip),y.object=function(t,e){for(var i={},n=0,o=A(t);n<o;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i};var M=function(t){return function(e,i,n){i=_(i,n);for(var o=A(e),r=t>0?0:o-1;r>=0&&r<o;r+=t)if(i(e[r],r,e))return r;return-1}};y.findIndex=M(1),y.findLastIndex=M(-1),y.sortedIndex=function(t,e,i,n){i=_(i,n,1);for(var o=i(e),r=0,a=A(t);r<a;){var s=Math.floor((r+a)/2);i(t[s])<o?r=s+1:a=s}return r};var O=function(t,e,i){return function(n,o,r){var a=0,s=A(n);if("number"==typeof r)t>0?a=r>=0?r:Math.max(r+s,a):s=r>=0?Math.min(r+1,s):r+s+1;else if(i&&r&&s)return r=i(n,o),n[r]===o?r:-1;if(o!==o)return r=e(u.call(n,a,s),y.isNaN),r>=0?r+a:-1;for(r=t>0?a:s-1;r>=0&&r<s;r+=t)if(n[r]===o)return r;return-1}};y.indexOf=O(1,y.findIndex,y.sortedIndex),y.lastIndexOf=O(-1,y.findLastIndex),y.range=function(t,e,i){null==e&&(e=t||0,t=0),i||(i=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/i),0),o=Array(n),r=0;r<n;r++,t+=i)o[r]=t;return o},y.chunk=function(t,e){if(null==e||e<1)return[];for(var i=[],n=0,o=t.length;n<o;)i.push(u.call(t,n,n+=e));return i};var N=function(t,e,i,n,o){if(!(n instanceof e))return t.apply(i,o);var r=E(t.prototype),a=t.apply(r,o);return y.isObject(a)?a:r};y.bind=P(function(t,e,i){if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=P(function(o){return N(t,n,e,this,i.concat(o))});return n}),y.partial=P(function(t,e){var i=y.partial.placeholder,n=function o(){for(var n=0,r=e.length,a=Array(r),s=0;s<r;s++)a[s]=e[s]===i?arguments[n++]:e[s];for(;n<arguments.length;)a.push(arguments[n++]);return N(t,o,this,this,a)};return n}),y.partial.placeholder=y,y.bindAll=P(function(t,e){e=L(e,!1,!1);var i=e.length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=e[i];t[n]=y.bind(t[n],t)}}),y.memoize=function(t,e){var i=function n(i){var o=n.cache,r=""+(e?e.apply(this,arguments):i);return y.has(o,r)||(o[r]=t.apply(this,arguments)),o[r]};return i.cache={},i},y.delay=P(function(t,e,i){return setTimeout(function(){return t.apply(null,i)},e)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,i){var n,o,r,a,s=0;i||(i={});var l=function(){s=i.leading===!1?0:y.now(),n=null,a=t.apply(o,r),n||(o=r=null)},d=function(){var d=y.now();s||i.leading!==!1||(s=d);var h=e-(d-s);return o=this,r=arguments,h<=0||h>e?(n&&(clearTimeout(n),n=null),s=d,a=t.apply(o,r),n||(o=r=null)):n||i.trailing===!1||(n=setTimeout(l,h)),a};return d.cancel=function(){clearTimeout(n),s=0,n=o=r=null},d},y.debounce=function(t,e,i){var n,o,r=function(e,i){n=null,i&&(o=t.apply(e,i))},a=P(function(a){if(n&&clearTimeout(n),i){var s=!n;n=setTimeout(r,e),s&&(o=t.apply(this,a))}else n=y.delay(r,e,this,a);return o});return a.cancel=function(){clearTimeout(n),n=null},a},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var i=e,n=t[e].apply(this,arguments);i--;)n=t[i].call(this,n);return n}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var i;return function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=null),i}},y.once=y.partial(y.before,2),y.restArgs=P;var B=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],z=function(t,e){var i=D.length,n=t.constructor,o=y.isFunction(n)&&n.prototype||l,r="constructor";for(y.has(t,r)&&!y.contains(e,r)&&e.push(r);i--;)r=D[i],r in t&&t[r]!==o[r]&&!y.contains(e,r)&&e.push(r)};y.keys=function(t){if(!y.isObject(t))return[];if(g)return g(t);var e=[];for(var i in t)y.has(t,i)&&e.push(i);return B&&z(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var i in t)e.push(i);return B&&z(t,e),e},y.values=function(t){for(var e=y.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=t[e[o]];return n},y.mapObject=function(t,e,i){e=_(e,i);for(var n=y.keys(t),o=n.length,r={},a=0;a<o;a++){var s=n[a];r[s]=e(t[s],s,t)}return r},y.pairs=function(t){for(var e=y.keys(t),i=e.length,n=Array(i),o=0;o<i;o++)n[o]=[e[o],t[e[o]]];return n},y.invert=function(t){for(var e={},i=y.keys(t),n=0,o=i.length;n<o;n++)e[t[i[n]]]=i[n];return e},y.functions=y.methods=function(t){var e=[];for(var i in t)y.isFunction(t[i])&&e.push(i);return e.sort()};var R=function(t,e){return function(i){var n=arguments.length;if(e&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var r=arguments[o],a=t(r),s=a.length,l=0;l<s;l++){var d=a[l];e&&void 0!==i[d]||(i[d]=r[d])}return i}};y.extend=R(y.allKeys),y.extendOwn=y.assign=R(y.keys),y.findKey=function(t,e,i){e=_(e,i);for(var n,o=y.keys(t),r=0,a=o.length;r<a;r++)if(n=o[r],e(t[n],n,t))return n};var F=function(t,e,i){return e in i};y.pick=P(function(t,e){var i={},n=e[0];if(null==t)return i;y.isFunction(n)?(e.length>1&&(n=w(n,e[1])),e=y.allKeys(t)):(n=F,e=L(e,!1,!1),t=Object(t));for(var o=0,r=e.length;o<r;o++){var a=e[o],s=t[a];n(s,a,t)&&(i[a]=s)}return i}),y.omit=P(function(t,e){var i,n=e[0];return y.isFunction(n)?(n=y.negate(n),e.length>1&&(i=e[1])):(e=y.map(L(e,!1,!1),String),n=function(t,i){return!y.contains(e,i)}),y.pick(t,n,i)}),y.defaults=R(y.allKeys,!0),y.create=function(t,e){var i=E(t);return e&&y.extendOwn(i,e),i},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var i=y.keys(e),n=i.length;if(null==t)return!n;for(var o=Object(t),r=0;r<n;r++){var a=i[r];if(e[a]!==o[a]||!(a in o))return!1}return!0};var W,H;W=function(t,e,i,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;if(t!==t)return e!==e;var o="undefined"==typeof t?"undefined":r(t);return("function"===o||"object"===o||"object"==("undefined"==typeof e?"undefined":r(e)))&&H(t,e,i,n)},H=function(t,e,i,n){t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var o=c.call(t);if(o!==c.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return d.valueOf.call(t)===d.valueOf.call(e)}var a="[object Array]"===o;if(!a){if("object"!=("undefined"==typeof t?"undefined":r(t))||"object"!=("undefined"==typeof e?"undefined":r(e)))return!1;var s=t.constructor,l=e.constructor;if(s!==l&&!(y.isFunction(s)&&s instanceof s&&y.isFunction(l)&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],n=n||[];for(var h=i.length;h--;)if(i[h]===t)return n[h]===e;if(i.push(t),n.push(e),a){if(h=t.length,h!==e.length)return!1;for(;h--;)if(!W(t[h],e[h],i,n))return!1}else{var u,p=y.keys(t);if(h=p.length,y.keys(e).length!==h)return!1;for(;h--;)if(u=p[h],!y.has(e,u)||!W(t[u],e[u],i,n))return!1}return i.pop(),n.pop(),!0},y.isEqual=function(t,e){return W(t,e)},y.isEmpty=function(t){return null==t||(x(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=f||function(t){return"[object Array]"===c.call(t)},y.isObject=function(t){var e="undefined"==typeof t?"undefined":r(t);return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){y["is"+t]=function(e){return c.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")});var U=a.document&&a.document.childNodes;"function"!=typeof/ . /&&"object"!=("undefined"==typeof Int8Array?"undefined":r(Int8Array))&&"function"!=typeof U&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return!y.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&isNaN(t)},y.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===c.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&p.call(t,e)},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=T,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,i){var n=Array(Math.max(0,t));e=w(e,i,1);for(var o=0;o<t;o++)n[o]=e(o);return n},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},V=y.invert(j),q=function(t){var e=function(e){return t[e]},i="(?:"+y.keys(t).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(o,e):t}};y.escape=q(j),y.unescape=q(V),y.result=function(t,e,i){var n=null==t?void 0:t[e];return void 0===n&&(n=i),y.isFunction(n)?n.call(t):n};var G=0;y.uniqueId=function(t){var e=++G+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var X=/(.)^/,Y={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(t){return"\\"+Y[t]};y.template=function(t,e,i){!e&&i&&(e=i),e=y.defaults({},e,y.templateSettings);var n=RegExp([(e.escape||X).source,(e.interpolate||X).source,(e.evaluate||X).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,n,a,s){return r+=t.slice(o,s).replace(Q,Z),o=s+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(r+="';\n"+a+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";var a;try{a=new Function(e.variable||"obj","_",r)}catch(s){throw s.source=r,s}var l=function(t){return a.call(this,t,y)},d=e.variable||"obj";return l.source="function("+d+"){\n"+r+"}",l},y.chain=function(t){var e=y(t);return e._chain=!0,e};var K=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){return y.each(y.functions(t),function(e){var i=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return h.apply(t,arguments),K(this,i.apply(y,t))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];y.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!==t&&"splice"!==t||0!==i.length||delete i[0],K(this,i)}}),y.each(["concat","join","slice"],function(t){var e=s[t];y.prototype[t]=function(){return K(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},n=[],o=function(){return y}.apply(e,n),!(void 0!==o&&(t.exports=o)),e["default"]=y},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){}Object.defineProperty(e,"__esModule",{value:!0});var r,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=i(0),d=n(l),h=Array.prototype.slice;o.prototype.on=function(t,e,i){if(!r(this,"on",t,[e,i])||!e)return this;this._events=this._events||{};var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},o.prototype.once=function(t,e,i){if(!r(this,"once",t,[e,i])||!e)return this;var n=this,o=d["default"].once(function(){n.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,i)},o.prototype.destructor=function(){var t,e,i;i=d["default"].keys(this._events);for(var n=0,o=i.length;n<o;n++){var r=i[n];if(e=this._events[r]){for(var a=0,s=e.length;a<s;a++)t=e[a],delete t.callback,delete t.context;delete this._events[r]}}},o.prototype.off=function(t,e,i){var n,o,a,s;if(!this._events||!r(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;s=t?[t]:d["default"].keys(this._events);for(var l=0,h=s.length;l<h;l++)if(t=s[l],a=this._events[t]){if(this._events[t]=n=[],e||i)for(var u=0,c=a.length;u<c;u++)o=a[u],(e&&e!==o.callback&&e!==o.callback._callback||i&&i!==o.context)&&n.push(o);n.length||delete this._events[t]}return this},o.prototype.trigger=function(t){if(!this._events)return this;var e=h.call(arguments,1);if(!r(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&a(i,e),n&&a(n,arguments),this},o.prototype.stopListening=function(t,e,i){var n=this._listeners;if(!n)return this;var o=!e&&!i;"object"===("undefined"==typeof e?"undefined":s(e))&&(i=this),t&&((n={})[t._listenerId]=t);for(var r in n)n.hasOwnProperty(r)&&(n[r].off(e,i,this),o&&delete this._listeners[r]);return this},o.prototype.set=function(t,e,i){var n=this,o=t,r=o.split(".");if(r.length>1){for(var a=0;a<r.length-1;a++)if(n=n[r[a]],d["default"].isUndefined(n))return console.error("Property does not have",r[a]),this;o=r[r.length-1]}if(n[o]===e)return this;var s=n[o];n[o]=e;var l=function(i){i.trigger("change:"+t,e,s,this)};if(d["default"].isUndefined(i)?(l(this),s=null):d["default"].defer(d["default"].bind(function(){l(this),s=null},this)),r.length>1){var h=function(t){var e=r[0],i=t[r[0]];t.trigger("change:"+e,i,null,this);for(var n=1;n<r.length-1;n++)e+="."+r[n],i=i[r[n]],t.trigger("change:"+e,i,null,this)};d["default"].isUndefined(i)?h(this):d["default"].defer(d["default"].bind(function(){h(this)},this))}return this};var u=/\s+/;r=function(t,e,i,n){if(!i)return!0;if("object"===("undefined"==typeof i?"undefined":s(i))){for(var o in i)i.hasOwnProperty(o)&&t[e].apply(t,[o,i[o]].concat(n));return!1}if(u.test(i)){for(var r=i.split(u),a=0,l=r.length;a<l;a++)t[e].apply(t,[r[a]].concat(n));return!1}return!0},a=function(t,e){var i,n=-1,o=t.length,r=e[0],a=e[1],s=e[2];switch(e.length){case 0:for(;++n<o;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,a);return;case 3:for(;++n<o;)(i=t[n]).callback.call(i.ctx,r,a,s);return;default:for(;++n<o;)(i=t[n]).callback.apply(i.ctx,e)}};var c={listenTo:"on",listenToOnce:"once"};d["default"].each(c,function(t,e){o.prototype[e]=function(e,i,n){var o=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=d["default"].uniqueId("l"));return o[r]=e,"object"===("undefined"==typeof i?"undefined":s(i))&&(n=this),e[t](i,n,this),this}}),o.prototype.bind=o.prototype.on,o.prototype.unbind=o.prototype.off,e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),r=n(o),a=i(1),s=n(a),l=function(){function t(){return e?e:this instanceof t?(e=this,void(this.services={})):new t}var e;return t.prototype=new s["default"],t.prototype.constructor=t,t.prototype.set=function(t,e){var i=this.services[t];this.services[t]=e,this.trigger(t),this.trigger("change:"+t,e,i,this)},t.prototype.get=function(t){return r["default"].has(this.services,t)?this.services[t]:(console.error("Service is not registered: "+t),null)},t.prototype.has=function(t){return r["default"].has(this.services,t)},t.prototype.destructor=function(){for(var t in this.services)if(r["default"].has(this.services,t)){var e=this.services[t];r["default"].isFunction(e.destructor)&&e.destructor()}this.services={}},t}();l.PAGER="PAGER",l.LIBRARY_MANAGER="LIBRARY_MANAGER",l.NOTE_MANAGER="NOTE_MANAGER",l.LOAD_MANAGER="LOAD_MANAGER",l.API="API",l.LOCALE="LOCALE",l.SEARCH_PROVIDER="SEARCH_PROVIDER",l.ANALYTICS="ANALYTICS",l.VIRTUAL_PRINTER="VIRTUAL_PRINTER",l.USER_AGENT_INFO="USER_AGENT_INFO",l.BOOK_STATE="BOOK_STATE",l.WIDE_HIGHLIGHTER="WIDE_HIGHLIGHTER",l.CONTEXT_MENU="CONTEXT_MENU",l.CURRENT_PRESENTER="CURRENT_PRESENTER",e["default"]=l},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),r=n(o),a={};a.canvas={},a.cTest=!1,a.id=function(e){return t.document.getElementById(e)},a.tag=function(t,e){return a.tags(t,e)[0]},a.className=function(e,i){return i=r["default"].isElement(i)?i:t.document,i.getElementsByClassName(e)},a.tags=function(e,i){return i=r["default"].isElement(i)?i:t.document,i.getElementsByTagName(e)},a.add=function(e){return t.document.createElement(e)},a.css=function(t,e){for(var i in e)if(e.hasOwnProperty(i)){var n=i.replace(/-(.)/g,function(t,e){return e.toUpperCase()});n="float"===n?"cssFloat":n,t.style[n]=e[i]}},a.del=function(t){try{return r["default"].isString(t)?null!==document.getElementById(t)&&a.id(t).parentNode.removeChild(a.id(t)):t.parentNode.removeChild(t),!0}catch(e){console.log(e)}return!1},a.addClass=function(t,e){if(t){r["default"].isString(t)&&(t=a.id(t));var i=t.getAttribute("class");null===i||"undefined"==typeof i?t.setAttribute("class",e):i.indexOf(e)<0&&t.setAttribute("class",i+" "+e)}},a.hasClass=function(t,e){if(t){if(r["default"].isString(t)&&(t=a.id(t)),"string"!=typeof t.className)return!1;for(var i=t.className.split(" "),n=0;n<i.length;n++)if(i[n]===e)return!0;return!1}},a.removeClass=function(t,e){if(t){r["default"].isString(t)&&(t=a.id(t));var i=new RegExp(e,"g"),n=t.getAttribute("class");r["default"].isNull(n)||t.setAttribute("class",n.replace(i,"").trim())}},a.createElement=function(t,e,i,n,o){i=i||-1;var a=document.createElement(t);for(var s in e)e.hasOwnProperty(s)&&("styles"!==s?a.setAttribute(s,e[s]):this.css(a,e.styles));if("top"===n)i!==-1&&(r["default"].isString(i)?document.getElementById(i).insertBefore(a,document.getElementById(i).firstChild):i.insertBefore(a,i.firstChild));else if("after"===n){var l=o.nextSibling,d=o.parentNode;l?d.insertBefore(a,l):d.appendChild(a)}else"before"===n?i.insertBefore(a,o):i!==-1&&(r["default"].isString(i)?document.getElementById(i).appendChild(a):i.appendChild(a));return a},a.setText=function(t,e){t["innerText"in t?"innerText":"textContent"]=e},a.clear=function(t){r["default"].isString(t)&&(t=t.id(t)),t.innerHTML=""},e["default"]=a}).call(e,i(6))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(){return t.XDomainRequest&&!/MSIE 1/.test(t.navigator.userAgent)?new t.XDomainRequest:t.XMLHttpRequest?new t.XMLHttpRequest:void 0}function r(t){return t instanceof Date||t instanceof RegExp}function a(t){if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);throw new Error("Unexpected situation")}function s(t){var e=[];return t.forEach(function(t,i){"object"===("undefined"==typeof t?"undefined":l(t))&&null!==t?Array.isArray(t)?e[i]=s(t):r(t)?e[i]=a(t):e[i]=u.deepExtend({},t):e[i]=t}),e}Object.defineProperty(e,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d=i(0),h=n(d),u={};u.SPLITTERS=[",",";","."," ","?","!","'",'"',"",String.fromCharCode(10),String.fromCharCode(13),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8722),String.fromCharCode(8209),String.fromCharCode(8208)],u.getNum=function(t){return("000"+t).slice(-Math.max((t+"").length,4))},u.mergeObjects=function(t,e){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);return i},u.extFormat=function(t){return h["default"].isEmpty(t)?"":"."+t},u.getPixelRatio=function(){return"undefined"==typeof t.devicePixelRatio?1:t.devicePixelRatio>1.3?2:1},u.split=function(t,e){for(var i=t.split(" "),n=[],o=0;o<i.length;o++)i[o].length>=e&&n.push(i[o]);return n},u.isSplitter=function(t){for(var e=0;e<this.SPLITTERS.length;e++)if(t===this.SPLITTERS[e])return!0;return!1},u.screening=function(t){var e=/</gi,i=function(){return"&lt;"};return t.replace(e,i)},u.chunk=function(t,e){"undefined"==typeof e&&(e=2);var i=t.match(new RegExp(".{1,"+e+"}","g"));return i||[]},u.parseQuery=function(){var t={};if(!h["default"].isUndefined(window)&&!h["default"].isUndefined(window.location)&&!h["default"].isUndefined(window.location.search)){var e=window.location.search.replace("?","");if(e.length)for(var i=e.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");t[decodeURIComponent(o[0])]=o.length>1?decodeURIComponent(o[1]):null}}return t},u.parseHash=function(){var t={};if(!h["default"].isUndefined(window)&&!h["default"].isUndefined(window.location)&&!h["default"].isUndefined(window.location.hash)){var e=window.location.hash.replace("#","");if(e.length)for(var i=e.split("&"),n=0;n<i.length;n++){var o=i[n].split("=");t[decodeURIComponent(o[0])]=o.length>1?decodeURIComponent(o[1]):null}}return t},u.fitScreenSizes=function(e,i,n,o){var r=n||t.innerWidth,a=o||t.innerHeight,s=r/a,l=e/i,d=s>l?e*a/i:r,h=s>l?a:i*r/e;return{width:d,height:h,paddingTop:(a-h)/2,paddingLeft:(r-d)/2}},u.fillScreenSizes=function(e,i,n,o){var r=n||t.innerWidth,a=o||t.innerHeight,s=r/a,l=e/i,d=s>l?r:e*a/i,h=s>l?i*r/e:a;return{width:d,height:h,paddingTop:(a-h)/2,paddingLeft:(r-d)/2}},u._loadExternalUrl=function(t,e,i){e=e||function(){},i=i||function(){};var n=o();n.open("GET",t,!0),n.onerror=function(){console.error("Error loading "+t),i(n.status)},n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e(n):i(n.status))},n.send(null)},u.loadText=function(t,e,i){e=e||function(){},i=i||function(){},u._loadExternalUrl(t,function(t){e(t.responseText)},function(t){i(t)})},u.loadJSON=function(t,e,i){e=e||function(){},i=i||function(){},u.loadText(t,function(t){e(JSON.parse(t))},function(t){i(t)})},u.loadXML=function(t,e,i){e=e||function(){},i=i||function(){},u._loadExternalUrl(t,function(t){e(t.response)},i)},u.loadScript=function(e,i){i=i||function(){};var n=t.document.getElementsByTagName("head")[0],o=t.document.createElement("script");o.type="text/javascript",o.src=e,n.appendChild(o),o.readyState?o.onreadystatechange=function(){"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,i())}:o.onload=function(){i()}},u.isPointInsideRect=function(t,e){if(e){var i,n;if(t.hasOwnProperty("x")&&(i=t.x),t.hasOwnProperty("y")&&(n=t.y),h["default"].isNumber(i)&&h["default"].isNumber(n)&&i>=e.left&&i<=e.right&&n>=e.top&&n<=e.bottom)return!0}return!1},u.localToGlobal=function(t,e){var i={};return t&&e.hasOwnProperty("x")&&(i.x=Number(e.x)+Number(t.left)),t&&e.hasOwnProperty("y")&&(i.y=Number(e.y)+Number(t.top)),t&&e.hasOwnProperty("left")&&(i.left=Number(e.left)+Number(t.left)),t&&e.hasOwnProperty("top")&&(i.top=Number(e.top)+Number(t.top)),i},u.globalToLocal=function(t,e){var i={};return t&&e.hasOwnProperty("x")&&(i.x=Number(e.x)-Number(t.left)),t&&e.hasOwnProperty("y")&&(i.y=Number(e.y)-Number(t.top)),t&&e.hasOwnProperty("left")&&(i.left=Number(e.left)-Number(t.left)),t&&e.hasOwnProperty("top")&&(i.top=Number(e.top)-Number(t.top)),i},u.downloadFile=function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&e&&e(i.response)},i.send(null)},u.loadCSS=function(e,i,n){var o=t.document.styleSheets.length,r=function(e){var i=t.document.getElementsByTagName("head")[0],r=t.document.createElement("link");r.href=e,r.type="text/css",r.rel="stylesheet",h["default"].isString(n)&&(r.id=n),n&&document.getElementById(n)?(i.replaceChild(r,document.getElementById(n)),o--):i.appendChild(r)},a=function(e){return h["default"].filter(t.document.styleSheets,function(t){return h["default"].isString(t.href)&&t.href.indexOf(e)>=0}).length>0};h["default"].isFunction(i)&&!function(){var n=setInterval(function(){o<t.document.styleSheets.length&&a(e)&&(i.call(),clearInterval(n))},20)}(),r(e)},u.romanize=function(t){var e="",i={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},n=parseInt(t,10);if(!(h["default"].isNaN(n)||n<=0)){var o;for(o in i)if(h["default"].has(i,o))for(;n>=i[o];)e+=o,n-=i[o];return e}},u.deromanize=function(t){var e,t=t.toUpperCase(),i=/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/,n=/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,o={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},r=0;if(t&&i.test(t)){for(e=n.exec(t);e;)r+=o[e[0]],e=n.exec(t);return r}},u.getBookSizes=function(t,e,i,n,o){var r={bookSize:t,realSize:e.hasOwnProperty("width")?{width:e.width,height:e.height}:{width:e.right-e.left,height:e.bottom-e.top}};return i?(r.offset=0,n&&(r.realSize.width=r.realSize.width/2)):r.offset=n&&o?r.bookSize.width:0,r.scales={scaleX:r.realSize.width/r.bookSize.width,scaleY:r.realSize.height/r.bookSize.height},r},u.hasParentClass=function(t,e){for(var i=t;i;){if(h["default"].isString(i.className)&&i.className.indexOf(e)>=0)return!0;i=i.parentNode}return!1},u.decodeEntities=function(t){var e=document.createElement("textarea");
return e.innerHTML=t,e.value},u.cleanString=function(e){var i=t.document.createElement("div");return i.appendChild(t.document.createTextNode(e)),i.innerHTML},u.isRoman=function(t){var e=t.toUpperCase(),i=/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/;return e&&i.test(e)},u.renderTemplate=function(e,i,n,o){n=n||{};var r=t.document.createElement("div");for(r.innerHTML=i(n);r.firstChild;)h["default"].isUndefined(o)?e.appendChild(r.firstChild):e.insertBefore(r.firstChild,o)},u.onWheel=function(t,e){t.addEventListener?"onwheel"in document?t.addEventListener("wheel",e):"onmousewheel"in document?t.addEventListener("mousewheel",e):t.addEventListener("MozMousePixelScroll",e):t.attachEvent("onmousewheel",e)},u.removeOnWheel=function(t,e){t.removeEventListener?"onwheel"in document?t.removeEventListener("wheel",e):"onmousewheel"in document?t.removeEventListener("mousewheel",e):t.removeEventListener("MozMousePixelScroll",e):t.detachEvent("onmousewheel",e)};var c=10,p=40,f=800;u.normalizeWheel=function(t){var e=0,i=0,n=0,o=0;return"detail"in t&&(i=t.detail),"wheelDelta"in t&&(i=-t.wheelDelta/120),"wheelDeltaY"in t&&(i=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(e=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=i,i=0),n=e*c,o=i*c,"deltaY"in t&&(o=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||o)&&t.deltaMode&&(1===t.deltaMode?(n*=p,o*=p):(n*=f,o*=f)),n&&!e&&(e=n<1?-1:1),o&&!i&&(i=o<1?-1:1),{spinX:e,spinY:i,pixelX:n,pixelY:o}},u.fitRectIntoBounds=function(t,e){var i=t.width/t.height,n=e.width/e.height,o={};return i>n?(o.width=e.width,o.height=t.height*(e.width/t.width)):(o.width=t.width*(e.height/t.height),o.height=e.height),o},u.combinePath=function(){var t=h["default"].without(Array.prototype.slice.call(arguments),"");return 1===t.length?t[0]:h["default"].map(t,function(t,e,i){switch(e){case 0:return t.replace(/(\/$)/,"");case i.length-1:return t.replace(/(^\/)/,"");default:return t.replace(/(^\/|\/$)/,"")}}).join("/")},u.addListener=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent&&t.attachEvent("on"+e,i)},u.deepExtend=function(){if(arguments.length<1||"object"!==l(arguments[0]))return!1;if(arguments.length<2)return arguments[0];var t,e,i=arguments[0],n=Array.prototype.slice.call(arguments,1);return n.forEach(function(n){"object"!==("undefined"==typeof n?"undefined":l(n))||Array.isArray(n)||Object.keys(n).forEach(function(o){return e=i[o],t=n[o],t===i?void 0:"object"!==("undefined"==typeof t?"undefined":l(t))||null===t?void(i[o]=t):Array.isArray(t)?void(i[o]=s(t)):r(t)?void(i[o]=a(t)):"object"!==("undefined"==typeof e?"undefined":l(e))||null===e||Array.isArray(e)?void(i[o]=u.deepExtend({},t)):void(i[o]=u.deepExtend(e,t))})}),i},u.findSpace=function(t,e,i,n){for(var o=0,r=0,a=void 0,s=void 0,l=void 0,d=0;d<n.length;d++)if("number"!=typeof n[d].left||"number"!=typeof n[d].top)return{left:Math.round(t/2),top:Math.round(i/2)};do{a=Math.round(t/2),1===o&&(a-=i),2===o&&(a+=i),s=Math.round(i/2)+i*r,l=!1;for(var h=0;h<n.length;h++)if(!(a>=n[h].left+i||a+i<=n[h].left||s>=n[h].top+i||s+i<=n[h].top)){l=!0;break}o++,3===o&&(o=0,r++),r*i+i>e&&(l=!1)}while(l);return{left:a,top:s}},e["default"]=u}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),r=n(o),a=function(){function t(){return e?e:this instanceof t?(e=this,void this.setCallback(function(){})):new t}var e;return t.prototype.setAdapter=function(t){var e=this;this.adapter&&(this.adapter.setCallback(null),this.adapter=null),this.adapter=t,this.adapter.setCallback(function(t){e.callback(t)})},t.prototype.setCallback=function(t){this.callback=t},t.prototype.getPathInfo=function(){return this.adapter.getPathInfo()},t.prototype.setPath=function(t){this.adapter.setPath(t)},t.prototype.getShareUrl=function(t,e,i){return this.adapter.getShareUrl(t,e,i)},t.prototype.getEmbedUrl=function(t){return this.adapter.getEmbedUrl(t)},t.prototype.getLocalStorage=function(){return this.adapter.getLocalStorage()},t.prototype.getSessionStorage=function(){return this.adapter.getSessionStorage()},t.prototype.translatePath=function(t,e){var i=this;r["default"].isString(t)&&(t=[t]);var n=r["default"].chain(t).flatten().map(function(t){return i.adapter.translatePath(t,e)}).value();return 1===n.length?n[0]:n},t.prototype.getEmbedPrefix=function(){return this.adapter.getEmbedPrefix()},t.prototype.getCrossOrigin=function(){return this.adapter.getCrossOrigin()},t}();e["default"]=a},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(n){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n;!function(o,r,a,s){"use strict";function l(t,e,i){return setTimeout(p(t,i),e)}function d(t,e,i){return!!Array.isArray(t)&&(h(t,i[e],i),!0)}function h(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==s)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function u(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=o.console&&(o.console.warn||o.console.log);return r&&r.call(o.console,n,i),t.apply(this,arguments)}}function c(t,e,i){var n,o=e.prototype;n=t.prototype=Object.create(o),n.constructor=t,n._super=o,i&&gt(n,i)}function p(t,e){return function(){return t.apply(e,arguments)}}function f(t,e){return typeof t==yt?t.apply(e?e[0]||s:s,e):t}function g(t,e){return t===s?e:t}function m(t,e,i){h(w(e),function(e){t.addEventListener(e,i,!1)})}function v(t,e,i){h(w(e),function(e){t.removeEventListener(e,i,!1)})}function y(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function b(t,e){return t.indexOf(e)>-1}function w(t){return t.trim().split(/\s+/g)}function _(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function E(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var a=e?t[r][e]:t[r];_(o,a)<0&&n.push(t[r]),o[r]=a,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function T(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<mt.length;){if(i=mt[r],n=i?i+o:e,n in t)return n;r++}return s}function C(){return Tt++}function A(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||o}function x(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){f(t.options.enable,[t])&&i.handler(e)},this.init()}function S(t){var e,i=t.options.inputClass;return new(e=i?i:xt?U:St?q:At?X:H)(t,k)}function k(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=e&Nt&&n-o===0,a=e&(Dt|zt)&&n-o===0;i.isFirst=!!r,i.isFinal=!!a,r&&(t.session={}),i.eventType=e,I(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function I(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=O(e)),o>1&&!i.firstMultiple?i.firstMultiple=O(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,a=i.firstMultiple,s=a?a.center:r.center,l=e.center=N(n);e.timeStamp=_t(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=R(s,l),e.distance=z(s,l),L(i,e),e.offsetDirection=D(e.deltaX,e.deltaY);var d=B(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=wt(d.x)>wt(d.y)?d.x:d.y,e.scale=a?W(a.pointers,n):1,e.rotation=a?F(a.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,M(i,e);var h=t.element;y(e.srcEvent.target,h)&&(h=e.srcEvent.target),e.target=h}function L(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};e.eventType!==Nt&&r.eventType!==Dt||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}function M(t,e){var i,n,o,r,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(e.eventType!=zt&&(l>Ot||a.velocity===s)){var d=e.deltaX-a.deltaX,h=e.deltaY-a.deltaY,u=B(l,d,h);n=u.x,o=u.y,i=wt(u.x)>wt(u.y)?u.x:u.y,r=D(d,h),t.lastInterval=e}else i=a.velocity,n=a.velocityX,o=a.velocityY,r=a.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}function O(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:bt(t.pointers[i].clientX),clientY:bt(t.pointers[i].clientY)},i++;return{timeStamp:_t(),pointers:e,center:N(e),deltaX:t.deltaX,deltaY:t.deltaY}}function N(t){var e=t.length;if(1===e)return{x:bt(t[0].clientX),y:bt(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:bt(i/e),y:bt(n/e)}}function B(t,e,i){return{x:e/t||0,y:i/t||0}}function D(t,e){return t===e?Rt:wt(t)>=wt(e)?t<0?Ft:Wt:e<0?Ht:Ut}function z(t,e,i){i||(i=Gt);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function R(t,e,i){i||(i=Gt);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return 180*Math.atan2(o,n)/Math.PI}function F(t,e){return R(e[1],e[0],Xt)+R(t[1],t[0],Xt)}function W(t,e){return z(e[0],e[1],Xt)/z(t[0],t[1],Xt)}function H(){this.evEl=Qt,this.evWin=Zt,this.pressed=!1,x.apply(this,arguments)}function U(){this.evEl=Jt,this.evWin=te,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function j(){this.evTarget=ie,this.evWin=ne,this.started=!1,x.apply(this,arguments)}function V(t,e){var i=P(t.touches),n=P(t.changedTouches);return e&(Dt|zt)&&(i=E(i.concat(n),"identifier",!0)),[i,n]}function q(){this.evTarget=re,this.targetIds={},x.apply(this,arguments)}function G(t,e){var i=P(t.touches),n=this.targetIds;if(e&(Nt|Bt)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var o,r,a=P(t.changedTouches),s=[],l=this.target;if(r=i.filter(function(t){return y(t.target,l)}),e===Nt)for(o=0;o<r.length;)n[r[o].identifier]=!0,o++;for(o=0;o<a.length;)n[a[o].identifier]&&s.push(a[o]),e&(Dt|zt)&&delete n[a[o].identifier],o++;return s.length?[E(r.concat(s),"identifier",!0),s]:void 0}function X(){x.apply(this,arguments);var t=p(this.handler,this);this.touch=new q(this.manager,t),this.mouse=new H(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Y(t,e){t&Nt?(this.primaryTouch=e.changedPointers[0].identifier,Q.call(this,e)):t&(Dt|zt)&&Q.call(this,e)}function Q(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches,o=function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)};setTimeout(o,ae)}}function Z(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),a=Math.abs(i-o.y);if(r<=se&&a<=se)return!0}return!1}function K(t,e){this.manager=t,this.set(e)}function $(t){if(b(t,pe))return pe;var e=b(t,fe),i=b(t,ge);return e&&i?pe:e||i?e?fe:ge:b(t,ce)?ce:ue}function J(){if(!de)return!1;var t={},e=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){t[i]=!e||o.CSS.supports("touch-action",i)}),t}function tt(t){this.options=gt({},this.defaults,t||{}),this.id=C(),this.manager=null,this.options.enable=g(this.options.enable,!0),this.state=ve,this.simultaneous={},this.requireFail=[]}function et(t){return t&Pe?"cancel":t&we?"end":t&be?"move":t&ye?"start":""}function it(t){return t==Ut?"down":t==Ht?"up":t==Ft?"left":t==Wt?"right":""}function nt(t,e){var i=e.manager;return i?i.get(t):t}function ot(){tt.apply(this,arguments)}function rt(){ot.apply(this,arguments),this.pX=null,this.pY=null}function at(){ot.apply(this,arguments)}function st(){tt.apply(this,arguments),this._timer=null,this._input=null}function lt(){ot.apply(this,arguments)}function dt(){ot.apply(this,arguments)}function ht(){tt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ut(t,e){return e=e||{},e.recognizers=g(e.recognizers,ut.defaults.preset),new ct(t,e)}function ct(t,e){this.options=gt({},ut.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=S(this),this.touchAction=new K(this,this.options.touchAction),pt(this,!0),h(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function pt(t,e){var i=t.element;if(i.style){var n;h(t.options.cssProps,function(o,r){n=T(i.style,r),e?(t.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={})}}function ft(t,e){var i=r.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}var gt,mt=["","webkit","Moz","MS","ms","o"],vt=r.createElement("div"),yt="function",bt=Math.round,wt=Math.abs,_t=Date.now;gt="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==s&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign;var Pt=u(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&t[n[o]]===s)&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),Et=u(function(t,e){return Pt(t,e,!0)},"merge","Use `assign`."),Tt=1,Ct=/mobile|tablet|ip(ad|hone|od)|android/i,At="ontouchstart"in o,xt=T(o,"PointerEvent")!==s,St=At&&Ct.test(navigator.userAgent),kt="touch",It="pen",Lt="mouse",Mt="kinect",Ot=25,Nt=1,Bt=2,Dt=4,zt=8,Rt=1,Ft=2,Wt=4,Ht=8,Ut=16,jt=Ft|Wt,Vt=Ht|Ut,qt=jt|Vt,Gt=["x","y"],Xt=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(A(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(A(this.element),this.evWin,this.domHandler)}};var Yt={mousedown:Nt,mousemove:Bt,mouseup:Dt},Qt="mousedown",Zt="mousemove mouseup";c(H,x,{handler:function(t){var e=Yt[t.type];e&Nt&&0===t.button&&(this.pressed=!0),e&Bt&&1!==t.which&&(e=Dt),this.pressed&&(e&Dt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Lt,srcEvent:t}))}});var Kt={pointerdown:Nt,pointermove:Bt,pointerup:Dt,pointercancel:zt,pointerout:zt},$t={2:kt,3:It,4:Lt,5:Mt},Jt="pointerdown",te="pointermove pointerup pointercancel";o.MSPointerEvent&&!o.PointerEvent&&(Jt="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel"),c(U,x,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=Kt[n],r=$t[t.pointerType]||t.pointerType,a=r==kt,s=_(e,t.pointerId,"pointerId");o&Nt&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):o&(Dt|zt)&&(i=!0),s<0||(e[s]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(s,1))}});var ee={touchstart:Nt,touchmove:Bt,touchend:Dt,touchcancel:zt},ie="touchstart",ne="touchstart touchmove touchend touchcancel";c(j,x,{handler:function(t){var e=ee[t.type];if(e===Nt&&(this.started=!0),this.started){var i=V.call(this,t,e);e&(Dt|zt)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:kt,srcEvent:t})}}});var oe={touchstart:Nt,touchmove:Bt,touchend:Dt,touchcancel:zt},re="touchstart touchmove touchend touchcancel";c(q,x,{handler:function(t){var e=oe[t.type],i=G.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:kt,srcEvent:t})}});var ae=2500,se=25;c(X,x,{handler:function(t,e,i){var n=i.pointerType==kt,o=i.pointerType==Lt;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)Y.call(this,e,i);else if(o&&Z.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var le=T(vt.style,"touchAction"),de=le!==s,he="compute",ue="auto",ce="manipulation",pe="none",fe="pan-x",ge="pan-y",me=J();K.prototype={set:function(t){t==he&&(t=this.compute()),de&&this.manager.element.style&&me[t]&&(this.manager.element.style[le]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return h(this.manager.recognizers,function(e){f(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),$(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,o=b(n,pe)&&!me[pe],r=b(n,ge)&&!me[ge],a=b(n,fe)&&!me[fe];if(o){var s=1===t.pointers.length,l=t.distance<2,d=t.deltaTime<250;if(s&&l&&d)return}return a&&r?void 0:o||r&&i&jt||a&&i&Vt?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ve=1,ye=2,be=4,we=8,_e=we,Pe=16,Ee=32;tt.prototype={defaults:{},set:function(t){return gt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=nt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)?this:(t=nt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return t=nt(t,this),_(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=nt(t,this);var e=_(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(e,t)}var i=this,n=this.state;n<we&&e(i.options.event+et(n)),e(i.options.event),t.additionalEvent&&e(t.additionalEvent),n>=we&&e(i.options.event+et(n))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=Ee)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Ee|ve)))return!1;t++}return!0},recognize:function(t){var e=gt({},t);return f(this.options.enable,[this,e])?(this.state&(_e|Pe|Ee)&&(this.state=ve),this.state=this.process(e),void(this.state&(ye|be|we|Pe)&&this.tryEmit(e))):(this.reset(),void(this.state=Ee))},process:function(t){},getTouchAction:function(){},reset:function(){}},c(ot,tt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(ye|be),o=this.attrTest(t);return n&&(i&zt||!o)?e|Pe:n||o?i&Dt?e|we:e&ye?e|be:ye:Ee}}),c(rt,ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:qt},getTouchAction:function(){var t=this.options.direction,e=[];return t&jt&&e.push(ge),t&Vt&&e.push(fe),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,a=t.deltaY;return o&e.direction||(e.direction&jt?(o=0===r?Rt:r<0?Ft:Wt,i=r!=this.pX,n=Math.abs(t.deltaX)):(o=0===a?Rt:a<0?Ht:Ut,i=a!=this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},attrTest:function(t){return ot.prototype.attrTest.call(this,t)&&(this.state&ye||!(this.state&ye)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=it(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),c(at,ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[pe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ye)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),c(st,tt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ue]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Dt|zt)&&!o)this.reset();else if(t.eventType&Nt)this.reset(),this._timer=l(function(){this.state=_e,this.tryEmit()},e.time,this);else if(t.eventType&Dt)return _e;return Ee},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===_e&&(t&&t.eventType&Dt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=_t(),this.manager.emit(this.options.event,this._input)))}}),c(lt,ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[pe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ye)}}),c(dt,ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:jt|Vt,pointers:1},getTouchAction:function(){return rt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(jt|Vt)?e=t.overallVelocity:i&jt?e=t.overallVelocityX:i&Vt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&wt(e)>this.options.velocity&&t.eventType&Dt},emit:function(t){var e=it(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(ht,tt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ce]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&Nt&&0===this.count)return this.failTimeout();if(n&&o&&i){if(t.eventType!=Dt)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||z(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t;var s=this.count%e.taps;if(0===s)return this.hasRequireFailures()?(this._timer=l(function(){this.state=_e,this.tryEmit()},e.interval,this),ye):_e}return Ee},failTimeout:function(){return this._timer=l(function(){this.state=Ee},this.options.interval,this),Ee},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==_e&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ut.VERSION="2.0.7",ut.defaults={domEvents:!1,touchAction:he,enable:!0,inputTarget:null,inputClass:null,preset:[[lt,{enable:!1}],[at,{enable:!1},["rotate"]],[dt,{direction:jt}],[rt,{direction:jt},["swipe"]],[ht],[ht,{event:"doubletap",taps:2},["tap"]],[st]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Te=1,Ce=2;ct.prototype={set:function(t){return gt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?Ce:Te},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,o=e.curRecognizer;(!o||o&&o.state&_e)&&(o=e.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],e.stopped===Ce||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&i.state&(ye|be|we)&&(o=e.curRecognizer=i),r++}},get:function(t){if(t instanceof tt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=_(e,t);i!==-1&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var i=this.handlers;return h(w(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==s){var i=this.handlers;return h(w(t),function(t){e?i[t]&&i[t].splice(_(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&ft(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&pt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},gt(ut,{INPUT_START:Nt,INPUT_MOVE:Bt,INPUT_END:Dt,INPUT_CANCEL:zt,STATE_POSSIBLE:ve,STATE_BEGAN:ye,STATE_CHANGED:be,STATE_ENDED:we,STATE_RECOGNIZED:_e,STATE_CANCELLED:Pe,STATE_FAILED:Ee,DIRECTION_NONE:Rt,DIRECTION_LEFT:Ft,DIRECTION_RIGHT:Wt,DIRECTION_UP:Ht,DIRECTION_DOWN:Ut,DIRECTION_HORIZONTAL:jt,DIRECTION_VERTICAL:Vt,DIRECTION_ALL:qt,Manager:ct,Input:x,TouchAction:K,TouchInput:q,MouseInput:H,PointerEventInput:U,TouchMouseInput:X,SingleTouchInput:j,Recognizer:tt,AttrRecognizer:ot,Tap:ht,Pan:rt,Swipe:dt,Pinch:at,Rotate:lt,Press:st,on:m,off:v,each:h,merge:Et,extend:Pt,assign:gt,inherit:c,bindFn:p,prefixed:T});var Ae="undefined"!=typeof o?o:"undefined"!=typeof self?self:{};Ae.Hammer=ut,n=function(){return ut}.call(e,i,e,t),!(n!==s&&(t.exports=n))}(window,document,"Hammer")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n["workspace-accessibility-window"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<a role="button" tabindex="0" target=\'_blank\' class="download-full-button" href="'+e(t.fileUrl)+'" download aria-label="'+e(t.fullDescription)+'" title="'+e(t.fullDescription)+'"> <span class="title" id="accessibility-title">'+e(t.title)+' - <span dir="ltr">'+e(t.size)+'</span></span> <span class="description" id="accessibility-description">'+e(t.fullDescription)+"</span></a>";return i},n["workspace-book"]=function(t){var e='<div class="'+t.type+'-viewport" id="'+t.type+'-viewport"> <div id="'+t.type+'-viewport-central" class="'+t.type+'-viewport-central"> <div class="'+t.type+'" id="'+t.type+'"> <!-- Next button --> <div ignore="1" class="next-button"> <button tabindex="0" id="icon-right-note" title="'+t.localization.addNote+'" aria-label="'+t.localization.addNote+'" class="icon icon-add-note right ';return t.notesEnabled||(e+="disabled"),e+='"></button> <div class="btn-container"> <button tabindex="0" class="icon icon-book-next" title="'+t.localization.nextPage+'" aria-label="'+t.localization.nextPage+'"></button> </div> <button tabindex="0" id="icon-book-last" class="icon icon-book-last" title="'+t.localization.lastPage+'" aria-label="'+t.localization.lastPage+'"></button> </div> <!-- Previous button --> <div ignore="1" class="previous-button"> <button tabindex="0" id="icon-left-note" title="'+t.localization.addNote+'" aria-label="'+t.localization.addNote+'" class="icon icon-add-note left ',t.notesEnabled||(e+="disabled"),e+='"></button> <div class="btn-container"> <button tabindex="0" class="icon icon-book-prev" title="'+t.localization.previousPage+'" aria-label="'+t.localization.previousPage+'"></button> </div> <button tabindex="0" id="icon-book-first" class="icon icon-book-first" title="'+t.localization.firstPage+'" aria-label="'+t.localization.firstPage+'"></button> </div> </div> </div></div>'},n["workspace-bottom-menu"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="bottom-toolbar" role="menubar"> <button role="menuitem" class="icon icon-toc group1" id="toc" title="'+e(t.localization.toc)+'" aria-label="'+e(t.localization.toc)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-thumbnails group1" id="thumbnails" title="'+e(t.localization.thumbnails)+'" aria-label="'+e(t.localization.thumbnails)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-note group1" id="notes" title="'+e(t.localization.notes)+'" aria-label="'+e(t.localization.notes)+'" tabindex="0"></button> <span role="separator" class="divider" id="divider1"></span> <button role="menuitem" class="icon icon-social group2" id="social" title="'+e(t.localization.social)+'" aria-label="'+e(t.localization.social)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-font group2" id="text-selection" title="'+e(t.localization.textSelection)+'" aria-label="'+e(t.localization.textSelection)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-print group2" id="print" title="'+e(t.localization.print)+'" aria-label="'+e(t.localization.print)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-download group2" id="download" title="'+e(t.localization.download)+'" aria-label="'+e(t.localization.download)+'" tabindex="0"></button> <button role="menuitem" class="icon icon-sound group2" id="sound" title="'+e(t.localization.sound)+'" aria-label="'+e(t.localization.sound)+'" tabindex="0"></button> <span role="separator" class="divider" id="divider2"></span> <button role="menuitem" class="icon '+(t.fullscreenIcon||"icon-fullscreen")+' group3" id="fullscreen" title="'+e(t.localization.fullscreen)+'" aria-label="'+e(t.localization.fullscreen)+'" tabindex="0"></button> <button role="menuitem" class="icon '+(t.zoomIcon||"icon-zoomin")+' group3" id="zoom-page" title="'+e(t.localization.zoom)+'" aria-label="'+e(t.localization.zoom)+'" tabindex="0"></button> <span role="separator" class="divider" id="divider3"></span> <div class="nav-bar"> <div class=""> <button role="menuitem" class="icon icon-first group4" id="first-page" title="'+e(t.localization.firstPage)+'" aria-label="'+e(t.localization.firstPage)+'"></button> <button role="menuitem" class="icon icon-previous group4" id="prev-page" title="'+e(t.localization.previousPage)+'" aria-label="'+e(t.localization.previousPage)+'"></button> <button role="menuitem" class="icon '+(t.slideshowIcon||"icon-slideshow")+' group4" id="slideshow" title="'+e(t.localization.slideshow)+'" aria-label="'+e(t.localization.slideshow)+'"></button> <button role="menuitem" class="icon icon-next group4" id="next-page" title="'+e(t.localization.nextPage)+'" aria-label="'+e(t.localization.nextPage)+'"></button> <button role="menuitem" class="icon icon-last group4" id="last-page" title="'+e(t.localization.lastPage)+'" aria-label="'+e(t.localization.lastPage)+'"></button> </div> </div></div>';return i},n["workspace-download-window"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";t.full&&(i+='<a role="button" aria-label="'+e(t.localization.fullDescription)+'" aria-labelledby="download-title" aria-describedby="download-descr" tabindex="0" target=\'_blank\' class="download-full-button" href="'+e(t.full.fileUrl)+'" download data-filename="'+e(t.full.fileName||"")+'" data-option="'+e(t.full.option||"")+'"> <span class="title" id="download-title">'+e(t.full.title)+' - <span dir="ltr">'+e(t.full.fileSize)+'</span></span> <span class="description" id="download-descr">'+e(t.localization.fullDescription)+"</span></a>"),i+='<div class="download-list" id="download-list"> <ul> ';var n=t;if(n)for(var o,r=-1,a=n.length-1;r<a;)o=n[r+=1],i+=' <li class="icon icon-file-'+(o.fileIcon||"any")+'"> <a role="button" tabindex="0" target=\'_blank\' href="'+(o.fileUrl||"")+'" download data-filename="'+(o.fileName||"")+'" ',o.pageNum&&(i+='data-pagenum="'+(o.pageNum||"")+'"'),i+=' data-option="'+(o.option||"")+'"> <bdi> <span class="file-name">'+(o.title||""),
o.fileSize&&(i+='</span> </bdi> <span dir="ltr"> <bdi>('+(o.fileSize||"")+")</bdi> </span>"),i+=" </a> </li> ";return i+=" </ul></div>"},n["workspace-note-rect"]=function(t){var e='<div id=\'note-rect\' class="note-rect"> <div class="note-header"></div> <div id="note-body" class="note-body"> <textarea id="note-text-area" class="note-article" dir="'+t.direction+'" placeholder="'+t.localization.PLACEHOLDER+'">'+t.text+'</textarea> <!--<div class="note-article-gradient-top"></div> <div class="note-article-gradient-bottom"></div>--> </div> <div class="note-footer"> <div id="color-set" class="note-color-set"> ',i=t.COLOR_LIST;if(i)for(var n,o=-1,r=i.length-1;o<r;)n=i[o+=1],e+=' <div data-color="'+n+'" class="note-border-color ',t.color===n&&(e+=""+n),e+='" ><div data-color="'+n+'" class="note-color '+n+'"></div></div> ';return e+=' </div> <span id="note-share-button" class="icon icon-share note-button"></span> <div id="note-time" class="note-time"></div> <span id=\'note-delete-button\' class="icon icon-trash-can note-button" title="'+t.localization.DELETE_TIP+'"> </span> </div> <div id="note-delete-dialog"> <div class="note-delete-dialog-text"> <div class="note-delete-dialog-text-flex"> <span>'+t.localization.DIALOG_DELETE_TEXT+'</span> </div> </div> <div class="note-delete-dialog-buttons"> <span class="note-delete-dialog-cancel">'+t.localization.BUTTON_CANCEL+'</span> <span class="note-delete-dialog-confirm">'+t.localization.BUTTON_DELETE+"</span> </div> </div></div>"},n["workspace-pdf-print-window"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div id="print-window"> <div class="print-title-frame"> <span class="text-block">'+(t.text||"")+'</span> <select tabindex="0" class="print-options-list" id="print-opt"> ',n=t;if(n)for(var o,r=-1,a=n.length-1;r<a;)o=n[r+=1],i+=' <option data-url="'+(o.fileUrl||"")+'" data-filename="'+(o.fileName||"")+'" data-option="'+(o.option||"")+'" ',o.pageId&&(i+='data-pageid="'+(o.pageId||"")+'"'),i+=">"+(o.title||"")+" ("+(o.fileSize||"")+")</option> ";return i+=" </select> ",t.printSupported||(i+=' <span class="text-block print-comment" id="print-comment"></span> '),i+=' </div> <div class="print-button-bar"> <div class="progress"> <div class="progress-background" > <div class="progress-bar" id="progress-bar"></div> </div> <bdi> <div id="progress-info" class="text-block progress-info"> </div> </bdi> </div> <div class="waiting-bar"> <div class="circle-loader"></div> <label class="print-window-label">'+(t.waiting||"")+'</label> </div> <button class="idle popup-button cancel-button" id="cancel-btn">'+e(t.cancel)+'</button> <button tabindex="0" aria-label="'+e(t.text)+'" class="idle popup-button print-button" id="print-btn">'+e(t.button)+"</button> </div></div>"},n["workspace-social-window"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="socialBody"> <div class="window-tabs-head ';return t.embedVisibility||(i+="disabled"),i+='"> <span id="share-button-tab" class="active">'+e(t.localization.shareTab)+'</span> <span id="embed-button-tab">'+e(t.localization.embedTab)+'</span> </div> <section class="window-tab active" id="share-tab"> <div class="qr" id="qr"></div> <div class="url-section"> <textarea tabindex="0" class="url-container tip" id="share-url-container" readonly></textarea> <label for="current-page-checkbox" class="current-page-label"><input tabindex="0" type="checkbox" id="current-page-checkbox" /> '+e(t.localization.shareCurrent)+'</label> <button tabindex="0" id="copy-button" class="popup-button social-button tip" data-clipboard-target="#share-url-container">'+e(t.localization.copyButton)+'</button> </div> <span class="text-block">'+e(t.localization.shareText)+'</span> <a role="button" tabindex="0" class="social-link facebook-link" id="facebook-link" target="_blank" title="'+e(t.localization.facebookTitle)+'"></a> <a role="button" tabindex="0" class="social-link twitter-link" id="twitter-link" target="_blank" title="'+e(t.localization.twitterTitle)+'"></a> <a role="button" tabindex="0" class="social-link linkedin-link" id="linkedin-link" target="_blank" title="'+e(t.localization.linkedinTitle)+'"></a> <a role="button" tabindex="0" class="social-link tumblr-link" id="tumblr-link" target="_blank" title="'+e(t.localization.tumblrTitle)+'"></a> <a role="button" tabindex="0" class="social-link google-link" id="google-link" target="_blank" title="'+e(t.localization.googleTitle)+'"></a> <a role="button" tabindex="0" class="social-link mail-link" id="mail-link" target="_blank" title="'+e(t.localization.mailTitle)+'"></a> <a role="button" tabindex="0" class="social-link vk-link" id="vk-link" target="_blank" title="'+e(t.localization.vkTitle)+'"></a> </section> <section class="window-tab " id="embed-tab"> <label class="embed-label">'+e(t.localization.embedType)+' <select id="embed-type-select"> <option value="1">'+e(t.localization.fullPublication)+'</option> <option value="2">'+e(t.localization.linkablePage)+'</option> </select> </label> <label class="embed-label" for="current-page-embed"><input type="checkbox" id="current-page-embed" /> '+e(t.localization.embedCurrent)+'</label> <textarea id="embed-text" class="embed-text-area" readonly></textarea> <div class="embed-size-frame" id="embed-size-frame"> <label for="embed-width">'+e(t.localization.width)+': <input class="size-inp" type="text" value="640" id="embed-width" /></label> <label for="embed-height">'+e(t.localization.height)+': <input class="size-inp" type="text" value="480" id="embed-height" /></label> </div> <span id="embed-copy-button" class="popup-button social-button embed-copy tip" data-clipboard-target="#embed-text">'+e(t.localization.copyButton)+"</span> </section></div>"},n["workspace-tool-window"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="tool-window" id="tool-window"> <div class="tool-title-frame"> <h3 class="tool-title icon icon-'+t.icon+'">'+e(t.title)+'</h3> <button class="icon icon-close" id="tool-left-window" tabindex="1"></button> </div> <div class="tool-header" id="tool-header"></div> <div class="scroller" id="scroller"> <div class="cont" id="content-scroller" tabindex="1"> </div> </div></div>';return i},n["workspace-tooltip"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="arrow"></div><div class="tooltip-content"> '+e(t.text)+"</div>";return i},n["workspace-top-bar"]=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<span class="publication-title" id="publication-title" dir="auto" role="heading" aria-level="1" aria-label="'+e(t.title)+'">'+e(t.title)+'</span><span class="divider" role="separator"></span><span class="pager" id="pager" > <span id="page-text">'+e(t.page||"page:")+'</span> <input type="text" id="pager-val" aria-label="'+e(t.page)+'" role="navigation"> <span id="pages-divider" role="separator">/</span> <span class="pager-total" id="pages-count"></span></span><span class="space" aria-hidden="true"></span><span class="copyright-button" id="copyright-button"> <a role="button"  target="_blank" id="copyright-link"></a></span><span class="accessibility-button" id="accessibility-button" role="menuitem"> <button class="icon icon-accessibility icon-button" tabindex="1" title="'+e(t.accessibilityTitle)+'" aria-label="'+e(t.accessibilityTitle)+'"></button></span><span class="search-button" id="search-button" role="menuitem"> <button class="icon icon-search icon-button" title="'+e(t.searchTitle)+'" aria-label="'+e(t.searchTitle)+'" tabindex="0"></button></span>';return i},e["default"]=n},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){this._state=d.IDLE,this._loadedData=void 0,this._id=void 0,this._type=void 0,this._size=void 0,this.uses=0,this._url=void 0,this._history=[]}Object.defineProperty(e,"__esModule",{value:!0}),e.LoaderEvent=e.LoaderState=e["default"]=void 0;var r=i(0),a=n(r),s=i(1),l=n(s),d={IDLE:0,UNREADY:1,READY:2,LOADING:3,LOADED:4,ERROR:-1,CANCELLED:-2},h={LOADING:"loading",LOADED:"loaded",DATA_IS_READY:"data",ERROR:"error",CANCELLED:"cancelled"};o.prototype=Object.create(l["default"].prototype),o.constructor=o,o.prototype.destructor=function(){this.destructed=!0},o.prototype.free=function(){this._state=d.IDLE,this._loadedData=void 0,this._history.push(this.hash()),this._id=void 0,this._type=void 0,this._size=void 0,this.uses=0,this._url=void 0,l["default"].prototype.destructor.call(this)},o.prototype.setHash=function(t,e,i){return this._id=t,this._type=e,this._size=i||0,this._id+"_"+this._type+"_"+this._size},o.prototype.id=function(){return this._id},o.prototype.type=function(){return this._type},o.prototype.size=function(){return this._size},o.prototype.url=function(){return this._url},o.prototype.hash=function(){return this._id+"_"+this._type+"_"+this._size},o.prototype.getState=function(){return this._state},o.prototype.toString=function(){return this.hash()+"("+this._state+")"},o.prototype.setUrl=function(t){this._url=t},o.prototype.unready=function(){if(this._state!==d.IDLE)throw new Error("Only IDLE loader may become UNREADY.");this._state=d.UNREADY},o.prototype.ready=function(){if(this._state!==d.IDLE&&this._state!==d.UNREADY)throw new Error("Only IDLE or UNREADY loader may become READY.");this._state=d.READY,this._loadedData=this._url},o.prototype.load=function(){if(this._state!==d.READY)throw new Error("Can't load loader with status ",(+this._state));this._state=d.LOADING;var t=this;a["default"].defer(function(){t._onLoad(t._url)}),this.trigger(h.DATA_IS_READY),this.trigger(h.LOADING)},o.prototype.abort=function(){this._state=d.CANCELLED,this.trigger("onCancelled")},o.prototype.isIndefiniteProgress=function(){return!0},o.prototype.getLoadedData=function(){return this.isDataReady()?this._loadedData:void 0},o.prototype.isIdle=function(){return this._state===d.IDLE},o.prototype.isLoaded=function(){return this._state===d.LOADED},o.prototype.isDataReady=function(){return this._state>=d.LOADING},o.prototype.isLoading=function(){return this._state===d.LOADING},o.prototype.isError=function(){return this._state===d.ERROR},o.prototype.setError=function(t){this._onError(t)},o.prototype._onLoad=function(t){this._state=d.LOADED,this._loadedData=t,this.trigger(h.LOADED,this._loadedData)},o.prototype._onError=function(t){this._state=d.ERROR,this.trigger("onError",t)},o.prototype._onProgress=function(t,e,i){var n={progress:t};e&&(n.title=e),i&&(n.image=i),this.trigger("onProgress",n)},e["default"]=o,e.LoaderState=d,e.LoaderEvent=h},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),r=n(o),a=i(16),s=n(a),l={parseTranslate:function(t){function e(t){return parseInt(t.replace("px",""),10)}var i=t.match(/[^(),\s]+/g),n={};if("undefined"==typeof t)return n={},n.translate={x:0,y:0,z:0},n;if(null===i)return n.translate={x:0,y:0,z:0},n;for(var o=0,r=i.length;o<r;o++)switch(i[o]){case"translate":n.translate={x:e(i[o+1]),y:e(i[o+2]),z:0};break;case"translateX":n.translate={x:e(i[o+1]),y:0,z:0};break;case"translateY":n.translate={x:0,y:e(i[o+1]),z:0};break;case"translate3d":n.translate={x:e(i[o+1]),y:e(i[o+2]),z:e(i[o+3])};break;case"translateZ":n.translate={x:0,y:0,z:e(i[o+1])}}return n},translate:function(t,e,i,n){e=e||"0",i=i||"0",n=n||"0",e+="",i+="",n+="",e.indexOf("%")===-1&&(e+="px"),i.indexOf("%")===-1&&(i+="px"),n.indexOf("%")===-1&&(n+="px"),s["default"].csstransforms3d?t.style[s["default"].prefixedCSS("transform")]="translate3d("+e+","+i+","+n+")":t.style[s["default"].prefixedCSS("transform")]="translate("+e+", "+i+")"},origin:function(t,e,i){t.style[s["default"].prefixedCSS("transform-origin")]=e+"px "+i+"px"},transition:function(t,e,i){t.style[s["default"].prefixedCSS("transition")]=i+" "+e+"ms"},duration:function(t,e){t.style[s["default"].prefixedCSS("transition-duration")]=e+"ms"},delay:function(t,e){t.style[s["default"].prefixedCSS("transition-delay")]=e+"ms"},animation:function(t,e,i){t.style[s["default"].prefixedCSS("animation")]=e+" "+i+"ms"},perspective:function(t,e){t.style[s["default"].prefixedCSS("transform")]="perspective("+e+")"},scale:function(t,e,i){t=t||0,e=e||0,i=i||0,s["default"].csstransforms3d?r["default"].style[s["default"].prefixedCSS("transform")]="scale3d("+t+","+e+","+i+")":r["default"].style[s["default"].prefixedCSS("transform")]="scale("+t+","+e+")"},rotate:function(t,e,i,n,o,r){i=i||0,n=n||0,o=o||0,r=r||!1,s["default"].csstransforms3d&&!r?t.style[s["default"].prefixedCSS("transform")]="rotate3d("+i+","+n+","+o+","+e+")":t.style[s["default"].prefixedCSS("transform")]="rotate("+e+")"},backfaceVisibility:function(t,e){t.style[s["default"].prefixedCSS("backface-visibility")]=e},boxShadow:function(t,e){t&&(t.style[s["default"].prefixedCSS("box-shadow")]=e)},getTransform:function(t){return t.style[s["default"].prefixedCSS("transform")]},changeOnlyScale:function(t,e,i,n){var o=/translate3d\([A-Za-z0-9_, ]*\)/i,r=t.style[s["default"].prefixedCSS("transform")].match(o);null===r&&(r=""),t.style[s["default"].prefixedCSS("transform")]=r+" scale3d("+e+","+i+","+n+")"},changeOnlyTranslate:function(t,e,i,n){var o=/scale(3d)?\(.*\)/i,r=t.style[s["default"].prefixedCSS("transform")].match(o);null===r&&(r=""),this.translate(t,e,i,n),r&&r.length&&(t.style[s["default"].prefixedCSS("transform")]=t.style[s["default"].prefixedCSS("transform")]+" "+r[0])}};e["default"]=l},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.model=t,this.rect=e}function r(t,e){o.call(this,t,e)}function a(t){y["default"].call(this,t),this.targetName="TurnJSPresenter",this.contentPresenters={};var e={width:0,height:0};this.bookSizeProvider=this.model.isHardcover()?new r(this.model,e):new o(this.model,e),this.model.on("change:hardcoverColor",this._onHardcoverColorChanged,this)}Object.defineProperty(e,"__esModule",{value:!0});var s=i(0),l=n(s),d=i(4),h=n(d),u=i(26),c=n(u),p=i(27),f=n(p),g=i(86),m=n(g),v=i(30),y=n(v),b=i(5),w=n(b);o.prototype.getPageSize=function(){var t=this.getBookSize();return t.width/=2,t},o.prototype.getBookSize=function(){var t=this.model.getPadding(),e=this.rect.width*t>50?this.rect.width*(1-t):this.rect.width-50,i=h["default"].fitRectIntoBounds({width:2*this.model.getBookSize().width,height:this.model.getBookSize().height},{width:e,height:this.rect.height*(1-t)});return{width:2*Math.round(i.width/2),height:Math.round(i.height)}},o.prototype.setRect=function(t){this.rect=t},r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.getPageSize=function(t){var e=o.prototype.getPageSize.call(this);if(1===t||t===this.model.getPagesCount()&&t%2===0)return e;var i=this.model.getHardcoverSize(),n=e.width/e.height,r=i,a=r*n;return e.width=Math.round(e.width-2*a),e.height=Math.round(e.height-2*r),e},a.prototype=Object.create(y["default"].prototype),a.prototype.constructor=a,a.prototype.destructor=function(){for(var t in this.contentPresenters)this.contentPresenters.hasOwnProperty(t)&&l["default"].isFunction(this.contentPresenters[t].destructor)&&this.contentPresenters[t].destructor();this.view._stopCorner()},a.prototype._createView=function(){return new m["default"](this)},a.prototype.init=function(t){var e=this;this.bookSizeProvider.setRect(t.getBoundingClientRect());var i=this.model.getPager().getState();return this.view.init(t,{hardcover:this.model.isHardcover(),coverColor:this.model.getCoverColor(),startPage:this.model.getPager().pageTable.getPageIndexById(i.leftPage?i.leftPage:i.rightPage)+1,totalPages:this.model.getPagesCount(),rightToLeft:this.model.getPager().isRtl(),pageFlippingDuration:this.model.getFlippingDuration(),bookSizeProvider:this.bookSizeProvider,contentProvider:this,flipCorner:this.model.getFlipCorner(),lightFlipCorner:this.model.getBrowser().firefox,notes:!(0,w["default"])().getLocalStorage().isStub&&this.model.getNotesEnabled()}),this.model.on("change:flipCorner",this._flipCornerUpdate,this),this.view.setPrevButtonVisible(!this.model.getPager().isFirstPage()),this.view.setNextButtonVisible(!this.model.getPager().isLastPage()),this.model.getPager().on("freezed",function(){e.view._jqueryFlipbook.turn("disable",!0),e.view._jqueryFlipbook.turn("stop"),e._flipCornerUpdate(!1)}),this.model.getPager().on("unfreezed",function(){e.view._jqueryFlipbook.turn("disable",!1),e._flipCornerUpdate(e.model.getFlipCorner())}),this.resize(t.getBoundingClientRect()),this.onPagerStateChange(i),y["default"].prototype.init.call(this)},a.prototype._flipCornerUpdate=function(t){this.view.setFlipCorner(t)},a.prototype.getViewContainer=function(){return this.view.getContainer()},a.prototype.getContentForPage=function(t){if(l["default"].has(this.contentPresenters,t))return this.contentPresenters[t].getViewElement();var e=this.model.getPageTable().getPageIdByIndex(t-1);if(!l["default"].isUndefined(e)){var i=this.model.getPageTable().getPageModel(e),n=i.getProperty("wide"),o=t%2!==0;this.model.getPager().isRtl()&&(o=!o);var r=new c["default"](this.model.getBookModel(),i,(!1),n?o?"wideRight":"wideLeft":void 0),a=new f["default"](r).init(this.bookSizeProvider.getPageSize(parseInt(t,10)),!1);return this.listenTo(a,"requestNavigation",function(e){if(!this.view.isFlipping()&&e)switch(e.type){case"page":this.model.getPager().goToPageById(e.data.pageId);break;case"next":if(this.view.isAnimating())break;this.model.getPager().goForward();break;case"prev":if(this.view.isAnimating())break;this.model.getPager().goBackward();break;case"zoom":var i=e.data.center;n&&o&&(i.x+=this.bookSizeProvider.getPageSize(t-1).width),this.model.getPager().setZoomMode(!0,t%2,{name:"mouse",center:i})}},this),this.contentPresenters[t]=a,a.getViewElement()}},a.prototype.goToPage=function(t){var e=this.model.getPager();if(e.isFreezed()&&e.isFreezedBy(this)&&e.unfreeze(this),l["default"].isNumber(t)){var i=this.model.getPageTable(),n=i.getPageIdByIndex(t);e.goToPageById(n,this.targetName)}else switch(t){case"next":e.goForward();break;case"previous":e.goBackward();break;case"first":e.goToFirst();break;case"last":e.goToLast()}e.freeze(this)},a.prototype.resize=function(t){var e=this;this.bookSizeProvider.setRect(t),this.view.resize(),l["default"].each(this.contentPresenters,function(t,i){t.resize(e.bookSizeProvider.getPageSize(parseInt(i,10)))})},a.prototype.onPagerStateChange=function(t,e,i,n){var o=this;if(!l["default"].isNull(t)&&!l["default"].isUndefined(t)&&(y["default"].prototype.onPagerStateChange.apply(this,arguments),this.view.setPrevButtonVisible(!this.model.isFirstPageState(t)),this.view.setNextButtonVisible(!this.model.isLastPageState(t)),this.view.setLastAddNoteVisible(this.model.isLastPageState(t)),this.targetName!==n)){var r=l["default"].isNull(e)||l["default"].isUndefined(e),a=l["default"].isUndefined(t.leftPage)?t.rightPage:t.leftPage;if(!r){var s=l["default"].isUndefined(e.leftPage)?e.rightPage:e.leftPage;if(a!==s){var d=this.model.getPageTable().getPageIndexById(a);if(this.model.isHardcover()){var h=function(t,e){t>=0&&(o.model.getPager().freeze(o),o.once("onPageChanged",function(){o.model.getPager().unfreeze(o),e>=0&&1!=e&&!(e>1&&t-e===1)&&o.view.goToPage(e+1)}),o.view.goToPage(t+1))};if(this.model.isFirstPageState(e)){if(!this.model.isLastPageState(t)||!this.model.hasBackOutsideCover())return void h(1,d)}else if(this.model.isLastPageState(e)&&this.model.hasBackOutsideCover()){if(!this.model.isFirstPageState(t))return void h(this.model.getPagesCount()-2,d)}else if(this.model.isFirstPageState(t)){if(!this.model.isFrontInsideCoverPageState(e))return void h(1,0)}else if(this.model.isLastPageState(t)&&this.model.hasBackOutsideCover()&&!this.model.isBackInsideCoverPageState(e))return void h(this.model.getPagesCount()-2,this.model.getPagesCount()-1)}d>=0&&this.view.goToPage(d+1)}}}},a.prototype.onPageActivate=function(t){y["default"].prototype.onPageActivate.call(this,t);var e=this,i=this.model.getPageTable(),n=i.getPageModel(t),o=n.getProperty("wide"),r=[i.getPageIndexById(t)+1];o&&r.push(i.getPageIndexById(t)+2),l["default"].each(r,function(t){t>0&&(l["default"].has(e.contentPresenters,t)||e.view.addPageContent(t),e.model.getBookModel().isReady?e.contentPresenters[t].setActive(!0):e.model.getBookModel().on("change:isReady",function(i){i&&e.contentPresenters[t].setActive(!0)}))})},a.prototype.onPageDeactivate=function(t){var e=this,i=this.model.getPageTable(),n=i.getPageModel(t),o=n.getProperty("wide"),r=[i.getPageIndexById(t)+1];o&&r.push(i.getPageIndexById(t)+2),l["default"].each(r,function(t){t>0&&l["default"].has(e.contentPresenters,t)&&e.contentPresenters[t].setActive(!1)})},a.prototype.getDataForTransitionStart=function(){var t={};return l["default"].each(this.view.getCurrentPagesDomElements(),function(e,i){t[i-1]=e}),t},a.prototype._onHardcoverColorChanged=function(t){this.view.setCoverColor(t)},a.prototype.destroy=function(){l["default"].each(this.contentPresenters,function(t){t.destroy()}),this.model.off("change:hardcoverColor",this._onHardcoverColorChanged,this),this.model.off("change:flipCorner",this._flipCornerUpdate,this),this.model.destroy(),this.view._stopCorner(),y["default"].prototype.destroy.call(this)},a.prototype.onPageChanged=function(){var t=this.model.getPager();t.isFreezed()&&t.isFreezedBy(this)&&t.unfreeze(this),y["default"].prototype.onPageChanged.call(this)},e["default"]=a},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.parent=t,this.items={}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(2),l=n(s);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.addItem=function(t,e){var i=this.getElementType(e.target);if(!t.include||t.include.indexOf(i)>=0){var n=t.group||0;this.items.hasOwnProperty(n)||(this.items[n]=new Array),this.items[n].push({name:t.name,action:t.action,icon:t.icon,event:t.event,options:t.options,analyticsName:t.analyticsName||t.name})}},o.prototype.removeItemByName=function(t){for(var e in this.items)for(var i=0;i<this.items[e].length;i++)if(this.items[e][i].name.valueOf()==t.valueOf()){this.items[e].splice(i,1);break}},o.prototype.clearItems=function(){this.items={},this._hideMenu&&this._hideMenu()},o.prototype.setItems=function(t){this.clearItems();for(var e=0;e<t.length;e++)t[e].name&&(t[e].action||t[e].event)&&this.addItem(t[e])},o.prototype.getUrlHeaderByX=function(t){var e=(0,l["default"])().get(l["default"].PAGER),i=e.getState().leftPage,n=e.getState().rightPage,o=i;if(n){var r=e.isRtl(),a=t>document.documentElement.clientWidth/2?r?"left":"right":r?"right":"left";o="left"===a?i:n}return e.pageTable.getUrlHeaderById(o)},o.prototype.getElementType=function(t){var e={image:"image",video:"video","publication-link":"link",gif:"gif","publication-note":"note"},i=["playButton","image-inner","thumbnail","highlight","note-icon"],n="page",o=t.classList[0];return i.indexOf(o)!==-1&&(o=t.parentElement.classList[0]),e.hasOwnProperty(o)&&(n=e[o]),n},o.prototype.getLength=function(t){if(void 0===t){var e=0;for(var t in this.items)e+=this.items[t].length;return e}return this.items.hasOwnProperty(t)&&this.items[t].length,0},o.prototype.showMenu=function(t){if(this.getLength()>0&&!t.ctrlKey){var e=this.getElementType(t.target),i=i||this.parent;t=t||window.event,t.preventDefault?t.preventDefault():t.returnValue=!1,this.initMenu(i);var n=this.DOMObj.getBoundingClientRect(),r=i.getBoundingClientRect(),a=t.pageX,s=t.pageY,d=a-r.left,h=s-r.top,u=(0,l["default"])().get(l["default"].LOCALE).isLocaleRTL();u?d-n.width>=0?this.DOMObj.style.left=a-n.width+"px":d+n.width<r.width?this.DOMObj.style.left=a+"px":this.DOMObj.style.left=r.left+r.width-n.width+"px":d+n.width<r.width?this.DOMObj.style.left=a+"px":d-n.width>=0?this.DOMObj.style.left=a-n.width+"px":this.DOMObj.style.left=r.left+r.width-n.width+"px",h+n.height<r.height?this.DOMObj.style.top=s+"px":h-n.height>=0?this.DOMObj.style.top=s-n.height+"px":this.DOMObj.style.top=r.top+r.height-n.height+"px",(0,l["default"])().get(l["default"].API).trigger("contextMenu",{action:"open",page:this.getUrlHeaderByX(a),elementType:e,x:a,y:s});var c=this,p=function f(){c.DOMObj&&c.DOMObj.parentNode&&c.DOMObj.parentNode.removeChild(c.DOMObj),this.onclick=void 0,document.removeEventListener("click",f),document.removeEventListener("keydown",f),delete c._hideMenu,c.trigger(o.HIDE_EVENT)};this._hideMenu=p,document.addEventListener("click",p),document.addEventListener("keydown",p),c.trigger(o.SHOW_EVENT,t)}else this._hideMenu&&this._hideMenu()},o.prototype.initMenu=function(t){this.DOMObj&&this.DOMObj.parentNode&&this.DOMObj.parentNode.removeChild(this.DOMObj);var e=this,i=document.createElement("div");i.className="context-menu";var n=document.createElement("ul");i.appendChild(n);var o=!0;for(var r in this.items){if(!o){var a=document.createElement("li");a.className="context-menu-divider",n.appendChild(a)}for(var s=0;s<this.items[r].length;s++){var a=document.createElement("li");a.className="context-menu-item",n.appendChild(a),a.setAttribute("data-index",s),a.setAttribute("group",r);var d=document.createElement("span");if(d.className="context-menu-item-name",d.textContent=this.items[r][s].name,this.items[r][s].icon){var h=document.createElement("div");h.className="icon "+this.items[r][s].icon,a.appendChild(h)}a.appendChild(d),a.onclick=function(t){var i=this.getAttribute("data-index"),n=this.getAttribute("group");e.items[n][i].action&&e.items[n][i].action(e.items[n][i].options),e.items[n][i].event&&e.trigger(e.items[n][i].event,e.items[n][i].options),(0,l["default"])().get(l["default"].API).trigger("contextMenu",{action:"select",page:e.getUrlHeaderByX(t.x),selectedItem:e.items[n][i].analyticsName})}}o=!1}this.DOMObj=i,t.appendChild(i)},o.HIDE_EVENT="HIDE_EVENT",o.SHOW_EVENT="SHOW_EVENT",e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.presenter=t,this.scaleFactor=1,this.offsetFactor=0}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.init=function(){},o.prototype.getDOMElement=function(){throw new Error("Method getDOMElement should be overridden")},o.prototype.scale=function(t,e){this.scaleFactor=t,this.currentSize=e},o.prototype.offset=function(t){this.offsetFactor=t},o.prototype.commit=function(){},o.prototype.destructor=function(){},o.prototype.highlight=function(){},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.model=t}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(2),l=n(s);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.getView=function(){return this.view},o.prototype.getLocaleProvider=function(){return(0,l["default"])().get(l["default"].LOCALE)},o.prototype.getApiProvider=function(){return(0,l["default"])().get(l["default"].API)},o.prototype.scale=function(t,e){this.getView().scale(t,e)},o.prototype.offset=function(t){this.getView().offset(t)},o.prototype.commit=function(){this.getView().commit()},o.prototype.destructor=function(){this.getView().destructor()},o.prototype.highlight=function(){this.getView().highlight()},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this._defaultObject=e,this._construct(t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(1),l=n(s),d=i(4),h=n(d);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.cast=function(t){function e(t,e,i,n){if(n=n||0,!(n>e.length)){for(var o=0;o<e.length-n;o++){var r=e[o];if(!a["default"].has(t,r)){if(!i)return;t[r]={}}t=t[r]}return t}}var i=t.split("."),n=e(this,i,!0),r=e(this._defaultObject,i,!1);if(n.constructor!==o){var s=new o(n,r),l=e(this,i,!0,1);return l[i[i.length-1]]=s,this._updateInfoAboutCastedObjects(i),s}},o.prototype.set=function(t,e,i){if(a["default"].isUndefined(t)&&a["default"].isObject(e))throw new Error("You can't set the value of properties");var n=t.split("."),o=this._getCasted(n);if(o)if(o.name)o.value.set(o.name,e,i);else{if(!o.value||!a["default"].isObject(e))throw new Error("You can't set the value of properties");o.value.reset(e)}else l["default"].prototype.set.call(this,t,e,i)},o.prototype.onAndChange=function(t,e,i){this.on(t,e,i),this.trigger(t,this._get(t.split(":")[1]),void 0,i)},o.prototype._construct=function(t){var e=this._defaultObject?h["default"].deepExtend({},this._defaultObject,t):t;for(var i in e)e.hasOwnProperty(i)&&"_"!==i[0]&&(this[i]=e[i])},o.prototype._updateInfoAboutCastedObjects=function(t){a["default"].isObject(this._infoAboutCastedObject)||(this._infoAboutCastedObject={});for(var e=this._infoAboutCastedObject,i=0;i<t.length-1;i++){var n=t[i];a["default"].isObject(e[n])||(e[n]={}),e=e[n]}e[t[t.length-1]]=!0},o.prototype._makeNewName=function(t,e){for(var i=t[e],n=e+1;n<t.length;n++)i+="."+t[n];return i},o.prototype._getCasted=function(t){for(var e=this._infoAboutCastedObject,i=this,n=0;n<t.length;n++){if(!a["default"].isObject(e)){if(e===!0){for(var o=t[n],r=n+1;r<t.length;r++)o+="."+t[r];return{value:i,name:this._makeNewName(t,n)}}return}var s=t[n];e=e[s],i=i[s]}return e===!0?{value:i,name:this._makeNewName(t,n)}:void 0},o.prototype.clear=function(){var t=this;Object.keys(this).forEach(function(e){"_"!==e[0]&&delete t[e]})},o.prototype._get=function(t){for(var e=t.split("."),i=this,n=0;n<e.length;n++)if(i=i[e[n]],a["default"].isUndefined(i))return;return i},o.prototype.reset=function(t){if(!a["default"].isObject(t))throw new Error("The value for reset need to be an Object");var e=this._defaultObject?h["default"].deepExtend({},this._defaultObject,t):t;if(!a["default"].isEmpty(this._infoAboutCastedObject))throw new Error("You can't reset complex property");var i=this,n=function(t){for(var n=t.split("."),o=i,r=e,a=0;a<n.length-1;a++){var s=n[a];o=o&&o.hasOwnProperty(s)?o[s]:null,r=r&&r.hasOwnProperty(s)?r[s]:null}var l={};return o&&o.hasOwnProperty(n[n.length-1])&&(l.oldValue=o[n[n.length-1]]),r&&r.hasOwnProperty(n[n.length-1])&&(l.newValue=r[n[n.length-1]]),l},o=function(){var t=[];return a["default"].isEmpty(i._events)||Object.keys(i._events).forEach(function(e){if(e.startsWith("change:")){var o=i._events[e];if(o)for(var r in o)if(o.hasOwnProperty(r)){var s=o[r],l=n(e.substr(7));t.push(a["default"].extend(l,{event:s}))}}}),t},r=o();this.clear(),Object.keys(e).forEach(function(t){"_"!==t[0]&&(i[t]=e[t])}),Object.keys(r).forEach(function(t){"_"!==t[0]&&(i[t]=e[t]);var n=r[t],o=n.event;o.callback.apply(o.context,[n.newValue,n.oldValue,o])})},o.prototype.destructor=function(){function t(e,i){for(var n in i)if(i[n]===!0){var r=e[n];a["default"].isObject(r)&&r.constructor===o&&r.destructor()}else t(e[n],i[n])}a["default"].isObject(this._infoAboutCastedObject)&&t(this,this._infoAboutCastedObject);for(var e in this)a["default"].has(this,e)&&delete this[e];l["default"].prototype.destructor.call(this);
},o.prototype.getJSON=function(t){var e=t||this,i=function(t,e){if("_"!==t.substring(0,1))return e};return JSON.stringify(e,i)},e["default"]=o},function(t,e,i){"use strict";function n(t,e){return("undefined"==typeof t?"undefined":y(t))===e}function o(){var t,e,i,o,r,a,s;for(var l in w)if(w.hasOwnProperty(l)){if(t=[],e=w[l],e.name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(i=0;i<e.options.aliases.length;i++)t.push(e.options.aliases[i].toLowerCase());for(o=n(e.fn,"function")?e.fn():e.fn,r=0;r<t.length;r++)a=t[r],s=a.split("."),1===s.length?P[s[0]]=o:(!P[s[0]]||P[s[0]]instanceof Boolean||(P[s[0]]=new Boolean(P[s[0]])),P[s[0]][s[1]]=o),b.push((o?"":"no-")+s.join("-"))}}function r(t){var e=E.className,i=P._config.classPrefix||"";if(T&&(e=e.baseVal),P._config.enableJSClass){var n=new RegExp("(^|\\s)"+i+"no-js(\\s|$)");e=e.replace(n,"$1"+i+"js$2")}P._config.enableClasses&&(e+=" "+i+t.join(" "+i),T?E.className.baseVal=e:E.className=e)}function a(){return"function"!=typeof document.createElement?document.createElement(arguments[0]):T?document.createElementNS.call(document,"http://www.w3.org/2000/svg",arguments[0]):document.createElement.apply(document,arguments)}function s(){var t=document.body;return t||(t=a(T?"svg":"body"),t.fake=!0),t}function l(t,e,i,n){var o,r,l,d,h="modernizr",u=a("div"),c=s();if(parseInt(i,10))for(;i--;)l=a("div"),l.id=n?n[i]:h+(i+1),u.appendChild(l);return o=a("style"),o.type="text/css",o.id="s"+h,(c.fake?c:u).appendChild(o),c.appendChild(u),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),u.id=h,c.fake&&(c.style.background="",c.style.overflow="hidden",d=E.style.overflow,E.style.overflow="hidden",E.appendChild(c)),r=e(u,t),c.fake?(c.parentNode.removeChild(c),E.style.overflow=d,E.offsetHeight):u.parentNode.removeChild(u),!!r}function d(t,e){return!!~(""+t).indexOf(e)}function h(t){return t.replace(/([a-z])-([a-z])/g,function(t,e,i){return e+i.toUpperCase()}).replace(/^-/,"")}function u(t,e){return function(){return t.apply(e,arguments)}}function c(t,e,i){var o;for(var r in t)if(t[r]in e)return i===!1?t[r]:(o=e[t[r]],n(o,"function")?u(o,i||e):o);return!1}function p(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}).replace(/^ms-/,"-ms-")}function f(t,e){var i=t.length;if("CSS"in window&&"supports"in window.CSS){for(;i--;)if(window.CSS.supports(p(t[i]),e))return!0;return!1}if("CSSSupportsRule"in window){for(var n=[];i--;)n.push("("+p(t[i])+":"+e+")");return n=n.join(" or "),l("@supports ("+n+") { #modernizr { position: absolute; } }",function(t){return"absolute"==getComputedStyle(t,null).position})}}function g(t,e,i,o){function r(){l&&(delete M.style,delete M.modElem)}if(o=!n(o,"undefined")&&o,!n(i,"undefined")){var s=f(t,i);if(!n(s,"undefined"))return s}for(var l,u,c,p,g,m=["modernizr","tspan","samp"];!M.style&&m.length;)l=!0,M.modElem=a(m.shift()),M.style=M.modElem.style;for(c=t.length,u=0;u<c;u++)if(p=t[u],g=M.style[p],d(p,"-")&&(p=h(p)),void 0!==M.style[p]){if(o||n(i,"undefined"))return r(),"pfx"!=e||p;try{M.style[p]=i}catch(v){}if(M.style[p]!=g)return r(),"pfx"!=e||p}return r(),!1}function m(t,e,i,o,r){var a=t.charAt(0).toUpperCase()+t.slice(1),s=(t+" "+k.join(a+" ")+a).split(" ");return n(e,"string")||n(e,"undefined")?g(s,e,o,r):(s=(t+" "+I.join(a+" ")+a).split(" "),c(s,e,i))}function v(t,e,i){return m(t,void 0,void 0,e,i)}Object.defineProperty(e,"__esModule",{value:!0});var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=[],w=[],_={_version:"3.3.1",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var i=this;setTimeout(function(){e(i[t])},0)},addTest:function(t,e,i){w.push({name:t,fn:e,options:i})},addAsyncTest:function(t){w.push({name:null,fn:t})}},P=function(){};P.prototype=_,P=new P;var E=document.documentElement,T="svg"===E.nodeName.toLowerCase(),C="CSS"in window&&"supports"in window.CSS,A="supportsCSS"in window;P.addTest("supports",C||A);var x=_.testStyles=l,S="Moz O ms Webkit",k=_._config.usePrefixes?S.split(" "):[];_._cssomPrefixes=k;var I=_._config.usePrefixes?S.toLowerCase().split(" "):[];_._domPrefixes=I;var L={elem:a("modernizr")};P._q.push(function(){delete L.elem});var M={style:L.elem.style};P._q.unshift(function(){delete M.style}),_.testAllProps=m,_.testAllProps=v,P.addTest("csstransforms3d",function(){var t=!!v("perspective","1px",!0),e=P._config.usePrefixes;if(t&&(!e||"webkitPerspective"in E.style)){var i,n="#modernizr{width:0;height:0}";P.supports?i="@supports (perspective: 1px)":(i="@media (transform-3d)",e&&(i+=",(-webkit-transform-3d)")),i+="{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}",x(n+i,function(e){t=7===e.offsetWidth&&18===e.offsetHeight})}return t});var O=function(t){var e,i=prefixes.length,n=window.CSSRule;if("undefined"!=typeof n){if(!t)return!1;if(t=t.replace(/^@/,""),e=t.replace(/-/g,"_").toUpperCase()+"_RULE",e in n)return"@"+t;for(var o=0;o<i;o++){var r=prefixes[o],a=r.toUpperCase()+"_"+e;if(a in n)return"@-"+r.toLowerCase()+"-"+t}return!1}};_.atRule=O;var N=_.prefixed=function(t,e,i){return 0===t.indexOf("@")?O(t):(t.indexOf("-")!=-1&&(t=h(t)),e?m(t,e,i):m(t,"pfx"))};_.prefixedCSS=function(t){var e=N(t);return e&&p(e)};o(),r(b),delete _.addTest,delete _.addAsyncTest;for(var B=0;B<P._q.length;B++)P._q[B]();e["default"]=P},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),r=n(o),a=i(4),s=n(a),l=i(3),d=n(l),h=i(0),u=(n(h),i(1)),c=n(u),p=i(2),f=n(p),g=i(11),m=n(g),v=function(){function t(){if(e)return e;if(!(this instanceof t))return new t;e=this,i=this,this.state=v.CLOSE_STATE;var n=this.getUserAgentInfo().browser;this.downRect=!1,document.addEventListener("mousedown",function(t){i.clickTarget=t.target,i.time=Date.now(),s["default"].hasParentClass(t.target,"note-rect")&&(i.downRect=!0)}),document.addEventListener("mouseup",function(t){i.downRect=!1,i.clickTarget===t.target&&i.click.call(i,t,Date.now()-i.time),delete i.clickTarget}),document.addEventListener("mousemove",function(t){i.downRect||!(1===t.buttons||n.safari&&1===t.which)||i.getState()===v.CLOSE_STATE||s["default"].hasParentClass(t.target,"note")||i.close()},!1),document.addEventListener("click",function(t){},!1),document.addEventListener("keydown",function(t){if(27===t.keyCode&&i.state!==v.CLOSE_STATE&&(i.setText(i.noteTextArea.value),i.close()),i.state!==v.CLOSE_STATE&&i.state===v.VIEW_STATE&&t.preventDefault(),(46===t.keyCode||8===t.keyCode)&&i.state!==v.CLOSE_STATE){if(i.noteTextArea===document.activeElement)return;0===i.noteTextArea.textLength?(i.trigger(v.DELETE_EVENT+i.eventSuffix()),i.close()):d["default"].addClass(i.noteDeleteDialog,"show-dialog")}},!1)}var e,i;return t.prototype=new c["default"],t.prototype.constructor=t,t.prototype.click=function(t,e){this.noteRect&&(s["default"].hasParentClass(t.target,"note-rect")||s["default"].hasParentClass(t.target,"publication-note")||s["default"].hasParentClass(t.target,"context-menu")?i.state===v.VIEW_STATE&&s["default"].hasParentClass(t.target,"note-body")&&s["default"].hasParentClass(t.target,"note-rect")?i.setState(v.EDIT_STATE):s["default"].hasParentClass(t.target,"icon-trash-can")&&s["default"].hasParentClass(t.target,"note-button")?0===i.noteTextArea.textLength?(i.trigger(v.DELETE_EVENT+i.eventSuffix()),i.close()):d["default"].addClass(i.noteDeleteDialog,"show-dialog"):s["default"].hasParentClass(t.target,"note-delete-dialog-cancel")?(d["default"].removeClass(i.noteDeleteDialog,"show-dialog"),this.forceHide&&i.close()):s["default"].hasParentClass(t.target,"note-delete-dialog-confirm")&&(i.trigger(v.DELETE_EVENT+i.eventSuffix()),i.close()):i.close())},t.prototype.showDeleteDialog=function(){d["default"].addClass(this.noteDeleteDialog,"show-dialog")},t.prototype.forceDialogHide=function(){this.forceHide=!0},t.prototype.getState=function(){return this.state},t.prototype.eventSuffix=function(t){return t=t||this.ids,"_"+t.pageId+"_"+t.noteId},t.prototype.setText=function(t){var e=v.CHANGE_TEXT_EVENT+this.eventSuffix();this.trigger(e,t)},t.prototype.setState=function(t){d["default"].hasClass(this.noteRect,v.EDIT_STATE)&&d["default"].removeClass(this.noteRect,v.EDIT_STATE),d["default"].hasClass(this.noteRect,v.VIEW_STATE)&&d["default"].removeClass(this.noteRect,v.VIEW_STATE),d["default"].addClass(this.noteRect,t),t===v.EDIT_STATE&&(this.oldText=this.noteTextArea.value,this.noteTextArea.addEventListener("blur",function(){i.oldText!==i.noteTextArea.value&&i.setText(i.noteTextArea.value)}),this.noteTextArea.addEventListener("keydown",function(t){t.ctrlKey&&13===t.keyCode&&(i.setText(i.noteTextArea.value),i.setState(v.VIEW_STATE))},!1),this.noteTextArea.value.length>0&&this.noteTextArea.focus(),this.options&&this.options.model&&this.options.model.isNew&&(this.noteTextArea.focus(),delete this.options.model.isNew)),this.state=t,this.trigger(v.CHANGE_STATE_EVENT,{state:t})},t.prototype.open=function(t,e){if(this.state===v.CLOSE_STATE||!this.ids||!this.isSameIds(e)){var n=this._getAreaContainer();this.noteRect&&this.close(null,!0),this.ids=e,this.options=t,s["default"].renderTemplate(n,r["default"]["workspace-note-rect"],t),this.noteRect=d["default"].id("note-rect"),this.noteTextArea=d["default"].id("note-text-area"),this.noteDeleteDialog=d["default"].id("note-delete-dialog"),this.noteRect&&(this.noteRect.style["z-index"]=10001,this.setState(t.text?v.VIEW_STATE:v.EDIT_STATE)),this.colorSet=d["default"].id("color-set"),this.noteTime=d["default"].id("note-time");var o=new Date(Date.now()),a=new Date(t.date),l=a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});o.getDay()===a.getDay()&&o.getFullYear()===a.getFullYear()&&o.getMonth()===a.getMonth()||(l=a.toLocaleDateString()+", "+l),this.noteTime.innerText=l,this.colorSet.addEventListener("click",function(t){var e=t.target.getAttribute("data-color");if(e){i.trigger(v.CHANGE_COLOR_EVENT+i.eventSuffix(),e);for(var n=d["default"].className("note-border-color"),o=0;o<n.length;o++){var r=n[o],a=r.getAttribute("data-color");r.className="note-border-color",a===e&&d["default"].addClass(r,e)}}t.stopImmediatePropagation()},!0);var h={action:"open",text:t.model.note.text,pageUrl:t.model.getUrlHeader()};this.getApiProvider().trigger("note",h)}},t.prototype.isSameIds=function(t){return t.noteId===this.ids.noteId&&t.pageId===this.ids.pageId},t.prototype.close=function(t,e){if(this.forceHide&&delete this.forceHide,this.ids&&(!t||this.isSameIds(t))){var i=d["default"].id("note-rect");i&&(d["default"].del(i),delete this.noteRect),e||this.setState(v.CLOSE_STATE),delete this.ids}},t.prototype._getAreaContainer=function(){var t=(0,f["default"])().get(f["default"].CURRENT_PRESENTER);return t.constructor===m["default"]?t.view.flipbook:t.view.currentWrapper?t.view.currentWrapper.content:null},t.prototype.getUserAgentInfo=function(){return(0,f["default"])().get(f["default"].USER_AGENT_INFO)},t.prototype.getApiProvider=function(){return(0,f["default"])().get(f["default"].API)},t}();v.VIEW_STATE="view",v.EDIT_STATE="edit",v.CLOSE_STATE="close",v.OPEN_MENU_STATE="open",v.CLOSE_MENU_STATE="close",v.CHANGE_COLOR_EVENT="CHANGE_COLOR_EVENT",v.CHANGE_STATE_EVENT="CHANGE_STATE_EVENT",v.CHANGE_TEXT_EVENT="CHANGE_TEXT_EVENT",v.DELETE_EVENT="DELETE_EVENT",e["default"]=v},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),r=n(o),a=i(1),s=n(a),l=i(5),d=n(l),h=i(3),u=n(h),c=function(){function e(){return i?i:this instanceof e?(i=this,void(i.root=u["default"].tag("body"))):new e}var i,n=function(e,i,n,o){var r=o?o.getBoundingClientRect():{width:t.innerWidth,height:t.innerHeight},a=Math.max(100,Math.min(r.width/10,r.height/10)),n=n||!1,s=r.width-a,l=r.height-a,d=s/l,h=e/i,u=d>h?e*l/i:s,c=d>h?l:i*s/e;return n&&(u>e||c>i)?(u=e,c=i,s+=a,l+=a,a=0):(u=Math.round(u),c=Math.round(c)),{width:u,height:c,paddingTop:(l+a-c)/2-10,paddingLeft:(s+a-u)/2-10}},o=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent("on"+e,i)},a=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.detachEvent("on"+e,i)};return e.prototype=new s["default"],e.prototype.setRootContainer=function(t){this.root=t},e.prototype.showFrame=function(e,i){var n=this,a=this.root;this.sizer=i,this.frame=e,this.blackout=u["default"].createElement("div",{"class":"black-out"},a),this.lightbox=u["default"].createElement("div",{"class":"contentfull-lightbox"},a),this.closeButton=u["default"].createElement("div",{"class":"closeButton"},this.lightbox),"img"===e.tagName.toLowerCase()?e.naturalWidth?(this.lightbox.appendChild(e),this._sizing(!0),n.trigger("contentLoaded")):(this.pr=document.createElement("img"),this.pr.src=(0,d["default"])().translatePath("static/html/styles/img/lightbox-preloader.gif"),n.lightbox.appendChild(this.pr),this._sizing(!0)):(this.lightbox.appendChild(e),this._sizing(),n.trigger("contentLoaded")),this._bindClose(),r["default"].defer(function(){u["default"].addClass(a,"lightbox-opened")}),o(t,"resize",function(){var t=!i||i.maxSizes;n._sizing.call(n,t)})},e.prototype._sizing=function(t){var e=1600,i=900;this.sizer&&this.sizer.width&&this.sizer.height&&(e=this.sizer.width,i=this.sizer.height,this.pr&&this.pr.parentElement===this.lightbox&&(this.lightbox.removeChild(this.pr),this.lightbox.appendChild(this.frame))),t=t||!1;var o=n(e,i,t,this.root);this.lightbox.style.width=o.width+"px",this.lightbox.style.height=o.height+"px",this.lightbox.style.top=o.paddingTop+"px",this.lightbox.style.left=o.paddingLeft+"px",this.lightbox.style.margin="0"},e.prototype._close=function(){var t=this,e=this.root;u["default"].removeClass(e,"lightbox-opened"),u["default"].del(t.lightbox),function i(){var e=getComputedStyle(t.blackout);"hidden"===e.visibility?(u["default"].del(t.blackout),t.trigger("closed")):setTimeout(i,100)}()},e.prototype._bindClose=function(){var e=this,i=function r(i){27===i.keyCode&&(i.stopPropagation(),a(t.document,"keyup",r),e._close())},n=function(n){n.stopPropagation(),a(t.document,"keyup",i),e._close()};o(this.closeButton,"mousedown",n),o(this.blackout,"click",n),o(t.document,"keyup",i)},e}();e["default"]=c}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){this.value={},this.oldValue={},this.value.changingPosition=!1,this.value.changingZoom=!1,this.value.changeFullscreen=!1,this.video={}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(0),l=n(s);Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var i=Object(t),n=1;n<arguments.length;n++){var o=arguments[n];if(void 0!==o&&null!==o)for(var r=Object.keys(Object(o)),a=0,s=r.length;a<s;a++){var l=r[a],d=Object.getOwnPropertyDescriptor(o,l);void 0!==d&&d.enumerable&&(i[l]=o[l])}}return i}}),o.POSITION="POSITION",o.ZOOM="ZOOM",o.NONE="NONE",o.FULLSCREEN="FULLSCREEN",o.VIDEO_PLAYING="VIDEO_PLAYING",o.VIDEO_STOPPED="VIDEO_STOPPED",o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.getLastChanging=function(){return this.value.changingPosition?o.POSITION:this.value.changingZoom?o.ZOOM:this.value.changeFullscreen?o.FULLSCREEN:this.oldValue.changingPosition?o.POSITION:this.oldValue.changingZoom?o.ZOOM:this.oldValue.changeFullscreen?o.FULLSCREEN:o.NONE},o.prototype.changeFullscreen=function(t,e){Object.assign(this.oldValue,this.value),this.value.changeFullscreen=!0,this.value.from=t,this.value.to=e,this.trigger("update",this.value,this.oldValue)},o.prototype.startChangingPosition=function(t,e){Object.assign(this.oldValue,this.value),this.value.changingPosition=!0,this.value.from=t,this.value.to=e,this.trigger("update",this.value,this.oldValue)},o.prototype.endChangingPosition=function(){Object.assign(this.oldValue,this.value),this.value.changingPosition=!1,this.trigger("update",this.value,this.oldValue)},o.prototype.startChangingZoom=function(t,e){Object.assign(this.oldValue,this.value),this.value.changingZoom=!0,this.value.from=t,this.value.to=e,this.trigger("update",this.value,this.oldValue)},o.prototype.endChangingZoom=function(){Object.assign(this.oldValue,this.value),this.value.changingZoom=!1,this.trigger("update",this.value,this.oldValue)},o.prototype.getVideoState=function(t,e){return this._getPage(t)[e]},o.prototype._getPage=function(t){var e={},i=this.video[t];return i&&(e=i),e},o.prototype._setPage=function(t,e){this.video[t]=e},o.prototype.start=function(t,e){var i=this._getPage(t);i[e]=o.VIDEO_PLAYING,this._setPage(t,i)},o.prototype.stop=function(t,e){var i=this._getPage(t);i[e]=o.VIDEO_STOPPED,this._setPage(t,i)},o.prototype.removeStorageExcept=function(){for(var t=Array.prototype.slice.call(arguments),e={},i=0;i<t.length;i++)l["default"].isUndefined(t[i])||l["default"].isUndefined(this.video[t[i]])||(e[t[i]]=this.video[t[i]]);this.video=e},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){e=e||{},this.extensions=e.extensions,this.userAgentInfo=e.userAgentInfo,this.services=e.services||{};var i=this;(0,P["default"])().set(P["default"].LIBRARY_MANAGER,e.moduleManager||new X(e.adapter,"modules/")),(0,P["default"])().set(P["default"].BOOK_STATE,new R["default"]),(0,P["default"])().set(P["default"].WIDE_HIGHLIGHTER,new W["default"]),(0,P["default"])().set(P["default"].NOTE_MANAGER,new S["default"]),y["default"].isObject(e.api)&&y["default"].isFunction(e.api.addMethod)?(this.api=e.api,this.api.addMethod(o.FREEZE,function(){if(!y["default"].isUndefined(i._isFreezed))throw new Error("Publication is freezed already");i._isFreezed=!0,i.pager&&i.pager.freeze("api"),i.workspace&&i.workspace.freeze()}),this.api.addMethod(o.UNFREEZE,function(){if(i._isFreezed!==!0)throw new Error("Publication is not freezed yet");delete i._isFreezed,i.pager&&i.pager.unfreeze("api"),i.workspace&&i.workspace.unfreeze()}),this.api.addMethod(o.GET_PROPERTY,function(t){switch(t){case"skin":return i.skinConfig;case"pages":return i.pagesProps;case"workspace":return i.workspaceProps;default:throw new Error("Publication does not have this property: "+t)}}),this.api.addMethod(o.GET_STATE,function(){return i.getState()}),this.api.addMethod(o.SET_LOCALIZATION_STRING,function(t,e){return i.setLocalizationString(t,e)}),this.api.addMethod(o.GOTO_PAGE,function(t){return i.goToPage(t)}),this.api.addMethod(o.GOTO_PAGE_BY_ID,function(t){return i.goToPageById(t)}),this.api.addMethod(o.GOTO_PAGE_BY_URL_HEADER,function(t){return i.goToPageByUrlHeader(t)}),this.api.addMethod(o.SHOW_BOOK,function(t){return i.showBook(t)}),this.api.addMethod(o.REMOVE_PROPERTY,function(t,e){return i.removeProperty(t,e)}),this.api.addMethod(o.RESET_NUMERATION,function(){return i.resetNumeration()}),(0,P["default"])().set(P["default"].API,this.api)):(0,P["default"])().set(P["default"].API,new a["default"]),this.pagerFunc=null,y["default"].isFunction(e.getPager)&&(this.pagerFunc=e.getPager),this.isStarted=!1,y["default"].isObject(t)?this.container=t:this.container=m["default"].tag("body"),(0,P["default"])().set(P["default"].CONTEXT_MENU,new U["default"](this.container)),i.contextMenu().on("showAbout",function(){this.showAbout()},this),this.container.addEventListener("contextmenu",function(t){i.contextMenu().clearItems()},!0),this.container.addEventListener("contextmenu",function(t){i.contextMenu().showMenu(t)},!1),(0,P["default"])().set(P["default"].USER_AGENT_INFO,this.userAgentInfo),y["default"].isObject(e.fullscreenContainer)?this.fullscreenContainer=e.fullscreenContainer:this.fullscreenContainer=m["default"].tag("body"),this.workspaceProps=null,this.pagesProps=null,this.isLocaleLoaded=!1,this.isCssLoaded=!1,this.isFontLoaded=!1,this.skinConfig=null,this.isSkinConfigInited=!1,this.on("change:workspaceProps change:pagesProps",this.initModules,this),this.on("change:workspaceProps change:pagesProps change:skinConfig change:isLocaleLoaded change:isSkinConfigInited change:isFontLoaded",this.tryToStart,this),this.on("change:workspaceProps",this.loadLocale,this),(0,w["default"])().setAdapter(e.adapter||new G({mappings:{"skins/current":"build/skins/default","static/html/":"build/"}})),this.routerEnabled=!0,this.loadProperties()}Object.defineProperty(e,"__esModule",{value:!0}),e.FBLocator=e.FBRouter=e.fbUtils=e.Events=e.html5Lib=e._=e.el=e.App=void 0;var r=i(1),a=n(r),s=i(15),l=n(s),d=i(4),h=n(d),u=i(34),c=n(u),p=i(37),f=n(p),g=i(3),m=n(g),v=i(0),y=n(v),b=i(5),w=n(b),_=i(2),P=n(_),E=i(104),T=n(E),C=i(106),A=n(C),x=i(110),S=n(x),k=i(111),I=n(k),L=i(112),M=n(L),O=i(113),N=n(O),B=i(114),D=n(B),z=i(19),R=n(z),F=i(115),W=n(F),H=i(12),U=n(H),j=i(10),V=n(j),q=window.FBPublication.ResourceStateProvider,G=window.LocalHashAdapter,X=window.FBPublication.LibraryManager;o.prototype=new a["default"],o.prototype.constructor=o,o.INIT="init",o.BOOK_STATE_CHANGED="bookStateChanged",o.TURNED="turned",o.ZOOMED="zoomed",o.UNZOOMED="unzoomed",o.LINK="link",o.DOWNLOAD="download",o.SEARCH="search",o.prototype.events=[o.INIT,o.BOOK_STATE_CHANGED,o.TURNED,o.ZOOMED,o.UNZOOMED,o.LINK,o.DOWNLOAD,o.SEARCH],o.FREEZE="freeze",o.UNFREEZE="unfreeze",o.GET_PROPERTY="getProperty",o.REMOVE_PROPERTY="removePageProperty",o.RESET_NUMERATION="resetNumeration",o.prototype.isLoaded=function(){return y["default"].isObject(this.workspaceProps)&&y["default"].isObject(this.pagesProps)&&this.isFontLoaded&&this.isCssLoaded&&this.isLocaleLoaded&&y["default"].isObject(this.skinConfig)&&this.isSkinConfigInited},o.prototype.tryToStart=function(){if(this.isLoaded()){var t=this,e=this.container.getBoundingClientRect(),i=document.body.contains(this.container)&&!(0===e.width||0===e.height);i?this.start():((0,P["default"])().get(P["default"].API).trigger("error",{msg:"The publication is not in DOM",code:0}),setTimeout(function(){t.tryToStart()},1e3))}},o.prototype.setDefaultLogic=function(){var t=this.services.resourceProvider||new q;(0,P["default"])().set(P["default"].LOAD_MANAGER,new A["default"](this.pager,t,N["default"],2)),(0,P["default"])().set(P["default"].VIRTUAL_PRINTER,this.services[P["default"].VIRTUAL_PRINTER]||new D["default"](this.userAgentInfo.browser))},o.prototype.loadProperties=function(){var t=this;h["default"].loadJSON((0,w["default"])().translatePath("assets/html/workspace.json"),function(e){var i=y["default"].isObject(t.extensions)&&y["default"].isObject(t.extensions.workspaceProps)?h["default"].deepExtend(e,t.extensions.workspaceProps):e;t.set("workspaceProps",new l["default"](i,I["default"]),!0)});var e=function(e){var i=y["default"].isObject(t.extensions)&&y["default"].isObject(t.extensions.pagesProps)?h["default"].deepExtend(e,t.extensions.pagesProps):e;navigator.userAgent.indexOf("Edge")>=0&&(i.hardcover=!1),i=new l["default"](i,M["default"]),t.pager=new c["default"](i),(0,P["default"])().set(P["default"].PAGER,t.pager),t.set("pagesProps",i,!0)};this.pagerFunc?this.pagerFunc().then(e):h["default"].loadJSON((0,w["default"])().translatePath("assets/common/pager.json"),e)},o.prototype.loadCss=function(){if(this.direction!==t.RTL){var e=this,i="buildCss";h["default"].loadCSS((0,w["default"])().translatePath("static/html/styles/css/build"+(t.RTL?".rtl":"")+".css"),function(){e._registerStyleTagForDestructor(i),e.loadSkin(),e.set("isCssLoaded",!0,!0),e.set("direction",t.RTL,!0)},i)}},o.prototype.loadSkin=function(){var e=this,i="skinCss";h["default"].loadCSS((0,w["default"])().translatePath("skins/current/css/build"+(t.RTL?".rtl":"")+".css"),function(){e._registerStyleTagForDestructor(i),h["default"].loadJSON((0,w["default"])().translatePath("skins/current/config.json"),function(t){var i=y["default"].isObject(e.extensions)&&y["default"].isObject(e.extensions.skinConfig)?h["default"].deepExtend(t,e.extensions.skinConfig):t;e.set("skinConfig",new l["default"](i),!0),e.skinConfig.on("all",e._onSkinConfigChange,e),y["default"].each(i,function(t,i){e.setParamToSkin(i,t)}),e.set("isSkinConfigInited",!0,!0)})},i)},o.prototype.initModules=function(){var t=(0,P["default"])().get(P["default"].LIBRARY_MANAGER),e=this;t.add({name:"search"}),y["default"].isObject(this.workspaceProps)&&y["default"].isObject(this.pagesProps)&&this.workspaceProps.onAndChange("change:search",function(i){if(i.enabled){var n=void 0,o=function(){if(n&&String.prototype.normalize){var t={};e.workspaceProps.search&&e.workspaceProps.search.searchCharactersLimit&&(t.searchCharactersLimit=e.workspaceProps.search.searchCharactersLimit),(0,P["default"])().set(P["default"].SEARCH_PROVIDER,new n(t,e.pager.pageTable))}};String.prototype.normalize||t.loaded("unorm")||(t.on("library:unorm",function(){o()}),t.load("unorm")),t.loaded("search")||(t.on("library:search",function(t){n=t.exports.LocalSearchProvider,o()}),t.load("search"))}},this)},o.prototype.loadLocale=function(){var e=this;y["default"].isObject(this.workspaceProps)&&this.workspaceProps.onAndChange("change:locales",function(){e.isLocaleLoading&&(0,P["default"])().get(P["default"].API).trigger("error",{msg:"Previous locale is still loading!",code:1}),e.set("isLocaleLoading",!0,!1),(0,P["default"])().has(P["default"].LOCALE)||(0,P["default"])().set(P["default"].LOCALE,new T["default"]);var i=(0,P["default"])().get(P["default"].LOCALE).getNewLocale(this.userAgentInfo.locales,this.workspaceProps.locales);this.container.setAttribute("lang",i),h["default"].loadJSON((0,w["default"])().translatePath("locales/"+i+".json"),function(n){(0,P["default"])().get(P["default"].LOCALE).setLanguage(n,i),t.RTL=(0,P["default"])().get(P["default"].LOCALE).isLocaleRTL(),e.set("isLocaleLoading",!1,!1),e.set("isLocaleLoaded",!0,!0),e.loadCss(),e._setFont()},function(t){(0,P["default"])().get(P["default"].API).trigger("error",{msg:"Could not load locale '"+i+"', error code "+t+".",code:2})})},this)},o.prototype._setFont=function(){var e="fontCss",i=(0,P["default"])().get(P["default"].LOCALE).getFontConfig(),n=this;return y["default"].isUndefined(i)?(this.container.style.fontFamily='"Helvetica Neue", Helvetica, Arial, sans-serif',void this.set("isFontLoaded",!0,!0)):(this.container.style.fontFamily=i["font-family"]+", Helvetica, Arial, sans-serif",this.fontLoaderNormal=m["default"].createElement("span",{"class":"font-loader","aria-hidden":"true",styles:{"font-weight":i["font-weight-normal"]}},n.container),this.fontLoaderBold=m["default"].createElement("span",{"class":"font-loader","aria-hidden":"true",styles:{"font-weight":i["font-weight-bold"]}},n.container),this.fontLoaderNormal.innerText="ABC 123",this.fontLoaderBold.innerText="DEF 456",void h["default"].loadCSS("https://fonts.googleapis.com/css?family="+encodeURIComponent(i["font-family"]+":"+i["font-weight-normal"]+","+i["font-weight-bold"]+"&amp;subset="+i.subset),function(){if(n._registerStyleTagForDestructor(e),n.setParamToSkin("font-weight-normal",i["font-weight-normal"]),n.setParamToSkin("font-weight-bold",i["font-weight-bold"]),t.navigator&&t.navigator.userAgent.indexOf("Publisher")!==-1)n.set("isFontLoaded",!0,!0);else if(document.fonts&&document.fonts.check&&navigator.onLine&&(n.userAgentInfo.browser.chrome||n.userAgentInfo.browser.firefox)){var o=0,r=function a(){setTimeout(function(){try{var t=document.fonts.check(i["font-weight-normal"]+" 16px "+i["font-family"]),e=document.fonts.check(i["font-weight-bold"]+" 16px "+i["font-family"]);t&&e?n.set("isFontLoaded",!0,!0):o<=20?a():n.set("isFontLoaded",!0,!0)}catch(r){console.error("Font error: "+r.message)}},100,o++)};r()}else setTimeout(function(){n.set("isFontLoaded",!0,!0)},1e3)},e))},o.prototype.setParamToSkin=function(t,e){var i=this,n=function(t,e){if(i._editorScriptLoader){if(!y["default"].isUndefined(i._previousSkinModifiers)){for(var n=i._previousSkinModifiers.length,o=0;o<n;o++)i._modifySkin(i._previousSkinModifiers[o].param,i._previousSkinModifiers[o].value);i._previousSkinModifiers=[]}y["default"].isUndefined(t)||i._modifySkin(t,e)}else console.error("templates.js is not loaded yet")};this._editorScriptLoader===!0?n(t,e):(y["default"].isUndefined(this._previousSkinModifiers)&&(this._previousSkinModifiers=[]),this._previousSkinModifiers.push({param:t,value:e}),y["default"].isUndefined(this._editorScriptLoader)&&(this._editorScriptLoader=!1,h["default"].loadScript((0,w["default"])().translatePath("skins/current/templates.js"),function(){i.isStarted?(i._editorScriptLoader=!0,n()):i.on("change:isStarted",function(t){t&&(this._editorScriptLoader=!0,n())},i)})))},o.prototype._onSkinConfigChange=function(t,e){t=t.split(":")[1],this.setParamToSkin(t,e)},o.prototype._registerStyleTagForDestructor=function(t){this.hasOwnProperty("_styleTags")||(this._styleTags=[]),this._styleTags.push(t)},o.prototype._unsubscribeFromLoaders=function(){this.off("change:workspaceProps change:pagesProps change:skinConfig change:isLocaleLoaded change:isSkinConfigInited change:isFontLoaded",this.tryToStart,this),this.off("change:workspaceProps",this.tryToLoadLocale,this),clearInterval(this._startInterval)},o.prototype.destructor=function(){function t(t){y["default"].isObject(t)&&t.constructor===l["default"]&&t.destructor()}this.workspace&&y["default"].isFunction(this.workspace.destructor)&&this.workspace.destructor(),this._unsubscribeFromLoaders(),y["default"].each(this._styleTags,function(t){m["default"].del(t)}),m["default"].del(this.fontLoaderNormal),m["default"].del(this.fontLoaderBold),m["default"].del(this.publicationContainer),t(this.workspaceProps),t(this.pagesProps),t(this.skinConfig),(0,w["default"])().setCallback(function(){}),(0,P["default"])().destructor()},o.prototype.contextMenu=function(){return(0,P["default"])().get(P["default"].CONTEXT_MENU)},o.prototype._modifySkin=function(t,e){if("classes"===t)this.workspace.updateMenuClasses(e);else{var i=this,n=function(e,n){var o=m["default"].tag("head"),r=e+"-style",a=m["default"].id(r);y["default"].isNull(a)&&(a=m["default"].createElement("style",{id:r},o),i._registerStyleTagForDestructor(r)),y["default"].has(window.FBPublication.SKIN_TEMPLATES,e)?a.innerHTML=window.FBPublication.SKIN_TEMPLATES[e](n):(0,P["default"])().get(P["default"].API).trigger("error",{msg:"global.FBPublication.SKIN_TEMPLATES does not have "+t,code:3})};"background-size"===t&&("auto"===e?n("background-repeat","repeat"):n("background-repeat","no-repeat"));var o=/url\(['"]?([^'"]+)['"]?\)/g.exec(e);if(y["default"].isArray(o)&&2===o.length){var r=(0,w["default"])().translatePath(o[1]);r=r.indexOf("?")===-1?r+"?v=123":r+"&v=123",e='url("'+r+'")'}n(t,e)}},o.prototype.start=function(){if(!this.isStarted){m["default"].addClass(this.container,"publication-container"),this.container.setAttribute("role","application"),this.publicationContainer=m["default"].createElement("div",{"class":"publ-container",id:"publ-container",role:"main"},this.container);var t=m["default"].createElement("div",{"class":"main-frame",id:"main-frame",role:"region","aria-label":"main window"},this.publicationContainer,"top");this.setDefaultLogic(),this._initRouter(),this.workspace=new f["default"](this.pager,t,this.pagesProps,this.workspaceProps,this.container,this.userAgentInfo.browser,this.fullscreenContainer,this.skinConfig),this.workspace.bookPresenter.on("onPageChanged",function(){(0,P["default"])().get(P["default"].API).trigger("turned",this.getState())},this),(0,P["default"])().get(P["default"].API).trigger("pagerReady",this.pager.getState()),this.workspace.bookPresenter.on("zoomTransitionEnd",function(){var t=this.getState();(0,P["default"])().get(P["default"].API).trigger(t.isZoomed?"zoomed":"unzoomed",t)},this),this.set("isStarted",!0,!0),(0,P["default"])().get(P["default"].API).trigger("init",this.getState()),this._unsubscribeFromLoaders(),this.workspaceProps.publicationInfo&&window.addEventListener("keydown",this.showAbout.bind(this))}},o.prototype.showAbout=function(t){
if(t.ctrlKey&&t.altKey&&t.shiftKey&&73===t.keyCode){var e="ID: "+this.workspaceProps.publicationInfo.id+"\nInitially created in version "+this.workspaceProps.publicationInfo.createVer+", "+this.workspaceProps.publicationInfo.createEdition+" edition.\n\nPublication date: "+this.workspaceProps.publicationInfo.publicationDate+"\nPublication version: "+this.workspaceProps.publicationInfo.publicationVer+"\nPublication edition: "+this.workspaceProps.publicationInfo.publicationEdition;alert(e)}},o.prototype.onReady=function(){this.workspace.onReady()},o.GET_STATE="getState",o.prototype.getState=function(){var t={};if(t.version="html",t.isStarted=this.isStarted,this.isStarted){var e=this.workspace.getState(),i=this.pager.getState();t.pageIndex=this.pager.pageTable.getPageIndexById(i.leftPage||i.rightPage),t.isZoomed=i.zoomMode,t.isWide=i.leftPage||i.rightPage?this.pager.pageTable.getPageModel(i.leftPage||i.rightPage).getProperty("wide"):void 0,t.locale=(0,P["default"])().get(P["default"].LOCALE).locale,t.rightPageId=i.rightPage,t.leftPageId=i.leftPage,i.leftPage&&(t.leftPageUrl=this.pager.pageTable.getUrlHeaderById(i.leftPage)),i.rightPage?t.rightPageUrl=this.pager.pageTable.getUrlHeaderById(i.rightPage):t.rightPageUrl=t.leftPageUrl,i.leftPage||(t.leftPageUrl=t.rightPageUrl),t.ui=e}return t},o.GOTO_PAGE="goToPage",o.prototype.goToPage=function(t){this.pager&&this.pager.goToPageByIndex(t)},o.GOTO_PAGE_BY_ID="goToPageById",o.prototype.goToPageById=function(t){t=""+t,this.pager&&this.pager.goToPageById(t)},o.GOTO_PAGE_BY_URL_HEADER="goToPageByUrlHeader",o.prototype.goToPageByUrlHeader=function(t){if(this.pager){var e=this.pager.pageTable.getPageIdByUrlHeader(t);this.pager.goToPageById(e)}},o.SET_LOCALIZATION_STRING="setLocalizationString",o.prototype.setLocalizationString=function(t,e){if(!(0,P["default"])().get(P["default"].LOCALE))return console.error("Unable to reach the locale provider"),!1;try{(0,P["default"])().get(P["default"].LOCALE).set(t,e)}catch(i){return console.error("Unable to set localization string with key",t),!1}return!0},o.SHOW_BOOK="showBook",o.prototype.showBook=function(t){m["default"].id("flipbook-container").style.opacity=t===!1?0:1},o.prototype.removeProperty=function(t,e){var i=["backgroundColor","customSubstrateSize","displayName","height","pageResize","rasterize","rtlContent","shadowDepth","slideDelay","stub","substrateFormat","substrateSizes","substrateSizesReady","substrateZoomFormat","textLayer","thFormat","urlHeader","vectorText","wide","width"];i.indexOf(e)!==-1&&this.pagesProps.pages[t]&&this.pagesProps.pages[t][e]?delete this.pagesProps.pages[t][e]:console.log("This is not a property that you are allowed to remove")},o.prototype.resetNumeration=function(){var t=this.pagesProps.pages;for(var e in t)if(t.hasOwnProperty(e)){if("size"===e||"defaults"===e||"structure"===e)continue;t[e].hasOwnProperty("displayName")&&(this.pagesProps.set("pages."+e+".displayName",null),delete t[e].displayName),t[e].hasOwnProperty("urlHeader")&&(this.pagesProps.set("pages."+e+".urlHeader",null),delete t[e].urlHeader)}this.pagesProps.set("numerationOffset",0),this._setUrlPath(this.pager.state)},o.prototype._setUrlPath=function(t,e,i,n){var o,r="app.js",a={};n!==r&&this.routerEnabled&&(this.workspaceProps.components.book.flip?a.zoom=t.zoomMode:a.zoom=!1,o=void 0!==t.leftPage?t.leftPage:t.rightPage,a.page=this.pager.pageTable.getUrlHeaderById(o),(0,w["default"])().setPath(a))},o.prototype._initRouter=function(){var t=this,e="app.js";this.pager.on("change:state",this._setUrlPath,this);var i=function(){if(t.routerEnabled){var i,n=(0,w["default"])().getPathInfo()||{};if(t.workspaceProps.components.book.flip||(n.zoom=!0),n){if(y["default"].has(n,"page")){var o=t.pager.pageTable.getPageIdByUrlHeader(n.page);t.pager.goToPageById(o,e)}y["default"].has(n,"zoom")?(i=t.pager.getState(),t.pager.setZoomMode(n.zoom,i.rightPage===o,e)):t.pager.setZoomMode(!1,!0,e)}}},n=y["default"].throttle(i,800),o=y["default"].debounce(i,300);(0,w["default"])().setCallback(function(){t.pager.getState().zoomMode?n():o()}),i()},e.App=o,e.el=m["default"],e._=y["default"],e.html5Lib=V["default"],e.Events=a["default"],e.fbUtils=h["default"],e.FBRouter=w["default"],e.FBLocator=P["default"]}).call(e,i(6))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),r=n(o),a=i(0),s=n(a),l=i(4),d=n(l),h=i(8),u=n(h),c=function(){function e(){return i?i:this instanceof e?void(i=this):new e}var i;return e.prototype.init=function(e){var i=this;this.container=e||r["default"].tag("body"),d["default"].addListener(t,"resize",function(){i.hideTooltips()}),d["default"].addListener(t.document,"click",function(t){var e=t.target||t.srcElement;i._isTip(e)||i._isInTooltip(e)||i.hideTooltips()}),d["default"].addListener(t,"keyup",function(){i.hideTooltips()}),this._timers_id=[],this._isActiveTooltips=!1},e.prototype.showTooltip=function(t,e){var i=this,n={hideTime:1500,text:"",position:"top"};s["default"].extend(n,e);var o=r["default"].createElement("div",{"class":"tooltip"+(n.position?" "+n.position:"")},this.container);o.innerHTML=u["default"]["workspace-tooltip"]({text:n.text});var a=window.pageYOffset||document.documentElement.scrollTop||0,l=window.pageXOffset||document.documentElement.scrollLeft||0,d=t.getBoundingClientRect(),h=d.width||d.left-d.right,c=h/2+d.left+l-o.clientWidth/2;c<10&&(c=10),s["default"].defer(function(){r["default"].addClass(o,"tooltip-active"),o.style.left=c+"px",r["default"].hasClass(o,"bottom")?o.style.top=d.bottom+a+5+"px":o.style.top=d.top+a-o.clientHeight-5+"px"}),this._timers_id.push(s["default"].delay(function(){i.hideTooltips()},n.hideTime)),this._isActiveTooltips=!0},e.prototype.hideTooltips=function(){if(this._isActiveTooltips){for(var t=r["default"].className("tooltip"),e=0;e<t.length;e++)r["default"].del(t[e]);for(;this._timers_id.length;)clearTimeout(this._timers_id.pop())}},e.prototype._isTip=function(t){return r["default"].hasClass(t,"tip")},e.prototype._isInTooltip=function(t){return!(!t||t===this.container)&&(!!r["default"].hasClass(t,"tooltip")||this._isInTooltip(t.parentElement))},e}();e["default"]=c}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){this.rootElement=t,this.data=e,this.pager=n,this.windowTitle=i,this.currentOption="",this.currentFile="",this._render(),this.getLocaleProvider().on("change:SaveWindow",this._onLocaleChange,this);var o=this;this.activeElements=Array.prototype.slice.call(this.rootElement.querySelectorAll("[tabindex]")),this.rootElement.addEventListener("keydown",function(t){if(9===t.keyCode){t.preventDefault();var e=o.activeElements.indexOf(document.activeElement);e===o.activeElements.length-1?o.activeElements[0].focus():o.activeElements[e+1].focus()}}),setTimeout(function(){o.activeElements[1].focus()},500)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(2),h=n(d),u=i(5),c=n(u),p=i(4),f=n(p),g=i(8),m=n(g),v=i(23),y=n(v);o.prototype._render=function(){this.content||(this.content=a["default"].createElement("div",{"class":"popup-content"},this.rootElement)),this.itemsArray=this._buildDownloadsArray(),this.content.innerHTML=m["default"]["workspace-download-window"](this.itemsArray),this._bindElements()},o.prototype._onLocaleChange=function(){a["default"].setText(this.windowTitle,this.getLocaleProvider().get("SaveWindow.TITLE")),this.update()},o.prototype.getApiProvider=function(){return(0,h["default"])().get(h["default"].API)},o.prototype.getLocaleProvider=function(){return(0,h["default"])().get(h["default"].LOCALE)},o.prototype.update=function(t){t&&(this.data=t),a["default"].del(this.content),delete this.content,this._render()},o.prototype._buildDownloadsArray=function(){var t=[],e=function(t){return(0,c["default"])().translatePath("assets/common/downloads/"+t)};if(this.data.url&&this.data.allPagesVisible&&(t.full={title:this.getLocaleProvider().get("SaveWindow.FULL_PUBLICATION"),fileUrl:e(this.data.url),fileName:this.data.url,fileSize:this._formatSize(this.data.size),fileType:"."+this.data.url.split(".").pop(),option:"full"}),this.data.pageFiles&&!l["default"].isEmpty(this.data.pageFiles)&&this.data.currentPagesVisible){var i=this.data.pageFiles,n=function(t){return l["default"].isArray(i)?l["default"].find(i,function(e){return e.url===t}):i[t]};if(this.pager.state.leftPage&&this.pager.state.rightPage&&this.pager.state.leftPage!==this.pager.state.rightPage){var o=this.pager.isRtl()?this.pager.state.rightPage:this.pager.state.leftPage,r=this.pager.isRtl()?this.pager.state.leftPage:this.pager.state.rightPage,a=n(o),s=n(r);a&&a.size&&t.push({title:this.getLocaleProvider().get("SaveWindow.SAVE_LEFT_PAGE"),fileUrl:e("page"+f["default"].getNum(o)+".pdf"),fileName:"page"+f["default"].getNum(o)+".pdf",fileSize:this._formatSize(a.size),fileIcon:"pdf",option:"single",pageNum:this.pager.pageTable.getUrlHeaderById(o)}),s&&s.size&&t.push({title:this.getLocaleProvider().get("SaveWindow.SAVE_RIGHT_PAGE"),fileUrl:e("page"+f["default"].getNum(r)+".pdf"),fileName:"page"+f["default"].getNum(r)+".pdf",fileSize:this._formatSize(s.size),fileIcon:"pdf",option:"single",pageNum:this.pager.pageTable.getUrlHeaderById(r)})}else{var d=this.pager.state.leftPage||this.pager.state.rightPage,h=n(d);h&&h.size&&t.push({title:this.getLocaleProvider().get("SaveWindow.SAVE_CURRENT_PAGE"),fileUrl:e("page"+f["default"].getNum(d)+".pdf"),fileName:"page"+f["default"].getNum(d)+".pdf",fileSize:this._formatSize(h.size),fileIcon:"pdf",option:"single",pageNum:this.pager.pageTable.getUrlHeaderById(d)})}}if(this.data.macAppFile&&!l["default"].isEmpty(this.data.macAppFile)){var u=this.data.macAppFile,p=u.url.split(".").pop();t.push({title:this.getLocaleProvider().get("SaveWindow.MAC_OFFLINE_PUBLICATION"),fileUrl:e(u.url),fileName:u.url,fileSize:this._formatSize(u.size),fileIcon:this._getIcon(p),option:"mac"})}if(this.data.winAppFile&&!l["default"].isEmpty(this.data.winAppFile)){var g=this.data.winAppFile,m=g.url.split(".").pop();t.push({title:this.getLocaleProvider().get("SaveWindow.WINDOWS_OFFLINE_PUBLICATION"),fileUrl:e(g.url),fileName:g.url,fileSize:this._formatSize(g.size),fileIcon:this._getIcon(m),option:"windows"})}if(this.data.customFiles&&!l["default"].isEmpty(this.data.customFiles))for(var v=0;v<this.data.customFiles.length;v++){var y=this.data.customFiles[v],b=y.url.split(".").pop(),w=y.url.split("/").pop();w.length>45&&(w=w.slice(0,20)+" ... "+w.slice(-15)),t.push({title:w,fileUrl:e(y.url),fileName:y.url,fileSize:this._formatSize(y.size),fileIcon:this._getIcon(b),option:"custom"})}return t.localization={fullDescription:this.getLocaleProvider().get("SaveWindow.FULL_PUBLICATION_DESCRIPTION")},t},o.prototype._formatSize=function(t){var e=t/1048576;return e=e<1?e<.1?(1024*e).toFixed(0)+" KB":e.toFixed(2)+" MB":e<100?e.toFixed(1)+" MB":e.toFixed(0)+" MB"},o.prototype._getIcon=function(t){var e=void 0,i=void 0,n=["doc","exe","gif","html","jpg","mp3","mp4","pdf","png","ppt","psd","rar","xls","zip"],o={docx:"doc",pptx:"ppt",xlsx:"xls",htm:"html"};return i=n.indexOf(t),e=i!==-1?n[i]:o[t]||"any"},o.prototype._bindElements=function(){var t=this,e=document.querySelectorAll(".download-list a, .download-full-button"),i=function(e,i,n){var o=t.pager.getState(),r=void 0,a=void 0;o.leftPage&&(r=t.pager.pageTable.getUrlHeaderById(o.leftPage)),a=o.rightPage?t.pager.pageTable.getUrlHeaderById(o.rightPage):r,o.leftPage||(r=a);var s={option:e,fileName:i,leftPageUrl:r,rightPageUrl:a};n&&(s.pageId=n,s.downloadPage=t.pager.pageTable.getUrlHeaderById(n)),t.getApiProvider().trigger("download",s)};l["default"].each(e,function(t){t.addEventListener("click",function(t){i(t.currentTarget.getAttribute("data-option"),t.currentTarget.getAttribute("data-filename"),t.currentTarget.getAttribute("data-pagenum"))})}),this.itemsArray.length>4&&(this.scrollObj=new y["default"](a["default"].id("download-list"),{mouseWheel:!0,scrollbars:!0,interactiveScrollbars:!0,bounce:!1}))},o.prototype.onClose=function(){this.getLocaleProvider().off("change:SaveWindow",this._onLocaleChange,this)},e["default"]=o},function(t,e,i){var n;!function(o,r,a){function s(t,e){this.wrapper="string"==typeof t?r.querySelector(t):t,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,disablePointer:!u.hasPointer,disableTouch:u.hasPointer||!u.hasTouch,disableMouse:u.hasPointer||u.hasTouch,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,bindToWrapper:"undefined"==typeof o.onmousedown};for(var i in e)this.options[i]=e[i];this.translateZ=this.options.HWCompositing&&u.hasPerspective?" translateZ(0)":"",this.options.useTransition=u.hasTransition&&this.options.useTransition,this.options.useTransform=u.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?u.ease[this.options.bounceEasing]||u.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function l(t,e,i){var n=r.createElement("div"),o=r.createElement("div");return i===!0&&(n.style.cssText="position:absolute;z-index:9999",o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),o.className="iScrollIndicator","h"==t?(i===!0&&(n.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",o.style.height="100%"),n.className="iScrollHorizontalScrollbar"):(i===!0&&(n.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",o.style.width="100%"),n.className="iScrollVerticalScrollbar"),n.style.cssText+=";overflow:hidden",e||(n.style.pointerEvents="none"),n.appendChild(o),n}function d(t,e){this.wrapper="string"==typeof e.el?r.querySelector(e.el):e.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=t,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var i in e)this.options[i]=e[i];if(this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(u.addEvent(this.indicator,"touchstart",this),u.addEvent(o,"touchend",this)),this.options.disablePointer||(u.addEvent(this.indicator,u.prefixPointerEvent("pointerdown"),this),u.addEvent(o,u.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(u.addEvent(this.indicator,"mousedown",this),u.addEvent(o,"mouseup",this))),this.options.fade){this.wrapperStyle[u.style.transform]=this.scroller.translateZ;var n=u.style.transitionDuration;this.wrapperStyle[n]=u.isBadAndroid?"0.0001ms":"0ms";var a=this;u.isBadAndroid&&h(function(){"0.0001ms"===a.wrapperStyle[n]&&(a.wrapperStyle[n]="0s")}),this.wrapperStyle.opacity="0"}}var h=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame||function(t){o.setTimeout(t,1e3/60)},u=function(){function t(t){return n!==!1&&(""===n?t:n+t.charAt(0).toUpperCase()+t.substr(1))}var e={},i=r.createElement("div").style,n=function(){for(var t,e=["t","webkitT","MozT","msT","OT"],n=0,o=e.length;n<o;n++)if(t=e[n]+"ransform",t in i)return e[n].substr(0,e[n].length-1);return!1}();e.getTime=Date.now||function(){return(new Date).getTime()},e.extend=function(t,e){for(var i in e)t[i]=e[i]},e.addEvent=function(t,e,i,n){t.addEventListener(e,i,!!n)},e.removeEvent=function(t,e,i,n){t.removeEventListener(e,i,!!n)},e.prefixPointerEvent=function(t){return o.MSPointerEvent?"MSPointer"+t.charAt(7).toUpperCase()+t.substr(8):t},e.momentum=function(t,e,i,n,o,r){var s,l,d=t-e,h=a.abs(d)/i;return r=void 0===r?6e-4:r,s=t+h*h/(2*r)*(d<0?-1:1),l=h/r,s<n?(s=o?n-o/2.5*(h/8):n,d=a.abs(s-t),l=d/h):s>0&&(s=o?o/2.5*(h/8):0,d=a.abs(t)+s,l=d/h),{destination:a.round(s),duration:l}};var s=t("transform");return e.extend(e,{hasTransform:s!==!1,hasPerspective:t("perspective")in i,hasTouch:"ontouchstart"in o,hasPointer:!(!o.PointerEvent&&!o.MSPointerEvent),hasTransition:t("transition")in i}),e.isBadAndroid=function(){var t=o.navigator.appVersion;if(/Android/.test(t)&&!/Chrome\/\d/.test(t)){var e=t.match(/Safari\/(\d+.\d)/);return!(e&&"object"==typeof e&&e.length>=2)||parseFloat(e[1])<535.19}return!1}(),e.extend(e.style={},{transform:s,transitionTimingFunction:t("transitionTimingFunction"),transitionDuration:t("transitionDuration"),transitionDelay:t("transitionDelay"),transformOrigin:t("transformOrigin")}),e.hasClass=function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)");return i.test(t.className)},e.addClass=function(t,i){if(!e.hasClass(t,i)){var n=t.className.split(" ");n.push(i),t.className=n.join(" ")}},e.removeClass=function(t,i){if(e.hasClass(t,i)){var n=new RegExp("(^|\\s)"+i+"(\\s|$)","g");t.className=t.className.replace(n," ")}},e.offset=function(t){for(var e=-t.offsetLeft,i=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,i-=t.offsetTop;return{left:e,top:i}},e.preventDefaultException=function(t,e){for(var i in e)if(e[i].test(t[i]))return!0;return!1},e.extend(e.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),e.extend(e.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return a.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var e=4;return(t-=1)*t*((e+1)*t+e)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var e=.22,i=.4;return 0===t?0:1==t?1:i*a.pow(2,-10*t)*a.sin((t-e/4)*(2*a.PI)/e)+1}}}),e.tap=function(t,e){var i=r.createEvent("Event");i.initEvent(e,!0,!0),i.pageX=t.pageX,i.pageY=t.pageY,t.target.dispatchEvent(i)},e.click=function(t){var e,i=t.target;/(SELECT|INPUT|TEXTAREA)/i.test(i.tagName)||(e=r.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,t.view,1,i.screenX,i.screenY,i.clientX,i.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),e._constructed=!0,i.dispatchEvent(e))},e}();s.prototype={version:"5.2.0",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),clearTimeout(this.resizeTimeout),this.resizeTimeout=null,this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(1!=u.eventType[t.type]){var e;if(e=t.which?t.button:t.button<2?0:4==t.button?1:2,0!==e)return}if(this.enabled&&(!this.initiated||u.eventType[t.type]===this.initiated)){!this.options.preventDefault||u.isBadAndroid||u.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var i,n=t.touches?t.touches[0]:t;this.initiated=u.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this.startTime=u.getTime(),this.options.useTransition&&this.isInTransition?(this._transitionTime(),this.isInTransition=!1,i=this.getComputedPosition(),this._translate(a.round(i.x),a.round(i.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")}},_move:function(t){if(this.enabled&&u.eventType[t.type]===this.initiated){this.options.preventDefault&&t.preventDefault();var e,i,n,o,r=t.touches?t.touches[0]:t,s=r.pageX-this.pointX,l=r.pageY-this.pointY,d=u.getTime();if(this.pointX=r.pageX,this.pointY=r.pageY,this.distX+=s,this.distY+=l,n=a.abs(this.distX),o=a.abs(this.distY),!(d-this.endTime>300&&n<10&&o<10)){if(this.directionLocked||this.options.freeScroll||(n>o+this.options.directionLockThreshold?this.directionLocked="h":o>=n+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)t.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)t.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);s=0}s=this.hasHorizontalScroll?s:0,l=this.hasVerticalScroll?l:0,e=this.x+s,i=this.y+l,(e>0||e<this.maxScrollX)&&(e=this.options.bounce?this.x+s/3:e>0?0:this.maxScrollX),(i>0||i<this.maxScrollY)&&(i=this.options.bounce?this.y+l/3:i>0?0:this.maxScrollY),this.directionX=s>0?-1:s<0?1:0,this.directionY=l>0?-1:l<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(e,i),d-this.startTime>300&&(this.startTime=d,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(t){if(this.enabled&&u.eventType[t.type]===this.initiated){this.options.preventDefault&&!u.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,i,n=(t.changedTouches?t.changedTouches[0]:t,u.getTime()-this.startTime),o=a.round(this.x),r=a.round(this.y),s=a.abs(o-this.startX),l=a.abs(r-this.startY),d=0,h="";if(this.isInTransition=0,this.initiated=0,this.endTime=u.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(o,r),!this.moved)return this.options.tap&&u.tap(t,this.options.tap),this.options.click&&u.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&n<200&&s<100&&l<100)return void this._execEvent("flick");if(this.options.momentum&&n<300&&(e=this.hasHorizontalScroll?u.momentum(this.x,this.startX,n,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},i=this.hasVerticalScroll?u.momentum(this.y,this.startY,n,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:r,duration:0},o=e.destination,r=i.destination,d=a.max(e.duration,i.duration),this.isInTransition=1),this.options.snap){var c=this._nearestSnap(o,r);this.currentPage=c,d=this.options.snapSpeed||a.max(a.max(a.min(a.abs(o-c.x),1e3),a.min(a.abs(r-c.y),1e3)),300),o=c.x,r=c.y,this.directionX=0,this.directionY=0,h=this.options.bounceEasing}return o!=this.x||r!=this.y?((o>0||o<this.maxScrollX||r>0||r<this.maxScrollY)&&(h=u.ease.quadratic),void this.scrollTo(o,r,d,h)):void this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(e!=this.x||i!=this.y)&&(this.scrollTo(e,i,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=u.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var i=this._events[t].indexOf(e);i>-1&&this._events[t].splice(i,1)}},_execEvent:function(t){if(this._events[t]){var e=0,i=this._events[t].length;if(i)for(;e<i;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,n){t=this.x+t,e=this.y+e,i=i||0,this.scrollTo(t,e,i,n)},scrollTo:function(t,e,i,n){n=n||u.ease.circular,this.isInTransition=this.options.useTransition&&i>0;var o=this.options.useTransition&&n.style;!i||o?(o&&(this._transitionTimingFunction(n.style),this._transitionTime(i)),this._translate(t,e)):this._animate(t,e,i,n.fn)},scrollToElement:function(t,e,i,n,o){if(t=t.nodeType?t:this.scroller.querySelector(t)){var r=u.offset(t);r.left-=this.wrapperOffset.left,r.top-=this.wrapperOffset.top,i===!0&&(i=a.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),n===!0&&(n=a.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),r.left-=i||0,r.top-=n||0,r.left=r.left>0?0:r.left<this.maxScrollX?this.maxScrollX:r.left,r.top=r.top>0?0:r.top<this.maxScrollY?this.maxScrollY:r.top,e=void 0===e||null===e||"auto"===e?a.max(a.abs(this.x-r.left),a.abs(this.y-r.top)):e,this.scrollTo(r.left,r.top,e,o)}},_transitionTime:function(t){t=t||0;var e=u.style.transitionDuration;if(this.scrollerStyle[e]=t+"ms",!t&&u.isBadAndroid){this.scrollerStyle[e]="0.0001ms";var i=this;h(function(){"0.0001ms"===i.scrollerStyle[e]&&(i.scrollerStyle[e]="0s")})}if(this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].transitionTime(t)},_transitionTimingFunction:function(t){if(this.scrollerStyle[u.style.transitionTimingFunction]=t,this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTimingFunction(t)},_translate:function(t,e){if(this.options.useTransform?this.scrollerStyle[u.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ:(t=a.round(t),e=a.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(t){var e=t?u.removeEvent:u.addEvent,i=this.options.bindToWrapper?this.wrapper:o;e(o,"orientationchange",this),e(o,"resize",this),this.options.click&&e(this.wrapper,"click",this,!0),this.options.disableMouse||(e(this.wrapper,"mousedown",this),e(i,"mousemove",this),e(i,"mousecancel",this),e(i,"mouseup",this)),u.hasPointer&&!this.options.disablePointer&&(e(this.wrapper,u.prefixPointerEvent("pointerdown"),this),e(i,u.prefixPointerEvent("pointermove"),this),e(i,u.prefixPointerEvent("pointercancel"),this),e(i,u.prefixPointerEvent("pointerup"),this)),u.hasTouch&&!this.options.disableTouch&&(e(this.wrapper,"touchstart",this),e(i,"touchmove",this),e(i,"touchcancel",this),e(i,"touchend",this)),e(this.scroller,"transitionend",this),e(this.scroller,"webkitTransitionEnd",this),e(this.scroller,"oTransitionEnd",this),e(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,e,i=o.getComputedStyle(this.scroller,null);return this.options.useTransform?(i=i[u.style.transform].split(")")[0].split(", "),t=+(i[12]||i[4]),e=+(i[13]||i[5])):(t=+i.left.replace(/[^-\d.]/g,""),e=+i.top.replace(/[^-\d.]/g,"")),{x:t,y:e}},_initIndicators:function(){function t(t){if(r.indicators)for(var e=r.indicators.length;e--;)t.call(r.indicators[e])}var e,i=this.options.interactiveScrollbars,n="string"!=typeof this.options.scrollbars,o=[],r=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:l("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),o.push(e)),this.options.scrollX&&(e={el:l("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:n,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),o.push(e))),this.options.indicators&&(o=o.concat(this.options.indicators));for(var a=o.length;a--;)this.indicators.push(new d(this,o[a]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){u.addEvent(this.wrapper,"wheel",this),u.addEvent(this.wrapper,"mousewheel",this),u.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){clearTimeout(this.wheelTimeout),this.wheelTimeout=null,u.removeEvent(this.wrapper,"wheel",this),u.removeEvent(this.wrapper,"mousewheel",this),u.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault();var e,i,n,o,r=this;if(void 0===this.wheelTimeout&&r._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){r.options.snap||r._execEvent("scrollEnd"),r.wheelTimeout=void 0},400),"deltaX"in t)1===t.deltaMode?(e=-t.deltaX*this.options.mouseWheelSpeed,i=-t.deltaY*this.options.mouseWheelSpeed):(e=-t.deltaX,i=-t.deltaY);else if("wheelDeltaX"in t)e=t.wheelDeltaX/120*this.options.mouseWheelSpeed,i=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)e=i=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;e=i=-t.detail/3*this.options.mouseWheelSpeed}if(e*=this.options.invertWheelDirection,i*=this.options.invertWheelDirection,this.hasVerticalScroll||(e=i,i=0),this.options.snap)return n=this.currentPage.pageX,o=this.currentPage.pageY,e>0?n--:e<0&&n++,i>0?o--:i<0&&o++,void this.goToPage(n,o);n=this.x+a.round(this.hasHorizontalScroll?e:0),o=this.y+a.round(this.hasVerticalScroll?i:0),this.directionX=e>0?-1:e<0?1:0,this.directionY=i>0?-1:i<0?1:0,n>0?n=0:n<this.maxScrollX&&(n=this.maxScrollX),o>0?o=0:o<this.maxScrollY&&(o=this.maxScrollY),this.scrollTo(n,o,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,i,n,o,r,s=0,l=0,d=0,h=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight;
if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(i=a.round(h/2),n=a.round(u/2);d>-this.scrollerWidth;){for(this.pages[s]=[],t=0,o=0;o>-this.scrollerHeight;)this.pages[s][t]={x:a.max(d,this.maxScrollX),y:a.max(o,this.maxScrollY),width:h,height:u,cx:d-i,cy:o-n},o-=u,t++;d-=h,s++}else for(r=this.options.snap,t=r.length,e=-1;s<t;s++)(0===s||r[s].offsetLeft<=r[s-1].offsetLeft)&&(l=0,e++),this.pages[l]||(this.pages[l]=[]),d=a.max(-r[s].offsetLeft,this.maxScrollX),o=a.max(-r[s].offsetTop,this.maxScrollY),i=d-a.round(r[s].offsetWidth/2),n=o-a.round(r[s].offsetHeight/2),this.pages[l][e]={x:d,y:o,width:r[s].offsetWidth,height:r[s].offsetHeight,cx:i,cy:n},d>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=a.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=a.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||a.max(a.max(a.min(a.abs(this.x-this.startX),1e3),a.min(a.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,n=this.pages.length,o=0;if(a.abs(t-this.absStartX)<this.snapThresholdX&&a.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),e>0?e=0:e<this.maxScrollY&&(e=this.maxScrollY);i<n;i++)if(t>=this.pages[i][0].cx){t=this.pages[i][0].x;break}for(n=this.pages[i].length;o<n;o++)if(e>=this.pages[0][o].cy){e=this.pages[0][o].y;break}return i==this.currentPage.pageX&&(i+=this.directionX,i<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),t=this.pages[i][0].x),o==this.currentPage.pageY&&(o+=this.directionY,o<0?o=0:o>=this.pages[0].length&&(o=this.pages[0].length-1),e=this.pages[0][o].y),{x:t,y:e,pageX:i,pageY:o}},goToPage:function(t,e,i,n){n=n||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:t<0&&(t=0),e>=this.pages[t].length?e=this.pages[t].length-1:e<0&&(e=0);var o=this.pages[t][e].x,r=this.pages[t][e].y;i=void 0===i?this.options.snapSpeed||a.max(a.max(a.min(a.abs(o-this.x),1e3),a.min(a.abs(r-this.y),1e3)),300):i,this.currentPage={x:o,y:r,pageX:t,pageY:e},this.scrollTo(o,r,i,n)},next:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,t,e)},prev:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--,i<0&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,t,e)},_initKeys:function(t){var e,i={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(e in this.options.keyBindings)"string"==typeof this.options.keyBindings[e]&&(this.options.keyBindings[e]=this.options.keyBindings[e].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(e in i)this.options.keyBindings[e]=this.options.keyBindings[e]||i[e];u.addEvent(o,"keydown",this),this.on("destroy",function(){u.removeEvent(o,"keydown",this)})},_key:function(t){if(this.enabled){var e,i=this.options.snap,n=i?this.currentPage.pageX:this.x,o=i?this.currentPage.pageY:this.y,r=u.getTime(),s=this.keyTime||0,l=.25;switch(this.options.useTransition&&this.isInTransition&&(e=this.getComputedPosition(),this._translate(a.round(e.x),a.round(e.y)),this.isInTransition=!1),this.keyAcceleration=r-s<200?a.min(this.keyAcceleration+l,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?n+=i?1:this.wrapperWidth:o+=i?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?n-=i?1:this.wrapperWidth:o-=i?1:this.wrapperHeight;break;case this.options.keyBindings.end:n=i?this.pages.length-1:this.maxScrollX,o=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:n=0,o=0;break;case this.options.keyBindings.left:n+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:o+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:n-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:o-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i)return void this.goToPage(n,o);n>0?(n=0,this.keyAcceleration=0):n<this.maxScrollX&&(n=this.maxScrollX,this.keyAcceleration=0),o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollY&&(o=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(n,o,0),this.keyTime=r}},_animate:function(t,e,i,n){function o(){var c,p,f,g=u.getTime();return g>=d?(r.isAnimating=!1,r._translate(t,e),void(r.resetPosition(r.options.bounceTime)||r._execEvent("scrollEnd"))):(g=(g-l)/i,f=n(g),c=(t-a)*f+a,p=(e-s)*f+s,r._translate(c,p),r.isAnimating&&h(o),void(3==r.options.probeType&&r._execEvent("scroll")))}var r=this,a=this.x,s=this.y,l=u.getTime(),d=l+i;this.isAnimating=!0,o()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":this.enabled&&!t._constructed&&(t.preventDefault(),t.stopPropagation())}}},d.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.fadeScrollbars&&(clearTimeout(this.fadeTimeout),this.fadeTimeout=null),this.options.interactive&&(u.removeEvent(this.indicator,"touchstart",this),u.removeEvent(this.indicator,u.prefixPointerEvent("pointerdown"),this),u.removeEvent(this.indicator,"mousedown",this),u.removeEvent(o,"touchmove",this),u.removeEvent(o,u.prefixPointerEvent("pointermove"),this),u.removeEvent(o,"mousemove",this),u.removeEvent(o,"touchend",this),u.removeEvent(o,u.prefixPointerEvent("pointerup"),this),u.removeEvent(o,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var e=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=e.pageX,this.lastPointY=e.pageY,this.startTime=u.getTime(),this.options.disableTouch||u.addEvent(o,"touchmove",this),this.options.disablePointer||u.addEvent(o,u.prefixPointerEvent("pointermove"),this),this.options.disableMouse||u.addEvent(o,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){var e,i,n,o,r=t.touches?t.touches[0]:t,a=u.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,e=r.pageX-this.lastPointX,this.lastPointX=r.pageX,i=r.pageY-this.lastPointY,this.lastPointY=r.pageY,n=this.x+e,o=this.y+i,this._pos(n,o),1==this.scroller.options.probeType&&a-this.startTime>300?(this.startTime=a,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),t.preventDefault(),t.stopPropagation()},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),u.removeEvent(o,"touchmove",this),u.removeEvent(o,u.prefixPointerEvent("pointermove"),this),u.removeEvent(o,"mousemove",this),this.scroller.options.snap){var e=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),i=this.options.snapSpeed||a.max(a.max(a.min(a.abs(this.scroller.x-e.x),1e3),a.min(a.abs(this.scroller.y-e.y),1e3)),300);this.scroller.x==e.x&&this.scroller.y==e.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=e,this.scroller.scrollTo(e.x,e.y,i,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0;var e=u.style.transitionDuration;if(this.indicatorStyle[e]=t+"ms",!t&&u.isBadAndroid){this.indicatorStyle[e]="0.0001ms";var i=this;h(function(){"0.0001ms"===i.indicatorStyle[e]&&(i.indicatorStyle[e]="0s")})}},transitionTimingFunction:function(t){this.indicatorStyle[u.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(u.addClass(this.wrapper,"iScrollBothScrollbars"),u.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(u.removeClass(this.wrapper,"iScrollBothScrollbars"),u.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=a.max(a.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=a.max(a.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&a.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&a.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(t<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=a.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=a.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),e<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=a.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=a.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[u.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=e+"px")},_pos:function(t,e){t<0?t=0:t>this.maxPosX&&(t=this.maxPosX),e<0?e=0:e>this.maxPosY&&(e=this.maxPosY),t=this.options.listenX?a.round(t/this.sizeRatioX):this.scroller.x,e=this.options.listenY?a.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,e)},fade:function(t,e){if(!e||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=t?250:500,n=t?0:300;t=t?"1":"0",this.wrapperStyle[u.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),n)}}},s.utils=u,"undefined"!=typeof t&&t.exports?t.exports=s:(n=function(){return s}.call(e,i,e,t),!(void 0!==n&&(t.exports=n)))}(window,document,Math)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){this.rootElement=t,this.bodyContainer=i,this.pager=e,this.thString=null,this.leftPage=void 0,this.rightPage=void 0,this.isZoomed=this.pager.getState().zoomMode,this.lastTarget=null,this.listenTo(this.pager,"change:state",this.setActiveTHs),this.listenTo(this.pager,"change:state",this._listenToPageChanges),(0,f["default"])().get(f["default"].API).on("turned",this.pageTurned,this),(0,f["default"])().get(f["default"].API).on("zoomed",this.pageTurned,this),(0,f["default"])().get(f["default"].API).on("unzoomed",this.pageTurned,this),this._listenToPageChanges(this.pager.getState()),this.render();var r=this,s=function(t){if(40===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("down");else if(38===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("up");else if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootElement.querySelector(".selected");if(null===e)return;e.querySelector(".th-img-element").click(),a["default"].removeClass(e,"selected"),a["default"].addClass(e,"active"),a["default"].removeClass(e.querySelector(".active"),"active")}};o&&this.rootElement.focus(),this.rootElement.addEventListener("keydown",s),this.rootElement.addEventListener("blur",function(){a["default"].removeClass(r.rootElement.querySelector(".selected"),"selected")})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(59),c=n(u),p=i(2),f=n(p);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype._changeSelected=function(t){var e,i,n=this.rootElement.querySelector(".selected")||this.rootElement.querySelector(".active"),o=a["default"].hasClass(n,"th-item-wrapper"),r=o?n.parentNode.parentNode:n.parentNode;if("up"===t){if(e=r.previousSibling,null===e){var s=r.parentNode.previousSibling;if(null===s)return;e=s.lastChild}}else if(e=r.nextSibling,null===e){var l=r.parentNode.nextSibling;if(null===l)return;e=l.firstChild}i=e.childNodes[0],a["default"].removeClass(n,"selected"),a["default"].hasClass(i,"active")||(a["default"].addClass(i,"selected"),this._updateScroll(!0))},o.prototype.render=function(){var t=20,e=Math.ceil((this.pager.pageTable.getPagesCount()+1)/(2*t));this.pager.getState().zoomMode===!0?a["default"].addClass(this.rootElement,"slide"):a["default"].removeClass(this.rootElement,"slide"),this.thBody=a["default"].createElement("div",{"class":"cont"},this.rootElement);for(var i=1;i<=e;i++)new c["default"](i,t,this.thBody,this.pager,this.pager.getState(),this,this.bodyContainer);this.setActiveTHs(this.pager.getState()),this._updateScroll()},o.prototype._updateScroll=function(t){t=t||!1,l["default"].defer(l["default"].bind(function(){this.trigger("change:height");var e=this.rootElement.querySelector(t?".selected":".active");l["default"].isUndefined(e)||(this.trigger("scroll:toElement",{el:e,speed:this.firstTimeScrolled?t?1500:500:0}),this.firstTimeScrolled=!0)},this))},o.prototype._pagePropsChanged=function(){this.trigger("reloadRequested")},o.prototype._listenToPageChanges=function(t){t.leftPage?(this.leftPage=t.leftPage,this.listenTo(this.pager.pageTable.getPageModel(this.leftPage).getPropertyModel(),"change:backgroundColor change:displayName",this._pagePropsChanged)):this.leftPage=void 0,t.rightPage&&t.rightPage!==t.leftPage?(this.rightPage=t.rightPage,this.listenTo(this.pager.pageTable.getPageModel(this.rightPage).getPropertyModel(),"change:backgroundColor change:displayName",this._pagePropsChanged)):this.rightPage=void 0,t.zoomMode!==this.isZoomed&&(this.isZoomed=t.zoomMode,this.rootElement.innerHTML="",this.firstTimeScrolled=!1,this.render())},o.prototype._stopListeningToPageChanges=function(){this.leftPage&&this.stopListening(this.pager.pageTable.getPageModel(this.leftPage).getPropertyModel(),"change:backgroundColor change:displayName",this._pagePropsChanged),this.rightPage&&this.rightPage!==this.leftPage&&this.stopListening(this.pager.pageTable.getPageModel(this.rightPage).getPropertyModel(),"change:backgroundColor change:displayName",this._pagePropsChanged)},o.prototype.unsetActiveTHs=function(){for(var t=this.rootElement.querySelectorAll(".active"),e=0,i=t.length;e<i;e++)a["default"].removeClass(t[e],"active");this._stopListeningToPageChanges()},o.prototype.pageTurned=function(){this.setActiveTHs(this.pager.getState())},o.prototype.setActiveTHs=function(t,e,i,n){if(e)return void(this.lastTarget=n);var o=this;this.trigger("change:active"),l["default"].defer(function(){o.unsetActiveTHs();var e=l["default"].isUndefined(t.leftPage)?null:o.rootElement.querySelector(".p"+t.leftPage),i=l["default"].isUndefined(t.rightPage)?null:o.rootElement.querySelector(".p"+t.rightPage),n=null;if(e&&i?n=e.parentNode.parentNode:(e&&(n=e.parentNode),i&&(n=i.parentNode)),a["default"].addClass(n,"active"),o.lastTarget){if(!l["default"].isUndefined(o.lastTarget)&&"th"===o.lastTarget)return void(o.lastTarget=null);o.lastTarget=null}o._updateScroll()})},o.prototype.destructor=function(){this._stopListeningToPageChanges(),this.stopListening(this.pager,"change:state",this.setActiveTHs),this.stopListening(this.pager,"change:state",this._listenToPageChanges),(0,f["default"])().get(f["default"].API).off("turned",this.pageTurned,this),(0,f["default"])().get(f["default"].API).off("zoomed",this.pageTurned,this),(0,f["default"])().get(f["default"].API).off("unzoomed",this.pageTurned,this)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.id=t,this.index={};var e=this.getPageKey("~index"),i=(0,h["default"])().getLocalStorage().getItem(e);this.pages=i?JSON.parse(i):{}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(1),l=n(s),d=i(5),h=n(d);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.getColorKey=function(){return this.id+"~color"},o.prototype.getPageKey=function(t){return this.id+"~page"+t},o.prototype.getPageData=function(t){var e=this.getPageKey(t);if(!this.index.hasOwnProperty(e)){var i=(0,h["default"])().getLocalStorage().getItem(e);this.index[e]=i?JSON.parse(i):{notes:[],lastId:0}}return this.index[e]},o.prototype.add=function(t,e){if(!a["default"].isUndefined(t)){var i=this.getPageData(t),n=i.notes;return n.push(Object.assign(e,{id:++i.lastId})),this._save(t),this.trigger(o.ADD_EVENT,{pageId:t,note:e}),Object.assign({},n[n.length-1])}},o.prototype.change=function(t,e){var i=this.getPageData(t),n=a["default"].findIndex(i.notes,function(t){return t.id===e.id});if(n>=0){var r=i.notes;if(!a["default"].isMatch(r[n],e))return r[n]=Object.assign(r[n],e),this._save(t),this.trigger(o.CHANGE_EVENT,{pageId:t,note:e}),!0}return!1},o.prototype.setDefaultColor=function(t){var e=this.getColorKey();(0,h["default"])().getLocalStorage().setItem(e,t)},o.prototype.getDefaultColor=function(){var t=this.getColorKey();return(0,h["default"])().getLocalStorage().getItem(t)},o.prototype._save=function(t){var e=this.getPageKey(t),i=JSON.stringify(this.index[e]);(0,h["default"])().getLocalStorage().setItem(e,i),this.index[e].notes.length?this.pages[t]="1":delete this.pages[t],(0,h["default"])().getLocalStorage().setItem(this.getPageKey("~index"),JSON.stringify(this.pages))},o.prototype.remove=function(t,e){var i=this.getPageData(t),n=a["default"].findIndex(i.notes,function(t){return t.id===e.id});return n>=0&&(i.notes.splice(n,1),this._save(t),this.trigger(o.REMOVE_EVENT,{pageId:t,note:e}),!0)},o.prototype.getPageIds=function(){var t=[];for(var e in this.pages)t.push(e);return t},o.prototype.getNotesOnPage=function(t){return this.getPageData(t).notes},o.CHANGE_EVENT="CHANGE_EVENT",o.ADD_EVENT="ADD_EVENT",o.REMOVE_EVENT="REMOVE_EVENT",e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){var o=this;this.noteData=t.noteData,this.pageModel=e,t.props.cast("links"),this.shadowDepth=this.pageModel.getProperty("shadowDepth"),this.shadowDepth===-1&&(this.shadowDepth=t.props.shadowDepth),this.listenTo(this.pageModel.model,"change:shadowDepth",function(e){e===-1&&(e=t.props.shadowDepth),this.set("shadowDepth",e)}),this.listenTo(t.props,"change:shadowDepth",function(t){this.pageModel.getProperty("shadowDepth")===-1&&this.set("shadowDepth",t)}),this.defaultLinksProps=t.props.links,this.pageFlippingDuration=t.props.pageFlippingDuration,this.highQuality=i,this.pageType=n||(e.getProperty("wide")?"wide":"single"),this._bookModel=t,this._isReadyChanged=function(t){o.trigger("isReady",t)},this.listenTo(this._bookModel,"change:isReady",this._isReadyChanged),this._isSearchActiveChanged=function(t){o.trigger("isSearchActive",t)},this.listenTo(this._bookModel,"change:isSearchActive",this._isSearchActiveChanged),this._searchQueryChanged=function(t){o.trigger("change:searchQuery",t)},this.listenTo(this._bookModel,"change:searchQuery",this._searchQueryChanged),this._fillChanged=function(){o.trigger("change:fillChanged")},this._contentChanged=function(){o.trigger("change:pageContent")},this._backgroundChanged=function(){o.trigger("change:pageBackground")},this._textLayerChanged=function(){o.trigger("change:textLayer")},this.listenTo(this.pageModel.getPropertyModel(),"change:videos change:links change:images",this._contentChanged),this.listenTo(this.pageModel.getPropertyModel(),"change:pageResize",this._fillChanged),this.listenTo(this.pageModel.getPropertyModel(),"change:backgroundColor",this._backgroundChanged),this.listenTo(this.pageModel.getPropertyModel(),"change:textLayer",this._textLayerChanged),this.listenTo(this.getDefaultLinkProps(),"all",this._contentChanged)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(0),l=n(s),d=i(2),h=n(d),u=window.FBPublication.PageResourceType;o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.isReady=function(){return this._bookModel.isReady},o.prototype.getPageId=function(){return this.getPageModel().id},o.prototype.getPageModel=function(){return this.pageModel},o.prototype.getPageContent=function(){var t=this,e=[],i=t.getMode().indexOf("wide")!==-1;this.maxZIndex=0;var n=function(n,o){l["default"].each(l["default"].sortBy(t.pageModel.getProperty(n),"zIndex").reverse(),function(n){if(n.zIndex&&n.zIndex>t.maxZIndex&&(t.maxZIndex=n.zIndex),i){var r=t.getPageSize().width/2;switch(t.getMode()){case"wideRight":if(n.rect[2]+n.rect[0]<=r)return;break;case"wideLeft":if(n.rect[2]>=r)return}}e.push({type:o,data:n})})};return n("links","link"),n("videos","video"),n("images","image"),n("gifs","gif"),l["default"].each(this.noteData.getNotesOnPage(this.getPageId()),function(n){if(i)switch(t.getMode()){case"wideRight":if(n.pX<=t.pageModel.bookSize.width)return;break;case"wideLeft":if(n.pX>t.pageModel.bookSize.width)return}e.push({type:"note",data:{note:n}})}),e},o.prototype.getMode=function(){return this.pageType},o.prototype.isSearchActive=function(){return this._bookModel.isSearchActive},o.prototype.getSearchCharactersLimit=function(){return this._bookModel.searchCharactersLimit},o.prototype.getSearchQuery=function(){return this._bookModel.searchQuery},o.prototype.getPageSize=function(){return{width:this.pageModel.getProperty("width"),height:this.pageModel.getProperty("height")}},o.prototype.getDefaultLinkProps=function(){return this.defaultLinksProps},o.prototype.getPageFlippingDuration=function(){return 1e3*this.pageFlippingDuration},o.prototype.getImageSizes=function(t){var e=this.pageModel.getProperty("substrateSizes"),i={};if(e){var n=parseInt(this.pageModel.getProperty("substrateSizesReady"),10),o=this.pageModel.getProperty("customSubstrateSize"),r=this.pageModel.getProperty("textSizes");0===n&&(n=4);var a=e.slice(0,n),s=void 0,d=void 0,h=void 0;o&&(a=a.slice(0,a.length-1),a.push(parseInt(o,10))),h=Math.max(t.width,t.height),s=l["default"].findIndex(a,function(t){return t>=h||t===a[a.length-1]}),d=l["default"].findIndex(r,function(t){return t>=h||t===r[r.length-1]}),i.substrate=s+1,i.text=d+1}else this.highQuality?(i.substrate="l",i.text="l1"):(i.substrate="",i.text="c");return i},o.prototype.getBackgroundImages=function(t){var e=(0,h["default"])().get(h["default"].LOAD_MANAGER),i=this.getImageSizes(t),n=this.isSVGSupported();return l["default"].filter([e.getPageLoader(this.getPageId(),u.PAGE_SUBSTRATE,i.substrate),n?e.getPageLoader(this.getPageId(),u.SVG):null,n?null:e.getPageLoader(this.getPageId(),u.PAGE_TEXT,i.text)],function(t){return t})},o.prototype.isSVGSupported=function(){return!this.pageModel.getProperty("rasterize")&&((!this.pageModel.getProperty("rtlContent")||!this._bookModel.browser.msedge)&&(!!this.pageModel.getProperty("vectorText")&&((!this._bookModel.browser.ie||"11.0"!==this._bookModel.browser.version)&&!(this._bookModel.browser.msedge&&this._bookModel.browser.version.split(".")[0]>=18))))},o.prototype.getPreloaderImage=function(){var t=(0,h["default"])().get(h["default"].LOAD_MANAGER);return t.getPageLoader(this.getPageId(),u.THUMBNAIL)},o.prototype.getBackgroundColor=function(){return this.pageModel.getProperty("backgroundColor")},o.prototype.getPageTable=function(){return this._bookModel.getPageTable()},o.prototype.isRight=function(){var t=this.getPageNumber()%2===0;return this._bookModel.getPager().isRtl()&&(t=!t),t},o.prototype.isLeft=function(){return!this.isRight()},o.prototype.getPageNumber=function(){return this.getPageTable().getPageIndexById(this.getPageId())},o.prototype.getPageUrlHeader=function(){return this.getPageTable().getUrlHeaderById(this.getPageId())},o.prototype.getFillMode=function(){if("FILL"===this.getPageModel().getProperty("pageResize")){var t=this.getPageModel().getProperty("width");t/=this.getPageModel().getProperty("wide")?2:1;var e=this.getPageModel().getProperty("height"),i=this._bookModel.getProps().bookSize.width,n=this._bookModel.getProps().bookSize.height;return t/e<i/n?"wide":"tall"}return"fit"},o.prototype.destroy=function(){this.stopListening(this._bookModel,"change:isReady",this._isReadyChanged),this.stopListening(this._bookModel,"change:isSearchActive",this._isSearchActiveChanged),this.stopListening(this._bookModel,"change:searchQuery",this._searchQueryChanged),this.stopListening(this.pageModel.getPropertyModel(),"change:videos change:links change:images",this._contentChanged),this.stopListening(this.pageModel.getPropertyModel(),"change:pageResize",this._fillChanged),this.stopListening(this.pageModel.getPropertyModel(),"change:backgroundColor",this._backgroundChanged),this.stopListening(this.pageModel.getPropertyModel(),"change:textLayer",this._textLayerChanged),this.stopListening(this.getDefaultLinkProps(),"all",this._contentChanged)},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.model=t,this.isActive=!1,this.pageContentPresenters=[],this.contentLoadCounter=0}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(62),l=n(s),d=i(65),h=n(d),u=i(67),c=n(u),p=i(28),f=n(p),g=i(17),m=n(g),v=i(69),y=n(v),b=i(70),w=n(b),_=i(73),P=n(_),E=i(74),T=n(E),C=i(77),A=n(C),x=i(78),S=n(x),k=i(85),I=n(k),L=i(4),M=n(L),O=i(0),N=n(O),B=i(9),D=i(2),z=n(D);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.destructor=function(){this.view.clearContentView(),this.view.destructor()},o.prototype.init=function(t,e){function i(t){for(var e=[];t;){if(e.push(t),"HTML"===t.tagName)return e;t=t.parentElement}}var n=this,o=this;this.currentSize=t,this.isZoomed=e,this.model.on("change:pageContent",function(){o.view.clearContentView(),N["default"].each(o._getPageContent(),function(t){o.view.addContentElement(t)})}),this.model.on("change:pageBackground",function(){o.view.updateBackgroundColor(o.model.getBackgroundColor())}),this.model.on("change:fillChanged",function(){o.view.setFillMode(o.model.getFillMode()),o.view.resize(o.currentSize)}),this.model.on("change:textLayer",function(){N["default"].defer(N["default"].bind(function(){this._updateBackgroundImages()},o))});var r=this.model.getPageSize();return this.view=new l["default"](this).init({mode:this.model.getMode(),fillMode:this.model.getFillMode(),isZoomed:e,pageSize:r,pageBackgroundColor:this.model.getBackgroundColor(),highlightOnFlip:this.model.getDefaultLinkProps().highlightOnFlip,highlightDelay:this.model.getPageFlippingDuration(),content:this._getPageContent()}),this.view.on("tap",function(t){N["default"].each(o.pageContentPresenters,function(e){e.getView().getDOMElement()===t.target&&t.target.classList.contains("publication-link")&&e.onLinkTap()}),o.toggleHighlight&&o.view.highlight("toggle")}),this.view.getDOMElement().addEventListener("mousedown",function(t){var e=!1,n=(0,m["default"])().getState()!==m["default"].CLOSE_STATE,r="function"==typeof(0,z["default"])().get(z["default"].CONTEXT_MENU)._hideMenu,a=i(t.target),s=0===t.button;o.toggleHighlight=!1,N["default"].each(o.pageContentPresenters,function(t){var i=t.getView().getDOMElement();a&&a.indexOf(i)!==-1&&(e=!0)}),!s||e||n||r||(o.toggleHighlight=!0)},!0),this.view.on("highlight",function(t){(0,z["default"])().get(z["default"].API).trigger("highlight",{action:t,page:o.model.getPageUrlHeader()})}),this.on("change:currentSize",N["default"].debounce(function(){n.isActive&&n._updateBackgroundImages()},100)),this.view.changeShadowDepth(this.model.shadowDepth),this.model.on("change:shadowDepth",function(t){this.view.changeShadowDepth(t)},this),this._updateBackgroundImages(),this._generateSearchHighlights(),this.view.resize(this.currentSize),this},o.prototype._updateBackgroundImages=function(){var t=this,e=this;this.preloaderImageLoader=this.model.getPreloaderImage(),this.pageResources=this.model.getBackgroundImages(this.currentSize);var i=this.preloaderImageLoader.getState();i>=B.LoaderState.LOADED?this.view.setPreloaderImage(this.preloaderImageLoader.getLoadedData()):i<B.LoaderState.LOADED&&this.preloaderImageLoader.once(B.LoaderEvent.LOADED,function(){t.view.setPreloaderImage(t.preloaderImageLoader.getLoadedData())});var n=e.pageResources[0].getState();N["default"].each(this.pageResources,function(t){var e=t.getState();e<n&&(n=e)}),n<B.LoaderState.LOADED&&n>=B.LoaderState.READY?e.view.setState(l["default"].STATES.LOADING):n<B.LoaderState.READY&&e.view.setState(l["default"].STATES.UNREADY);var o=0,r=function(){o++,o===e.pageResources.length&&(e.contentLoadCounter?e.on("change:contentLoadCounter",function(t){0===t&&(this.view.setState(l["default"].STATES.LOADED),this.view.setBackgroundImages(N["default"].map(this.pageResources,function(t){return t.getLoadedData()})),
this.setActive(this.realIsActive))},e):(e.view.setState(l["default"].STATES.LOADED),e.view.setBackgroundImages(N["default"].map(e.pageResources,function(t){return t.getLoadedData()})),e.setActive(e.realIsActive)))},a=function(){e.view.state===l["default"].STATES.UNREADY&&e.view.setState(l["default"].STATES.LOADING)},s=function(){e.view.setState(l["default"].STATES.ERROR)};N["default"].each(this.pageResources,function(t){var e=t.getState();e>=B.LoaderState.READY&&e<B.LoaderState.LOADED?a():e<B.LoaderState.LOADING&&t.once(B.LoaderEvent.LOADING,a),e>=B.LoaderState.LOADED?r():e<B.LoaderState.LOADED&&(t.once(B.LoaderEvent.LOADED,r),t.once(B.LoaderEvent.ERROR,s))})},o.prototype.addNote=function(t,e){var i={pX:t.pX,pY:t.pY},n=new c["default"](new f["default"](i,this.model.noteData,{pageId:this.model.getPageId(),pageTable:this.model.getPageTable(),isRight:this.isRight(),isZoomed:this.isZoomed,zIndex:++this.model.maxZIndex,bookSize:this.getBookSize(),isWide:this.isWide(),isNew:!0}),(!0)),o={action:"add",text:n.model.note.text,pageUrl:n.model.getUrlHeader(),initiator:e};this.getApiProvider().trigger("note",o),this.view.addContentElement(this.initPresenter(n))},o.prototype.getBookSize=function(){var t=this.model._bookModel.getProps().bookSize,e={width:parseInt(t.width),height:parseInt(t.height)};return e.ratio=e.width/e.height,e},o.prototype._getPageContent=function(){var t=this;return this.updateScale(this.currentSize),N["default"].map(this.model.getPageContent(),function(e){return t._contentItemsFactory(e)})},o.prototype._contentItemsFactory=function(t){var e,i=this.model.getPageSize().width/2,n=!1;if(this.isWide()&&"note"!==t.type){var o=N["default"].isUndefined(t.data.rect)?t.data.x:t.data.rect[2],r=N["default"].isUndefined(t.data.rect)?t.data.width:t.data.rect[0];o<=i&&o+r>=i&&(n=!0)}switch(t.type){case"link":e=new h["default"](new y["default"](M["default"].mergeObjects(this.model.getDefaultLinkProps(),t.data),{pageNumber:this.model.getPageNumber(),pageTable:this.model.getPageTable(),crossWide:n,id:this.pageContentPresenters.length,isZoomed:this.isZoomed}),this).init();break;case"video":switch(e=new w["default"](new P["default"](t.data,{browser:this.model._bookModel.browser,pageId:this.model.getPageId(),crossWide:n,id:t.data.zIndex},this.model.getDefaultLinkProps())).init(),e.state){case B.LoaderState.LOADING:this.set("contentLoadCounter",this.contentLoadCounter+1),e.on("change:state",function(){this.set("contentLoadCounter",this.contentLoadCounter-1)},this)}break;case"image":e=new T["default"](new A["default"](M["default"].mergeObjects(t.data,{pageId:this.model.getPageId(),browser:this.model._bookModel.browser,crossWide:n,id:this.pageContentPresenters.length,isZoomed:this.isZoomed}),this.model.getDefaultLinkProps())).init();break;case"gif":switch(e=new S["default"](new I["default"](M["default"].mergeObjects(t.data,{pageId:this.model.getPageId(),browser:this.model._bookModel.browser,crossWide:n,id:this.pageContentPresenters.length,isZoomed:this.isZoomed}),this.model.getDefaultLinkProps())).init(),e.state){case B.LoaderState.LOADING:this.set("contentLoadCounter",this.contentLoadCounter+1),e.on("change:state",function(){this.set("contentLoadCounter",this.contentLoadCounter-1)},this)}break;case"note":e=new c["default"](new f["default"](t.data.note,this.model.noteData,{pageId:this.model.getPageId(),pageTable:this.model.getPageTable(),isRight:this.isRight(),isZoomed:this.isZoomed,zIndex:++this.model.maxZIndex,bookSize:this.getBookSize(),isWide:this.isWide()}))}return this.initPresenter(e)},o.prototype.isRight=function(){return"single"===this.model.getMode()?this.model.isRight():"wideRight"===this.model.getMode()},o.prototype.initPresenter=function(t){var e=this,i=function(){"wideRight"===e.model.getMode()&&t.offset(-e._pageWidth),t.constructor!==c["default"]||"wideRight"!==e.model.getMode()&&"wideLeft"!==e.model.getMode()||t.setOffsetForChangePage(-e._pageWidth),t.scale(e._scale,e.currentSize),t.commit(),e.isZoomed&&setTimeout(function(){t.commit()},0)};return this.on("change:currentSize",function(){i()}),i(),t.isActive=this.isActive,this.on("change:isActive",function(e){t.set("isActive",e)}),this.pageContentPresenters.push(t),t.getView()},o.prototype.getLibraryManager=function(){return(0,z["default"])().get(z["default"].LIBRARY_MANAGER)},o.prototype._generateSearchHighlights=function(){var t=this,e=this.model.getPageModel();if(e.isStub()!==!0){var i;this.getLibraryManager().loaded("search")?(i=this.getLibraryManager().getExports("search").HighlighterModel,this.highlightModel=new i(e,this.model.getSearchCharactersLimit())):this.getLibraryManager().on("library:search",function(t){i=t.exports.HighlighterModel,this.highlightModel=new i(e,this.model.getSearchCharactersLimit())},this),this.model.isSearchActive()&&this._loadSearchHighlights(),this.model.on("isSearchActive change:searchQuery",N["default"].bind(this._onSearch,this)),this.on("change:currentSize",function(){t.model.isSearchActive()&&t._highlightResize()})}},o.prototype._highlightResize=function(){if(this.highlightPresenter){var t=this.currentSize,e=this.model.getPageSize();switch(this.model.getMode()){case"wideRight":case"wideLeft":e.width/=2}var i=M["default"].fitScreenSizes(e.width,e.height,t.width,t.height),n=i.width/e.width;"wideRight"===this.model.getMode()&&this.highlightPresenter.offset(-e.width),this.highlightPresenter.scale(n)}},o.prototype._onSearch=function(t){this.model.isSearchActive&&(this.view.clearSearchView(),t&&this._loadSearchHighlights())},o.prototype._loadSearchHighlights=function(){var t=this;this.highlightPresenter&&this.highlightPresenter.cancelAllRequests();var e,i=function(){t.highlightPresenter=new e(t.highlightModel),t.highlightPresenter.getSearchHighlightViews(t.model.getSearchQuery(),function(e,i){!e&&i&&i.length&&(t.view.addSearchViews(i),t._highlightResize())})};this.getLibraryManager().loaded("search")?(e=this.getLibraryManager().getExports("search").HighlighterPresenter,i()):this.getLibraryManager().on("library:search",function(t){e=t.exports.HighlighterPresenter,i()})},o.prototype.getViewElement=function(){return this.view.getDOMElement()},o.prototype.updateScale=function(t){var e=this.model.getPageSize();switch(this.model.getMode()){case"wideRight":case"wideLeft":e.width/=2}var i=M["default"].fitScreenSizes(e.width,e.height,t.width,t.height);this._pageWidth=e.width,this._scale=i.width/e.width},o.prototype.resize=function(t){this.updateScale(t),this.set("currentSize",t),this.view.resize(t)},o.prototype.requestNavigation=function(t,e){this.trigger("requestNavigation",{type:t,data:e})},o.prototype.setActive=function(t){var e=this;if(this.realIsActive=t,t)if(e.view.state===l["default"].STATES.LOADED)N["default"].delay(function(){e.realIsActive&&e.set("isActive",!0)},500);else{var i=0,n=function(){i--,0===i&&N["default"].delay(function(){e.realIsActive&&e.set("isActive",!0)},500)};N["default"].each(this.pageResources,function(t){var e=t.getState();e<B.LoaderState.LOADED&&(i++,t.once(B.LoaderEvent.LOADED,n))})}else this.set("isActive",!1)},o.prototype.isWide=function(){return this.model.getMode().indexOf("wide")!==-1},o.prototype.freePageLoaders=function(){this.model.freePageLoaders(this.pageResources)},o.prototype.sendContentSize=function(e,i,n){if(i=Math.round(i)||Math.round(this.currentSize.width),n=Math.round(n)||Math.round(this.currentSize.height),t.contentSizes||(t.contentSizes=[]),t.contentSizes.indexOf(i+"x"+n)===-1){var o={action:e,width:i,height:n};(0,z["default"])()&&(0,z["default"])().has("analytics")&&(0,z["default"])().get("analytics").trigger("contentSize",o),t.contentSizes.push(i+"x"+n)}},o.prototype.sendContentSizeThr1=N["default"].throttle(o.prototype.sendContentSize,5e3,{leading:!1}),o.prototype.sendContentSizeThr2=N["default"].throttle(o.prototype.sendContentSize,5e3,{leading:!1}),o.prototype.destroy=function(){N["default"].each(this.pageContentPresenters,function(t){t.destructor()}),this.model.off("isSearchActive change:searchQuery",N["default"].bind(this._onSearch,this)),this.model.destroy()},o.prototype.getApiProvider=function(){return(0,z["default"])().get(z["default"].API)},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this.noteData=e,this.pageTable=i.pageTable,this.note=Object.assign({color:e.getDefaultColor()||o.COLOR_LIST[0]},t),this.note.id||(this.note.date=(new Date).getTime(),this.note=this.noteData.add(i.pageId,this.note),this.setId(this.note.id)),this.options=i,this.isZoomed=i.isZoomed,this.bookSize=i.bookSize,this.isWide=i.isWide,this.setIsRight(i.isRight),this.setPageId(this.options.pageId),i.isNew&&(this.isNew=!0)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.setIsRight=function(t){this.isRight=t},o.prototype.setPageId=function(t){this.set("pageId",t),this.save()},o.prototype.setId=function(t){this.set("id",t)},o.prototype.setColor=function(t){this.note.color!==t&&(this.note.color=t,this.noteData.setDefaultColor(t),this.trigger("update"),this.save())},o.prototype.getUrlHeader=function(){return this.pageTable.getUrlHeaderById(this.pageId)},o.prototype.setText=function(t){this.note.text!==t&&(this.note.text=t,this.note.date=(new Date).getTime(),this.trigger("update"),this.save())},o.prototype.setPosition=function(t){this.note.pX===t.pX&&this.note.pY===t.pY||(this.note.pX=t.pX,this.note.pY=t.pY,this.trigger("update"),this.save())},o.prototype.remove=function(){this.note.id&&this.options.pageId&&this.noteData.remove(this.options.pageId,this.note)},o.prototype.save=function(){this.note.id&&this.options.pageId&&this.noteData.change(this.options.pageId,this.note),this.options.pageId!==this.pageId&&(this.noteData.remove(this.options.pageId,this.note),this.note=this.noteData.add(this.pageId,this.note),this.setId(this.note.id),this.options.pageId=this.pageId),this.trigger("save")},o.COLOR_LIST=["green","blue","violet","red","orange","gray"],e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.presenter=t}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.init=function(){},o.prototype.setTextSelectionMode=function(){},o.prototype.destroy=function(){},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.model=t,this.view=this._createView(),this.isReady=!1}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(1),l=n(s),d=i(2),h=n(d);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.getBookState=function(){return(0,h["default"])().get(h["default"].BOOK_STATE)},o.prototype.init=function(){var t=this;return a["default"].each(a["default"].uniq([this.model.getPager().state.leftPage,this.model.getPager().state.rightPage]),function(e){e&&t.onPageActivate(e)}),this},o.prototype.onPagerStateChange=function(t,e){var i=this;this.getBookState().removeStorageExcept(this.model.getPager().state.leftPage,this.model.getPager().state.rightPage),a["default"].isUndefined(e)||a["default"].each(a["default"].uniq([e.leftPage,e.rightPage]),function(t){t&&i.onPageDeactivate(t)}),a["default"].each(a["default"].uniq([t.leftPage,t.rightPage]),function(t){t&&i.onPageActivate(t)})},o.prototype.setTextSelectionMode=function(t){this.view.setTextSelectionMode(t)},o.prototype.onPageChanging=function(){this.trigger("onPageChanging")},o.prototype.onEndDrag=function(){this.trigger("onEndDrag")},o.prototype.onStartDrag=function(){this.trigger("onStartDrag")},o.prototype.onPageChanged=function(){this.trigger("onPageChanged")},o.prototype.destroy=function(){this.view.destroy()},o.prototype._createView=function(){throw new Error("_createView should be overriden")},o.prototype.onPageActivate=function(t){this.trigger("onPageActivate",t)},o.prototype.onPageDeactivate=function(){},o.prototype.resize=function(){},o.prototype.getDataForTransitionStart=function(){},o.prototype.freeze=function(){this.model.getPager().freeze("zoom")},o.prototype.unfreeze=function(){this.model.getPager().unfreeze("zoom")},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){a["default"].call(this,t),this.contentPresenters={}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(30),a=n(r),s=i(27),l=n(s),d=i(94),h=n(d),u=i(26),c=n(u),p=i(4),f=n(p),g=i(2),m=n(g),v=i(0),y=n(v),b=4,w={toView:function(t){return 1+t*(b-1)},fromView:function(t){return(t-1)/(b-1)}};o.prototype=Object.create(a["default"].prototype),o.prototype.constructor=o,o.prototype.destructor=function(){for(var t in this.contentPresenters)this.contentPresenters.hasOwnProperty(t)&&y["default"].isFunction(this.contentPresenters[t].destructor)&&this.contentPresenters[t].destructor()},o.prototype._createView=function(){return new h["default"](this)},o.prototype.init=function(t,e){var i=this;this.size=t.getBoundingClientRect();var n=y["default"].isNull(this.model.zoomScaleValue)?null:w.toView(this.model.zoomScaleValue),o={contentProvider:this,unitSizeProvider:this,animate:null};return y["default"].extend(o,e),o.animate?(n&&(o.animate.to||(o.animate.to=n)),o.animate.fromRect&&(o.animate.from=o.animate.fromRect.width/this.getUnitPageSize().width,delete o.animate.fromRect)):o.zoom=n,this.view.init(t,o),this.view.getDOMElement().dataset.dir=this.model.getPager().isRtl()?"rtl":"",this.view.setLeftArrowVisible(this.model.getPager().isRtl()?this.model.getPager().getNextPageId():this.model.getPager().getPrevPageId()),this.view.setRightArrowVisible(this.model.getPager().isRtl()?this.model.getPager().getPrevPageId():this.model.getPager().getNextPageId()),this.model.flipDisabled&&this.view.setZoomValue(1,null,0),this.model.zoomScaleValue||this.model.set("zoomScaleValue",w.fromView(this.view.getZoomValue())),this._onViewZoomChanged=function(t){i._fireZoom=!0,i.model.set("zoomScaleValue",w.fromView(t))},this.view.on("zoom",this._onViewZoomChanged),this._onZoomScaleValueChanged=function(t){i.setZoomValue(w.toView(t),null,i.model.zoomChangeAnimation?0:150,i.model.zoomChangeAnimation)},this.listenTo(this.model,"change:zoomScaleValue",this._onZoomScaleValueChanged),this._changeAnimationType=function(t){t||(i._fireZoom=!1,this._onZoomScaleValueChanged(this.model.zoomScaleValue))},this.listenTo(this.model,"change:zoomChangeAnimation",this._changeAnimationType),a["default"].prototype.init.call(this)},o.prototype.requestNavigation=function(t){if(t)switch(t.type){case"page":this.model.getPager().goToPageById(t.data.pageId);break;case"next":this.model.getPager().goForward();break;case"prev":this.model.getPager().goBackward();break;case"zoom":if(this.model.flipDisabled)if(0!==this.model.zoomScaleValue)this.model.singlePageZoomStore=this.model.zoomScaleValue,this.view.setZoomValue(1,t.data.center,300);else{var e=this.model.singlePageZoomStore||w.fromView(this.view._calcZoomFactorToCoverScreen(this.getUnitPageSize()));this.view.setZoomValue(w.toView(e),t.data.center,300,!1)}else this.model.getPager().setZoomMode(!1)}},o.prototype.getContentForPage=function(t,e){var i=this.model.getPager(),n=this.model.getPageTable(),o=i.getState().leftPage,r=i.isRtl()?i.getPrevPageId():i.getNextPageId(),a=i.isRtl()?i.getNextPageId():i.getPrevPageId(),s=e||("left"===t?a:"right"===t?r:o),d=n.getPageModel(s);if((0,m["default"])().get(m["default"].LOAD_MANAGER).setBookRange([],[o,i.getPrevPageId(),i.getNextPageId()],!1),d){if(y["default"].has(this.contentPresenters,d.id))return this.contentPresenters[d.id];var h={};if("undefined"!=typeof this.size.top){var u=void 0,p=this.getUnitPageSize();y["default"].isNull(this.model.zoomScaleValue)?this.model.flipDisabled&&(u=1):u=w.toView(this.model.zoomScaleValue),"undefined"!=typeof u?(h.width=Math.round(p.width*u),h.height=Math.round(p.height*u-90)):h=f["default"].fillScreenSizes(p.width,p.height,this.size.width,this.size.height-90)}else h=this.size;var g=new c["default"](this.model,d,(!0)),v=new l["default"](g).init(h,!0);return this.listenTo(v,"requestNavigation",this.requestNavigation,this),this.contentPresenters[d.id]=v,v}},o.prototype.getUnitPageSize=function(){return this.model.flipDisabled?f["default"].fitRectIntoBounds({width:this.model.props.bookSize.width,height:this.model.props.bookSize.height},{width:this.size.width-60,height:this.size.height}):f["default"].fitRectIntoBounds({width:this.model.props.bookSize.width,height:this.model.props.bookSize.height},{width:.95*this.size.width/2,height:.95*this.size.height})},o.prototype.resize=function(t){this.size=t,this.view.resize()},o.prototype.goLeft=function(t){this._fireTrigger=!t;var e=this.model.getPager();e.isRtl()?e.goForward():e.goBackward()},o.prototype.goRight=function(t){this._fireTrigger=!t;var e=this.model.getPager();e.isRtl()?e.goBackward():e.goForward()},o.prototype.onPagerStateChange=function(t,e){if(this.view.setLeftArrowVisible(this.model.getPager().isRtl()?this.model.getPager().getNextPageId():this.model.getPager().getPrevPageId()),this.view.setRightArrowVisible(this.model.getPager().isRtl()?this.model.getPager().getPrevPageId():this.model.getPager().getNextPageId()),a["default"].prototype.onPagerStateChange.apply(this,arguments),this._fireTrigger)return void(this._fireTrigger=!1);if(t.zoomMode!==!1&&!y["default"].isNull(t)&&!y["default"].isUndefined(t)){var i=y["default"].isNull(e)||y["default"].isUndefined(e);if(!i&&t.leftPage!==e.leftPage){var n,o=this.model.getPageTable();n=o.getPageIndexById(t.leftPage)>o.getPageIndexById(e.leftPage)?!this.model.getPager().isRtl():this.model.getPager().isRtl(),this.view.goToPage(t.leftPage,n)}}},o.prototype.pre_destroy=function(){this.stopListening(this.model,"change:zoomScaleValue",this._onZoomScaleValueChanged),this.stopListening(this.model,"change:zoomChangeAnimation",this._changeAnimationType),this.view.off("zoom",this._onViewZoomChanged)},o.prototype.destroy=function(){y["default"].each(this.contentPresenters,function(t){t.destroy()}),a["default"].prototype.destroy.call(this)},o.prototype.getViewContainer=function(){return this.view.getContainer()},o.prototype.onPageActivate=function(t){var e=this;a["default"].prototype.onPageActivate.call(this,t),y["default"].has(this.contentPresenters,t)||this.getContentForPage(void 0,t),this.model.isReady?this.contentPresenters[t].setActive(!0):this.model.on("change:isReady",function(i){i&&e.contentPresenters[t].setActive(!0)})},o.prototype.onPageDeactivate=function(t){y["default"].has(this.contentPresenters,t)&&this.contentPresenters[t].setActive(!1)},o.prototype.setZoomValue=function(t,e,i,n){this.view.setZoomValue(t,e,i,n)},o.prototype.getDataForTransitionStart=function(){return this.view.getCurrentWrappers()},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.start=function(){},o.prototype.clear=function(){},e["default"]=o},,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this.leftPage=t,this.rightPage=e,this.zoomMode=i}function r(t){this.pageTable=new u["default"](t),this._model=t,this.state=new o((void 0),this.pageTable.getPageIdByIndex(0),(!1)),this.totalPages=this.pageTable.getPagesCount(),this.isTotalCustom=!1,s["default"].has(t,"customTotalPages")&&(this.totalPages=t.customTotalPages,this.isTotalCustom=!0),this.target=null,this.rtl=t.rightToLeft,this._model.on("change:rightToLeft",function(t){this.set("rtl",t)},this)}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=e.PagerState=void 0;var a=i(0),s=n(a),l=i(1),d=n(l),h=i(35),u=n(h);o.prototype.isEqualTo=function(t){return s["default"].isEqual(this,t)},r.prototype=new d["default"],r.prototype.constructor=r,r.prototype.getState=function(){return this.state},r.prototype.goToPageById=function(t,e,i){var n=this._getStateByPageIdAndZoomMode(t,this.state.zoomMode);return!!this._canChangeStateTo(n)&&(!!this.state.isEqualTo(n)||(this.target=e||null,this.initiator=i,this.set("state",n),!0))},r.prototype.goToPageByIndex=function(t,e,i){if(t<0||t>=this.pageTable.getPagesCount())return!1;var n=this.pageTable.getPageIdByIndex(t);return(!s["default"].isUndefined(n)||(n=this.pageTable.getPageIdByIndex(t-1),!s["default"].isUndefined(n)))&&this.goToPageById(n,e,i)},r.prototype.setZoomMode=function(t,e,i){var n,o;return n=e?s["default"].isUndefined(this.state.rightPage)?this.state.leftPage:this.state.rightPage:s["default"].isUndefined(this.state.leftPage)?this.state.rightPage:this.state.leftPage,o=this._getStateByPageIdAndZoomMode(n,t),!!this._canChangeStateTo(o)&&(!!this.state.isEqualTo(o)||(this.target=i||null,this.set("state",o),!0))},r.prototype._canChangeStateTo=function(t){return!s["default"].isUndefined(t)&&(s["default"].isNull(this._isFreezedBy)||s["default"].isUndefined(this._isFreezedBy))},r.prototype._getStateByPageIdAndZoomMode=function(t,e){if(this.pageTable.hasPageWithId(t)){if(e)return new o(t,(void 0),(!0));var i=this.pageTable.getPageIndexById(t);return i%2!==0?new o(t,this.pageTable.getPageIdByIndex(i+1),(!1)):new o(this.pageTable.getPageIdByIndex(i-1),t,(!1))}},r.prototype.trigger=function(t){"change:state"!==t||s["default"].isNull(this.target)?d["default"].prototype.trigger.apply(this,arguments):(d["default"].prototype.trigger.apply(this,s["default"].union(arguments,[this.target])),this.target=null)},r.prototype.goToFirst=function(t){var e=this.pageTable.getUrlHeaderById(this.state.leftPage||this.state.rightPage);return!!this.goToPageByIndex(0,void 0,t)&&(this.trigger("goToFirstPage",{pageUrl:e}),!0)},r.prototype.goToLast=function(t){var e=this.pageTable.getUrlHeaderById(this.state.leftPage||this.state.rightPage);return!!this.goToPageByIndex(this.pageTable.getPagesCount()-1,t)&&(this.trigger("goToFirstPage",{pageUrl:e}),!0)},r.prototype.goBackward=function(t){var e=this.getPrevPageId();if(e)return this.goToPageById(e,void 0,t)},r.prototype.goForward=function(t){var e=this.getNextPageId();if(e)return this.goToPageById(e,void 0,t)},r.prototype.getNextPageId=function(){var t=s["default"].filter(this.pageTable.getStructure(),function(t){return!s["default"].isNull(t)}),e=this.state.rightPage?this.state.rightPage:this.state.leftPage,i=s["default"].indexOf(t,e);return i<t.length-1?t[i+1]:null},r.prototype.getPrevPageId=function(){var t=s["default"].filter(this.pageTable.getStructure(),function(t){return!s["default"].isNull(t)}),e=this.state.leftPage?this.state.leftPage:this.state.rightPage,i=s["default"].indexOf(t,e);return i>0?t[i-1]:null},r.prototype.toggleZoomMode=function(){return this.setZoomMode(!this.state.zoomMode,!1)},r.prototype.getStateForDisplay=function(t){var e=null,i=null;return t.leftPage===t.rightPage?this.pageTable.getPageCaptionById(t.leftPage):(s["default"].isUndefined(t.leftPage)||(e=this.pageTable.getPageCaptionById(t.leftPage)),s["default"].isUndefined(t.rightPage)||(i=this.pageTable.getPageCaptionById(t.rightPage)),this.isRtl()?s["default"].isNull(i)?s["default"].isNull(e)?"":e:i+(s["default"].isNull(e)?"":" - "+e):s["default"].isNull(e)?s["default"].isNull(i)?"":i:e+(s["default"].isNull(i)?"":" - "+i))},r.prototype.isFirstPage=function(t){var e,i,t=t||this.getState();return t.leftPage&&(e=this.pageTable.isFirstPage(t.leftPage)),t.rightPage&&(i=this.pageTable.isFirstPage(t.rightPage)),e||i},r.prototype.isLastPage=function(t){var e,i,t=t||this.getState();return t.leftPage&&(e=this.pageTable.isLastPage(t.leftPage)),t.rightPage&&(i=this.pageTable.isLastPage(t.rightPage)),e||i},r.prototype.isRtl=function(){return!s["default"].isUndefined(this._model.rightToLeft)&&this._model.rightToLeft},r.prototype.isHardcover=function(){return!s["default"].isUndefined(this._model.hardcover)&&this._model.hardcover},r.prototype.freeze=function(t){this._isFreezedBy||(this._isFreezedBy=t,"api"===t&&this.trigger("freezed"))},r.prototype.unfreeze=function(t){this._isFreezedBy&&this._isFreezedBy===t&&(this._isFreezedBy=null,"api"===t&&this.trigger("unfreezed"))},r.prototype.isFreezed=function(){return!!this._isFreezedBy},r.prototype.isFreezedBy=function(t){return this.isFreezed()&&this._isFreezedBy===t},e.PagerState=o,e["default"]=r},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.model=t,this.numerationOffset=t.numerationOffset}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(36),l=n(s),d=i(4),h=n(d);o.prototype.getPageModel=function(t){if(this.hasPageWithId(t)){if(a["default"].isUndefined(this.pageModelsCache)){var e=this;this.pageModelsCache=a["default"].memoize(function(t){return e.model.cast("pages."+t),new l["default"](t,e.model.pages[t],e.model.pages.defaults,e.model.bookSize)})}return this.pageModelsCache(t)}},o.prototype.getPageIdByIndex=function(t){if(!(t>=this.getPagesCount()||t<0)){var e=this.getStructure()[t];return a["default"].isNull(e)?this.getPageIdByIndex(t-1):e}},o.prototype.getStructure=function(){return this.model.pages.structure},o.prototype.getNumerationOffset=function(){return this.model.numerationOffset},o.prototype.getPageIndexById=function(t){var e=a["default"].indexOf(this.getStructure(),t);return a["default"].isUndefined(e)?-1:e},o.prototype.getUrlHeaderById=function(t){var e=this.getPageModel(t);if(!a["default"].isUndefined(e)){var i=e.getUrlHeader();return a["default"].isUndefined(i)?this._calculateCaptionById(t,"-"):i}},o.prototype.getPageCaptionById=function(t){var e=this.getPageModel(t);if(!a["default"].isUndefined(e)){var i=e.getCaption();return a["default"].isUndefined(i)?this._calculateCaptionById(t," - "):i}},o.prototype._calculateCaptionById=function(t,e){var i=this,n=this.getPageModel(t),o=this.getPageIndexById(t),r=n.getProperty("wide");if(!a["default"].isUndefined(this.getNumerationOffset())){var s=function(t){return t<i.getNumerationOffset()?h["default"].romanize(t+1):t-i.getNumerationOffset()+1},l=s(o);return!a["default"].isUndefined(r)&&r&&(this.model.rightToLeft?l=s(o+1)+e+l:l+=e+s(o+1)),""+l}return!a["default"].isUndefined(r)&&r?this.model.rightToLeft?(o+2).toString()+e+(o+1).toString():(o+1).toString()+e+(o+2).toString():(o+1).toString()},o.prototype.getPageIdByUrlHeader=function(t){var e,i,n=t.split("-");return a["default"].isUndefined(this.model.urlNames)||(e=this.model.urlNames[t],a["default"].isUndefined(e)||a["default"].isNull(e))?(i=h["default"].isRoman(n[0])?h["default"].deromanize(n[0]):a["default"].isUndefined(this.getNumerationOffset())?n[0]:Number(n[0])+this.getNumerationOffset(),this.getPageIdByIndex(i-1)):e},o.prototype.getPagesCount=function(){return this.getStructure().length},o.prototype.getPageResourcesCount=function(){return a["default"].without(this.getStructure(),null).length},o.prototype.hasPageWithId=function(t){return a["default"].has(this.model.pages,t)},o.prototype.isFirstPage=function(t){var e=this.getPageIndexById(t);return 0===e},o.prototype.isLastPage=function(t){var e,i=this.getPageIndexById(t),n=this.getPageModel(t);return!a["default"].isUndefined(n)&&(e=i+(n.getProperty("wide")?2:1),e===this.getStructure().length)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){this.id=t,this.model=e,this.defaults=i,this.bookSize=n}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(4),l=n(s),d=i(5),h=n(d);o.prototype.getPropertyModel=function(){return this.model},o.prototype.getThumbnailUrl=function(){var t=this.id,e=l["default"].getNum(t),i=l["default"].extFormat(this.getProperty("thFormat")),n=this.isStub();return n?this._getStubPageUrl():(0,h["default"])().translatePath("assets/common/pages/thumbnails/page"+e+"_s"+i)},o.prototype.getTextLayerUrl=function(t){var e=this.id,i=l["default"].getNum(e),n=this.isStub(),o=this.getProperty("textLayer");if(n)return null;if("undefined"!=typeof t)t=t?"_"+t:"";else{var r=this.getProperty("substrateSizes");t=r?this.getProperty("vectorText")?"_1":"_"+Math.min(r.length,3):"_c"}return o?(0,h["default"])().translatePath("assets/common/pages/text/page"+i+t+".png"):null},o.prototype.getSVGLayerUrl=function(){var t=this.id,e=l["default"].getNum(t),i=this.isStub(),n=this.getProperty("vectorText");return i?null:n?(0,h["default"])().translatePath("assets/common/pages/vector/"+e+".svg"):null},o.prototype.getSubstrateUrl=function(t){var e=this.id,i=l["default"].getNum(e),n=l["default"].extFormat(this.getProperty("substrateFormat")),o=this.isStub();if(o)return this._getStubPageUrl();if("undefined"!=typeof t)t=t?"_"+t:"";else{var r=this.getProperty("substrateSizes");t=r?"_"+Math.min(r.length,3):""}return(0,h["default"])().translatePath("assets/common/pages/substrates/page"+i+t+n)},o.prototype._getStubPageUrl=function(){return(0,h["default"])().translatePath("assets/common/pages/pagestub.png")},o.prototype.getHtmlUrl=function(){var t=this.id,e=l["default"].getNum(t);return(0,h["default"])().translatePath("assets/common/pages/html/page"+e+".html")},o.prototype.getSearchInfoUrl=function(){return(0,h["default"])().translatePath("assets/common/search/search"+l["default"].getNum(this.id)+".xml")},o.prototype.isStub=function(){return Boolean(this.getProperty("stub"))},o.prototype.getProperty=function(t){return a["default"].isUndefined(this.model[t])?this.defaults[t]:this.model[t]},o.prototype.getCaption=function(){if(a["default"].has(this.model,"displayName")&&!a["default"].isNull(this.model.displayName)&&!a["default"].isEmpty(this.model.displayName))return this.model.displayName},o.prototype.getUrlHeader=function(){if(a["default"].has(this.model,"urlHeader")&&!a["default"].isNull(this.model.urlHeader)&&!a["default"].isEmpty(this.model.urlHeader))return this.model.urlHeader},o.prototype.getRect=function(t){var e=this.getProperty("width"),i=this.getProperty("height"),n=this.bookSize.width,o=this.bookSize.height;this.getProperty("wide")&&(n*=2);var r,a,s={};return r=l["default"].fitScreenSizes(n,o,t.width,t.height),a=l["default"].fitScreenSizes(e,i,r.width,r.height),s.pageWidth=r.width,s.pageHeight=r.height,s.ratio=a.width/e,s.contentWidth=a.width,s.contentHeight=a.height,s.pagePadding=[(t.height-s.pageHeight)/2,(t.width-s.pageWidth)/2],s.contentPadding=[(s.pageHeight-s.contentHeight)/2,(s.pageWidth-s.contentWidth)/2],s},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(e,i,n,o,r,s,d,h){var u=(0,$["default"])();this.noteData=new tt["default"](u.getShareUrl()),this.pager=e,this.fullscreen=!1,this.browser=s,this.miniMode=!1,this.toolWindow="none",this._toolWindowObj=null,this.currentPopup="none",this._currentPopupObj=null,this.needFocusToolWindow=!0,this._isFreezed=!1,this.properties=o,this.pagesProps=n,this.skinConfig=h,this.workspaceContainer=i,this.flipbookContainer=a["default"].createElement("div",{"class":"flipbook-container",id:"flipbook-container",role:"region","aria-label":"publication"},this.workspaceContainer),this.bodyContainer=r,this.publContainer=a["default"].id("publ-container"),this.fullscreenContainer=d,this.defaultToolWindowOpened=!1,(0,X["default"])().setRootContainer(r),this.bookModel=new j["default"](this.pagesProps,this.properties,this.pager,this.browser,this.noteData),this.printer=new F["default"](this.pager,this.bodyContainer),this.properties.cast("sound"),this.sound=new E["default"](this.properties.sound,this.pager,this.bodyContainer),this.bookPresenter=new q["default"](this.bookModel).init(this.flipbookContainer),this.slideshow=new Z["default"](o.cast("components.slideshow"),this.pager,this.bookPresenter),this.bottomMenu=new B["default"](this.workspaceContainer,this.pager,this.properties,this.sound,this.slideshow),this._initBottomMenuButtons();var p=this;if(o.onAndChange("change:search",function(t){if(t.enabled){(0,g["default"])().get(g["default"].LIBRARY_MANAGER);(0,g["default"])().has(g["default"].SEARCH_PROVIDER)&&String.prototype.normalize?p._initSearch():(0,
g["default"])().on(g["default"].SEARCH_PROVIDER,function(){p._initSearch()})}},this),this.showNotice(),this.getLocaleProvider().on("change:Other.CUSTOM_POLICY_TEXT",this.showNotice,this),this.getLocaleProvider().on("change:Other.CUSTOM_POLICY_LINK_CAPTION",this.showNotice,this),o.on("change:cookieNotice",function(t){t&&t.enabled===!0?this.showNotice():this.hideNotice(!0)},this),this.topBar=new v["default"](this.workspaceContainer,this.pager,this.properties),this.topBar.on("search:request",function(){p.isFreezed()||(0,g["default"])().has(g["default"].SEARCH_PROVIDER)&&String.prototype.normalize&&p.set("toolWindow","search")}),this.topBar.on("accessibility:tap",function(){p.tapAccessibility()}),this.zoomPanel=new _["default"](this.flipbookContainer,this.bookModel,this.pager),l["default"].has(this.properties,"logoLink")&&(this.logo=new z["default"](this.workspaceContainer,this.properties,this.bottomMenu.getRootElement(),this.topBar.getRootElement(),this.flipbookContainer,this.bodyContainer,this.skinConfig)),this._initContextMenu(),this.on("change:fullscreen",this.toggleFullscreen,this),this.fullscreenchange=function(t){var e=t.target.mozFullScreenElement||t.target.msFullscreenElement||t.target;p.isFullscreen()&&"video"===e.parentNode.className?(p.getBookState().changeFullscreen(!1,!0),p.fullscreenvideo=!0):(p.getBookState().changeFullscreen(!0,!1),p.fullscreenvideo=!1),p.fullscreenCheck.call(p)},t.addEventListener("fullscreenchange",this.fullscreenchange),t.addEventListener("webkitfullscreenchange",this.fullscreenchange),t.addEventListener("mozfullscreenchange",this.fullscreenchange),t.addEventListener("MSFullscreenChange",this.fullscreenchange),this.on("change:toolWindow",this._onToolWindowChanged,this),this.properties.on("change:defaultToolWindow",function(){this.updateDefaultToolWindow()},this),this.on("change:currentPopup",this._onCurrentPopupChanged,this),this._bindProperties(),(0,H["default"])().init(this.bodyContainer),this.onResizeFlipbookContainer=function(){p.fullscreenvideo!==!0&&(p.flipbookContainerResized=!0,p.bookPresenter.resize(p.flipbookContainer.getBoundingClientRect()))},(0,Y.addResizeListener)(this.flipbookContainer,this.onResizeFlipbookContainer),l["default"].defer(function(){p.flipbookContainerResized!==!0&&p.onResizeFlipbookContainer()}),this.pager.on("change:state",this._sendStateApiEvents,this),this.pager.on("goToLastPage",function(t){p.getApiProvider().trigger("goToLastPage",t)}),this.pager.on("goToFirstPage",function(t){p.getApiProvider().trigger("goToFirstPage",t)}),this._sendStateApiEvents(),this.pagesProps.on("change:rightToLeft change:numerationOffset",function(){"thumbnails"===this.toolWindow&&(this.set("toolWindow","none"),this.set("toolWindow","thumbnails")),"search"===this.toolWindow&&(this.set("toolWindow","none"),this.set("toolWindow","search"))},this),this._boundKeyDownHandler=this._keyDownHandler.bind(this),this._throttleKeyDownHandler=l["default"].throttle(this._boundKeyDownHandler,800,{leading:!0}),this._bindKeys(),this.listenTo(this.pager,"change:state",function(t,e){t.zoomMode!==e.zoomMode&&(p._unBindKeys(),p._bindKeys())}),this.updateDefaultToolWindow(),!this.properties.defaultToolWindow||"none"===this.properties.defaultToolWindow||"search"===this.properties.defaultToolWindow){var f=c["default"].parseQuery(),m=c["default"].parseHash();f.search&&f.search.length?(this.searchProvider.set("query",f.search),this.set("toolWindow","search")):m.search&&m.search.length&&(this.searchProvider.set("query",m.search),this.set("toolWindow","search"))}if(this._initMiniMode(),!l["default"].isUndefined(this.properties.downloads)&&!l["default"].isUndefined(this.properties.downloads.size)&&(0,g["default"])().has("analytics")){var y=(0,$["default"])().getLocalStorage().getItem("pdfSizeSent");y||(this.getAnalyticsProvider().trigger("develop",{action:"pdfSizeMB",data:(this.properties.downloads.size/1048576).toFixed(2)}),(0,$["default"])().getLocalStorage().setItem("pdfSizeSent",!0))}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(4),c=n(u),p=i(7),f=(n(p),i(2)),g=n(f),m=i(38),v=n(m),y=i(41),b=n(y),w=i(56),_=n(w),P=i(57),E=n(P),T=i(58),C=n(T),A=i(24),x=n(A),S=i(60),k=n(S),I=i(88),L=n(I),M=i(90),O=n(M),N=i(91),B=n(N),D=i(92),z=n(D),R=i(95),F=n(R),W=i(21),H=n(W),U=i(96),j=n(U),V=i(97),q=n(V),G=i(18),X=n(G),Y=i(101),Q=i(102),Z=n(Q),K=i(5),$=n(K),J=i(25),tt=n(J),et=i(12),it=n(et),nt=i(103),ot=n(nt);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.destructor=function(){(0,Y.removeResizeListener)(this.flipbookContainer,this.onResizeFlipbookContainer),(0,Y.removeResizeListener)(this.bodyContainer,this.onResizeBodyContainer),t.removeEventListener("fullscreenchange",this.fullscreenchange),t.removeEventListener("webkitfullscreenchange",this.fullscreenchange),t.removeEventListener("mozfullscreenchange",this.fullscreenchange),t.removeEventListener("MSFullscreenChange",this.fullscreenchange),t.removeEventListener("keydown",this._boundKeyDownHandler),t.removeEventListener("keydown",this._throttleKeyDownHandler),this.bookPresenter.destructor(),this.logo&&this.logo.destructor(),this.sound.destructor(),this.topBar.destructor(),this.bottomMenu.destructor(),this.clickToRead&&a["default"].del(this.clickToRead)},o.prototype._keyDownHandler=function(t){if((l["default"].isNull(t.target)||l["default"].isUndefined(t.target)||"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&"select"!==t.target.tagName.toLowerCase()&&"option"!==t.target.tagName.toLowerCase())&&"none"===this.currentPopup){var e,i,n=32;switch(this.pagesProps.rightToLeft?(i=39,e=37):(i=37,e=39),t.keyCode){case i:this.pager.goBackward(),t.preventDefault();break;case e:this.pager.goForward(),t.preventDefault();break;case n:this.slideshow.toggle()}}},o.prototype._bindKeys=function(){var e=this;this.properties.downloads.enabled&&(0,ot["default"])("cmd+s,ctrl+s",function(t){t.preventDefault(),e.tapDownload()}),this.properties.components.print&&(0,ot["default"])("cmd+p,ctrl+p",function(t){t.preventDefault(),e.tapPrint()}),this.properties.search.enabled&&(0,ot["default"])("cmd+f,ctrl+f",function(t){t.preventDefault(),e.topBar.trigger("search:request")}),this.properties.components.fullscreen&&(0,ot["default"])("cmd+shift+f,ctrl+shift+f",function(t){t.preventDefault(),e.tapFullscreen()}),this.properties.components.zoom&&((0,ot["default"])("cmd+=,ctrl+=",function(t){t.preventDefault(),e.pager.getState().zoomMode?e.zoomPanel.levelPlus():a["default"].id("zoom-page").click()}),(0,ot["default"])("cmd+-,ctrl+-",function(t){t.preventDefault(),e.pager.getState().zoomMode&&(0===e.zoomPanel.bookModel.zoomScaleValue?a["default"].id("zoom-page").click():e.zoomPanel.levelMinus())})),this.pager.getState().zoomMode?t.addEventListener("keydown",this._throttleKeyDownHandler):t.addEventListener("keydown",this._boundKeyDownHandler)},o.prototype._unBindKeys=function(){ot["default"].unbind("cmd+s,ctrl+s"),ot["default"].unbind("cmd+p,ctrl+p"),ot["default"].unbind("cmd+f,ctrl+f"),ot["default"].unbind("cmd+shift+f,ctrl+shift+f"),ot["default"].unbind("cmd+=,ctrl+="),ot["default"].unbind("cmd+-,ctrl+-"),this.pager.getState().zoomMode?t.removeEventListener("keydown",this._boundKeyDownHandler):t.removeEventListener("keydown",this._throttleKeyDownHandler)},o.prototype.hideNotice=function(t){t||(0,$["default"])().getLocalStorage().setItem("fb_cookieNotice_dismissed","true");var e=a["default"].id("banner-notice");e&&(a["default"].del(e),this._resize())},o.prototype.showNotice=function(){if(this.properties.cookieNotice&&this.properties.cookieNotice.enabled===!0&&"true"!==(0,$["default"])().getLocalStorage().getItem("fb_cookieNotice_dismissed")){var t=this,e=void 0;if(this.properties.cookieNotice.link){var i=this.getLocaleProvider().get("Other.CUSTOM_POLICY_LINK_CAPTION"),n='<a href="'+this.properties.cookieNotice.link+'" target="_blank" title="'+i+'">'+i+"</a>";e=this.getLocaleProvider().get("Other.CUSTOM_POLICY_TEXT",{0:n})}else e=this.getLocaleProvider().get("Other.COOKIE_POLICY_NOTICE");var o=a["default"].id("banner-notice");if(o){var r=a["default"].id("notice-text");r.innerHTML=e}else{o=a["default"].createElement("div",{"class":"banner-notice",id:"banner-notice"},this.bodyContainer);var s=a["default"].createElement("div",{"class":"notice-text",id:"notice-text"},o),l=a["default"].createElement("button",{"class":"icon icon-cancel close-button",tabindex:"1"},o);s.innerHTML=e,l.addEventListener("click",function(){t.properties.cookieNotice.onClose&&"function"==typeof t.properties.cookieNotice.onClose?t.properties.cookieNotice.onClose():t.browser.publisher?t.hideNotice(!0):t.hideNotice()})}this._resize()}},o.prototype.updateDefaultToolWindow=function(){if(!this.miniMode&&this.properties.defaultToolWindow)switch(this.properties.defaultToolWindow){case"toc":var t=this.properties.toc;t.enabled&&t.children&&t.children.length>0&&(this.needFocusToolWindow=!1,this.set("toolWindow","toc"));break;case"notes":this.properties.components.notes&&!(0,$["default"])().getLocalStorage().isStub&&(this.needFocusToolWindow=!1,this.set("toolWindow","notes"));break;case"thumbnails":this.needFocusToolWindow=!1,this.set("toolWindow","thumbnails");break;case"search":this.needFocusToolWindow=!1,this.set("toolWindow","search");break;default:this.set("toolWindow","none")}},o.prototype.contextMenu=function(){return(0,g["default"])().get(g["default"].CONTEXT_MENU)},o.prototype.getApiProvider=function(){return(0,g["default"])().get(g["default"].API)},o.prototype.getLocaleProvider=function(){return(0,g["default"])().get(g["default"].LOCALE)},o.prototype.freeze=function(){this._isFreezed=!0},o.prototype.unfreeze=function(){this._isFreezed=!1},o.prototype.isFreezed=function(){return this._isFreezed},o.prototype.updateMenuClasses=function(t){var e=this.workspaceContainer;a["default"].removeClass(e,"opaqueTop"),a["default"].removeClass(e,"opaqueBottom"),a["default"].removeClass(e,"justifyBottom");var i=t.split(" ");l["default"].each(i,function(t){a["default"].addClass(e,t)}),this.logo&&this.logo.updateMenuClasses(i)},o.prototype._initContextMenu=function(){function t(){this.shareCurrentPage=!0,this.tapSocial(),delete this.shareCurrentPage}var e="TOGGLE_FULLSCREEN_EVENT",i="SHARE_PAGE_EVENT",n="PRINT_PAGE_EVENT";this.contextMenu().on(it["default"].HIDE_EVENT,function(){this.contextMenu().off(e,this.tapFullscreen,this),this.contextMenu().off(i,t,this),this.contextMenu().off(n,this.tapPrint,this)},this),this.contextMenu().on(it["default"].SHOW_EVENT,function(){this.contextMenu().on(e,this.tapFullscreen,this),this.contextMenu().on(i,t,this),this.contextMenu().on(n,this.tapPrint,this)},this)},o.prototype.tapFullscreen=function(){this.isFreezed()||this.set("fullscreen",!this.fullscreen)},o.prototype.tapDownload=function(){this.isFreezed()||this.set("currentPopup","download")},o.prototype.tapAccessibility=function(){this.isFreezed()||this.set("currentPopup","accessibility")},o.prototype.tapSocial=function(){this.isFreezed()||this.set("currentPopup","social")},o.prototype.tapPrint=function(t){this.isFreezed()||(this.printOptions=t,this.set("currentPopup","print"),delete this.printOptions)},o.prototype._initBottomMenuButtons=function(){var t=this;this.bottomMenu.on("tap:fullscreen",function(){t.tapFullscreen()}),this.bottomMenu.on("tap:download",function(){t.tapDownload()}),this.bottomMenu.on("tap:social",function(){t.tapSocial()}),this.bottomMenu.on("tap:print",function(){t.tapPrint()}),this.bottomMenu.on("tap:toc",function(){t.isFreezed()||("toc"===t.toolWindow?t.set("toolWindow","none"):t.set("toolWindow","toc"))}),this.bottomMenu.on("tap:thumbnails",function(){t.isFreezed()||("thumbnails"===t.toolWindow?t.set("toolWindow","none"):t.set("toolWindow","thumbnails"))}),this.bottomMenu.on("tap:notes",function(){t.isFreezed()||("notes"===t.toolWindow?t.set("toolWindow","none"):t.set("toolWindow","notes"))}),this.bottomMenu.on("tap:sound",function(){t.isFreezed()||t.sound.set("muted",!t.sound.muted)}),this.sound.on("change:muted",function(e){t.getApiProvider().trigger("sound",{action:e?"off":"on"}),t.bottomMenu.toggleSound(e)}),this.bookModel.on("change:textSelectionMode",function(e){t.bottomMenu.toogleTextSelectionMode(e)})},o.prototype._sendStateApiEvents=function(t){var e=t||this.pager.state;this.getApiProvider().trigger("bookStateChanged",{leftPageUrl:this.pager.pageTable.getUrlHeaderById(e.leftPage||e.rightPage),rightPageUrl:this.pager.pageTable.getUrlHeaderById(e.rightPage||e.leftPage),isWide:e.leftPage||e.rightPage?this.pager.pageTable.getPageModel(e.leftPage||e.rightPage).getProperty("wide"):void 0,isZoomed:e.zoomMode})},o.prototype._bindProperties=function(){var t=this;this.properties.on("change:components.notes",function(e){e||"notes"!==t.toolWindow||t.set("toolWindow","none")}),this.properties.on("change:components.thumbnails",function(e){e||"thumbnails"!==t.toolWindow||t.set("toolWindow","none")}),this.properties.on("change:search",function(e){l["default"].isEmpty(e)&&"search"===t.toolWindow&&t.set("toolWindow","none")}),this.properties.on("change:downloads",function(e){!l["default"].isUndefined(e)&&!l["default"].isNull(e)&&l["default"].has(e,"enabled")&&e.enabled&&"download"===t.currentPopup?t._currentPopupObj.updateWindow(t.properties.downloads):"download"===t.currentPopup&&t._currentPopupObj.close()}),this.properties.on("change:components.share",function(t){}),this.getLocaleProvider().on("change:SearchToolWindow",function(){t.reloadToolWindow("search")}),this.getLocaleProvider().on("change:TOCToolWindow",function(){t.reloadToolWindow("toc")}),this.getLocaleProvider().on("change:ThumbnailsToolWindow",function(){t.reloadToolWindow("thumbnails")})},o.prototype._onToolWindowChanged=function(t,e){function i(t){n.properties.defaultToolWindow!==t||n.defaultToolWindowOpened?n.getApiProvider().trigger("window",{action:"open",component:t}):n.defaultToolWindowOpened=!0}var n=this;if("search"===e&&"search"!==t&&this.bookModel.setSearchQuery(""),"none"!==e&&(this._toolWindowObj&&(this._toolWindowObj.removeWindow(),this._toolWindowObj=void 0,this.getApiProvider().trigger("window",{action:"close",component:e})),this.topBar.set("searchButtonVisible",!0)),"toc"===t)this.properties.cast("toc"),this._toolWindowObj=new C["default"]({iconName:"toc",title:this.getLocaleProvider().get("TOCToolWindow.TITLE"),data:this.properties.toc,focus:this.needFocusToolWindow},L["default"],this.pager,this.publContainer,{},this.browser),i("toc");else if("thumbnails"===t)this._toolWindowObj=new C["default"]({iconName:"thumbnails",title:this.getLocaleProvider().get("ThumbnailsToolWindow.TITLE"),data:this.bodyContainer,focus:this.needFocusToolWindow},x["default"],this.pager,this.publContainer),i("thumbnails");else if("notes"===t)this._toolWindowObj=new C["default"]({iconName:"note",title:this.getLocaleProvider().get("NotesToolWindow.TITLE"),data:{noteData:this.noteData,bodyContainer:this.bodyContainer,bookModel:this.bookModel},focus:this.needFocusToolWindow},k["default"],this.pager,this.publContainer),i("notes");else{if("search"!==t||!this.properties.search||!this.properties.search.enabled)return void this._resize();this._toolWindowObj=new C["default"]({iconName:"search",title:this.getLocaleProvider().get("SearchToolWindow.TITLE"),data:this.searchProvider,focus:this.needFocusToolWindow},O["default"],this.pager,this.publContainer,{position:"right"}),i("search"),this.topBar.set("searchButtonVisible",!1),this.searchProvider.isQueryValid()&&this.bookModel.setSearchQuery(this.searchProvider.query)}this.needFocusToolWindow=!0,this._resize(),this._toolWindowObj.on("change:page",function(t){var e=l["default"].has(t,"target")?t.target:null;l["default"].isUndefined(t.pageId)?l["default"].isUndefined(t.pageIndex)||this.pager.goToPageByIndex(t.pageIndex,e):this.pager.goToPageById(t.pageId,e)},this),this._toolWindowObj.once("toolWindow:close",function(){this.set("toolWindow","none")},this),this._toolWindowObj.once("toolWindow:reload",this.reloadToolWindow,this)},o.prototype.reloadToolWindow=function(t){if(!t||t&&this.toolWindow===t){var e=this.toolWindow;this.set("toolWindow","none"),this.set("toolWindow",e)}},o.prototype._onCurrentPopupChanged=function(t,e){if("none"!==e&&this.getApiProvider().trigger("window",{action:"close",component:e}),"accessibility"===t)this._currentPopupObj=new b["default"]({iconName:"accessibility",title:this.getLocaleProvider().get("Accessibility.WINDOW_TITLE"),content:"AccessibilityWindow",data:this.properties},this.bodyContainer,this.pager),this.getApiProvider().trigger("window",{action:"open",component:"download"});else if("download"===t)this._currentPopupObj=new b["default"]({iconName:"download",title:this.getLocaleProvider().get("SaveWindow.TITLE"),content:"DownloadWindow",data:this.properties.downloads},this.bodyContainer,this.pager),this.getApiProvider().trigger("window",{action:"open",component:"download"});else if("social"===t)this._currentPopupObj=new b["default"]({iconName:"social",title:this.getLocaleProvider().get("PermanentLinkBar.TITLE"),content:"SocialWindow",data:this.properties},this.bodyContainer,this.pager,this.shareCurrentPage),this.getApiProvider().trigger("window",{action:"open",component:"social"});else{if("print"!==t)return;this._currentPopupObj=new b["default"]({iconName:"print",title:this.getLocaleProvider().get("PrintWindow.TITLE"),content:"PrintWindow",data:this.properties},this.bodyContainer,this.pager,this.printer,this.printOptions,this.browser),this.getApiProvider().trigger("window",{action:"open",component:"print"})}this._currentPopupObj.once("popup:close",function(){this.set("currentPopup","none"),this.set("_currentPopupObj",null)},this)},o.prototype.isFullscreen=function(){return!!(t.document.fullscreenElement||t.document.mozFullScreenElement||t.document.webkitFullscreenElement||t.document.msFullscreenElement)},o.prototype.fullscreenCheck=function(){this.isFullscreen()?this.set("fullscreen",!0):this.set("fullscreen",!1)},o.prototype.toggleFullscreen=function(t){t?(this.launchIntoFullscreen(this.fullscreenContainer),this.getApiProvider().trigger("fullscreen",{action:"on"})):(this.exitFullscreen(),this.getApiProvider().trigger("fullscreen",{action:"off"})),this.getBookState().fullscreen=t,this.bottomMenu.toggleFullscreen(t)},o.prototype.launchIntoFullscreen=function(t){this.isFullscreen()||(t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t.msRequestFullscreen&&t.msRequestFullscreen())},o.prototype.getBookState=function(){return(0,g["default"])().get(g["default"].BOOK_STATE)},o.prototype.exitFullscreen=function(){this.isFullscreen()&&(document.exitFullscreen&&document.fullscreenElement?document.exitFullscreen():document.mozCancelFullScreen&&document.mozFullScreenElement?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitFullscreenElement?document.webkitExitFullscreen():document.msExitFullscreen&&document.msFullscreenElement&&document.msExitFullscreen())},o.prototype._resize=function(){this.logo&&this.logo.resetLogoPosition()},o.prototype.getState=function(){return{toolWindow:this.toolWindow,popup:this.currentPopup,isFullscreen:this.fullscreen,searchQuery:this.searchProvider?this.searchProvider.query:null}},o.prototype._initSearch=function(){var t=this;this.searchProvider=(0,g["default"])().get(g["default"].SEARCH_PROVIDER),this.searchProvider.on("change:query",function(e){t.searchProvider.isQueryValid()?t.bookModel.setSearchQuery(e):t.bookModel.setSearchQuery("")})},o.prototype._initMiniMode=function(){var t=this;this.clickToRead=a["default"].createElement("button",{"class":"clickToRead",tabindex:"1"},this.publContainer),this.getLocaleProvider().onAndChange("change:Other.CLICK_TO_READ",function(){a["default"].setText(t.clickToRead,this.getLocaleProvider().get("Other.CLICK_TO_READ"))},this),t.clickToRead.addEventListener("click",function(){t.set("fullscreen",!0)}),this.onResizeBodyContainer=function(){t.bodyContainerResized=!0;var e=t.bodyContainer.getBoundingClientRect();e.width<=550||e.height<=300?(t.zoomPanel.hidden=!0,t.miniMode=!0,a["default"].addClass(t.bodyContainer,"mini"),t._currentPopupObj&&t._currentPopupObj.close(),t.set("toolWindow","none"),t.zoomPanel.zoomPanel&&(a["default"].del(t.zoomPanel.zoomPanel),t.zoomPanel.zoomPanel=null)):(a["default"].removeClass(t.bodyContainer,"mini"),t.zoomPanel.hidden=!1,t.miniMode=!1,t.pager.getState().zoomMode&&(t.zoomPanel.zoomPanel||(t.zoomPanel.zoomPanel=t.zoomPanel.bindZoomPanel())))},(0,Y.addResizeListener)(this.bodyContainer,this.onResizeBodyContainer,this.browser.firefox===!0),l["default"].defer(function(){t.bodyContainerResized!==!0&&t.onResizeBodyContainer()}),this.bookPresenter.on("onPageChanging onStartDrag",function(){a["default"].addClass(t.clickToRead,"turning")}),this.bookPresenter.on("onPageChanged onEndDrag",function(){a["default"].removeClass(t.clickToRead,"turning")})},o.prototype.onReady=function(){this.bookModel.set("isReady",!0),this.slideshow.set("isReady",!0)},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this._container=a["default"].createElement("div",{id:"top","class":"top-toolbar",role:"menubar"},t,"top"),this._properties=i,this._properties.cast("components.paginator"),this._pager=e,this._render(),this._properties.on("change:components.topBar",this._checkVisibility,this),this._checkVisibility(this._properties.components.topBar),this.title=a["default"].id("publication-title"),this._properties.on("change:title",this._titleChange,this),this._properties.components.paginator.onAndChange("change:enabled",this._paginatorEnableChange,this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(4),c=n(u),p=i(2),f=n(p),g=i(39),m=n(g),v=i(8),y=n(v);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.getLocaleProvider=function(){return(0,f["default"])().get(f["default"].LOCALE)},o.prototype.getRootElement=function(){return this._container},o.prototype._checkVisibility=function(t){a["default"].removeClass(this._container,"hidden"),t||a["default"].addClass(this._container,"hidden")},o.prototype._titleChange=function(t){a["default"].setText(this.title,c["default"].decodeEntities(t)),this._validateDividerVisibility()},o.prototype._paginatorEnableChange=function(t){var e=a["default"].className("pager",this._container);this._validateDividerVisibility(),e.length>0&&(t?a["default"].removeClass(e[0],"hidden-component"):a["default"].addClass(e[0],"hidden-component"))},o.prototype._topMenuLableChange=function(){var t=a["default"].id("page-text");a["default"].setText(t,this.getLocaleProvider().get("TopMenu.PAGES_LABEL"))},o.prototype._searchButtonVisibleCheck=function(){this.searchButtonVisible&&this._properties.search&&this._properties.search.enabled?a["default"].removeClass(this._searchButton,"hidden-component"):a["default"].addClass(this._searchButton,"hidden-component")},o.prototype._accessibilityEnableChange=function(t){var e=a["default"].id("accessibility-button");a["default"].removeClass(e,"hidden-component"),null===t&&a["default"].addClass(e,"hidden-component")},o.prototype._copyrightEnableChange=function(t){var e=a["default"].id("copyright-button");a["default"].removeClass(e,"hidden-component"),t||a["default"].addClass(e,"hidden-component")},o.prototype._copyrightUrlLabelChange=function(t){var e=a["default"].id("copyright-link"),i=this._properties.components.copyright,n=i.url,o=c["default"].decodeEntities(i.label);e.href=n||"#",a["default"].setText(e,o||""),e.title=n?this.getLocaleProvider().get("TopMenu.EXTERNAL_LINK_TIP",{0:n}):o||""},o.prototype._topMenuEltChange=function(){var t=a["default"].id("copyright-link"),e=this._properties.components.copyright;e.url&&(t.title=this.getLocaleProvider().get("TopMenu.EXTERNAL_LINK_TIP",{0:e.url}))},o.prototype._copyrightTargetChange=function(t){var e=a["default"].id("copyright-link");e.target=t||"_blank"},o.prototype._validateDividerVisibility=function(){var t=a["default"].className("divider",this._container),e=t&&t.length>0?t[0]:null;l["default"].isNull(e)||(a["default"].removeClass(e,"hidden-component"),!l["default"].isEmpty(this._properties.title)&&this._properties.components.paginator.enabled||a["default"].addClass(e,"hidden-component"))},o.prototype._render=function(){this._container.innerHTML=y["default"]["workspace-top-bar"]({title:c["default"].decodeEntities(this._properties.title),searchTitle:this.getLocaleProvider().get("TopMenu.SEARCH"),accessibilityTitle:this.getLocaleProvider().get("Accessibility.WINDOW_TITLE")}),this.getLocaleProvider().onAndChange("change:TopMenu.PAGES_LABEL",this._topMenuLableChange,this),this.paginator=new m["default"](this._pager,this._properties.components.paginator),this._renderAccessibilityButton(),this._renderSearchButton(),this._renderCopyrightButton()},o.prototype._renderAccessibilityButton=function(){this._properties.onAndChange("change:accessibilityPDF",this._accessibilityEnableChange,this);var t=this;a["default"].id("accessibility-button").addEventListener("click",function(){t.trigger("accessibility:tap")})},o.prototype._renderSearchButton=function(){var t=this;this._searchButton=a["default"].id("search-button"),this._searchButton.addEventListener("click",function(){t.trigger("search:request")}),this.searchButtonVisible=!0,this.on("change:searchButtonVisible",this._searchButtonVisibleCheck,this),this._properties.on("change:search",this._searchButtonVisibleCheck,this),this._searchButtonVisibleCheck()},o.prototype._renderCopyrightButton=function(){var t=void 0;this._properties.cast("components.copyright"),t=this._properties.components.copyright,t.onAndChange("change:enabled",this._copyrightEnableChange,this),t.onAndChange("change:url change:label",this._copyrightUrlLabelChange,this),this.getLocaleProvider().onAndChange("change:TopMenu.EXTERNAL_LINK_TIP",this._topMenuEltChange,this),t.onAndChange("change:target",this._copyrightTargetChange,this)},o.prototype.destructor=function(){var t=this._properties.components.copyright,e=this.getLocaleProvider();this._properties.off("change:components.topBar",this._checkVisibility,this),this._properties.off("change:title",this._titleChange,this),this._properties.components.paginator.off("change:enabled",this._paginatorEnableChange,this),e.off("change:TopMenu.PAGES_LABEL",this._topMenuLableChange,this),this.off("change:searchButtonVisible",this._searchButtonVisibleCheck,this),this._properties.off("change:search",this._searchButtonVisibleCheck,this),t.off("change:enabled",this._copyrightEnableChange,this),t.off("change:url change:label",this._copyrightUrlLabelChange,this),e.off("change:TopMenu.EXTERNAL_LINK_TIP",this._topMenuEltChange,this),t.off("change:target",this._copyrightTargetChange,this),this.paginator.destructor(),this._container&&a["default"].del(this._container)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var i=this;this.pager=t,this.properties=e,this.paginatorInput=a["default"].id("pager-val"),this.totalPages=a["default"].id("pages-count"),this.divider=a["default"].id("pages-divider"),this.properties.onAndChange("change:totalPagesVisible",this.totalPagesVisibleChange,this),this.leftPage=void 0,this.rightPage=void 0,this.paginatorInputClick=function(t){t.target.select()},this.paginatorInputKeypress=function(t){if(13===t.keyCode){var e=t.target.value;if(!l["default"].isEmpty(e)){var n=c["default"].findPageIndexByUserInput(e,i.pager);l["default"].isUndefined(n)||i.pager.goToPageByIndex(n)}t.target.blur()}},this.paginatorInputBlur=function(t){i._updateInput(i.pager.getState())},this.paginatorInput.addEventListener("click",this.paginatorInputClick),this.paginatorInput.addEventListener("keypress",this.paginatorInputKeypress),this.paginatorInput.addEventListener("blur",this.paginatorInputBlur),this.pager.on("change:totalPages",this.updateTotalPages,this),this.pager.on("change:rtl",this.pageTurned,this),(0,f["default"])().get(f["default"].API).on("turned",this.pageTurned,this),(0,f["default"])().get(f["default"].API).on("zoomed",this.pageTurned,this),(0,f["default"])().get(f["default"].API).on("unzoomed",this.pageTurned,this),this.pager._model.on("change:numerationOffset",this.numerationOffsetChange,this),this.target="paginator",this.updateCurrentPages(this.pager.getState());var n=this.pager.totalPages;this.pager.pageTable&&this.pager.pageTable.numerationOffset&&!this.pager.isTotalCustom&&(n-=this.pager.pageTable.numerationOffset),this.updateTotalPages(n)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(40),c=n(u),p=i(2),f=n(p);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.paginatorInputClick=function(){},o.prototype.paginatorInputKeypress=function(){},o.prototype.paginatorInputBlur=function(){},o.prototype.totalPagesVisibleChange=function(t){t?(a["default"].removeClass(this.totalPages,"hidden-component"),a["default"].removeClass(this.divider,"hidden-component")):(a["default"].addClass(this.totalPages,"hidden-component"),a["default"].addClass(this.divider,"hidden-component"))},o.prototype.numerationOffsetChange=function(){var t=this.pager.isTotalCustom?this.pager.totalPages:this.pager.totalPages-this.pager.pageTable.getNumerationOffset();this.updateCurrentPages(this.pager.getState()),this.updateTotalPages(t)},o.prototype.pageTurned=function(){this.updateCurrentPages(this.pager.getState())},o.prototype.updateCurrentPages=function(t,e,i,n){e||n!==this.target&&(this._updateInput(t),this._updateListenToPageChanges(t))},o.prototype._updateListenToPageChanges=function(t){this.leftPage&&this.stopListening(this.pager.pageTable.getPageModel(this.leftPage).getPropertyModel(),"change:displayName",this._pageCaptionChanged),this.rightPage&&this.rightPage!==this.leftPage&&this.stopListening(this.pager.pageTable.getPageModel(this.rightPage).getPropertyModel(),"change:displayName",this._pageCaptionChanged),t.leftPage?(this.leftPage=t.leftPage,this.listenTo(this.pager.pageTable.getPageModel(this.leftPage).getPropertyModel(),"change:displayName",this._pageCaptionChanged)):this.leftPage=void 0,t.rightPage&&t.rightPage!==t.leftPage?(this.rightPage=t.rightPage,this.listenTo(this.pager.pageTable.getPageModel(this.rightPage).getPropertyModel(),"change:displayName",this._pageCaptionChanged)):this.rightPage=void 0},o.prototype._pageCaptionChanged=function(){this.updateCurrentPages(this.pager.getState())},o.prototype.updateTotalPages=function(t){a["default"].setText(this.totalPages,t)},o.prototype._updateInput=function(t){var e=this.pager.getStateForDisplay(t),i=5;this.paginatorInput.value=l["default"].isUndefined(e)?"":e,!l["default"].isUndefined(this.paginatorInput.value)&&!l["default"].isNull(this.paginatorInput.value)&&this.paginatorInput.value.length>5&&(i=this.paginatorInput.value.length),this.paginatorInput.size=i},o.prototype.destructor=function(){this.paginatorInput.removeEventListener("click",this.paginatorInputClick),this.paginatorInput.removeEventListener("keypress",this.paginatorInputKeypress),this.paginatorInput.removeEventListener("blur",this.paginatorInputBlur),this.properties.off("change:totalPagesVisible",this.totalPagesVisibleChange,this),this.pager.off("change:totalPages",this.updateTotalPages,this),this.pager.off("change:rtl",this.pageTurned,this),(0,f["default"])().get(f["default"].API).off("turned",this.pageTurned,this),(0,f["default"])().get(f["default"].API).off("zoomed",this.pageTurned,this),(0,f["default"])().get(f["default"].API).off("unzoomed",this.pageTurned,this),this.pager._model.off("change:numerationOffset",this.numerationOffsetChange,this)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(0),r=n(o),a=i(4),s=n(a),l={};l.findPageIndexByUserInput=function(t,e){var i=r["default"].findWhere(e.pageTable.model.pages,{
displayName:t});if(r["default"].isUndefined(i)){var n=e.pageTable.getNumerationOffset();if(n>0){var o=s["default"].deromanize(t);if(!r["default"].isUndefined(o)&&o<=n)return o-1}var a=parseInt(t,10);if(!r["default"].isNaN(a)&&a>0&&a+n<=e.pageTable.getPagesCount())return a+n-1}else{var l=r["default"].findKey(e.pageTable.model.pages,i);if(!r["default"].isUndefined(l))return e.pageTable.getPageIndexById(l)}},e["default"]=l},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var i=Array.prototype.slice.call(arguments,2);i.push(this),this.container=e||a["default"].tag("body"),this.renderWindow(t.iconName,t.title);var n=function(t){switch(t){case"SocialWindow":return m["default"];case"PrintWindow":return y["default"];case"DownloadWindow":return w["default"];case"AccessibilityWindow":return P["default"];default:throw new Error}}(t.content);this.childView=new(Function.prototype.bind.apply(n,l["default"].union([null,this.mainWindow,t.data,this.windowTitle],i))),l["default"].functions(this.childView).indexOf("on")!==-1&&this.childView.on("close",function(){this.close()},this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(7),c=n(u),p=i(2),f=n(p),g=i(42),m=n(g),v=i(54),y=n(v),b=i(22),w=n(b),_=i(55),P=n(_);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.renderWindow=function(t,e){this.blackOut=a["default"].createElement("div",{"class":"black-out",tabindex:"-1"},this.container),this.mainWindow=a["default"].createElement("div",{"class":"popup-window",role:"dialog","aria-labelledby":"dialog-title"});var i=a["default"].createElement("div",{"class":"popup-title-frame"},this.mainWindow);this.windowTitle=a["default"].createElement("h3",{"class":"popup-title icon icon-"+t,id:"dialog-title"},i),a["default"].setText(this.windowTitle,e),this.closeButton=a["default"].createElement("button",{"class":"icon icon-close",tabindex:"0","aria-label":(0,f["default"])().get(f["default"].LOCALE).get("Accessibility.CLOSE_DIALOG"),title:(0,f["default"])().get(f["default"].LOCALE).get("Accessibility.CLOSE_DIALOG")},i),this.container.appendChild(this.mainWindow);var n=this;l["default"].defer(function(){a["default"].addClass(n.container,"popup-opened")}),this.bindDOM()},o.prototype.updateWindow=function(t){l["default"].functions(this.childView).indexOf("update")!==-1&&this.childView.update(t)},o.prototype.bindDOM=function(){var e=new c["default"](this.blackOut,{}),i=this,n=function(t){27===t.keyCode&&i.close()},o=function(){i.close()};e.on("tap",o),this.closeButton.addEventListener("click",o),t.addEventListener("keydown",n),this.on("popup:close",function(){t.removeEventListener("keydown",n)})},o.prototype.close=function(){l["default"].functions(this.childView).indexOf("onClose")!==-1&&this.childView.onClose(),a["default"].del(this.mainWindow),this.mainWindow=null,a["default"].removeClass(this.container,"popup-opened");var t=this;!function e(){var i=getComputedStyle(t.blackOut);"hidden"===i.visibility?a["default"].del(t.blackOut):setTimeout(e,100)}(),this.trigger("popup:close")},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){this.rootElement=t,this.properties=e,this.pager=n,this.windowTitle=i,this.currentUrl=(0,c["default"])().getShareUrl(),this.embedTemplate=T["default"].template,this._render(o),this._enableClipboard(),this.getLocaleProvider().on("change:PermanentLinkBar",this._onLocaleChange,this);var r=this;setTimeout(function(){document.getElementById("copy-button").focus()},500),this.activeElements=Array.prototype.slice.call(this.rootElement.querySelectorAll("[tabindex]")),this.rootElement.addEventListener("keydown",function(t){if(9===t.keyCode){t.preventDefault();var e=r.activeElements.indexOf(document.activeElement);e===r.activeElements.length-1?r.activeElements[0].focus():r.activeElements[e+1].focus()}})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(2),h=n(d),u=i(5),c=n(u),p=i(4),f=n(p),g=i(21),m=n(g),v=i(8),y=n(v),b=i(43),w=n(b),_=i(44),P=n(_),E=i(52),T=n(E),C=i(53),A=n(C);o.prototype._render=function(t){var e=this;this.content||(this.content=a["default"].createElement("div",{"class":"popup-content"},this.rootElement)),f["default"].renderTemplate(this.content,y["default"]["workspace-social-window"],{embedVisibility:this.properties.components.embed,localization:{shareTab:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TAB"),embedTab:this.getLocaleProvider().get("PermanentLinkBar.INSERT_TO_SITE_TAB"),shareCurrent:this.getLocaleProvider().get("PermanentLinkBar.SHARE_CURRENT_PAGE"),embedCurrent:this.getLocaleProvider().get("PermanentLinkBar.INSERT_CURRENT_PAGE"),width:this.getLocaleProvider().get("PermanentLinkBar.WIDTH"),height:this.getLocaleProvider().get("PermanentLinkBar.HEIGHT"),fullPublication:this.getLocaleProvider().get("PermanentLinkBar.FULL_PUBLICATION"),linkablePage:this.getLocaleProvider().get("PermanentLinkBar.LINKABLE_PAGE"),embedType:this.getLocaleProvider().get("PermanentLinkBar.EMBEDDING_TYPE"),copyButton:this.getLocaleProvider().get("PermanentLinkBar.COPY_BUTTON"),shareText:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TEXT"),facebookTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_FACEBOOK"),twitterTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_TWITTER"),linkedinTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_LINKEDIN"),tumblrTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_TUMBLR"),googleTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_GOOGLE_PLUS"),mailTitle:this.getLocaleProvider().get("PermanentLinkBar.SEND_BY_EMAIL"),vkTitle:this.getLocaleProvider().get("PermanentLinkBar.SHARE_TO_VK")}}),this.qr=a["default"].id("qr"),this.copyButton=a["default"].id("copy-button"),this.urlContainer=a["default"].id("share-url-container"),this.facebookBtn=a["default"].id("facebook-link"),this.twitterBtn=a["default"].id("twitter-link"),this.linkedInBtn=a["default"].id("linkedin-link"),this.tubmlrBtn=a["default"].id("tumblr-link"),this.googleBtn=a["default"].id("google-link"),this.mailBtn=a["default"].id("mail-link"),this.vkBtn=a["default"].id("vk-link");var i=a["default"].id("current-page-checkbox");void 0!==t&&(a["default"].id("current-page-embed").checked=a["default"].id("current-page-checkbox").checked=t),"undefined"!=typeof i.addEventListener&&i.addEventListener("change",function(){a["default"].id("current-page-embed").checked=i.checked,e.currentUrl=(0,c["default"])().getShareUrl(i.checked),e.currentPage=i.checked,e._updateUrl()}),this._bindTabs(),this._updateUrl(),this._bindApiEvents(),this._initEmbedTab()},o.prototype._onLocaleChange=function(){a["default"].setText(this.windowTitle,this.getLocaleProvider().get("PermanentLinkBar.TITLE")),this.update()},o.prototype.getApiProvider=function(){return(0,h["default"])().get(h["default"].API)},o.prototype.getLocaleProvider=function(){return(0,h["default"])().get(h["default"].LOCALE)},o.prototype.update=function(t){t&&(this.properties=t),a["default"].del(this.content),delete this.content,this._render()},o.prototype._bindTabs=function(){var t=this;this.embedButtonTab=a["default"].id("embed-button-tab"),this.shareButtonTab=a["default"].id("share-button-tab"),this.embedButtonTab.addEventListener("click",function(){t.shareButtonTab.className="",t.embedButtonTab.className="active",a["default"].removeClass(a["default"].id("share-tab"),"active"),a["default"].addClass(a["default"].id("embed-tab"),"active")}),this.shareButtonTab.addEventListener("click",function(){t.shareButtonTab.className="active",t.embedButtonTab.className="",a["default"].addClass(a["default"].id("share-tab"),"active"),a["default"].removeClass(a["default"].id("embed-tab"),"active")})},o.prototype._bindApiEvents=function(){var t=this;this.facebookBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"facebook",url:t.currentUrl})}),this.twitterBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"twitter",url:t.currentUrl})}),this.linkedInBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"linkedin",url:t.currentUrl})}),this.tubmlrBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"tumblr",url:t.currentUrl})}),this.googleBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"google+",url:t.currentUrl})}),this.mailBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"email",url:t.currentUrl})}),this.vkBtn.addEventListener("click",function(){t.getApiProvider().trigger("share",{service:"vk",url:t.currentUrl})})},o.prototype._updateUrl=function(){var t=this.properties.title;this.urlContainer.value=this.currentUrl;var e=function(t,e){var i=[];for(var n in e)if(l["default"].has(e,n)){var o=encodeURIComponent(n),r=encodeURIComponent(e[n]);i.push(o+"="+r)}return t+"?"+i.join("&")};this.facebookBtn.href=e("http://www.facebook.com/sharer.php",{u:this.currentUrl}),this.twitterBtn.href=e("http://twitter.com/share",{text:t,url:this.currentUrl}),this.linkedInBtn.href=e("http://www.linkedin.com/shareArticle",{mini:!0,url:this.currentUrl,title:t,summary:t}),this.tubmlrBtn.href=e("http://www.tumblr.com/share/link",{url:this.currentUrl,name:t}),this.googleBtn.href=e("https://plus.google.com/share",{text:t,url:this.currentUrl}),this.mailBtn.href=e("mailto:",{subject:t,body:this.currentUrl}),this.vkBtn.href=e("http://vk.com/share.php",{url:this.currentUrl,title:t}),this._renderQR();var i=this._getPageLinkParams();this.animatedUrl=(0,c["default"])().translatePath(e("assets/common/embed/page.html",i))},o.prototype._getPageLinkParams=function(){function t(t){var e=i.pager.pageTable.getPageModel(t);if(e.isStub())return"s";switch(e.getProperty("thFormat")){case"jpg":return"j";default:return"p"}}var e={link:this.currentUrl},i=this;if(this.currentPage===!0){var n=this.pager.getState();e.f="",void 0!==n.rightPage&&(e.f+=t(n.rightPage),e.p=this.pager.pageTable.getPageIndexById(n.rightPage)+1),void 0!==n.leftPage&&(e.f+=t(n.leftPage),e.p=this.pager.pageTable.getPageIndexById(n.leftPage)+1)}else e.f=t(this.pager.pageTable.getPageIdByIndex(0));return e},o.prototype._renderQR=function(){a["default"].clear(this.qr),new w["default"](this.qr,{text:(0,c["default"])().getShareUrl(a["default"].id("current-page-embed").checked,"qr"),width:96,height:96})},o.prototype._enableClipboard=function(){var t=this,e=new P["default"](this.copyButton),i=new P["default"](a["default"].id("embed-copy-button")),n=a["default"].id("share-url-container");e.on("success",function(t){t.clearSelection()}),document.addEventListener("copy",function(e){e.target===n&&t.getApiProvider().trigger("share",{service:"clipboard",url:t.currentUrl})}),e.on("error",function(){(0,m["default"])().showTooltip(t.urlContainer,{hideTime:2e3,text:this.getLocaleProvider().get("PermanentLinkBar.COPY_TOOLTIP"),position:"bottom"})}),i.on("success",function(t){t.clearSelection()}),i.on("error",function(){(0,m["default"])().showTooltip(t.urlContainer,{hideTime:2e3,text:this.getLocaleProvider().get("PermanentLinkBar.COPY_TOOLTIP"),position:"bottom"})})},o.prototype._initEmbedTab=function(){var t=this;this.embedTextarea=a["default"].id("embed-text"),this.embedTypeSelect=a["default"].id("embed-type-select"),this.embedWidth=a["default"].id("embed-width"),this.embedHeight=a["default"].id("embed-height"),this.currentPageEmbed=a["default"].id("current-page-embed");var e=function(){t.currentUrl=(0,c["default"])().getShareUrl(t.currentPageEmbed.checked),t.currentPage=t.currentPageEmbed.checked,a["default"].id("current-page-checkbox").checked=t.currentPageEmbed.checked,t._updateUrl(),1*t.embedTypeSelect.value===1?(a["default"].id("embed-size-frame").style.display="inline-block",t.embedTextarea.value=t._getPublicationEmbed(t.embedWidth.value,t.embedHeight.value,!0)):(a["default"].id("embed-size-frame").style.display="none",t.embedTextarea.value=t._getPublicationEmbed("240","210",!0))};this.embedTypeSelect.addEventListener("change",e),this.currentPageEmbed.addEventListener("change",e),this.embedWidth.addEventListener("keyup",e),this.embedHeight.addEventListener("keyup",e),this.properties.on("change:title",e,this),e()},o.prototype._getPublicationEmbed=function(t,e,i){var n=(0,c["default"])().getEmbedPrefix(),o=void 0;o="fbp"===n?(0,c["default"])().getShareUrl(this.currentPageEmbed.checked,null,!0):this.currentUrl;var r={url:o,title:this.properties.title,script:(0,c["default"])().translatePath("static/html/embed.js",!0),prefix:n,lightbox:i?"yes":"no",width:t.indexOf("%")!==-1||t.indexOf("px")!==-1?t:t+"px",height:e.indexOf("%")!==-1||e.indexOf("px")!==-1?e:e+"px",method:"site"};return this.properties.publicationInfo&&(r.version=this.properties.publicationInfo.publicationVer),A["default"].render(this.embedTemplate,r)},o.prototype.onClose=function(){this.getLocaleProvider().off("change:PermanentLinkBar",this._onLocaleChange,this)},e["default"]=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n;!function(){function t(t){this.mode=h.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,i=this.data.length;e<i;e++){var n=[],o=this.data.charCodeAt(e);o>65536?(n[0]=240|(1835008&o)>>>18,n[1]=128|(258048&o)>>>12,n[2]=128|(4032&o)>>>6,n[3]=128|63&o):o>2048?(n[0]=224|(61440&o)>>>12,n[1]=128|(4032&o)>>>6,n[2]=128|63&o):o>128?(n[0]=192|(1984&o)>>>6,n[1]=128|63&o):n[0]=o,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function i(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}function o(t,e){this.totalCount=t,this.dataCount=e}function r(){this.buffer=[],this.length=0}function a(){return"undefined"!=typeof CanvasRenderingContext2D}function s(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var i=e.toString().match(/android ([0-9]\.[0-9])/i);i&&i[1]&&(t=parseFloat(i[1]))}return t}function l(t,e){for(var i=1,n=d(t),o=0,r=m.length;o<=r;o++){var a=0;switch(e){case u.L:a=m[o][0];break;case u.M:a=m[o][1];break;case u.Q:a=m[o][2];break;case u.H:a=m[o][3]}if(n<=a)break;i++}if(i>m.length)throw new Error("Too long data");return i}function d(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}t.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,i=this.parsedData.length;e<i;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var i=new t(e);this.dataList.push(i),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[n][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},setupPositionProbePattern:function(t,e){for(var i=-1;i<=7;i++)if(!(t+i<=-1||this.moduleCount<=t+i))for(var n=-1;n<=7;n++)e+n<=-1||this.moduleCount<=e+n||(0<=i&&i<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==i||6==i)||2<=i&&i<=4&&2<=n&&n<=4?this.modules[t+i][e+n]=!0:this.modules[t+i][e+n]=!1)},getBestMaskPattern:function(){for(var t=0,e=0,i=0;i<8;i++){this.makeImpl(!0,i);var n=p.getLostPoint(this);(0==i||t>n)&&(t=n,e=i)}return e},createMovieClip:function(t,e,i){var n=t.createEmptyMovieClip(e,i),o=1;this.make();for(var r=0;r<this.modules.length;r++)for(var a=r*o,s=0;s<this.modules[r].length;s++){var l=s*o,d=this.modules[r][s];d&&(n.beginFill(0,100),n.moveTo(l,a),n.lineTo(l+o,a),n.lineTo(l+o,a+o),n.lineTo(l,a+o),n.endFill())}return n},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=p.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var i=0;i<t.length;i++){var n=t[e],o=t[i];if(null==this.modules[n][o])for(var r=-2;r<=2;r++)for(var a=-2;a<=2;a++)r==-2||2==r||a==-2||2==a||0==r&&0==a?this.modules[n+r][o+a]=!0:this.modules[n+r][o+a]=!1}},setupTypeNumber:function(t){for(var e=p.getBCHTypeNumber(this.typeNumber),i=0;i<18;i++){var n=!t&&1==(e>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=n}for(var i=0;i<18;i++){var n=!t&&1==(e>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=n}},setupTypeInfo:function(t,e){for(var i=this.errorCorrectLevel<<3|e,n=p.getBCHTypeInfo(i),o=0;o<15;o++){var r=!t&&1==(n>>o&1);o<6?this.modules[o][8]=r:o<8?this.modules[o+1][8]=r:this.modules[this.moduleCount-15+o][8]=r}for(var o=0;o<15;o++){var r=!t&&1==(n>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=r:o<9?this.modules[8][15-o-1+1]=r:this.modules[8][15-o-1]=r}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var i=-1,n=this.moduleCount-1,o=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;s<2;s++)if(null==this.modules[n][a-s]){var l=!1;r<t.length&&(l=1==(t[r]>>>o&1));var d=p.getMask(e,n,a-s);d&&(l=!l),this.modules[n][a-s]=l,o--,o==-1&&(r++,o=7)}if(n+=i,n<0||this.moduleCount<=n){n-=i,i=-i;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,i,n){for(var a=o.getRSBlocks(t,i),s=new r,l=0;l<n.length;l++){var d=n[l];s.put(d.mode,4),s.put(d.getLength(),p.getLengthInBits(d.mode,t)),d.write(s)}for(var h=0,l=0;l<a.length;l++)h+=a[l].dataCount;if(s.getLengthInBits()>8*h)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*h+")");for(s.getLengthInBits()+4<=8*h&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*h)break;if(s.put(e.PAD0,8),s.getLengthInBits()>=8*h)break;s.put(e.PAD1,8)}return e.createBytes(s,a)},e.createBytes=function(t,e){for(var n=0,o=0,r=0,a=new Array(e.length),s=new Array(e.length),l=0;l<e.length;l++){var d=e[l].dataCount,h=e[l].totalCount-d;o=Math.max(o,d),r=Math.max(r,h),a[l]=new Array(d);for(var u=0;u<a[l].length;u++)a[l][u]=255&t.buffer[u+n];n+=d;var c=p.getErrorCorrectPolynomial(h),f=new i(a[l],c.getLength()-1),g=f.mod(c);s[l]=new Array(c.getLength()-1);for(var u=0;u<s[l].length;u++){var m=u+g.getLength()-s[l].length;s[l][u]=m>=0?g.get(m):0}}for(var v=0,u=0;u<e.length;u++)v+=e[u].totalCount;for(var y=new Array(v),b=0,u=0;u<o;u++)for(var l=0;l<e.length;l++)u<a[l].length&&(y[b++]=a[l][u]);for(var u=0;u<r;u++)for(var l=0;l<e.length;l++)u<s[l].length&&(y[b++]=s[l][u]);return y};for(var h={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},u={L:1,M:0,Q:3,H:2},c={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},p={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;p.getBCHDigit(e)-p.getBCHDigit(p.G15)>=0;)e^=p.G15<<p.getBCHDigit(e)-p.getBCHDigit(p.G15);return(t<<10|e)^p.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;p.getBCHDigit(e)-p.getBCHDigit(p.G18)>=0;)e^=p.G18<<p.getBCHDigit(e)-p.getBCHDigit(p.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return p.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,i){switch(t){case c.PATTERN000:return(e+i)%2==0;case c.PATTERN001:return e%2==0;case c.PATTERN010:return i%3==0;case c.PATTERN011:return(e+i)%3==0;case c.PATTERN100:return(Math.floor(e/2)+Math.floor(i/3))%2==0;case c.PATTERN101:return e*i%2+e*i%3==0;case c.PATTERN110:return(e*i%2+e*i%3)%2==0;case c.PATTERN111:return(e*i%3+(e+i)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new i([1],0),n=0;n<t;n++)e=e.multiply(new i([1,f.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case h.MODE_NUMBER:return 10;case h.MODE_ALPHA_NUM:return 9;case h.MODE_8BIT_BYTE:return 8;case h.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case h.MODE_NUMBER:return 12;case h.MODE_ALPHA_NUM:return 11;case h.MODE_8BIT_BYTE:return 16;case h.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case h.MODE_NUMBER:return 14;case h.MODE_ALPHA_NUM:return 13;case h.MODE_8BIT_BYTE:return 16;case h.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),i=0,n=0;n<e;n++)for(var o=0;o<e;o++){for(var r=0,a=t.isDark(n,o),s=-1;s<=1;s++)if(!(n+s<0||e<=n+s))for(var l=-1;l<=1;l++)o+l<0||e<=o+l||0==s&&0==l||a==t.isDark(n+s,o+l)&&r++;r>5&&(i+=3+r-5)}for(var n=0;n<e-1;n++)for(var o=0;o<e-1;o++){var d=0;t.isDark(n,o)&&d++,t.isDark(n+1,o)&&d++,t.isDark(n,o+1)&&d++,t.isDark(n+1,o+1)&&d++,0!=d&&4!=d||(i+=3)}for(var n=0;n<e;n++)for(var o=0;o<e-6;o++)t.isDark(n,o)&&!t.isDark(n,o+1)&&t.isDark(n,o+2)&&t.isDark(n,o+3)&&t.isDark(n,o+4)&&!t.isDark(n,o+5)&&t.isDark(n,o+6)&&(i+=40);for(var o=0;o<e;o++)for(var n=0;n<e-6;n++)t.isDark(n,o)&&!t.isDark(n+1,o)&&t.isDark(n+2,o)&&t.isDark(n+3,o)&&t.isDark(n+4,o)&&!t.isDark(n+5,o)&&t.isDark(n+6,o)&&(i+=40);for(var h=0,o=0;o<e;o++)for(var n=0;n<e;n++)t.isDark(n,o)&&h++;var u=Math.abs(100*h/e/e-50)/5;return i+=10*u}},f={glog:function(t){if(t<1)throw new Error("glog("+t+")");return f.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return f.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},g=0;g<8;g++)f.EXP_TABLE[g]=1<<g;for(var g=8;g<256;g++)f.EXP_TABLE[g]=f.EXP_TABLE[g-4]^f.EXP_TABLE[g-5]^f.EXP_TABLE[g-6]^f.EXP_TABLE[g-8];for(var g=0;g<255;g++)f.LOG_TABLE[f.EXP_TABLE[g]]=g;i.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var o=0;o<t.getLength();o++)e[n+o]^=f.gexp(f.glog(this.get(n))+f.glog(t.get(o)));return new i(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=f.glog(this.get(0))-f.glog(t.get(0)),n=new Array(this.getLength()),o=0;o<this.getLength();o++)n[o]=this.get(o);for(var o=0;o<t.getLength();o++)n[o]^=f.gexp(f.glog(t.get(o))+e);return new i(n,0).mod(t)}},o.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o.getRSBlocks=function(t,e){var i=o.getRsBlockTable(t,e);if(void 0==i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var n=i.length/3,r=[],a=0;a<n;a++)for(var s=i[3*a+0],l=i[3*a+1],d=i[3*a+2],h=0;h<s;h++)r.push(new o(l,d));return r},o.getRsBlockTable=function(t,e){switch(e){case u.L:return o.RS_BLOCK_TABLE[4*(t-1)+0];case u.M:return o.RS_BLOCK_TABLE[4*(t-1)+1];case u.Q:return o.RS_BLOCK_TABLE[4*(t-1)+2];case u.H:return o.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},r.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var m=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],v=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){function e(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg",t);for(var n in e)e.hasOwnProperty(n)&&i.setAttribute(n,e[n]);return i}var i=this._htOption,n=this._el,o=t.getModuleCount();Math.floor(i.width/o),Math.floor(i.height/o);this.clear();var r=e("svg",{viewBox:"0 0 "+String(o)+" "+String(o),width:"100%",height:"100%",fill:i.colorLight});r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(r),r.appendChild(e("rect",{fill:i.colorLight,width:"100%",height:"100%"})),r.appendChild(e("rect",{fill:i.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<o;a++)for(var s=0;s<o;s++)if(t.isDark(a,s)){var l=e("use",{x:String(s),y:String(a)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),r.appendChild(l)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),y="svg"===document.documentElement.tagName.toLowerCase(),b=y?v:a()?function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function e(t,e){var i=this;if(i._fFail=e,i._fSuccess=t,null===i._bSupportDataURI){var n=document.createElement("img"),o=function(){i._bSupportDataURI=!1,i._fFail&&i._fFail.call(i)},r=function(){i._bSupportDataURI=!0,i._fSuccess&&i._fSuccess.call(i)};return n.onabort=o,n.onerror=o,n.onload=r,void(n.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}i._bSupportDataURI===!0&&i._fSuccess?i._fSuccess.call(i):i._bSupportDataURI===!1&&i._fFail&&i._fFail.call(i)}var i=function(t,e){this._bIsPainted=!1,this._android=s(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(t){var e=this._elImage,i=this._oContext,n=this._htOption,o=t.getModuleCount(),r=n.width/o,a=n.height/o,s=Math.round(r),l=Math.round(a);e.style.display="none",this.clear();for(var d=0;d<o;d++)for(var h=0;h<o;h++){var u=t.isDark(d,h),c=h*r,p=d*a;i.strokeStyle=u?n.colorDark:n.colorLight,i.lineWidth=1,i.fillStyle=u?n.colorDark:n.colorLight,i.fillRect(c,p,r,a),i.strokeRect(Math.floor(c)+.5,Math.floor(p)+.5,s,l),i.strokeRect(Math.ceil(c)-.5,Math.ceil(p)-.5,s,l)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&e.call(this,t)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},i}():function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,i=this._el,n=t.getModuleCount(),o=Math.floor(e.width/n),r=Math.floor(e.height/n),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<n;s++){a.push("<tr>");for(var l=0;l<n;l++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+o+"px;height:"+r+"px;background-color:"+(t.isDark(s,l)?e.colorDark:e.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),i.innerHTML=a.join("");var d=i.childNodes[0],h=(e.width-d.offsetWidth)/2,u=(e.height-d.offsetHeight)/2;h>0&&u>0&&(d.style.margin=u+"px "+h+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}();n=function(t,e){if(this._htOption={
width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:u.H},"string"==typeof e&&(e={text:e}),e)for(var i in e)this._htOption[i]=e[i];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(b=v),this._android=s(),this._el=t,this._oQRCode=null,this._oDrawing=new b(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},n.prototype.makeCode=function(t){this._oQRCode=new e(l(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},n.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},n.prototype.clear=function(){this._oDrawing.clear()},n.CorrectLevel=u}(),e["default"]=n},function(t,e,i){var n,o,r;!function(a,s){o=[t,i(45),i(47),i(48)],n=s,r="function"==typeof n?n.apply(e,o):n,!(void 0!==r&&(t.exports=r))}(this,function(t,e,i,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(t,e){var i="data-clipboard-"+t;if(e.hasAttribute(i))return e.getAttribute(i)}var d=o(e),h=o(i),u=o(n),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),f=function(t){function e(t,i){r(this,e);var n=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.resolveOptions(i),n.listenClick(t),n}return s(e,t),p(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===c(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,u["default"])(t,"click",function(t){return e.onClick(t)})}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new d["default"]({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return l("action",t)}},{key:"defaultTarget",value:function(t){var e=l("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return l("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,i=!!document.queryCommandSupported;return e.forEach(function(t){i=i&&!!document.queryCommandSupported(t)}),i}}]),e}(h["default"]);t.exports=f})},function(t,e,i){var n,o,r;!function(a,s){o=[t,i(46)],n=s,r="function"==typeof n?n.apply(e,o):n,!(void 0!==r&&(t.exports=r))}(this,function(t,e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=i(e),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(){function t(e){n(this,t),this.resolveOptions(e),this.initSelection()}return a(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,o["default"])(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o["default"])(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==("undefined"==typeof t?"undefined":r(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s})},function(t,e){function i(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var i=t.hasAttribute("readonly");i||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),i||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var n=window.getSelection(),o=document.createRange();o.selectNodeContents(t),n.removeAllRanges(),n.addRange(o),e=n.toString()}return e}t.exports=i},function(t,e){function i(){}i.prototype={on:function(t,e,i){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:i}),this},once:function(t,e,i){function n(){o.off(t,n),e.apply(i,arguments)}var o=this;return n._=e,this.on(t,n,i)},emit:function(t){var e=[].slice.call(arguments,1),i=((this.e||(this.e={}))[t]||[]).slice(),n=0,o=i.length;for(n;n<o;n++)i[n].fn.apply(i[n].ctx,e);return this},off:function(t,e){var i=this.e||(this.e={}),n=i[t],o=[];if(n&&e)for(var r=0,a=n.length;r<a;r++)n[r].fn!==e&&n[r].fn._!==e&&o.push(n[r]);return o.length?i[t]=o:delete i[t],this}},t.exports=i},function(t,e,i){function n(t,e,i){if(!t&&!e&&!i)throw new Error("Missing required arguments");if(!s.string(e))throw new TypeError("Second argument must be a String");if(!s.fn(i))throw new TypeError("Third argument must be a Function");if(s.node(t))return o(t,e,i);if(s.nodeList(t))return r(t,e,i);if(s.string(t))return a(t,e,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function o(t,e,i){return t.addEventListener(e,i),{destroy:function(){t.removeEventListener(e,i)}}}function r(t,e,i){return Array.prototype.forEach.call(t,function(t){t.addEventListener(e,i)}),{destroy:function(){Array.prototype.forEach.call(t,function(t){t.removeEventListener(e,i)})}}}function a(t,e,i){return l(document.body,t,e,i)}var s=i(49),l=i(50);t.exports=n},function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var i=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===i||"[object HTMLCollection]"===i)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e}},function(t,e,i){function n(t,e,i,n,r){var a=o.apply(this,arguments);return t.addEventListener(i,a,r),{destroy:function(){t.removeEventListener(i,a,r)}}}function o(t,e,i,n){return function(i){i.delegateTarget=r(i.target,e),i.delegateTarget&&n.call(t,i)}}var r=i(51);t.exports=n},function(t,e){function i(t,e){for(;t&&t.nodeType!==n;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}var n=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var o=Element.prototype;o.matches=o.matchesSelector||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector}t.exports=i},function(t,e){t.exports={template:'{{#legacy}}\n<iframe frameborder="0" src="{{{url}}}" title="{{title}}" width="{{width}}" height="{{height}}" scrolling="no" marginwidth="0" marginheight="0" allowfullscreen></iframe>\n{{/legacy}}\n{{^legacy}}\n<a href="{{{url}}}" class="{{prefix}}-embed" {{#id}} data-{{prefix}}-id="{{id}}" {{/id}} data-{{prefix}}-lightbox="{{#lightbox}}yes{{/lightbox}}{{^lightbox}}no{{/lightbox}}" data-{{prefix}}-width="{{width}}" data-{{prefix}}-height="{{height}}" {{#method}} data-{{prefix}}-method="{{method}}" {{/method}} {{#version}} data-{{prefix}}-version="{{version}}" {{/version}} {{#analytics}} data-{{prefix}}-analytics="{{analytics}}" {{/analytics}} style="max-width: 100%">{{title}}</a><script async defer src="{{{script}}}"></script>\n{{/legacy}}'}},function(t,e,i){var n,o,r;!function(i,a){"object"==typeof e&&e&&"string"!=typeof e.nodeName?a(e):(o=[e],n=a,r="function"==typeof n?n.apply(e,o):n,!(void 0!==r&&(t.exports=r)))}(this,function(t){function e(t){return"function"==typeof t}function i(t){return g(t)?"array":typeof t}function n(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(t,e){return null!=t&&"object"==typeof t&&e in t}function r(t,e){return m.call(t,e)}function a(t){return!r(v,t)}function s(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return y[t]})}function l(e,i){function o(){if(v&&!y)for(;m.length;)delete f[m.pop()];else m=[];v=!1,y=!1}function r(t){if("string"==typeof t&&(t=t.split(w,2)),!g(t)||2!==t.length)throw new Error("Invalid tags: "+t);s=new RegExp(n(t[0])+"\\s*"),l=new RegExp("\\s*"+n(t[1])),c=new RegExp("\\s*"+n("}"+t[1]))}if(!e)return[];var s,l,c,p=[],f=[],m=[],v=!1,y=!1;r(i||t.tags);for(var T,C,A,x,S,k,I=new u(e);!I.eos();){if(T=I.pos,A=I.scanUntil(s))for(var L=0,M=A.length;L<M;++L)x=A.charAt(L),a(x)?m.push(f.length):y=!0,f.push(["text",x,T,T+1]),T+=1,"\n"===x&&o();if(!I.scan(s))break;if(v=!0,C=I.scan(E)||"name",I.scan(b),"="===C?(A=I.scanUntil(_),I.scan(_),I.scanUntil(l)):"{"===C?(A=I.scanUntil(c),I.scan(P),I.scanUntil(l),C="&"):A=I.scanUntil(l),!I.scan(l))throw new Error("Unclosed tag at "+I.pos);if(S=[C,A,T,I.pos],f.push(S),"#"===C||"^"===C)p.push(S);else if("/"===C){if(k=p.pop(),!k)throw new Error('Unopened section "'+A+'" at '+T);if(k[1]!==A)throw new Error('Unclosed section "'+k[1]+'" at '+T)}else"name"===C||"{"===C||"&"===C?y=!0:"="===C&&r(A)}if(k=p.pop())throw new Error('Unclosed section "'+k[1]+'" at '+I.pos);return h(d(f))}function d(t){for(var e,i,n=[],o=0,r=t.length;o<r;++o)e=t[o],e&&("text"===e[0]&&i&&"text"===i[0]?(i[1]+=e[1],i[3]=e[3]):(n.push(e),i=e));return n}function h(t){for(var e,i,n=[],o=n,r=[],a=0,s=t.length;a<s;++a)switch(e=t[a],e[0]){case"#":case"^":o.push(e),r.push(e),o=e[4]=[];break;case"/":i=r.pop(),i[5]=e[2],o=r.length>0?r[r.length-1][4]:n;break;default:o.push(e)}return n}function u(t){this.string=t,this.tail=t,this.pos=0}function c(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function p(){this.cache={}}var f=Object.prototype.toString,g=Array.isArray||function(t){return"[object Array]"===f.call(t)},m=RegExp.prototype.test,v=/\S/,y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},b=/\s*/,w=/\s+/,_=/\s*=/,P=/\s*\}/,E=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},u.prototype.scanUntil=function(t){var e,i=this.tail.search(t);switch(i){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=e.length,e},c.prototype.push=function(t){return new c(t,this)},c.prototype.lookup=function(t){var i,n=this.cache;if(n.hasOwnProperty(t))i=n[t];else{for(var r,a,s=this,l=!1;s;){if(t.indexOf(".")>0)for(i=s.view,r=t.split("."),a=0;null!=i&&a<r.length;)a===r.length-1&&(l=o(i,r[a])),i=i[r[a++]];else i=s.view[t],l=o(s.view,t);if(l)break;s=s.parent}n[t]=i}return e(i)&&(i=i.call(this.view)),i},p.prototype.clearCache=function(){this.cache={}},p.prototype.parse=function(t,e){var i=this.cache,n=i[t];return null==n&&(n=i[t]=l(t,e)),n},p.prototype.render=function(t,e,i){var n=this.parse(t),o=e instanceof c?e:new c(e);return this.renderTokens(n,o,i,t)},p.prototype.renderTokens=function(t,e,i,n){for(var o,r,a,s="",l=0,d=t.length;l<d;++l)a=void 0,o=t[l],r=o[0],"#"===r?a=this.renderSection(o,e,i,n):"^"===r?a=this.renderInverted(o,e,i,n):">"===r?a=this.renderPartial(o,e,i,n):"&"===r?a=this.unescapedValue(o,e):"name"===r?a=this.escapedValue(o,e):"text"===r&&(a=this.rawValue(o)),void 0!==a&&(s+=a);return s},p.prototype.renderSection=function(t,i,n,o){function r(t){return a.render(t,i,n)}var a=this,s="",l=i.lookup(t[1]);if(l){if(g(l))for(var d=0,h=l.length;d<h;++d)s+=this.renderTokens(t[4],i.push(l[d]),n,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)s+=this.renderTokens(t[4],i.push(l),n,o);else if(e(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,o.slice(t[3],t[5]),r),null!=l&&(s+=l)}else s+=this.renderTokens(t[4],i,n,o);return s}},p.prototype.renderInverted=function(t,e,i,n){var o=e.lookup(t[1]);if(!o||g(o)&&0===o.length)return this.renderTokens(t[4],e,i,n)},p.prototype.renderPartial=function(t,i,n){if(n){var o=e(n)?n(t[1]):n[t[1]];return null!=o?this.renderTokens(this.parse(o),i,n,o):void 0}},p.prototype.unescapedValue=function(t,e){var i=e.lookup(t[1]);if(null!=i)return i},p.prototype.escapedValue=function(e,i){var n=i.lookup(e[1]);if(null!=n)return t.escape(n)},p.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.3.0",t.tags=["{{","}}"];var T=new p;return t.clearCache=function(){return T.clearCache()},t.parse=function(t,e){return T.parse(t,e)},t.render=function(t,e,n){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+i(t)+'" was given as the first argument for mustache#render(template, view, partials)');return T.render(t,e,n)},t.to_html=function(i,n,o,r){var a=t.render(i,n,o);return e(r)?void r(a):a},t.escape=s,t.Scanner=u,t.Context=c,t.Writer=p,t})},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o,r,a,s){this.popup=s,this.options=r,this.pager=n,this.printer=o,this.rootElement=t,this.data=e||{},this.downloads=this.data.downloads,this.print=this.data.print,this.windowTitle=i,this.currentPageInformer=0,this.leftArrow=!0,this.rightArrow=!0,this.printOption="";var l=this;if(this.editorMode=!!a.publisher,this.editorMode||!this.downloads.url&&!this._hasSingleFiles())l.getPrinterProvider().setPdfPrintingSupport(!1),l.pdfIsAvailable=!0,l.pagesForPrint=[],l._render(),l.getLocaleProvider().on("change:PrintWindow",l._onLocaleChange,l);else{var d=this.pager.state.leftPage||this.pager.state.rightPage;this.url=b(this.downloads.url||"page"+m["default"].getNum(d)+".pdf");var h=new XMLHttpRequest;h.open("HEAD",this.url),h.onreadystatechange=function(){if(this.readyState===this.DONE){if(200===this.status){var t=this.getResponseHeader("content-disposition"),e=t&&t.search("attachment")>=0;l.getPrinterProvider().setPdfPrintingSupport("application/pdf"===this.getResponseHeader("Content-Type")&&!e),l.pdfIsAvailable=!0}else l.getPrinterProvider().setPdfPrintingSupport(!1),console.error("Pdf printing is not ready."),l.pdfIsAvailable=!1;l.pagesForPrint=[],l._render(),l.getLocaleProvider().on("change:PrintWindow",l._onLocaleChange,l)}},h.send()}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(2),c=n(u),p=i(5),f=n(p),g=i(4),m=n(g),v=i(8),y=n(v),b=function(t){return(0,f["default"])().translatePath("assets/common/downloads/"+t)},w="idle",_="downloading",P="printing";o.prototype=new h["default"],o.prototype.constructor=o,o.prototype._formatSize=function(t){var e=t/1048576,i="MB";return e<1?e<.1?(e=(1024*e).toFixed(0),i="KB"):e=e.toFixed(2):e=e<100?e.toFixed(1):e.toFixed(0),this.getLocaleProvider().isLocaleRTL()?i+" "+e:e+" "+i},o.prototype._hasSingleFiles=function(){return this.downloads.pageFiles&&!l["default"].isEmpty(this.downloads.pageFiles)&&this.print&&this.print.currentPagesVisible},o.prototype._getFileByID=function(t){return l["default"].isArray(this.downloads.pageFiles)?l["default"].find(this.downloads.pageFiles,function(e){return e.url===t}):this.downloads.pageFiles[t]},o.prototype._buildPrintArray=function(){var t=[];if(this._hasSingleFiles())if(this.pager.state.leftPage&&this.pager.state.rightPage&&this.pager.state.leftPage!==this.pager.state.rightPage){var e=this.pager.isRtl()?this.pager.state.rightPage:this.pager.state.leftPage,i=this.pager.isRtl()?this.pager.state.leftPage:this.pager.state.rightPage,n=this._getFileByID(e),o=this._getFileByID(i);n&&n.size&&t.push({title:this.getLocaleProvider().get("PrintWindow.LEFT_PAGE"),fileUrl:b("page"+m["default"].getNum(e)+".pdf"),fileName:"page"+m["default"].getNum(e)+".pdf",fileSize:this._formatSize(n.size),fileType:".pdf",option:"Current",pageId:e}),o&&o.size&&t.push({title:this.getLocaleProvider().get("PrintWindow.RIGHT_PAGE"),fileUrl:b("page"+m["default"].getNum(i)+".pdf"),fileName:"page"+m["default"].getNum(i)+".pdf",fileSize:this._formatSize(o.size),fileType:".pdf",option:"Current",pageId:i})}else{var r=this.pager.state.leftPage||this.pager.state.rightPage,a=this._getFileByID(r);a&&a.size&&t.push({title:this.getLocaleProvider().get("PrintWindow.CURRENT_PAGE"),fileUrl:b("page"+m["default"].getNum(r)+".pdf"),fileName:"page"+m["default"].getNum(r)+".pdf",fileSize:this._formatSize(a.size),fileType:".pdf",option:"Current",pageId:r})}return this.downloads.url&&this.print&&this.print.selectedPagesVisible?t.push({title:this.getLocaleProvider().get("PrintWindow.CUSTOM_RANGE"),fileUrl:b(this.downloads.url),fileName:this.downloads.url,fileSize:this._formatSize(this.downloads.size),fileType:"."+this.downloads.url.split(".").pop(),option:"Custom"}):this.editorMode&&this.print&&this.print.selectedPagesVisible&&t.push({title:this.getLocaleProvider().get("PrintWindow.CUSTOM_RANGE"),fileUrl:"publication.pdf",fileName:"publication.pdf",fileSize:this._formatSize(0),fileType:".pdf",option:"Custom"}),t.text=this.getLocaleProvider().get("PrintWindow.INTRODUCTION"),t.button=this.getLocaleProvider().get("PrintWindow.PRINT_BUTTON"),t.cancel=this.getLocaleProvider().get("PrintWindow.CANCEL_BUTTON"),t.waiting=this.getLocaleProvider().get("PrintWindow.WAITING"),t.printSupported=this.getPrinterProvider().isPdfPrintingSupport(),t},o.prototype._render=function(){if(this.content||(this.content=a["default"].createElement("div",{"class":"print-window-container"},this.rootElement)),this.pdfIsAvailable){if(this.content.innerHTML=y["default"]["workspace-pdf-print-window"](this._buildPrintArray()),this.printSelect=t.document.getElementById("print-opt"),this.options&&(this.printSelect.value=this.printSelect.querySelector('[data-filename="'+this.options.fileName+'"]').value,this.printSelect.selectedIndex===-1))for(var e=this.printSelect.getElementsByTagName("option"),i=0;i<e.length;i++)e[i].getAttribute("data-filename")===this.options.fileName&&(this.printSelect.selectedIndex=i);l["default"].defer(l["default"].bind(this._bindElements,this))}else this.content.innerHTML=this.getLocaleProvider().get("PrintWindow.ERROR_MESSAGE");var n=this;setTimeout(function(){document.getElementById("print-btn").focus()},500),this.activeElements=Array.prototype.slice.call(this.rootElement.querySelectorAll("[tabindex]")),this.rootElement.addEventListener("keydown",function(t){if(9===t.keyCode){t.preventDefault();var e=n.activeElements.indexOf(document.activeElement);e===n.activeElements.length-1?n.activeElements[0].focus():n.activeElements[e+1].focus()}})},o.prototype._onLocaleChange=function(){a["default"].setText(this.windowTitle,this.getLocaleProvider().get("PrintWindow.TITLE")),this.update()},o.prototype.getAnalyticsProvider=function(){return(0,c["default"])().get(c["default"].ANALYTICS)},o.prototype.getLocaleProvider=function(){return(0,c["default"])().get(c["default"].LOCALE)},o.prototype.getPrinterProvider=function(){return(0,c["default"])().get(c["default"].VIRTUAL_PRINTER)},o.prototype.getUserAgentInfo=function(){return(0,c["default"])().get(c["default"].USER_AGENT_INFO)},o.prototype.getApiProvider=function(){return(0,c["default"])().get(c["default"].API)},o.prototype.update=function(t){t&&(this.data=t),a["default"].del(this.content),delete this.content,this._render()},o.prototype.progress=function(t){var e=document.getElementById("progress-bar");e.style.width=parseInt(t.loaded/t.total*100,10)+"%";var i=this.getLocaleProvider().get("PrintWindow.DOWNLOADING",{0:this._formatSize(t.loaded),1:this._formatSize(t.total)}),n=document.getElementById("progress-info");n.innerText=i},o.prototype.loaded=function(t){this.getPrinterProvider().off("progress",this.progress,this),this.getPrinterProvider().off("loaded",this.loaded,this),this.set("state",P);var e=this,i=this.getUserAgentInfo().os.mac?2:1,n=this.pager.totalPages,o=(1500+t.loaded/1e5+8*n)*i;this.timeout=setTimeout(function(){e.popup.close()},o)},o.prototype._bindElements=function(){var t=function(t,e){!l["default"].isUndefined(e)&&a["default"].hasClass("print-window",e)&&a["default"].removeClass("print-window",e),a["default"].addClass("print-window",t),t!==w?(a["default"].addClass("print-btn","disable"),a["default"].addClass("print-opt","disable"),this.printSelect.disabled=!0):(this.printSelect.disabled=!1,!l["default"].isUndefined(e)&&a["default"].hasClass("print-btn","disable")&&a["default"].removeClass("print-btn","disable"),!l["default"].isUndefined(e)&&a["default"].hasClass("print-opt","disable")&&a["default"].removeClass("print-opt","disable"))};this.on("change:state",t,this),this.set("state",w),a["default"].id("print-opt").addEventListener("change",l["default"].bind(this._setPrintOption,this)),this._setPrintOption({target:a["default"].id("print-opt")}),a["default"].id("cancel-btn").addEventListener("click",l["default"].bind(function(){this.popup.close()},this)),a["default"].id("print-btn").addEventListener("click",l["default"].bind(function(){if(!this.editorMode&&this.state===w&&this.printSelect.selectedIndex>=0){var t=this.printSelect.options[this.printSelect.selectedIndex].dataset,e=t.url,i=this.pager.getState(),n=void 0,o=void 0;i.leftPage&&(n=this.pager.pageTable.getUrlHeaderById(i.leftPage)),o=i.rightPage?this.pager.pageTable.getUrlHeaderById(i.rightPage):n,i.leftPage||(n=o);var r={option:t.option,fileName:t.filename,leftPageUrl:n,rightPageUrl:o};t.pageid&&(r.printPage=this.pager.pageTable.getUrlHeaderById(t.pageid)),this.getApiProvider().trigger("print",r),this.getPrinterProvider().isPdfPrintingSupport()&&this.printSelect.selectedIndex>=0?(this.set("state",_),this.getPrinterProvider().on("progress",this.progress,this),this.getPrinterProvider().on("loaded",this.loaded,this),this.getPrinterProvider().printPdf(e,function(){})):(this.popup.close(),window.open(e,"_blank"))}},this))},o.prototype._setPrintOption=function(){if(!this.getPrinterProvider().isPdfPrintingSupport()&&this.printSelect.selectedIndex>=0)switch(this.printSelect.options[this.printSelect.selectedIndex].dataset.option){case"Current":a["default"].setText(a["default"].id("print-comment"),this.getLocaleProvider().get("PrintWindow.COMMENT_OPEN_CURRENT"));break;case"Custom":a["default"].setText(a["default"].id("print-comment"),this.getLocaleProvider().get("PrintWindow.COMMENT_OPEN_CUSTOM"))}},o.prototype.onClose=function(){this.timeout&&clearTimeout(this.timeout),this.getPrinterProvider().reset(),this.printer.reset(),this.getLocaleProvider().off("change:PrintWindow",this._onLocaleChange,this)},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){this.rootElement=t,this.data=e,this.pager=n,this.windowTitle=i,this.currentOption="",this.currentFile="",this._render();var o=this;this.activeElements=Array.prototype.slice.call(this.rootElement.querySelectorAll("[tabindex]")),this.rootElement.addEventListener("keydown",function(t){if(9===t.keyCode){t.preventDefault();var e=o.activeElements.indexOf(document.activeElement);e===o.activeElements.length-1?o.activeElements[0].focus():o.activeElements[e+1].focus()}}),setTimeout(function(){o.activeElements[1].focus()},500)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(2),l=n(s),d=i(5),h=n(d),u=i(8),c=n(u),p=i(22);n(p);o.prototype.getLocaleProvider=function(){return(0,l["default"])().get(l["default"].LOCALE)},o.prototype._formatSize=function(t){var e=t/1048576;return e=e<1?e<.1?(1024*e).toFixed(0)+" KB":e.toFixed(2)+" MB":e<100?e.toFixed(1)+" MB":e.toFixed(0)+" MB"},o.prototype._render=function(){this.content||(this.content=a["default"].createElement("div",{"class":"popup-content"},this.rootElement)),this.content.innerHTML=c["default"]["workspace-accessibility-window"]({title:this.getLocaleProvider().get("Accessibility.DOWNLOAD_TITLE"),fullDescription:this.getLocaleProvider().get("Accessibility.DOWNLOAD_DESCRIPTION"),fileUrl:(0,h["default"])().translatePath(this.data.accessibilityPDF.fileName),size:this._formatSize(this.data.accessibilityPDF.size)})},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this.container=t,this.bookModel=e,this.pager=i,this.hidden=!1,this.pager.on("change:state",function(t,e){t.zoomMode!==e.zoomMode&&(t.zoomMode?this.hidden||(this.zoomPanel=this.bindZoomPanel()):this.zoomPanel&&(a["default"].del(this.zoomPanel),this.zoomPanel=null))},this),this.pager.getState().zoomMode&&(this.zoomPanel=this.bindZoomPanel())}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(7),l=n(s);o.prototype.levelPlus=function(){},o.prototype.levelMinus=function(){},o.prototype.bindZoomPanel=function(){var e=this,i=a["default"].createElement("div",{id:"zoom-panel","class":"zoom-panel"},this.container),n=a["default"].createElement("button",{"class":"zoom-panel-caption minus",tabindex:"0"},i);a["default"].setText(n,"–");var o=a["default"].createElement("div",{"class":"zoom-panel-line"},i),r={};r[t.RTL?"right":"left"]=(77*this.bookModel.zoomScaleValue).toFixed(0)-4+"px";var s=a["default"].createElement("div",{id:"zoom-slider","class":"zoom-panel-slider",styles:r},o);!function(i){e.bookModel.on("change:zoomScaleValue",function(e){i&&(i.style[t.RTL?"right":"left"]=(77*e).toFixed(0)-4+"px")})}(s);var d=a["default"].createElement("button",{"class":"zoom-panel-caption",tabindex:"0"},i);a["default"].setText(d,"+");var s=new l["default"](s,{}),h=new l["default"](o,{}),u=o.getBoundingClientRect(),c=t.RTL?Math.abs(u.right-u.left):Math.abs(u.left-u.right),p=function(i){var n=t.RTL?-Math.round(i.center.x-u.right):Math.round(i.center.x-u.left);n<0||n>c||(i.isFinal&&e.bookModel.set("zoomChangeAnimation",!1),e.changeFlipBookZoomValue(n/c))};return s.on("press",function(){u=o.getBoundingClientRect()}),s.on("pan",p),s.on("panstart",function(){e.bookModel.set("zoomChangeAnimation",!0)}),s.on("panend",function(){e.bookModel.set("zoomChangeAnimation",!1)}),s.on("pancancel",function(){e.bookModel.set("zoomChangeAnimation",!1)}),h.on("tap",function(t){u=o.getBoundingClientRect(),p(t)}),this.levelPlus=function(){var t=e.bookModel.zoomScaleValue+.1;t=t<0?0:t>1?1:t,e.changeFlipBookZoomValue(t)},this.levelMinus=function(){var t=e.bookModel.zoomScaleValue-.1;t=t<0?0:t>1?1:t,e.changeFlipBookZoomValue(t)},d.addEventListener("click",this.levelPlus),n.addEventListener("click",this.levelMinus),i},o.prototype.changeFlipBookZoomValue=function(t){this.bookModel.set("zoomScaleValue",t)},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){return this._canPlayMp3()?t&&t.constructor===f["default"]?(this.container=i||a["default"].tag("body"),this.properties=t,this.muted=!1,this.soundEnabled=!0,this.videosPlaying=[],this.mutedByVideo=!1,this.pager=e,this.properties.cast("background"),this._initBackgroundSound(this.properties.background),this.properties.cast("flip"),this._initFlipBookSounds(this.properties.flip),void this.properties.on("change:enabled",function(t){this.soundEnabled=t,this._fadeBackgroundSound(),this._updateCanWork()},this)):void console.error("Sound need properties in constructor"):void console.error("Audio mp3 is not supported")}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(5),h=n(d),u=i(1),c=n(u),p=i(15),f=n(p),g=i(2),m=n(g);o.prototype=new c["default"],o.constructor=o,o.prototype.getApiProvider=function(){return(0,m["default"])().get(m["default"].API)},o.prototype._canPlayMp3=function(){if(navigator.userAgent.toLowerCase().indexOf("publisher")!==-1)return!0;var t=new Audio,e=!!t.canPlayType&&""!==t.canPlayType("audio/mp3");return e},o.prototype._updateCanWork=function(){var t=this.properties.enabled,e=this.flipEnabled&&!l["default"].isEmpty(this.properties.flip.soft),i=!l["default"].isEmpty(this.properties.background.url);this.set("canWork",this._canPlayMp3()&&t&&(e||i))},o.prototype._initBackgroundSound=function(t){var e=this,i={autoplay:"autoplay"};!this.muted&&this.soundEnabled||(i.muted="muted"),this.audio=a["default"].createElement("audio",i,this.container),this.on("change:muted",function(){this._fadeBackgroundSound()}),t.onAndChange("change:url",function(t){this._updateBackgroundURL(t),this._updateCanWork();
},this),t.onAndChange("change:loop",function(t){this._updateBackgroundLoop(t)},this),t.onAndChange("change:volume",function(t){this._updateBackgroundVolume(t)},this),this.getApiProvider().on("video",function(t){switch(t.action){case"play":e.videosPlaying.indexOf(t.url)===-1&&e.videosPlaying.push(t.url),1!==e.videosPlaying.length||e.mutedByVideo||(e.mutedByVideo=!e.muted,e.mutedByVideo&&e.set("muted",!0)),clearTimeout(e.muteTimeout);break;case"pause":case"stop":case"close":e.videosPlaying.splice(e.videosPlaying.indexOf(t.url),1),0===e.videosPlaying.length&&e.mutedByVideo&&(e.muteTimeout=setTimeout(function(){e.set("muted",!1),e.mutedByVideo=!1},1e3))}})},o.prototype._updateBackgroundVolume=function(t){this.audio.volume=t/100,this.backgroundVolume=this.audio.volume},o.prototype._updateBackgroundLoop=function(t){t?(this.audio.setAttribute("loop","loop"),this._playBackgroundSound()):this.audio.removeAttribute("loop")},o.prototype._updateBackgroundURL=function(t){if(l["default"].isEmpty(t))this._fadeBackgroundSound(!0);else{if(this.backgroundAudioSources)this.backgroundAudioSources.src=(0,h["default"])().translatePath("assets/common/sound/"+t),this.audio.load();else{var e={type:"audio/mp3"};e.src=(0,h["default"])().translatePath("assets/common/sound/"+t),this.backgroundAudioSources=a["default"].createElement("source",e,this.audio)}this._playBackgroundSound()}},o.prototype._playBackgroundSound=function(){var t=this,e=this.audio.play();e&&e.then&&"function"==typeof e.then&&e["catch"](function(){(0,m["default"])().has(m["default"].API)&&(0,m["default"])().get(m["default"].API).once("turned",function(){t.audio.play()})})},o.prototype._fadeBackgroundSound=function(t){if(!l["default"].isUndefined(this.audio)){var e=l["default"].isUndefined(t)?this.muted||!this.soundEnabled:t,i=this;this.fadeEffect=void 0;var n,o=500,r=100,a=o/r;l["default"].isUndefined(this.fadeEffect)||clearInterval(this.fadeEffect),e?(n=this.audio.volume/a,this.fadeEffect=setInterval(function(){0===i.audio.volume?(i.audio.muted=!0,clearInterval(i.fadeEffect)):i.audio.volume>n?i.audio.volume-=n:i.audio.volume=0},r)):(n=(this.backgroundVolume-this.audio.volume)/a,this.audio.muted=!1,this.fadeEffect=setInterval(function(){i.audio.volume===i.backgroundVolume?clearInterval(i.fadeEffect):i.audio.volume+n<=i.backgroundVolume?i.audio.volume+=n:i.audio.volume=i.backgroundVolume},r))}},o.prototype.createFlipElements=function(t,e){var i=[];if(!l["default"].isUndefined(e[t]))for(var n,o,r=e[t].length,s=0;s<r;s++)n=e[t][s],o=a["default"].createElement("audio",{id:t+"FlipSound_"+(s+1)},this.container),a["default"].createElement("source",{src:(0,h["default"])().translatePath("assets/common/sound/flip/"+n),type:"audio/mp3"},o),o.volume=1,i.push(o);return i},o.prototype._initFlipBookSounds=function(t){var e=this;t.onAndChange("change:soft",function(){this._updateCanWork()},this),this.soft=this.createFlipElements("soft",t),this.hard=this.createFlipElements("hard",t);var i=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},n=function(t){var n=t===!0?e.hard:e.soft;if(n&&n.length>0){var o=i(0,n.length-1),r=n[o],a=i(5,10)/10;if(r.volume=e.flipVolume*a,!l["default"].isUndefined(r)){var s=r.pause();s&&s.then&&"function"==typeof s.then&&s["catch"](function(){}),function(t){l["default"].delay(function(){if(t.paused){t.currentTime=0;var e=t.play();e&&e.then&&"function"==typeof e.then&&e["catch"](function(){})}},10)}(r)}}};this.pager.on("change:state",function(t,i){if(!e.muted&&e.flipEnabled&&e.soundEnabled&&t.zoomMode===i.zoomMode&&!t.zoomMode){var o=(this.pageTable.isLastPage(i.leftPage)||this.pageTable.isLastPage(t.leftPage)||this.pageTable.isFirstPage(i.rightPage)||this.pageTable.isFirstPage(t.rightPage))&&this.isHardcover();n(o)}}),t.onAndChange("change:volume",function(t){this.flipVolume=t/100},this),t.onAndChange("change:enabled",function(t){this.flipEnabled=t,this._updateCanWork()},this)},o.prototype.destructor=function(){a["default"].del(this.audio),l["default"].each(this.hard,function(t){a["default"].del(t)}),l["default"].each(this.soft,function(t){a["default"].del(t)})},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o,r){this.options={position:"left"},l["default"].extend(this.options,o),this.container=n||a["default"].tag("body"),this.renderWindow(t.iconName,t.title),e&&(this.content=new e(a["default"].id("content-scroller"),i,t.data,r,t.focus),this.content.on("change:page",function(t){this.trigger("change:page",t)},this),this.content.on("change:height",function(){this.scrollObj.refresh(),0===this.scrollObj.maxScrollY?this.scrollObj.wrapper.classList.add("hide-vertical"):this.scrollObj.wrapper.classList.remove("hide-vertical")},this),this.content.on("scroll:toElement",function(t){l["default"].isUndefined(t.el)||this.scrollObj.scrollToElement(t.el,t.speed,!0,!0)},this),this.content.on("scroll:toTop",function(){this.scrollObj.scrollTo(0,0)},this),this.content.on("reloadRequested",function(){this.trigger("toolWindow:reload")},this)),this.currentDOMElement=a["default"].id("tool-window");var s=this;this.currentDOMElement.addEventListener("keydown",function(t){27===t.keyCode&&s.trigger("toolWindow:close")}),"left"!==this.getPosition()&&a["default"].addClass(this.currentDOMElement,this.getPosition())}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(4),c=n(u),p=i(7),f=(n(p),i(23)),g=n(f),m=i(8),v=n(m);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.renderWindow=function(t,e){var i=this,n=this.container.querySelector(".publication-container > .resize-triggers");c["default"].renderTemplate(this.container,v["default"]["workspace-tool-window"],{icon:t,title:e},n),this.bindDOM(),this.scrollObj=new g["default"](a["default"].id("scroller"),{mouseWheel:!0,scrollbars:!0,fadeScrollbars:!0,interactiveScrollbars:!0,probeType:3}),this.scrollObj.on("scroll",function(){i.content instanceof h["default"]&&i.content.trigger("scroll")})},o.prototype.bindDOM=function(){var t=this;a["default"].id("tool-left-window").addEventListener("click",function(){t.trigger("toolWindow:close")})},o.prototype.removeWindow=function(){a["default"].del(this.currentDOMElement),this.currentDOMElement=null,l["default"].isObject(this.content)&&l["default"].isFunction(this.content.destructor)&&this.content.destructor()},o.prototype.getPosition=function(){return this.options.position},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(e,i,n,o,r,a,s){this.visible=!1,this.numberOfRows=i,this.wrapper=n,this.pageNum=e,this.pager=o,this.thumbnailsObj=a,this.bodyContainer=s,this.leftWindowWidth=t.document.querySelector(".tool-title-frame").getBoundingClientRect().width,r=o.pageTable.getPageIndexById(r.leftPage||r.rightPage),this.loadManager=(0,h["default"])().get(h["default"].LOAD_MANAGER),this.thumbnailsObj.on("scroll",function(){this._changePos(!1)},this),this._init(),this._initTH(),this._render(),r<=this.endIndex&&r>=this.startIndex&&this._renderPageContent(),this.thumbnailsObj.on("change:active",function(){this._changePos(!0)},this),this.pager.on("change:state",this._updatePageHeight,this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(2),h=n(d),u=i(5),c=n(u),p=i(4),f=n(p),g=i(7),m=(n(g),i(9)),v=window.FBPublication.PageResourceType;o.prototype._init=function(){var t=2*this.numberOfRows*(this.pageNum-1)-1,e=2*this.numberOfRows*this.pageNum-2;this.startIndex=t<0?-1:t,this.endIndex=e>=this.pager.pageTable.getPagesCount()?this.pager.pageTable.getPagesCount()-1:e},o.prototype._initTH=function(){this._renderItem(0,!0);try{var t=a["default"].className("th-string th-template")[0],e=t.getBoundingClientRect();this.thHeight=e.bottom-e.top}catch(i){console.error("Can't find template. Defaulting thHeight to 43. \nError: "+i.name+i.message),this.thHeight=43}finally{a["default"].del(t)}},o.prototype.getApiProvider=function(){return(0,h["default"])().get(h["default"].API)},o.prototype._changePos=function(e){e=e||!1;var i=this.pager.getState(),n=this.pager.pageTable.getPageIndexById(i.leftPage||i.rightPage),o=n>=this.startIndex&&n<=this.endIndex;o&&!e||!o&&e||l["default"].delay(l["default"].bind(function(){var i=this.pageWrapper.getBoundingClientRect();this.visible?e||(i.bottom<0||i.top>t.innerHeight)&&this._clear():(i.bottom>0&&i.top<t.innerHeight||e)&&this._renderPageContent()},this),e?0:700)},o.prototype._render=function(){this.pageWrapper=a["default"].createElement("div",{id:"page"+this.pageNum},this.wrapper),this._updatePageHeight()},o.prototype._updatePageHeight=function(){a["default"].css(this.pageWrapper,{height:this._getRowsHeight()+"px"})},o.prototype._renderPageContent=function(){for(var t=this.startIndex;t<=this.endIndex;t++)this._renderItem(t);this.loadManager.setVisibleThRange(this.startIndex,this.endIndex),this.visible=!0},o.prototype._clear=function(){this.pageWrapper.innerHTML="",this.visible=!1},o.prototype._getRowsHeight=function(){for(var t,e,i,n,o,r=0,s=this.startIndex;s<=this.endIndex;s++)t=this.pager.pageTable.getPageIdByIndex(s),l["default"].isUndefined(t)||(e=this.pager.pageTable.getPageModel(t),o=a["default"].hasClass(this.wrapper.parentNode,"slide"),n=e.getProperty("wide"),i=e.getRect(this._getWrapperRect(n||o)).pageHeight,o?(!n||n&&s%2===1)&&(r+=1*i.toFixed(0)+this.thHeight):s%2!==1&&0!==s||(r+=1*i.toFixed(0)+this.thHeight));return r},o.prototype._getWrapperRect=function(t){return{width:t?220:110,height:170}},o.prototype.changeShadowDepth=function(t,e){switch(1*e){case 0:t.className="gradient zero";break;case 1:t.className="gradient light";break;case 2:t.className="gradient";break;case 3:t.className="gradient hard"}},o.prototype._renderItem=function(e,i){var n=this,o=this,r=this.pager.pageTable.getPageIdByIndex(e);if(!l["default"].isUndefined(r)){var s=this.pager.pageTable.getPageModel(r),d=s.getProperty("wide"),h=a["default"].hasClass(this.wrapper.parentNode,"slide"),u=s.getProperty("shadowDepth"),p=void 0,g=void 0,y=void 0,b=void 0,w={},_=void 0,P=void 0;if(!d||e%2!==0){var E=s.getRect(this._getWrapperRect(d)),T=s.getRect(this._getWrapperRect(!0)),C=i?this.bodyContainer||t.document.body:this.pageWrapper;e%2!==1&&0!==e||(p=a["default"].createElement("div",{"class":i?"th-string th-template":"th-string"},C),this.spreadWrapper=a["default"].createElement("div",{"class":"th-spread-wrapper"},p),this.pager.isRtl()&&a["default"].addClass(p,"rtl")),g=a["default"].createElement("div",{"class":d?"th-item-wrapper wide":"th-item-wrapper"},this.spreadWrapper),this.pager.pageTable.isFirstPage(r)&&a["default"].addClass(g,"first"),this.pager.pageTable.isLastPage(r)&&a["default"].addClass(g,"last"),i||(_=h?T.pageHeight:E.pageHeight,P=h?T.pageWidth:E.pageWidth,w={height:_.toFixed(0)+"px",width:P.toFixed(0)+"px","background-color":s.getProperty("backgroundColor")}),y=a["default"].createElement("div",{"class":"th-img-element p"+r,"data-id":e,styles:w},g);var A=a["default"].createElement("div",{},y);if(this.changeShadowDepth(A,u),s.model.on("change:shadowDepth",function(t){n.changeShadowDepth(A,t)}),d&&!h?(a["default"].createElement("div",{"class":"preloader",styles:{left:0}},y),a["default"].createElement("div",{"class":"preloader",styles:{right:0}},y)):a["default"].createElement("div",{"class":"preloader"},y),!i){var x=this.loadManager.getPageLoader(s.id,v.THUMBNAIL);if(x){var S=function(){!function(t){var e="FILL"===s.getProperty("pageResize")?f["default"].fillScreenSizes(parseInt(s.getProperty("width"),10),parseInt(s.getProperty("height"),10),parseInt(P,10),parseInt(_,10)):f["default"].fitScreenSizes(parseInt(s.getProperty("width"),10),parseInt(s.getProperty("height"),10),parseInt(P,10),parseInt(_,10)),i=a["default"].createElement("img",{styles:{width:e.width+"px",height:e.height+"px","margin-left":e.paddingLeft+"px","margin-top":e.paddingTop+"px"}},t);i.crossOrigin=(0,c["default"])().getCrossOrigin(),i.src=x.getLoadedData(),a["default"].removeClass(t,"loading")}(y)};x.isDataReady()?S():(a["default"].addClass(y,"loading"),x.once(m.LoaderEvent.DATA_IS_READY,S))}}y.addEventListener("click",function(){o.getApiProvider().trigger("link",{type:"internal",pageToUrl:o.pager.pageTable.getUrlHeaderById(r),pageUrl:o.pager.pageTable.getUrlHeaderById(o.pager.state.leftPage||o.pager.state.rightPage),source:"thumbnails"}),o.thumbnailsObj.trigger("change:page",{pageId:r,target:"th"}),a["default"].id("content-scroller").focus()}),b=a["default"].createElement("span",{"class":"th-item-title"},g),a["default"].setText(b,this.pager.pageTable.getPageCaptionById(r))}}},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){this.rootElement=t,this.bodyContainer=i.bodyContainer,this.bookModel=i.bookModel,this.pager=e,this.RTL=(0,m["default"])().get(m["default"].LOCALE).isLocaleRTL(),this.noteData=i.noteData,this.noteData.on(c["default"].CHANGE_EVENT,this.render,this),this.noteData.on(c["default"].ADD_EVENT,this.render,this),this.noteData.on(c["default"].REMOVE_EVENT,this.render,this),this.leftPage=void 0,this.rightPage=void 0,this.isZoomed=this.pager.getState().zoomMode,this.body=a["default"].createElement("div",{"class":"note-window-content"},this.rootElement),this.render();var r=this,s=function(t){if("BUTTON"===t.target.tagName)return!0;if(40===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("down");else if(38===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("up");else if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootElement.querySelector(".selected");if(null===e)return;e.click()}};o&&this.rootElement.focus(),this.rootElement.addEventListener("keydown",s),this.rootElement.addEventListener("blur",function(){a["default"].removeClass(r.rootElement.querySelector(".selected"),"selected")})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(25),c=n(u),p=i(61),f=n(p),g=i(2),m=n(g),v=i(4),y=n(v),b=i(11),w=n(b);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype._changeSelected=function(t){var e,i=this.rootElement.querySelector(".selected");e=null===i?this.rootElement.querySelector(".list-item"):"up"===t?i.previousSibling:i.nextSibling,null!==e&&a["default"].hasClass(e,"list-item")&&(null!==i&&a["default"].removeClass(i,"selected"),a["default"].addClass(e,"selected"),this._updateScroll(!0))},o.prototype.render=function(){a["default"].clear(this.body);for(var t=this.noteData.getPageIds(),e=[],i=this,n=0,o=t[n];n<t.length;o=t[++n]){var r=this.noteData.getNotesOnPage(o),s=this.pager.pageTable.hasPageWithId(o);if(s)for(var l=0,d=r[l];l<r.length;d=r[++l]){var h={note:d,pageId:o};e.push(h),new f["default"](h,this.body,this.pager,this.bookModel)}}t.length||(this.noteInvitation=a["default"].createElement("span",{"class":"note-window-invitation-text"},this.body),this.noteInvitation.innerHTML=y["default"].cleanString(this.getLocaleProvider().get("NotesToolWindow.INVITATION_MESSAGE"))),this.addButton=a["default"].createElement("button",{"class":"tool-button note-button","aria-label":y["default"].cleanString(this.getLocaleProvider().get("NotesToolWindow.POST_INVITATION_MESSAGE"))},this.body),this.addButton.innerHTML=y["default"].cleanString(this.getLocaleProvider().get("NotesToolWindow.ADD_NOTE")),t.length||(this.noteInvitation=a["default"].createElement("span",{"class":"note-window-post-invitation-text"},this.body),this.noteInvitation.innerHTML=y["default"].cleanString(this.getLocaleProvider().get("NotesToolWindow.POST_INVITATION_MESSAGE"))),this.addButton.addEventListener("click",function(){var t,e=i.getNoteManager().containers;for(var n in e){var o=e[n];if(i.RTL&&o.presenter.isWide()&&n.indexOf("Right")>=0){t=o;break}if(!i.RTL&&o.presenter.isWide()&&n.indexOf("Left")>=0){t=o;break}t=t?i.pager.rtl?i.RTL?parseInt(o.presenter.model.getPageNumber())<parseInt(t.presenter.model.getPageNumber())?o:t:parseInt(o.presenter.model.getPageNumber())>parseInt(t.presenter.model.getPageNumber())?o:t:i.RTL?parseInt(o.presenter.model.getPageNumber())>parseInt(t.presenter.model.getPageNumber())?o:t:parseInt(o.presenter.model.getPageNumber())<parseInt(t.presenter.model.getPageNumber())?o:t:o}for(var r=i.noteData.getNotesOnPage(t.presenter.model.getPageId()),a=t.presenter.model._bookModel.getProps(),s=parseInt(a.bookSize.width,10),l=parseInt(a.bookSize.height,10),d=[],h=t.presenter.isWide()&&i.RTL?s:0,u=0;u<r.length;u++)d.push({left:parseInt(r[u].pX)-h,top:parseInt(r[u].pY)});var c=y["default"].findSpace(s,l,40,d);if(t.presenter.view.parentObject){var p=(0,m["default"])().get(m["default"].CURRENT_PRESENTER);if(p.constructor===w["default"])t.presenter.addNote({pX:c.left+h,pY:c.top});else{var f=function g(e){e&&e.changingZoom||(i.getBookState().off("update",g),t.presenter.addNote({pX:c.left+h,pY:c.top}))};0==i.bookModel.zoomScaleValue?f():(i.bookModel.setZoomScaleValue(0),i.getBookState().on("update",f))}}}),this._updateScroll()},o.prototype._updateScroll=function(t){t=t||!1,l["default"].defer(l["default"].bind(function(){this.trigger("change:height");var e=t?this.rootElement.querySelector(".selected"):a["default"].className("th-item-wrapper active",this.rootElement)[0]||a["default"].className("th-spread-wrapper active",this.rootElement)[0];l["default"].isUndefined(e)||(this.trigger("scroll:toElement",{el:e,speed:this.firstTimeScrolled?t?1500:500:0}),this.firstTimeScrolled=!0)},this))},o.prototype._pagePropsChanged=function(){this.trigger("reloadRequested")},o.prototype.destructor=function(){},o.prototype.getNoteManager=function(){return(0,m["default"])().get(m["default"].NOTE_MANAGER)},o.prototype.getBookState=function(){return(0,m["default"])().get(m["default"].BOOK_STATE)},o.prototype.getLocaleProvider=function(){return(0,m["default"])().get(m["default"].LOCALE)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){this.bookModel=n;var o=this;this.pager=i,this.body=e,this.pageId=t.pageId,this.data=t.note,this.init(),this.noteElement.addEventListener("click",function(){var t=(0,h["default"])().get(h["default"].CURRENT_PRESENTER);if(t.constructor===p["default"])o.pager.goToPageById(o.pageId),o.getNoteManager().clickOnWindowItem(o.pageId,o.data.id);else{var e=function(){o.getNoteManager().clickOnWindowItem(o.pageId,o.data.id)};o.pager.state.leftPage===o.pageId||o.pager.state.rightPage===o.pageId;o.pager.goToPageById(o.pageId),setTimeout(e,160)}a["default"].id("content-scroller").focus()},!1)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(4),l=n(s),d=i(2),h=n(d),u=i(9),c=i(11),p=n(c),f=i(5),g=n(f),m=window.FBPublication.PageResourceType;o.prototype.constructor=o,o.prototype.init=function(){function t(t){for(var e=t.innerText.split("\n").join(" ").split(" ");t.scrollHeight>t.offsetHeight;)e.pop(),t.innerText=e.join(" ")+"..."}this.loadManager=(0,h["default"])().get(h["default"].LOAD_MANAGER);var e=this.pager.pageTable.getPageCaptionById(this.pageId);this.noteElement=a["default"].createElement("div",{id:"note"+this.pageId+"-"+this.data.id,"class":"note-window-item list-item"},this.body);var i=this.createImage();this.body=a["default"].createElement("div",{"class":"note-body-element p"+this.pageId,styles:{width:210-i.width+"px"}},this.noteElement),this.pageElement=a["default"].createElement("span",{"class":"note-window-item-title"},this.body),this.pageElement.innerHTML=l["default"].cleanString(this.getLocaleProvider().get("NotesToolWindow.PAGE",{0:e}));a["default"].createElement("div",{"class":"note-color "+this.data.color},this.body);this.textElement=a["default"].createElement("span",{"class":this.data.text?"note-window-item-text":"note-window-item-text not-available"},this.body),this.textElement.innerHTML=this.data.text?l["default"].cleanString(this.data.text):this.getLocaleProvider().get("NotesToolWindow.NO_TEXT_AVAILABLE"),t(this.textElement)},o.prototype.createImage=function(){var t=this,e=this.pager.pageTable.getPageModel(this.pageId),i=e.getProperty("wide"),n=e.getRect({width:40*(i?2:1),height:56}),o=n.pageHeight.toFixed(0),r=(n.pageWidth/(i?2:1)).toFixed(0),s=a["default"].createElement("div",{"class":"note-img-element p"+this.pageId,styles:{height:o+"px",width:r+"px","background-color":e.getProperty("backgroundColor"),overflow:"hidden"}},this.noteElement),d=this.loadManager.getPageLoader(this.pageId,m.THUMBNAIL);if(d){var h=function(){!function(n){var s="FILL"===e.getProperty("pageResize")?l["default"].fillScreenSizes(parseInt(e.getProperty("width"),10),parseInt(e.getProperty("height"),10),parseInt(r*(i?2:1),10),parseInt(o,10)):l["default"].fitScreenSizes(parseInt(e.getProperty("width"),10),parseInt(e.getProperty("height"),10),parseInt(r*(i?2:1),10),parseInt(o,10)),h=0;if(i){var u=parseInt(e.getProperty("width"),10)/2,c=u/parseInt(e.getProperty("height"),10),p=e.bookSize.width/e.bookSize.height,f=0;c<p&&(f=(p-c)*u),e.bookSize.width<t.data.pX&&(h=r)}var m=a["default"].createElement("img",{styles:{width:s.width+"px",height:s.height+"px","margin-left":s.paddingLeft-h+"px","margin-top":s.paddingTop+"px"}},n);m.crossOrigin=(0,g["default"])().getCrossOrigin(),m.src=d.getLoadedData(),a["default"].removeClass(n,"loading")}(s)};d.isDataReady()?h():(a["default"].addClass(s,"loading"),d.once(u.LoaderEvent.DATA_IS_READY,h))}return{width:r,height:o}},o.prototype.getLocaleProvider=function(){return(0,h["default"])().get(h["default"].LOCALE)},o.prototype.getNoteManager=function(){return(0,h["default"])().get(h["default"].NOTE_MANAGER)},o.prototype.getBookState=function(){return(0,h["default"])().get(h["default"].BOOK_STATE)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.presenter=t,this.pager=(0,m["default"])().get(m["default"].PAGER)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(7),l=n(s),d=i(0),h=n(d),u=i(4),c=n(u),p=i(3),f=n(p),g=i(2),m=n(g),v=i(5),y=n(v),b=i(63),w=n(b),_=(i(20),i(12)),P=n(_);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.setFillMode=function(t){this.fillMode=t,this.backgroundContainer.style["background-size"]="fit"===this.fillMode?"contain":"cover",this.textLayer.className="fit"===this.fillMode?"img-fit":"img-fill",this.backgroundLayer.className="fit"===this.fillMode?"img-fit":"img-fill",this.textLayer.style.transform="safari"===this.presenter.model._bookModel.browser.name.toLowerCase()?"fit"===this.fillMode?"translate3d(0,0,0)":"translate3d(-50%, -50%, 0)":"fit"===this.fillMode?"translate(0,0)":"translate(-50%, -50%)",this.backgroundLayer.style.transform="safari"===this.presenter.model._bookModel.browser.name.toLowerCase()?"fit"===this.fillMode?"translate3d(0,0,0)":"translate3d(-50%, -50%, 0)":"fit"===this.fillMode?"translate(0,0)":"translate(-50%, -50%)","wide"===this.fillMode&&(this.textLayer.style.height="auto",this.backgroundLayer.style.height="auto",this.textLayer.style.width="100%",this.backgroundLayer.style.width="100%"),"tall"===this.fillMode&&(this.textLayer.style.width="auto",this.backgroundLayer.style.width="auto",this.textLayer.style.height="100%",this.backgroundLayer.style.height="100%")},o.prototype.destructor=function(){this.destructed=!0},o.prototype.contextMenu=function(){return(0,m["default"])().has(m["default"].CONTEXT_MENU)?(0,m["default"])().get(m["default"].CONTEXT_MENU):null},o.prototype.noteManager=function(){return(0,m["default"])().has(m["default"].NOTE_MANAGER)?(0,m["default"])().get(m["default"].NOTE_MANAGER):null},o.prototype.init=function(t){var e=this;this.state=o.STATES.IDLE;var i={state:o.STATES.IDLE,backgroundImages:[],mode:"single",fillMode:"fit",pageSize:{width:100,height:100},isZoomed:!1,pageBackgroundColor:"#FFFFFF",highlightOnFlip:!0,highlightDelay:1e3,content:[]};h["default"].extend(i,t),this.pageBackgroundColor=i.pageBackgroundColor,this.mode=i.mode,this.pageWidth=i.pageSize.width,this.pageHeight=i.pageSize.height,this.fillMode=i.fillMode,this.content=i.content,this.isZoomed=i.isZoomed,this.highlightOnFlip=i.highlightOnFlip,this.highlightDelay=i.highlightDelay>200?i.highlightDelay-200:0,this.setBackgroundImages(i.backgroundImages),this.crossOrigin=(0,y["default"])().getCrossOrigin(),this.parentObject=f["default"].createElement("div",{"class":"page-content",styles:{position:"absolute",overflow:"hidden",top:0,bottom:0,right:0,left:0,background:i.pageBackgroundColor}});var n="ADD_NOTE_EVENT",r="TOGGLE_ZOOM_EVENT",a="SHARE_PAGE_EVENT",s="DOWNLOAD_PAGE_EVENT",l="PRINT_PAGE_EVENT",d="TOGGLE_FULLSCREEN_EVENT";this.container=f["default"].createElement("div",{},this.parentObject),this._buildDOM(this.container),this._addNavigationButtons(this.parentObject),this._bindDOMEvents(this.container),this.on("change:state",this._onStateChanged,this),this.set("state",i.state);var u=(0,m["default"])().get(m["default"].WIDE_HIGHLIGHTER),p=function(t){this.presenter.addNote(t,"context-menu")},g=function(t){var e=document.createElement("a");e.setAttribute("href",t.fileUrl),e.setAttribute("target","_blank"),e.setAttribute("download",t.fileName),document.body.appendChild(e),e.click(),document.body.removeChild(e)},v=function(t){function i(t,i,n,o,r,a,s){e.contextMenu().addItem({name:(0,m["default"])().get(m["default"].LOCALE).get(i),event:t,icon:n,options:o,group:s,include:a},r)}function o(t){t.preventDefault=function(){},this._onDoubleTap(t)}var h=e.parentObject.getBoundingClientRect(),u=0;"wideRight"===e.presenter.model.getMode()&&(u=h.right-h.left);var f=e.presenter.getBookSize(),v={width:h.right-h.left,height:h.bottom-h.top};v.ratio=v.width/v.height;var b=({scaleX:v.width/f.width,scaleY:v.height/f.height},c["default"].getBookSizes(e.presenter.getBookSize(),h,e.isZoomed,e.presenter.isWide(),e.presenter.isRight())),w={pX:Number((t.pageX-h.left)/b.scales.scaleX+b.offset).toFixed(2),pY:Number((t.pageY-h.top)/b.scales.scaleY).toFixed(2)},_=e.presenter.model._bookModel.getWorkspaceProperties(),E=_.components;if(E.notes!==!0||(0,y["default"])().getLocalStorage().isStub||i(n,"RightClickMenu.ADD_NOTE","icon-add-note",w,t,void 0,1),_.downloads.enabled===!0&&_.downloads.currentPagesVisible===!0&&!e.presenter.model.pageModel.isStub()){var T="page"+c["default"].getNum(e.presenter.model.pageModel.id)+".pdf",C=(0,y["default"])().translatePath("assets/common/downloads/"+T);i(s,"RightClickMenu.DOWNLOAD_PAGE","icon-download",{fileUrl:C,fileName:T},t,void 0,1)}if(E.print===!0&&!e.presenter.model.pageModel.isStub()){var A="page"+c["default"].getNum(e.presenter.model.pageModel.id)+".pdf";i(l,"RightClickMenu.PRINT_PAGE","icon-print",{fileName:A,pageId:e.presenter.model.getPageId(),isRight:e.presenter.model.isRight()&&!e.pager.state.zoomMode},t,void 0,1)}if(E.share===!0&&i(a,"RightClickMenu.SHARE_PAGE","icon-social",void 0,t,void 0,1),E.book.flip===!0&&_.components.book.slide===!0&&(e.pager.state.zoomMode===!1?i(r,"RightClickMenu.SWITCH_TO_ZOOM","icon-zoomin",{center:{x:t.pageX,y:t.pageY}},t,void 0,1):i(r,"RightClickMenu.SWITCH_TO_BOOK","icon-zoomout",{center:{x:t.pageX,y:t.pageY}},t,void 0,1)),E.fullscreen===!0){var x=(0,m["default"])().get(m["default"].BOOK_STATE);x.fullscreen===!0?i(d,"RightClickMenu.EXIT_FULLSCREEN","icon-fullscreen-out",void 0,t,void 0,1):i(d,"RightClickMenu.ENTER_FULLSCREEN","icon-fullscreen",void 0,t,void 0,1)}e.contextMenu().on(P["default"].HIDE_EVENT,function(){this.contextMenu().off(n,p,this),this.contextMenu().off(s,g,this)},e),e.contextMenu().on(n,p,e),e.contextMenu().on(s,g,e),e.contextMenu().on(P["default"].HIDE_EVENT,function(){this.contextMenu().off(r,o,this)},e),e.contextMenu().on(r,o,e)};return this.presenter.on("change:isActive",function(t){if(t){if(this.noteManager()&&this.noteManager().registerContentContainer(this.presenter.model.getPageId(),this.mode,this.parentObject,this.presenter),this.parentObject.addEventListener("contextmenu",v,!1),f["default"].addClass(e.contentContainer,"active"),e.highlightOnFlip){var i=this.pager.state,n=this.presenter.model.getPageId(),o=!0,r=void 0;if(i.leftPage!==n||h["default"].isUndefined(i.rightPage)?i.rightPage===n&&(r=i.leftPage):r=i.rightPage,r&&(i.isZoomed||(r=this.pager.pageTable.getPageIndexById(r)+1),o=(0,m["default"])().get(m["default"].CURRENT_PRESENTER).contentPresenters[r].isActive),o)if(e.isZoomed||0!==e.mode.indexOf("wide"))e.highlight("flip");else{var a=u.pushContent(this);a&&e.highlight("flip")}}h["default"].delay(function(){e._applyHQImages()},500)}else this.noteManager()&&this.noteManager().unregisterContentContainer(this.presenter.model.getPageId(),this.mode),this.parentObject.removeEventListener("contextmenu",v,!0),u.pushContent(null),clearTimeout(e.highlightTimeout),f["default"].removeClass(e.contentContainer,"active")},this),this.on("contentResize",function(){this.backgroundLayer.setAttribute("data-hq","0"),this.textLayer.setAttribute("data-hq","0"),this.presenter.isActive&&this._applyHQImages()}),this.listenTo(this.presenter,"change:currentSize",h["default"].debounce(function(t,i){t.width===i.width&&t.height===i.height||this.trigger("contentResize",e.presenter.currentSize)},500)),this},o.prototype.highlight=function(t){function e(t){i.highlightTimeout=setTimeout(function(){f["default"].addClass(n,t),setTimeout(function(){f["default"].removeClass(n,t)},500)},i.isZoomed?500:i.highlightDelay)}if((0,m["default"])().has(m["default"].CURRENT_PRESENTER)){var i=this,n=(0,m["default"])().get(m["default"].CURRENT_PRESENTER).getViewContainer();switch(t){case"full":e("highlighted");break;case"toggle":f["default"].hasClass(n,"highlighted")?(f["default"].removeClass(n,"highlighted"),this.trigger("highlight","off")):(f["default"].addClass(n,"highlighted"),this.trigger("highlight","on"));break;case"flip":default:e("flip-highlighted")}(0,m["default"])().get(m["default"].API).on("bookStateChanged",function(){f["default"].removeClass(n,"flip-highlighted"),f["default"].removeClass(n,"highlighted")})}},o.prototype._parseColor=function(t){var e;return(e=t.match(/^#([0-9a-f]{3})$/i))?(e=e[1],[17*parseInt(e.charAt(0),16),17*parseInt(e.charAt(1),16),17*parseInt(e.charAt(2),16)]):(e=t.match(/^#([0-9a-f]{6})$/i),e?(e=e[1],[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]):[0,0,0])},o.prototype._calculateLuma=function(t){var e=299,i=667,n=114,o=(t[0]*e+t[1]*i+t[2]*n)/(e+i+n);return o/255},o.prototype._buildDOM=function(t){var e={position:"relative","background-position":"center center","background-repeat":"no-repeat",height:"100%"};switch(this.mode){case"wideLeft":e.width="200%";break;case"wideRight":e.width="200%",e["margin-left"]="-100%";break;default:e.width="100%"}this.backgroundContainer=f["default"].createElement("div",{"class":"background",styles:e});var i={styles:{"text-indent":"-999px"}};this.textLayer=f["default"].createElement("img",i),this.backgroundLayer=f["default"].createElement("img",i,this.backgroundContainer),this.setFillMode(this.fillMode),this.crossOrigin&&(this.textLayer.crossOrigin=this.crossOrigin,this.backgroundLayer.crossOrigin=this.crossOrigin),this.textLayer.setAttribute("draggable","false"),this.backgroundLayer.setAttribute("draggable","false"),this.container.appendChild(this.backgroundContainer),this.searchContainer=f["default"].createElement("div",{"class":"search-container"},this.container,"top"),this.contentContainer=f["default"].createElement("div",{"class":"content-container"},this.container,"top");var n=this.presenter.model._bookModel.browser,o=this.presenter.model.getPageNumber()+1,r=this.presenter.model.getPageTable().getPagesCount();n.chrome&&parseInt(n.version.split(".")[0],10)>=67&&(2===o||o===r-1||"wideRight"===this.mode&&o===r-2)&&(this.contentContainer.style.willChange="transform"),this.preloader=f["default"].createElement("div",{"class":"preloader",styles:{display:"none"}},t),this.shadowDiv=f["default"].createElement("div",{},this.parentObject)},o.prototype._bindDOMEvents=function(t){var e=this,i=new l["default"].Manager(t,{}),n=new l["default"].Tap({
event:"singletap"}),o=new l["default"].Tap({event:"doubletap",taps:2});i.add([o,n]),o.recognizeWith(n),n.requireFailure(o),i.on("singletap",function(t){t.target&&t.target.className&&t.target.className.constructor===SVGAnimatedString||e.trigger("tap",t.srcEvent)}),i.on("doubletap",function(t){e._onDoubleTap(t)})},o.prototype._addNavigationButtons=function(t){var e=this,i=f["default"].createElement("div",{"class":"prev-nav-button"},t),n=f["default"].createElement("div",{"class":"next-nav-button"},t),o=new l["default"].Manager(i,{}),r=new l["default"].Tap({event:"singletap"}),a=new l["default"].Tap({event:"doubletap",taps:2});o.add([a,r]),a.recognizeWith(r),r.requireFailure([a]),o.on("singletap",function(t){e.presenter.requestNavigation("prev"),t.preventDefault()}),o.on("doubletap",function(t){e._onDoubleTap(t)});var s=new l["default"].Manager(n,{});r=new l["default"].Tap({event:"singletap"}),a=new l["default"].Tap({event:"doubletap",taps:2}),s.add([a,r]),a.recognizeWith(r),r.requireFailure([a]),s.on("singletap",function(t){e.presenter.requestNavigation("next"),t.preventDefault()}),s.on("doubletap",function(t){e._onDoubleTap(t)})},o.prototype.changeShadowDepth=function(t){switch(1*t){case 0:this.shadowDiv.className="gradient zero";break;case 1:this.shadowDiv.className="gradient light";break;case 2:this.shadowDiv.className="gradient";break;case 3:this.shadowDiv.className="gradient hard"}},o.prototype._onStateChanged=function(t,e){var i=this;switch(this._applyPreloaderVisibility(),t){case o.STATES.LOADED:this.content&&this.content.length&&h["default"].each(this.content,function(t){i.addContentElement(t)}),this._applyBackgroundImages()}},o.prototype._applyPreloaderVisibility=function(){if(!this.destructed){f["default"].clear(this.preloader),this.preloaderBackground=f["default"].createElement("div",{},this.preloader),this.preloaderAnimation=f["default"].createElement("div",{},this.preloaderBackground);var t=this.presenter.pageResources[0].preloaderHack?o.STATES.LOADING:this.state;switch(t){case o.STATES.ERROR:f["default"].removeClass(this.preloaderBackground,"loading-bg"),f["default"].removeClass(this.preloaderAnimation,"loading"),f["default"].removeClass(this.preloaderBackground,"unready-bg");var e=this._calculateLuma(this._parseColor(this.pageBackgroundColor));f["default"].css(this.backgroundContainer,{"background-image":"none",filter:"none"}),this.textLayer.removeAttribute("src"),this.backgroundLayer.removeAttribute("src"),this.preloaderTitle=f["default"].createElement("div",{"class":e<.5?"error-title-light":"error-title-dark"},this.preloader),this.preloaderTitle.innerText=(0,m["default"])().get(m["default"].LOCALE).get("Other.PAGE_ERROR_TITLE"),this.preloaderText=f["default"].createElement("div",{"class":e<.5?"error-text-light":"error-text-dark"},this.preloader),this.preloaderText.innerText=(0,m["default"])().get(m["default"].LOCALE).get("Other.PAGE_ERROR_MESSAGE"),f["default"].addClass(this.preloaderBackground,"error");break;case o.STATES.LOADING:f["default"].css(this.preloader,{display:"block"}),f["default"].addClass(this.preloaderBackground,"loading-bg"),f["default"].addClass(this.preloaderAnimation,"loading");break;case o.STATES.UNREADY:f["default"].css(this.preloader,{display:"block"}),f["default"].addClass(this.preloaderBackground,"unready-bg");var e=this._calculateLuma(this._parseColor(this.pageBackgroundColor));this.preloaderText=f["default"].createElement("div",{"class":e<.5?"unready-text-light":"unready-text-dark"},this.preloader),this.preloaderText.innerText=(0,m["default"])().get(m["default"].LOCALE).get("Other.CONVERTING_PAGE");break;default:f["default"].css(this.preloader,{display:"none"})}}},o.prototype.setPreloaderImage=function(t){!t||this.state!==o.STATES.LOADING&&this.state!==o.STATES.IDLE||(f["default"].css(this.backgroundLayer,{filter:"blur(2px)"}),this.backgroundLayer.src=t)},o.prototype._applyHQImages=function(){function t(t,e){(0,m["default"])().get(m["default"].API).trigger("develop",{action:"img-scale",data:t+(e?", length: "+e:"")})}function e(e,i,n,o){s.destructed||(n.setAttribute("data-hq","1"),o.resize(e,i,{unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:166,quality:3,alpha:!0}).then(function(o){if(!s.destructed){e=null,i=null,n.onload=function(){n.onload=null,o=null};var r=window.MSInputMethodContext&&document.documentMode?1e4:6500;if("wideLeft"===s.mode)for(var a=document.querySelectorAll('[data-src="'+n.getAttribute("data-src")+'"]'),l=0,d=a.length;l<d;l++){var h=o.toDataURL();h.length>r?a[l].src=h:t("error",h.length),h=null}else{var u=o.toDataURL();u.length>r?n.src=u:t("error",u.length),u=null}}}))}if(this.presenter.isActive){var i=this.backgroundImages.length>1&&this.backgroundImages[1].indexOf(".svg")===-1,n=i?this.textLayer:this.backgroundLayer;if("wideRight"!==this.mode&&"1"!==n.getAttribute("data-hq")&&"Promise"in window&&!this.isZoomed&&"firefox"!==this.presenter.model._bookModel.browser.name.toLowerCase()){var o,r,a=n.getBoundingClientRect(),s=this,l=f["default"].createElement("canvas",{styles:{transform:"translateZ(0)"}}),d=f["default"].createElement("canvas",{styles:{transform:"translateZ(0)"}}),s=this;d.width=a.width,d.height=a.height,o=new Image,s.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.onload=function(){s.destructed||(i?(r=new Image,s.crossOrigin&&(r.crossOrigin=s.crossOrigin),r.onload=function(){if(!s.destructed){var t=l.getContext("2d");l.width=r.width,l.height=r.height,t.drawImage(o,0,0,r.width,r.height),t.drawImage(r,0,0,r.width,r.height),e(l,d,n,w["default"]),r=null,o=null}},r.src=s.backgroundImages[1]):(e(o,d,n,w["default"]),o=null))},o.src=this.backgroundImages[0]}}},o.prototype._applyBackgroundImages=function(){this.backgroundLayer.getAttribute("data-src")!==this.backgroundImages[0]&&("firefox"===this.presenter.model._bookModel.browser.name.toLowerCase()&&(this.backgroundLayer.src=this.backgroundImages[0]),this.backgroundLayer.src=this.backgroundImages[0],this.backgroundLayer.setAttribute("data-src",this.backgroundImages[0]),this.backgroundLayer.setAttribute("data-hq","0")),this.backgroundImages.length>1&&this.textLayer.getAttribute("data-src")!==this.backgroundImages[1]&&(this.textLayer.src=this.backgroundImages[1],this.textLayer.setAttribute("data-src",this.backgroundImages[1]),this.textLayer.parentNode||this.backgroundContainer.appendChild(this.textLayer)),h["default"].delay(h["default"].bind(function(){f["default"].css(this.backgroundLayer,{filter:"none"})},this),100)},o.prototype.setState=function(t){this.set("state",t)},o.prototype.setBackgroundImages=function(t){this.backgroundImages=h["default"].filter(t,function(t){return t}),this.state===o.STATES.LOADED&&this._applyBackgroundImages()},o.prototype.getDOMElement=function(){return this.parentObject},o.prototype.addContentElement=function(t){t.setBorderHolder&&t.setBorderHolder(this.parentObject),this.contentContainer.appendChild(t.getDOMElement()),t.commit()},o.prototype.clearContentView=function(){this.contentContainer.innerHTML=""},o.prototype.clearSearchView=function(){this.searchContainer.innerHTML=""},o.prototype.addSearchViews=function(t){var e=this;h["default"].each(t,function(t){e.searchContainer.appendChild(t)})},o.prototype.updateBackgroundColor=function(t){this.parentObject.style.backgroundColor=t},o.prototype.resize=function(t){var e=this.pageWidth;switch(this.mode){case"wideLeft":case"wideRight":e/=2}var i,n,o;if("fit"===this.fillMode)switch(i=c["default"].fitScreenSizes(e,this.pageHeight,t.width,t.height),Math.abs(i.paddingLeft)<1&&Math.abs(i.paddingTop)<1&&(i=c["default"].fillScreenSizes(e,this.pageHeight,t.width,t.height),this.backgroundContainer.style["background-size"]="cover"),n=(t.width-i.width)/2,o=(t.height-i.height)/2,this.mode){case"wideLeft":n*=2;break;case"wideRight":n=0}else i=t,n=o=0;var r=t.width/t.height,a=this.pageWidth/this.pageHeight;switch(this.mode){case"wideLeft":case"wideRight":a/=2}var s=r>a?r/a:a/r,l=r>a?(t.height/s-t.height)/2:0,d=0;switch(this.mode){case"wideLeft":r<a?d=-(t.width-t.width/s)/2:r>a&&(d=(t.width-t.width/s)/2);break;case"wideRight":r!==a&&(d=(t.width-t.width/s)/2);break;default:r>a&&(d=(t.width-t.width/s)/2)}var h="fit"===this.fillMode?"scale(1) translateX(0px) translateY(0px)":"scale("+s+") translateX("+d+"px) translateY("+l+"px)";this.contentContainer.style.transform=h,this.searchContainer.style.transform=h,this.presenter.sendContentSizeThr1("bookPage"),f["default"].css(this.container,{width:Math.floor(i.width)+"px",height:Math.floor(i.height)+"px","margin-left":n.toFixed(0)+"px","margin-top":o.toFixed(0)+"px"})},o.prototype._onDoubleTap=function(t){var e=this.container.getBoundingClientRect(),i={x:t.center.x-e.left,y:t.center.y-e.top};this.presenter.requestNavigation("zoom",{center:i}),t.preventDefault()},o.STATES={IDLE:"idle",UNREADY:"unready",LOADING:"loading",LOADED:"loaded",ERROR:"error"},(0,y["default"])(),e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(64),r=n(o);e["default"]="Promise"in window?new r["default"]:function(){return!1}},function(t,e,i){"use strict";var n,o,r,a,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(i){if("object"===s(e)&&"undefined"!=typeof t)t.exports=i();else{o=[],n=i,r="function"==typeof n?n.apply(e,o):n,!(void 0!==r&&(t.exports=r))}}(function(){return function(){function t(e,i,n){function o(s,l){if(!i[s]){if(!e[s]){var d="function"==typeof a&&a;if(!l&&d)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){var i=e[s][1][t];return o(i||t)},u,u.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof a&&a,s=0;s<n.length;s++)o(n[s]);return o}return t}()({1:[function(t,e,i){function n(t){var e=t||[],i={js:e.indexOf("js")>=0,wasm:e.indexOf("wasm")>=0};r.call(this,i),this.features={js:i.js,wasm:i.wasm&&this.has_wasm},this.use(a),this.use(s)}var o=t("inherits"),r=t("multimath"),a=t("multimath/lib/unsharp_mask"),s=t("./mm_resize");o(n,r),n.prototype.resizeAndUnsharp=function(t,e){var i=this.resize(t,e);return t.unsharpAmount&&this.unsharp_mask(i,t.toWidth,t.toHeight,t.unsharpAmount,t.unsharpRadius,t.unsharpThreshold),i},e.exports=n},{"./mm_resize":4,inherits:15,multimath:16,"multimath/lib/unsharp_mask":19}],2:[function(t,e,i){function n(t){return t<0?0:t>255?255:t}function o(t,e,i,o,r,a){var s,l,d,h,u,c,p,f,g,m,v,y=0,b=0;for(g=0;g<o;g++){for(u=0,m=0;m<r;m++){for(c=a[u++],p=a[u++],f=y+4*c|0,s=l=d=h=0;p>0;p--)v=a[u++],h=h+v*t[f+3]|0,d=d+v*t[f+2]|0,l=l+v*t[f+1]|0,s=s+v*t[f]|0,f=f+4|0;e[b+3]=n(h+8192>>14),e[b+2]=n(d+8192>>14),e[b+1]=n(l+8192>>14),e[b]=n(s+8192>>14),b=b+4*o|0}b=4*(g+1)|0,y=(g+1)*i*4|0}}function r(t,e,i,o,r,a){var s,l,d,h,u,c,p,f,g,m,v,y=0,b=0;for(g=0;g<o;g++){for(u=0,m=0;m<r;m++){for(c=a[u++],p=a[u++],f=y+4*c|0,s=l=d=h=0;p>0;p--)v=a[u++],h=h+v*t[f+3]|0,d=d+v*t[f+2]|0,l=l+v*t[f+1]|0,s=s+v*t[f]|0,f=f+4|0;e[b+3]=n(h+8192>>14),e[b+2]=n(d+8192>>14),e[b+1]=n(l+8192>>14),e[b]=n(s+8192>>14),b=b+4*o|0}b=4*(g+1)|0,y=(g+1)*i*4|0}}e.exports={convolveHorizontally:o,convolveVertically:r}},{}],3:[function(t,e,i){e.exports="AGFzbQEAAAABFAJgBn9/f39/fwBgB39/f39/f38AAg8BA2VudgZtZW1vcnkCAAEDAwIAAQQEAXAAAAcZAghjb252b2x2ZQAACmNvbnZvbHZlSFYAAQkBAArmAwLBAwEQfwJAIANFDQAgBEUNACAFQQRqIRVBACEMQQAhDQNAIA0hDkEAIRFBACEHA0AgB0ECaiESAn8gBSAHQQF0IgdqIgZBAmouAQAiEwRAQQAhCEEAIBNrIRQgFSAHaiEPIAAgDCAGLgEAakECdGohEEEAIQlBACEKQQAhCwNAIBAoAgAiB0EYdiAPLgEAIgZsIAtqIQsgB0H/AXEgBmwgCGohCCAHQRB2Qf8BcSAGbCAKaiEKIAdBCHZB/wFxIAZsIAlqIQkgD0ECaiEPIBBBBGohECAUQQFqIhQNAAsgEiATagwBC0EAIQtBACEKQQAhCUEAIQggEgshByABIA5BAnRqIApBgMAAakEOdSIGQf8BIAZB/wFIG0EQdEGAgPwHcUEAIAZBAEobIAtBgMAAakEOdSIGQf8BIAZB/wFIG0EYdEEAIAZBAEobciAJQYDAAGpBDnUiBkH/ASAGQf8BSBtBCHRBgP4DcUEAIAZBAEobciAIQYDAAGpBDnUiBkH/ASAGQf8BSBtB/wFxQQAgBkEAShtyNgIAIA4gA2ohDiARQQFqIhEgBEcNAAsgDCACaiEMIA1BAWoiDSADRw0ACwsLIQACQEEAIAIgAyAEIAUgABAAIAJBACAEIAUgBiABEAALCw=="},{}],4:[function(t,e,i){e.exports={name:"resize",fn:t("./resize"),wasm_fn:t("./resize_wasm"),wasm_src:t("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(t,e,i){function n(t,e,i){for(var n=3,o=e*i*4|0;n<o;)t[n]=255,n=n+4|0}var o=t("./resize_filter_gen"),r=t("./convolve").convolveHorizontally,a=t("./convolve").convolveVertically;e.exports=function(t){var e=t.src,i=t.width,s=t.height,l=t.toWidth,d=t.toHeight,h=t.scaleX||t.toWidth/t.width,u=t.scaleY||t.toHeight/t.height,c=t.offsetX||0,p=t.offsetY||0,f=t.dest||new Uint8Array(l*d*4),g="undefined"==typeof t.quality?3:t.quality,m=t.alpha||!1,v=o(g,i,l,h,c),y=o(g,s,d,u,p),b=new Uint8Array(l*s*4);return r(e,b,i,s,l,v),a(b,f,s,l,d,y),m||n(f,l,d),f}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(t,e,i){function n(t){return Math.round(t*((1<<r)-1))}var o=t("./resize_filter_info"),r=14;e.exports=function(t,e,i,r,a){var s,l,d,h,u,c,p,f,g,m,v,y,b,w,_,P,E,T=o[t].filter,C=1/r,A=Math.min(1,r),x=o[t].win/A,S=Math.floor(2*(x+1)),k=new Int16Array((S+2)*i),I=0,L=!k.subarray||!k.set;for(s=0;s<i;s++){for(l=(s+.5)*C+a,d=Math.max(0,Math.floor(l-x)),h=Math.min(e-1,Math.ceil(l+x)),u=h-d+1,c=new Float32Array(u),p=new Int16Array(u),f=0,g=d,m=0;g<=h;g++,m++)v=T((g+.5-l)*A),f+=v,c[m]=v;for(y=0,m=0;m<c.length;m++)b=c[m]/f,y+=b,p[m]=n(b);for(p[i>>1]+=n(1-y),w=0;w<p.length&&0===p[w];)w++;if(w<p.length){for(_=p.length-1;_>0&&0===p[_];)_--;if(P=d+w,E=_-w+1,k[I++]=P,k[I++]=E,L)for(m=w;m<=_;m++)k[I++]=p[m];else k.set(p.subarray(w,_+1),I),I+=E}else k[I++]=0,k[I++]=0}return k}},{"./resize_filter_info":7}],7:[function(t,e,i){e.exports=[{win:.5,filter:function(t){return t>=-.5&&t<.5?1:0}},{win:1,filter:function(t){if(t<=-1||t>=1)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*(.54+.46*Math.cos(e/1))}},{win:2,filter:function(t){if(t<=-2||t>=2)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/2)/(e/2)}},{win:3,filter:function(t){if(t<=-3||t>=3)return 0;if(t>-1.1920929e-7&&t<1.1920929e-7)return 1;var e=t*Math.PI;return Math.sin(e)/e*Math.sin(e/3)/(e/3)}}]},{}],8:[function(t,e,i){function n(t,e,i){for(var n=3,o=e*i*4|0;n<o;)t[n]=255,n=n+4|0}function o(t){return new Uint8Array(t.buffer,0,t.byteLength)}function r(t,e,i){if(s)return void e.set(o(t),i);for(var n=i,r=0;r<t.length;r++){var a=t[r];e[n++]=255&a,e[n++]=a>>8&255}}var a=t("./resize_filter_gen"),s=!0;try{s=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(l){}e.exports=function(t){var e=t.src,i=t.width,o=t.height,s=t.toWidth,l=t.toHeight,d=t.scaleX||t.toWidth/t.width,h=t.scaleY||t.toHeight/t.height,u=t.offsetX||0,c=t.offsetY||0,p=t.dest||new Uint8Array(s*l*4),f="undefined"==typeof t.quality?3:t.quality,g=t.alpha||!1,m=a(f,i,s,d,u),v=a(f,o,l,h,c),y=0,b=this.__align(y+Math.max(e.byteLength,p.byteLength)),w=this.__align(b+o*s*4),_=this.__align(w+m.byteLength),P=_+v.byteLength,E=this.__instance("resize",P),T=new Uint8Array(this.__memory.buffer),C=new Uint32Array(this.__memory.buffer),A=new Uint32Array(e.buffer);C.set(A),r(m,T,w),r(v,T,_);var x=E.exports.convolveHV||E.exports._convolveHV;x(w,_,b,i,o,s,l);var S=new Uint32Array(p.buffer);return S.set(new Uint32Array(this.__memory.buffer,0,l*s)),g||n(p,s,l),p}},{"./resize_filter_gen":6}],9:[function(t,e,i){function n(t,e){this.create=t,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=e||2e3}var o=100;n.prototype.acquire=function(){var t,e=this;return 0!==this.available.length?t=this.available.pop():(t=this.create(),t.id=this.lastId++,t.release=function(){return e.release(t)}),this.acquired[t.id]=t,t},n.prototype.release=function(t){var e=this;delete this.acquired[t.id],t.lastUsed=Date.now(),this.available.push(t),0===this.timeoutId&&(this.timeoutId=setTimeout(function(){return e.gc()},o))},n.prototype.gc=function(){var t=this,e=Date.now();this.available=this.available.filter(function(i){return!(e-i.lastUsed>t.idle)||(i.destroy(),!1)}),0!==this.available.length?this.timeoutId=setTimeout(function(){return t.gc()},o):this.timeoutId=0},e.exports=n},{}],10:[function(t,e,i){var n=2;e.exports=function(t,e,i,o,r,a){var s=i/t,l=o/e,d=(2*a+n+1)/r;if(d>.5)return[[i,o]];var h=Math.ceil(Math.log(Math.min(s,l))/Math.log(d));if(h<=1)return[[i,o]];for(var u=[],c=0;c<h;c++){var p=Math.round(Math.pow(Math.pow(t,h-c-1)*Math.pow(i,c+1),1/h)),f=Math.round(Math.pow(Math.pow(e,h-c-1)*Math.pow(o,c+1),1/h));u.push([p,f])}return u}},{}],11:[function(t,e,i){function n(t){var e=Math.round(t);return Math.abs(t-e)<r?e:Math.floor(t)}function o(t){var e=Math.round(t);return Math.abs(t-e)<r?e:Math.ceil(t)}var r=1e-5;e.exports=function(t){var e=t.toWidth/t.width,i=t.toHeight/t.height,r=n(t.srcTileSize*e)-2*t.destTileBorder,a=n(t.srcTileSize*i)-2*t.destTileBorder;if(r<1||a<1)throw new Error("Internal error in pica: target tile width/height is too small.");var s,l,d,h,u,c,p,f=[];for(h=0;h<t.toHeight;h+=a)for(d=0;d<t.toWidth;d+=r)s=d-t.destTileBorder,s<0&&(s=0),u=d+r+t.destTileBorder-s,s+u>=t.toWidth&&(u=t.toWidth-s),l=h-t.destTileBorder,l<0&&(l=0),c=h+a+t.destTileBorder-l,l+c>=t.toHeight&&(c=t.toHeight-l),p={toX:s,toY:l,toWidth:u,toHeight:c,toInnerX:d,toInnerY:h,toInnerWidth:r,toInnerHeight:a,offsetX:s/e-n(s/e),offsetY:l/i-n(l/i),scaleX:e,scaleY:i,x:n(s/e),y:n(l/i),width:o(u/e),height:o(c/i)},f.push(p);return f}},{}],12:[function(t,e,i){function n(t){return Object.prototype.toString.call(t)}e.exports.isCanvas=function(t){var e=n(t);return"[object HTMLCanvasElement]"===e||"[object Canvas]"===e},e.exports.isImage=function(t){return"[object HTMLImageElement]"===n(t)},e.exports.limiter=function(t){function e(){i<t&&n.length&&(i++,n.shift()())}var i=0,n=[];return function(t){return new Promise(function(o,r){n.push(function(){t().then(function(t){o(t),i--,e()},function(t){r(t),i--,e()})}),e()})}},e.exports.cib_quality_name=function(t){switch(t){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},e.exports.cib_support=function(){return Promise.resolve().then(function(){if("undefined"==typeof createImageBitmap||"undefined"==typeof document)return!1;var t=document.createElement("canvas");return t.width=100,t.height=100,createImageBitmap(t,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(e){var i=10===e.width;return e.close(),t=null,i})})["catch"](function(){return!1})}},{}],13:[function(t,e,i){e.exports=function(){var e,i=t("./mathlib");onmessage=function(t){var n=t.data.opts;e||(e=new i(t.data.features));var o=e.resizeAndUnsharp(n);postMessage({result:o},[o.buffer])}}},{"./mathlib":1}],14:[function(t,e,i){function n(t){t<.5&&(t=.5);var e=Math.exp(.527076)/t,i=Math.exp(-e),n=Math.exp(-2*e),o=(1-i)*(1-i)/(1+2*e*i-n);return a=o,s=o*(e-1)*i,l=o*(e+1)*i,d=-o*n,h=2*i,u=-n,c=(a+s)/(1-h-u),p=(l+d)/(1-h-u),new Float32Array([a,s,l,d,h,u,c,p])}function o(t,e,i,n,o,r){var a,s,l,d,h,u,c,p,f,g,m,v,y,b;for(f=0;f<r;f++){for(u=f*o,c=f,p=0,a=t[u],h=a*n[6],d=h,m=n[0],v=n[1],y=n[4],b=n[5],g=0;g<o;g++)s=t[u],l=s*m+a*v+d*y+h*b,h=d,d=l,a=s,i[p]=d,p++,u++;for(u--,p--,c+=r*(o-1),a=t[u],h=a*n[7],d=h,s=a,m=n[2],v=n[3],g=o-1;g>=0;g--)l=s*m+a*v+d*y+h*b,h=d,d=l,a=s,s=t[u],e[c]=i[p]+d,u--,p--,c-=r}}function r(t,e,i,r){if(r){var a=new Uint16Array(t.length),s=new Float32Array(Math.max(e,i)),l=n(r);o(t,a,s,l,e,i,r),o(a,t,s,l,i,e,r)}}var a,s,l,d,h,u,c,p;e.exports=r},{}],15:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],16:[function(t,e,i){function n(t){if(!(this instanceof n))return new n(t);var e=o({},s,t||{});if(this.options=e,this.__cache={},this.has_wasm=a(),this.__init_promise=null,this.__modules=e.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}var o=t("object-assign"),r=t("./lib/base64decode"),a=t("./lib/wa_detect"),s={js:!0,wasm:!0};n.prototype.use=function(t){return this.__modules[t.name]=t,this.has_wasm&&this.options.wasm&&t.wasm_fn?this[t.name]=t.wasm_fn:this[t.name]=t.fn,this},n.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm)return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var t=this;return this.__init_promise=Promise.all(Object.keys(t.__modules).map(function(e){var i=t.__modules[e];return t.has_wasm&&t.options.wasm&&i.wasm_fn?t.__wasm[e]?null:WebAssembly.compile(t.__base64decode(i.wasm_src)).then(function(i){t.__wasm[e]=i}):null})).then(function(){return t}),this.__init_promise},n.prototype.__base64decode=r,n.prototype.__reallocate=function(t){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(t/65536)}),this.__memory;var e=this.__memory.buffer.byteLength;return e<t&&this.__memory.grow(Math.ceil((t-e)/65536)),this.__memory},n.prototype.__instance=function(t,e,i){if(e&&this.__reallocate(e),!this.__wasm[t]){var n=this.__modules[t];this.__wasm[t]=new WebAssembly.Module(this.__base64decode(n.wasm_src))}if(!this.__cache[t]){var r={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[t]=new WebAssembly.Instance(this.__wasm[t],{env:o(r,i||{})})}return this.__cache[t]},n.prototype.__align=function(t,e){e=e||8;var i=t%e;return t+(i?e-i:0)},e.exports=n},{"./lib/base64decode":17,"./lib/wa_detect":23,"object-assign":24}],17:[function(t,e,i){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.exports=function(t){for(var e=t.replace(/[\r\n=]/g,""),i=e.length,o=new Uint8Array(3*i>>2),r=0,a=0,s=0;s<i;s++)s%4===0&&s&&(o[a++]=r>>16&255,o[a++]=r>>8&255,o[a++]=255&r),r=r<<6|n.indexOf(e.charAt(s));var l=i%4*6;return 0===l?(o[a++]=r>>16&255,o[a++]=r>>8&255,o[a++]=255&r):18===l?(o[a++]=r>>10&255,o[a++]=r>>2&255):12===l&&(o[a++]=r>>4&255),o}},{}],18:[function(t,e,i){e.exports=function(t,e,i){for(var n,o,r,a,s,l=e*i,d=new Uint16Array(l),h=0;h<l;h++)n=t[4*h],o=t[4*h+1],r=t[4*h+2],s=n>=o&&n>=r?n:o>=r&&o>=n?o:r,a=n<=o&&n<=r?n:o<=r&&o<=n?o:r,d[h]=257*(s+a)>>1;return d}},{}],19:[function(t,e,i){e.exports={name:"unsharp_mask",fn:t("./unsharp_mask"),wasm_fn:t("./unsharp_mask_wasm"),wasm_src:t("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":20,"./unsharp_mask_wasm":21,"./unsharp_mask_wasm_base64":22}],20:[function(t,e,i){var n=t("glur/mono16"),o=t("./hsl_l16");e.exports=function(t,e,i,r,a,s){var l,d,h,u,c,p,f,g,m,v,y,b,w;if(!(0===r||a<.5)){a>2&&(a=2);var _=o(t,e,i),P=new Uint16Array(_);n(P,e,i,a);for(var E=r/100*4096+.5|0,T=257*s|0,C=e*i,A=0;A<C;A++)b=2*(_[A]-P[A]),Math.abs(b)>=T&&(w=4*A,l=t[w],d=t[w+1],h=t[w+2],g=l>=d&&l>=h?l:d>=l&&d>=h?d:h,f=l<=d&&l<=h?l:d<=l&&d<=h?d:h,p=257*(g+f)>>1,f===g?u=c=0:(c=p<=32767?4095*(g-f)/(g+f)|0:4095*(g-f)/(510-g-f)|0,u=l===g?65535*(d-h)/(6*(g-f))|0:d===g?21845+(65535*(h-l)/(6*(g-f))|0):43690+(65535*(l-d)/(6*(g-f))|0)),p+=E*b+2048>>12,p>65535?p=65535:p<0&&(p=0),0===c?l=d=h=p>>8:(v=p<=32767?p*(4096+c)+2048>>12:p+((65535-p)*c+2048>>12),m=2*p-v>>8,v>>=8,y=u+21845&65535,l=y>=43690?m:y>=32767?m+(6*(v-m)*(43690-y)+32768>>16):y>=10922?v:m+(6*(v-m)*y+32768>>16),y=65535&u,d=y>=43690?m:y>=32767?m+(6*(v-m)*(43690-y)+32768>>16):y>=10922?v:m+(6*(v-m)*y+32768>>16),y=u-21845&65535,h=y>=43690?m:y>=32767?m+(6*(v-m)*(43690-y)+32768>>16):y>=10922?v:m+(6*(v-m)*y+32768>>16)),t[w]=l,t[w+1]=d,t[w+2]=h)}}},{"./hsl_l16":18,"glur/mono16":14}],21:[function(t,e,i){e.exports=function(t,e,i,n,o,r){if(!(0===n||o<.5)){o>2&&(o=2);var a=e*i,s=4*a,l=2*a,d=2*a,h=4*Math.max(e,i),u=32,c=0,p=s,f=p+l,g=f+d,m=g+d,v=m+h,y=this.__instance("unsharp_mask",s+l+2*d+h+u,{exp:Math.exp}),b=new Uint32Array(t.buffer),w=new Uint32Array(this.__memory.buffer);w.set(b);var _=y.exports.hsl_l16||y.exports._hsl_l16;_(c,p,e,i),_=y.exports.blurMono16||y.exports._blurMono16,_(p,f,g,m,v,e,i,o),_=y.exports.unsharp||y.exports._unsharp,_(c,c,p,f,e,i,n,r),b.set(new Uint32Array(this.__memory.buffer,0,a))}}},{}],22:[function(t,e,i){e.exports="AGFzbQEAAAABMQZgAXwBfGACfX8AYAZ/f39/f38AYAh/f39/f39/fQBgBH9/f38AYAh/f39/f39/fwACGQIDZW52A2V4cAAAA2VudgZtZW1vcnkCAAEDBgUBAgMEBQQEAXAAAAdMBRZfX2J1aWxkX2dhdXNzaWFuX2NvZWZzAAEOX19nYXVzczE2X2xpbmUAAgpibHVyTW9ubzE2AAMHaHNsX2wxNgAEB3Vuc2hhcnAABQkBAAqJEAXZAQEGfAJAIAFE24a6Q4Ia+z8gALujIgOaEAAiBCAEoCIGtjgCECABIANEAAAAAAAAAMCiEAAiBbaMOAIUIAFEAAAAAAAA8D8gBKEiAiACoiAEIAMgA6CiRAAAAAAAAPA/oCAFoaMiArY4AgAgASAEIANEAAAAAAAA8L+gIAKioiIHtjgCBCABIAQgA0QAAAAAAADwP6AgAqKiIgO2OAIIIAEgBSACoiIEtow4AgwgASACIAegIAVEAAAAAAAA8D8gBqGgIgKjtjgCGCABIAMgBKEgAqO2OAIcCwu3AwMDfwR9CHwCQCADKgIUIQkgAyoCECEKIAMqAgwhCyADKgIIIQwCQCAEQX9qIgdBAEgiCA0AIAIgAC8BALgiDSADKgIYu6IiDiAJuyIQoiAOIAq7IhGiIA0gAyoCBLsiEqIgAyoCALsiEyANoqCgoCIPtjgCACACQQRqIQIgAEECaiEAIAdFDQAgBCEGA0AgAiAOIBCiIA8iDiARoiANIBKiIBMgAC8BALgiDaKgoKAiD7Y4AgAgAkEEaiECIABBAmohACAGQX9qIgZBAUoNAAsLAkAgCA0AIAEgByAFbEEBdGogAEF+ai8BACIIuCINIAu7IhGiIA0gDLsiEqKgIA0gAyoCHLuiIg4gCrsiE6KgIA4gCbsiFKKgIg8gAkF8aioCALugqzsBACAHRQ0AIAJBeGohAiAAQXxqIQBBACAFQQF0ayEHIAEgBSAEQQF0QXxqbGohBgNAIAghAyAALwEAIQggBiANIBGiIAO4Ig0gEqKgIA8iECAToqAgDiAUoqAiDyACKgIAu6CrOwEAIAYgB2ohBiAAQX5qIQAgAkF8aiECIBAhDiAEQX9qIgRBAUoNAAsLCwvfAgIDfwZ8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIgyaEAAiDSANoCIPtjgCECAEIAxEAAAAAAAAAMCiEAAiDraMOAIUIAREAAAAAAAA8D8gDaEiCyALoiANIAwgDKCiRAAAAAAAAPA/oCAOoaMiC7Y4AgAgBCANIAxEAAAAAAAA8L+gIAuioiIQtjgCBCAEIA0gDEQAAAAAAADwP6AgC6KiIgy2OAIIIAQgDiALoiINtow4AgwgBCALIBCgIA5EAAAAAAAA8D8gD6GgIgujtjgCGCAEIAwgDaEgC6O2OAIcIAYEQCAFQQF0IQogBiEJIAIhCANAIAAgCCADIAQgBSAGEAIgACAKaiEAIAhBAmohCCAJQX9qIgkNAAsLIAVFDQAgBkEBdCEIIAUhAANAIAIgASADIAQgBiAFEAIgAiAIaiECIAFBAmohASAAQX9qIgANAAsLC7wBAQV/IAMgAmwiAwRAQQAgA2shBgNAIAAoAgAiBEEIdiIHQf8BcSECAn8gBEH/AXEiAyAEQRB2IgRB/wFxIgVPBEAgAyIIIAMgAk8NARoLIAQgBCAHIAIgA0kbIAIgBUkbQf8BcQshCAJAIAMgAk0EQCADIAVNDQELIAQgByAEIAMgAk8bIAIgBUsbQf8BcSEDCyAAQQRqIQAgASADIAhqQYECbEEBdjsBACABQQJqIQEgBkEBaiIGDQALCwvTBgEKfwJAIAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6CqIQ0gBSAEbCILBEAgB0GBAmwhDgNAQQAgAi8BACADLwEAayIGQQF0IgdrIAcgBkEASBsgDk8EQCAAQQJqLQAAIQUCfyAALQAAIgYgAEEBai0AACIESSIJRQRAIAYiCCAGIAVPDQEaCyAFIAUgBCAEIAVJGyAGIARLGwshCAJ/IAYgBE0EQCAGIgogBiAFTQ0BGgsgBSAFIAQgBCAFSxsgCRsLIgogCGoiD0GBAmwiEEEBdiERQQAhDAJ/QQAiCSAIIApGDQAaIAggCmsiCUH/H2wgD0H+AyAIayAKayAQQYCABEkbbSEMIAYgCEYEQCAEIAVrQf//A2wgCUEGbG0MAQsgBSAGayAGIARrIAQgCEYiBhtB//8DbCAJQQZsbUHVqgFBqtUCIAYbagshCSARIAcgDWxBgBBqQQx1aiIGQQAgBkEAShsiBkH//wMgBkH//wNIGyEGAkACfwJAIAxB//8DcSIFBEAgBkH//wFKDQEgBUGAIGogBmxBgBBqQQx2DAILIAZBCHYiBiEFIAYhBAwCCyAFIAZB//8Dc2xBgBBqQQx2IAZqCyIFQQh2IQcgBkEBdCAFa0EIdiIGIQQCQCAJQdWqAWpB//8DcSIFQanVAksNACAFQf//AU8EQEGq1QIgBWsgByAGa2xBBmxBgIACakEQdiAGaiEEDAELIAchBCAFQanVAEsNACAFIAcgBmtsQQZsQYCAAmpBEHYgBmohBAsCfyAGIgUgCUH//wNxIghBqdUCSw0AGkGq1QIgCGsgByAGa2xBBmxBgIACakEQdiAGaiAIQf//AU8NABogByIFIAhBqdUASw0AGiAIIAcgBmtsQQZsQYCAAmpBEHYgBmoLIQUgCUGr1QJqQf//A3EiCEGp1QJLDQAgCEH//wFPBEBBqtUCIAhrIAcgBmtsQQZsQYCAAmpBEHYgBmohBgwBCyAIQanVAEsEQCAHIQYMAQsgCCAHIAZrbEEGbEGAgAJqQRB2IAZqIQYLIAEgBDoAACABQQFqIAU6AAAgAUECaiAGOgAACyADQQJqIQMgAkECaiECIABBBGohACABQQRqIQEgC0F/aiILDQALCwsL"},{}],23:[function(t,e,i){var n;e.exports=function(){if("undefined"!=typeof n)return n;if(n=!1,"undefined"==typeof WebAssembly)return n;try{var t=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),e=new WebAssembly.Module(t),i=new WebAssembly.Instance(e,{});return 0!==i.exports.test(4)&&(n=!0),n}catch(o){}return n}},{}],24:[function(t,e,i){function n(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function o(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==n.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(r){return!1}}var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=o()?Object.assign:function(t,e){for(var i,o,l=n(t),d=1;d<arguments.length;d++){i=Object(arguments[d]);for(var h in i)a.call(i,h)&&(l[h]=i[h]);if(r){o=r(i);for(var u=0;u<o.length;u++)s.call(i,o[u])&&(l[o[u]]=i[o[u]])}}return l}},{}],25:[function(t,e,i){var n=arguments[3],o=arguments[4],r=arguments[5],a=JSON.stringify;e.exports=function(t,e){function i(t){m[t]=!0;for(var e in o[t][1]){var n=o[t][1][e];m[n]||i(n)}}for(var s,l=Object.keys(r),d=0,h=l.length;d<h;d++){var u=l[d],c=r[u].exports;if(c===t||c&&c["default"]===t){s=u;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var p={},d=0,h=l.length;d<h;d++){var u=l[d];p[u]=u}o[s]=["function(require,module,exports){"+t+"(self); }",p]}var f=Math.floor(Math.pow(16,8)*Math.random()).toString(16),g={};g[s]=s,o[f]=["function(require,module,exports){var f = require("+a(s)+");(f.default ? f.default : f)(self);}",g];var m={};i(f);var v="("+n+")({"+Object.keys(m).map(function(t){return a(t)+":["+o[t][0]+","+a(o[t][1])+"]"}).join(",")+"},{},["+a(f)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([v],{type:"text/javascript"});if(e&&e.bare)return b;var w=y.createObjectURL(b),_=new Worker(w);return _.objectURL=w,_}},{}],"/":[function(t,e,i){function n(t,e){return a(t)||r(t,e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(l){o=!0,r=l}finally{try{n||null==s["return"]||s["return"]()}finally{if(o)throw r}}return i}function a(t){if(Array.isArray(t))return t}function s(){return{value:h(f),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var t=window.URL||window.webkitURL||window.mozURL||window.msURL;t&&t.revokeObjectURL&&this.value.objectURL&&t.revokeObjectURL(this.value.objectURL)}}}}function l(t){if(!(this instanceof l))return new l(t);this.options=d({},E,t||{});var e="lk_".concat(this.options.concurrency);this.__limit=v[e]||p.limiter(this.options.concurrency),v[e]||(v[e]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}var d=t("object-assign"),h=t("webworkify"),u=t("./lib/mathlib"),c=t("./lib/pool"),p=t("./lib/utils"),f=t("./lib/worker"),g=t("./lib/stepper"),m=t("./lib/tiler"),v={},y=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(y=navigator.userAgent.indexOf("Safari")>=0)}catch(b){}var w=1;"undefined"!=typeof navigator&&(w=Math.min(navigator.hardwareConcurrency||1,4));var _,P,E={tile:1024,concurrency:w,features:["js","wasm","ww"],idle:2e3},T={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0};l.prototype.init=function(){var e=this;if(this.__initPromise)return this.__initPromise;if(_!==!1&&_!==!0&&(_=!1,"undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray))try{new ImageData(new Uint8ClampedArray(400),10,10),_=!0}catch(i){}P!==!1&&P!==!0&&(P=!1,"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?P=!0:this.debug("ImageBitmap does not support .close(), disabled")));var n=this.options.features.slice();if(n.indexOf("all")>=0&&(n=["cib","wasm","js","ww"]),this.__requested_features=n,this.__mathlib=new u(n),n.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{var o=t("webworkify")(function(){});o.terminate(),this.features.ww=!0;var r="wp_".concat(JSON.stringify(this.options));
v[r]?this.__workersPool=v[r]:(this.__workersPool=new c(s,this.options.idle),v[r]=this.__workersPool)}catch(i){}var a,l=this.__mathlib.init().then(function(t){d(e.features,t.features)});return a=P?p.cib_support().then(function(t){return e.features.cib&&n.indexOf("cib")<0?void e.debug("createImageBitmap() resize supported, but disabled by config"):void(n.indexOf("cib")>=0&&(e.features.cib=t))}):Promise.resolve(!1),this.__initPromise=Promise.all([l,a]).then(function(){return e}),this.__initPromise},l.prototype.resize=function(t,e,i){var o=this;this.debug("Start resize...");var r=d({},T);if(isNaN(i)?i&&(r=d(r,i)):r=d(r,{quality:i}),r.toWidth=e.width,r.toHeight=e.height,r.width=t.naturalWidth||t.width,r.height=t.naturalHeight||t.height,0===e.width||0===e.height)return Promise.reject(new Error("Invalid output size: ".concat(e.width,"x").concat(e.height)));r.unsharpRadius>2&&(r.unsharpRadius=2);var a=!1,s=null;r.cancelToken&&(s=r.cancelToken.then(function(t){throw a=!0,t},function(t){throw a=!0,t}));var l=3,h=Math.ceil(Math.max(l,2.5*r.unsharpRadius|0));return this.init().then(function(){if(a)return s;if(o.features.cib){var i=e.getContext("2d",{alpha:Boolean(r.alpha)});return o.debug("Resize via createImageBitmap()"),createImageBitmap(t,{resizeWidth:r.toWidth,resizeHeight:r.toHeight,resizeQuality:p.cib_quality_name(r.quality)}).then(function(t){if(a)return s;if(!r.unsharpAmount)return i.drawImage(t,0,0),t.close(),i=null,o.debug("Finished!"),e;o.debug("Unsharp result");var n=document.createElement("canvas");n.width=r.toWidth,n.height=r.toHeight;var l=n.getContext("2d",{alpha:Boolean(r.alpha)});l.drawImage(t,0,0),t.close();var d=l.getImageData(0,0,r.toWidth,r.toHeight);return o.__mathlib.unsharp(d.data,r.toWidth,r.toHeight,r.unsharpAmount,r.unsharpRadius,r.unsharpThreshold),i.putImageData(d,0,0),d=l=n=i=null,o.debug("Finished!"),e})}var l={},u=function(t){return Promise.resolve().then(function(){return o.features.ww?new Promise(function(e,i){var n=o.__workersPool.acquire();s&&s["catch"](function(t){return i(t)}),n.value.onmessage=function(t){n.release(),t.data.err?i(t.data.err):e(t.data.result)},n.value.postMessage({opts:t,features:o.__requested_features,preload:{wasm_nodule:o.__mathlib.__}},[t.src.buffer])}):o.__mathlib.resizeAndUnsharp(t,l)})},c=function(t,e,i){var n,r,l,d=function(e){return o.__limit(function(){if(a)return s;var d;if(p.isCanvas(t))o.debug("Get tile pixel data"),d=n.getImageData(e.x,e.y,e.width,e.height);else{o.debug("Draw tile imageBitmap/image to temporary canvas");var h=document.createElement("canvas");h.width=e.width,h.height=e.height;var c=h.getContext("2d",{alpha:Boolean(i.alpha)});c.globalCompositeOperation="copy",c.drawImage(r||t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),o.debug("Get tile pixel data"),d=c.getImageData(0,0,e.width,e.height),c=h=null}var f={src:d.data,width:e.width,height:e.height,toWidth:e.toWidth,toHeight:e.toHeight,scaleX:e.scaleX,scaleY:e.scaleY,offsetX:e.offsetX,offsetY:e.offsetY,quality:i.quality,alpha:i.alpha,unsharpAmount:i.unsharpAmount,unsharpRadius:i.unsharpRadius,unsharpThreshold:i.unsharpThreshold};return o.debug("Invoke resize math"),Promise.resolve().then(function(){return u(f)}).then(function(t){if(a)return s;d=null;var i;if(o.debug("Convert raw rgba tile result to ImageData"),_)i=new ImageData(new Uint8ClampedArray(t),e.toWidth,e.toHeight);else if(i=l.createImageData(e.toWidth,e.toHeight),i.data.set)i.data.set(t);else for(var n=i.data.length-1;n>=0;n--)i.data[n]=t[n];return o.debug("Draw tile"),y?l.putImageData(i,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth+1e-5,e.toInnerHeight+1e-5):l.putImageData(i,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth,e.toInnerHeight),null})})};return Promise.resolve().then(function(){if(l=e.getContext("2d",{alpha:Boolean(i.alpha)}),p.isCanvas(t))return n=t.getContext("2d",{alpha:Boolean(i.alpha)}),null;if(p.isImage(t))return P?(o.debug("Decode image via createImageBitmap"),createImageBitmap(t).then(function(t){r=t})):null;throw new Error('".from" should be image or canvas')}).then(function(){function t(){r&&(r.close(),r=null)}if(a)return s;o.debug("Calculate tiles");var n=m({width:i.width,height:i.height,srcTileSize:o.options.tile,toWidth:i.toWidth,toHeight:i.toHeight,destTileBorder:h}),l=n.map(function(t){return d(t)});return o.debug("Process tiles"),Promise.all(l).then(function(){return o.debug("Finished!"),t(),e},function(e){throw t(),e})})},f=function b(t,e,i,o){if(a)return s;var r=t.shift(),l=n(r,2),h=l[0],u=l[1],p=0===t.length;o=d({},o,{toWidth:h,toHeight:u,quality:p?o.quality:Math.min(1,o.quality)});var f;return p||(f=document.createElement("canvas"),f.width=h,f.height=u),c(e,p?i:f,o).then(function(){return p?i:(o.width=h,o.height=u,b(t,f,i,o))})},v=g(r.width,r.height,r.toWidth,r.toHeight,o.options.tile,h);return f(v,t,e,r)})},l.prototype.resizeBuffer=function(t){var e=this,i=d({},T,t);return this.init().then(function(){return e.__mathlib.resizeAndUnsharp(i)})},l.prototype.toBlob=function(t,e,i){return e=e||"image/png",new Promise(function(n){if(t.toBlob)return void t.toBlob(function(t){return n(t)},e,i);for(var o=atob(t.toDataURL(e,i).split(",")[1]),r=o.length,a=new Uint8Array(r),s=0;s<r;s++)a[s]=o.charCodeAt(s);n(new Blob([a],{type:e}))})},l.prototype.debug=function(){},e.exports=l},{"./lib/mathlib":1,"./lib/pool":9,"./lib/stepper":10,"./lib/tiler":11,"./lib/utils":12,"./lib/worker":13,"object-assign":24,webworkify:25}]},{},[])("/")})},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){l["default"].call(this,t),this.contentPresenter=e}Object.defineProperty(e,"__esModule",{value:!0});var r=i(66),a=n(r),s=i(14),l=n(s),d=i(0),h=n(d);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.init=function(){return this.view=new a["default"](this).init(this.getViewData()),this.model.isInternal()&&this.getLocaleProvider().onAndChange("change:AlertMessage.LINK_PAGE_TIP",this.onLinkCaptionChanged,this),this},o.prototype.getViewData=function(){return{title:this.model.getTitle(),target:this.model.getTarget(),color:this.model.getBackgroundColor(),zIndex:this.model.getZIndex(),angle:this.model.getAngle(),highlightOnHover:this.model.shouldBeHighlightedOnHover(),highlightOnFlip:this.model.shouldBeHighlightedOnFlip(),rect:this.model.getRect()}},o.prototype.onLinkTap=function(t){var e=this.model.getUrl();if(e.indexOf("fb-internal://")===-1){var i=this.getView().getDOMElement();i.href=this.model.getUrl(),this.getApiProvider().trigger("link",{type:"external",url:e,pageUrl:this.model.getUrlHeader(),target:t||this.model.getTarget(),source:null}),i.click(),i.removeAttribute("href")}else{var n=e.replace("fb-internal://","");this.getApiProvider().trigger("link",{type:"internal",pageToUrl:this.model.getUrlHeaderById(n),pageUrl:this.model.getUrlHeader(),source:"page"}),this.contentPresenter.requestNavigation("page",{pageId:n})}},o.prototype.onLinkCaptionChanged=function(){var t=this.getView().getDOMElement(),e=this.model.getTitle();h["default"].isEmpty(e)?t.hasAttribute("title")&&t.removeAttribute("title"):t.title=this.getLocaleProvider().get("AlertMessage.LINK_PAGE_TIP")+" "+e},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=this;c["default"].call(this,t),this.link=a["default"].createElement("a",{"class":"publication-link"});var i=this.presenter.model.getUrl();if(i.indexOf("fb-internal://")===-1){var n=function(t,i,n,o,r,a,s){e.contextMenu().addItem({name:(0,f["default"])().get(f["default"].LOCALE).get(i),event:t,icon:n,options:o,group:s,include:a},r)},o=function(t){this.presenter.onLinkTap("_blank")},r="OPEN_LINK_IN_NEW_TAB_EVENT";this.link.addEventListener("contextmenu",function(t){n(r,"RightClickMenu.OPEN_LINK_IN_NEW_TAB","icon-open-link",void 0,t,["link"],0)},!1),this.contextMenu().on(m["default"].HIDE_EVENT,function(){this.contextMenu().off(r,o,this)},this),this.contextMenu().on(m["default"].SHOW_EVENT,function(t){t.target===this.link&&this.contextMenu().on(r,o,this)},this)}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(10),l=n(s),d=i(0),h=n(d),u=i(13),c=n(u),p=i(2),f=n(p),g=i(12),m=n(g);o.prototype=new c["default"],o.prototype.constructor=o,o.prototype.init=function(t){var e={title:"",target:"_self",color:"#0000FF",zIndex:void 0,angle:void 0,highlightOnHover:!0,highlightOnFlip:!0,rect:{width:0,height:0,top:0,left:0},scale:1,offset:0};if(h["default"].extend(e,t),h["default"].isEmpty(e.title)?this.link.hasAttribute("title")&&this.link.removeAttribute("title"):this.link.title=e.title,this.link.target=e.target,this.link.style.backgroundColor=e.color,h["default"].isUndefined(e.zIndex)||(this.link.style.zIndex=e.zIndex),h["default"].isUndefined(e.angle)||(l["default"].origin(this.link,0,0),l["default"].rotate(this.link,e.angle+"rad",0,0,1,!0)),this.shouldHighlightOnHover=e.highlightOnHover,this.shouldHighlightOnFlip=e.highlightOnFlip,this.shouldHighlightOnHover)if(!this.presenter.model.crossWide||this.presenter.model.isZoomed)a["default"].addClass(this.link,"highlight-on-hover");else{var i=this,n=(0,f["default"])().get(f["default"].WIDE_HIGHLIGHTER),o=n.pushLink(this,this.presenter.model.pageNumber,this.presenter.model.id);o&&(this.reflection=o,o.reflection=this),this.link.onmouseover=function(){a["default"].addClass(i.link,"highlighted"),a["default"].addClass(i.reflection.link,"highlighted")},this.link.onmouseout=function(){a["default"].removeClass(i.link,"highlighted"),a["default"].removeClass(i.reflection.link,"highlighted")}}return this.rect=e.rect,this.scaleFactor=e.scale,this.offsetFactor=e.offset,this._place(this.scaleFactor,this.offsetFactor),this},o.prototype.destructor=function(){delete this.reflection},o.prototype.highlight=function(){},o.prototype.getDOMElement=function(){return this.link},o.prototype.scale=function(t){c["default"].prototype.scale.call(this,t),this._place()},o.prototype.offset=function(t){c["default"].prototype.offset.call(this,t),this._place()},o.prototype._place=function(){this.link.style.width=(this.rect.width*this.scaleFactor).toFixed(2)+"px",this.link.style.height=(this.rect.height*this.scaleFactor).toFixed(2)+"px",this.link.style.left=((this.rect.left+this.offsetFactor)*this.scaleFactor).toFixed(2)+"px",this.link.style.top=(this.rect.top*this.scaleFactor).toFixed(2)+"px"},o.prototype.contextMenu=function(){return(0,f["default"])().get(f["default"].CONTEXT_MENU)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.isAdding=e===!0,this.model=t,this.init()}Object.defineProperty(e,"__esModule",{value:!0});var r=i(14),a=n(r),s=i(68),l=n(s),d=i(17),h=n(d);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.init=function(){return this.view=new l["default"](this,this.model,this.isAdding),this.model.on("change:color",function(t){this.model.noteData.setDefaultColor(t)},this),this},o.prototype.save=function(){this.model.save(),delete this.isAdding},o.prototype.minimize=function(){this.save(),this.view.state!==l["default"].REMOVED_STATE&&this.view.set("state",l["default"].MINIMIZED_STATE)},o.prototype.remove=function(t){if("context-menu"===t&&this.model.note.text)return this.view.state===l["default"].MINIMIZED_STATE&&(this.view.set("state",l["default"].OPENED_STATE),(0,h["default"])().forceDialogHide()),void(0,h["default"])().showDeleteDialog();this.model.remove(),this.view.set("state",l["default"].REMOVED_STATE);var e={action:"remove",text:this.model.note.text,pageUrl:this.model.getUrlHeader(),initiator:t};this.getApiProvider().trigger("note",e)},o.prototype.setColor=function(t){this.model.setColor(t)},o.prototype.setState=function(t){this.model.setState(t)},o.prototype.setText=function(t){this.model.setText(t)},o.prototype.setPageId=function(t){this.model.setPageId(t)},o.prototype.toggleOffset=function(){this.hasOwnProperty("offsetForChangePage")&&(this.offsetForChangePage!==this.view.offsetFactor?this.view.offset(this.offsetForChangePage):this.view.offset(0))},o.prototype.setOffsetForChangePage=function(t){this.offsetForChangePage=t},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){function i(t,e,i,n,o){r.contextMenu().addItem({name:(0,u["default"])().get(u["default"].LOCALE).get(e),event:t,icon:i,options:n,group:0},o)}function n(t){this.hitCheck=!0,this.set("state",o.OPENED_STATE),(0,_["default"])().setState(_["default"].EDIT_STATE)}this.state=t.isAdding?o.OPENED_STATE:o.MINIMIZED_STATE,this.hitCheck=!0;var r=this;this.model=e,this.container=d["default"].createElement("div",{"class":"publication-note",styles:{zIndex:this.model.options.zIndex}}),this.iconBaseClass="note-icon icon icon-note-content";var a=this.getUserAgentInfo().browser;this.icon=d["default"].createElement("div",{"class":this.iconBaseClass,styles:{"will-change":a.safari?"opacity, transform":""}},this.container),e.note.id?(this.subscribeToNoteWindow(),this.setAttributes()):(e.once("change:id",this.subscribeToNoteWindow,this),e.once("change:id",this.setAttributes,this)),e.on("save",this.subscribeToNoteWindow,this),this.on("change:state",this.render,this),e.on("update",this.render,this),s["default"].call(this,t),this._calculateSizes(),this.init(e.note),this.render(),this.getNoteManager().on("clickOnIconItem",function(t){t.pageId===this.model.options.pageId&&this.model.note.id===t.noteId||this.presenter.minimize()},this);var l="DELETE_NOTE_EVENT",h="EDIT_NOTE_EVENT";this.container.addEventListener("contextmenu",function(t){switch(r.state){default:case o.REMOVED_STATE:case o.MOVING_STATE:break;case o.MINIMIZED_STATE:case o.OPENED_STATE:(0,_["default"])().getState()!==_["default"].EDIT_STATE&&i(h,"RightClickMenu.EDIT_NOTE","icon-edit-note",r.presenter,t),i(l,"RightClickMenu.DELETE_NOTE","icon-trash-can",{presenter:r.presenter,initiator:"context-menu"},t)}},!1),this.contextMenu().on(b["default"].HIDE_EVENT,function(){this.contextMenu().off(l,this.deleteNote,this),this.contextMenu().off(h,n,this)},this),this.contextMenu().on(b["default"].SHOW_EVENT,function(t){var e=t.target.getAttribute("page-id"),i=t.target.getAttribute("note-id");this.model.options.pageId==e&&i==this.model.note.id&&(this.contextMenu().on(l,this.deleteNote,this),this.contextMenu().on(h,n,this))},this),document.addEventListener("click",function(){r.hitCheck=!1},!1),this.container.addEventListener("click",function(t){r.hitCheck=!0},!0),this.presenter.on("change:isActive",function(t){r.state!==o.REMOVED_STATE&&r.set("state",o.MINIMIZED_STATE)},this),this.presenter.on("change:isActive",this.render,this),(0,_["default"])().on(_["default"].CHANGE_STATE_EVENT,this.onRectStateChanged,this);this.idsEventName(_["default"].CHANGE_TEXT_EVENT);(0,_["default"])().on(this.idsEventName(_["default"].CHANGE_TEXT_EVENT),this.setText,this),(0,_["default"])().on(this.idsEventName(_["default"].DELETE_EVENT),this.deleteNoteBubble,this)}function r(){function t(){setTimeout(function(){e.set("state",o.OPENED_STATE)},160),this.presenter.off("change:isActive",t,this)}var e=this;this.presenter.isActive?this.set("state",o.OPENED_STATE):this.presenter.on("change:isActive",t,this),this.hitCheck=!0}Object.defineProperty(e,"__esModule",{value:!0});var a=i(13),s=n(a),l=i(3),d=n(l),h=i(2),u=n(h),c=i(28),p=n(c),f=i(4),g=n(f),m=i(11),v=n(m),y=i(12),b=n(y),w=i(17),_=n(w);o.prototype=new s["default"],o.prototype.constructor=o,o.prototype.destructor=function(){(0,_["default"])().off(_["default"].CHANGE_STATE_EVENT,this.onRectStateChanged,this),(0,_["default"])().off(_["default"].CHANGE_COLOR_EVENT+(0,_["default"])().eventSuffix(this.ids()),this.setColor,this);var t=this.idsEventName(_["default"].CHANGE_TEXT_EVENT);(0,_["default"])().off(t,this.setText,this),(0,_["default"])().off(this.idsEventName(_["default"].DELETE_EVENT),this.deleteNoteBubble,this)},o.prototype.idsEventName=function(t){return t+(0,_["default"])().eventSuffix(this.ids())},o.prototype.onRectStateChanged=function(t){switch(t.state){case _["default"].VIEW_STATE:case _["default"].EDIT_STATE:break;case _["default"].CLOSE_STATE:this.state===o.OPENED_STATE&&this.set("state",o.MINIMIZED_STATE)}},o.prototype.deleteNoteBubble=function(){this.presenter.remove("bubble")},o.prototype.deleteNote=function(t){this.hitCheck=!0,t.presenter.remove(t.initiator)},o.prototype.setBorderHolder=function(t,e){this.borderHolder=t,this.neighbourHolder=e,this.render()},o.prototype.unsubscribeToNoteWindow=function(){this.getNoteManager().off("clickOnWindowItem:"+this.model.options.pageId+":"+this.model.note.id,r,this)},o.prototype.subscribeToNoteWindow=function(){this.getNoteManager().on("clickOnWindowItem:"+this.model.options.pageId+":"+this.model.note.id,r,this)},o.prototype.setAttributes=function(){this.icon&&(this.icon.setAttribute("page-id",this.model.options.pageId),this.icon.setAttribute("note-id",this.model.note.id))},o.prototype.ids=function(){return{noteId:this.model.note.id,pageId:this.model.pageId}},o.prototype.setColor=function(t){this.presenter.setColor(t)},o.prototype.setText=function(t){this.presenter.setText(t)},o.prototype.render=function(){var t=this;switch(this.state){default:case o.MINIMIZED_STATE:case o.REMOVED_STATE:case o.MOVING_STATE:(0,_["default"])().close(this.ids());break;case o.OPENED_STATE:var e={date:this.model.note.date,color:this.model.note.color,COLOR_LIST:p["default"].COLOR_LIST,text:this.model.note.text||"",direction:(0,u["default"])().get(u["default"].LOCALE).isLocaleRTL()?"rtl":"ltr",localization:{DELETE_TIP:this.getLocaleProvider().get("Notes.DELETE_TIP"),PLACEHOLDER:this.getLocaleProvider().get("Notes.PLACEHOLDER"),DIALOG_DELETE_TEXT:this.getLocaleProvider().get("Notes.DIALOG_DELETE_TEXT"),BUTTON_CANCEL:this.getLocaleProvider().get("AlertWindow.BUTTON_CANCEL"),BUTTON_DELETE:this.getLocaleProvider().get("AlertWindow.BUTTON_DELETE")},model:this.model};(0,_["default"])().open(e,this.ids()),this.noteRect=d["default"].id("note-rect"),this.noteRect?this.noteRect.addEventListener("click",function(){t.hitCheck=!0},!0):this.set("state",o.MINIMIZED_STATE),(0,_["default"])().on(_["default"].CHANGE_COLOR_EVENT+(0,_["default"])().eventSuffix(this.ids()),this.setColor,this)}this._calculateSizes();var i=this.iconBaseClass;switch(this.state){default:case o.REMOVED_STATE:i+=" removed";break;case o.MOVING_STATE:i+=" move";break;case o.MINIMIZED_STATE:i+=" mini";break;case o.OPENED_STATE:i+=" opened",this.setAttributes()}i+=" "+this.model.note.color,this.presenter.isActive||(i+=" removed"),this.icon.className=i,this._place()},o.prototype.init=function(){var t=this;return this.icon.addEventListener("mousedown",function(e){if(t.state!==o.REMOVED_STATE&&!window.FBPublication.moveLock){if(1!=e.which)return;window.FBPublication.moveLock=!0,e.stopImmediatePropagation();var i,n=e.pageX,r=e.pageY,a=!0,s=function(){a=!1,t.previousState=t.state,t.set("state",o.MOVING_STATE),t.move(n,r)};i=setTimeout(s,250);var l=function(e){e.stopImmediatePropagation(),n=e.pageX,r=e.pageY,a||t.move(n,r)},d=function(e){switch(t.state){case o.OPENED_STATE:t.presenter.save(),t.set("state",o.MINIMIZED_STATE);break;default:t.state===o.MINIMIZED_STATE?t.set("state",o.OPENED_STATE):t.set("state",o.MINIMIZED_STATE),t.hitCheck=!0,t.getNoteManager().clickOnIconItem(t.model.options.pageId,t.model.note.id)}},h=function u(e){if(e.stopImmediatePropagation(),document.removeEventListener("mousemove",l,!0),document.removeEventListener("mouseup",u),delete window.FBPublication.moveLock,clearTimeout(i),a)d(e);else switch(t.previousState){case o.MINIMIZED_STATE:default:t.set("state",t.previousState)}};document.addEventListener("mousemove",l,!0),document.addEventListener("mouseup",h)}},!0),this},o.prototype.getBorderHolder=function(){return this.container.parentNode&&this.container.parentNode.parentNode?this.container.parentNode.parentNode.parentNode:null},o.prototype.move=function(t,e){function i(t,e,i){return!(t<i.left)&&(!(e<i.top)&&(!(t>i.right)&&!(e>i.bottom)))}var n=this.getBorderHolder().getBoundingClientRect();if(!i(t,e,n)){var o=this.getNoteManager().containers;for(var r in o){var a=o[r];if(this.getBorderHolder()!==a.container&&i(t,e,a.container.getBoundingClientRect())){var s=a.container.getElementsByClassName("content-container");if(1===s.length){var l=s[0];l.appendChild(this.container),n=a.container.getBoundingClientRect(),this.presenter.toggleOffset();var d=this.idsEventName(_["default"].CHANGE_TEXT_EVENT);(0,_["default"])().off(this.idsEventName(_["default"].DELETE_EVENT),this.deleteNoteBubble,this),(0,_["default"])().off(d,this.setText,this),this.model.setIsRight(!this.model.isRight),this.presenter.setPageId(a.pageId);var h=this.idsEventName(_["default"].CHANGE_TEXT_EVENT);(0,_["default"])().on(h,this.setText,this),(0,_["default"])().on(this.idsEventName(_["default"].DELETE_EVENT),this.deleteNoteBubble,this)}}}}var u=g["default"].getBookSizes(this.model.bookSize,n,this.model.isZoomed,this.model.isWide,this.model.isRight),c={pX:Number(((t-n.left)/u.scales.scaleX+u.offset).toFixed(2)),pY:Number(((e-n.top)/u.scales.scaleY).toFixed(2))};this.model.setPosition(c)},o.prototype.getBookSizes=function(t,e,i,n,o){var r={bookSize:t,realSize:{width:e.right-e.left,height:e.bottom-e.top}};return i?(r.offset=0,n&&(r.realSize.width=r.realSize.width/2)):r.offset=n&&o?r.bookSize.width:0,r.scales={scaleX:r.realSize.width/r.bookSize.width,scaleY:r.realSize.height/r.bookSize.height},r},o.prototype.getDOMElement=function(){return this.container},o.prototype.commit=function(){this.render()},o.prototype._placeIcon=function(t){var e=g["default"].getBookSizes(this.model.bookSize,this.currentSize,this.model.isZoomed,this.model.isWide,this.model.isRight),i=Number(((this.model.note.pX-e.offset)*e.scales.scaleX).toFixed(2)),n=Number((this.model.note.pY*e.scales.scaleY).toFixed(2)),o=0,r=0,a=0,s=r+this.iconWidth/2,l=o+this.iconHeight/2,d=this.currentSize.width,h=this.currentSize.height,u={top:n,left:i,iconWidth:this.iconWidth,iconHeight:this.iconHeight,topShadow:o,sideShadow:r,bottomShadow:a};if(!(d>0&&h>0&&e.scales.scaleX>0&&e.scales.scaleY>0))return setTimeout(0,function(t){t._place()},this),null;if(i-s<0?i=0+s:i+s>d&&(i=d-s),n-l<0?n=0+l:n+l>h&&(n=h-l),!this.model.isZoomed&&this.presenter.isActive){var c=u.left+s>this.currentSize.width-100,p=u.left-s<100,f=u.top-l<100,m=u.top+l>this.currentSize.height-100;this.model.isRight?(c&&m||c&&f)&&(i=this.currentSize.width-100-s):(p&&m||p&&f)&&(i=100+s)}if(u.top=n,u.left=i,this.container.style.top=n+"px",this.container.style.left=i+"px",this.icon){var v={left:parseInt(this.container.parentNode.parentNode.style.marginLeft,10),top:parseInt(this.container.parentNode.parentNode.style.marginTop,10)};this.icon.style.left=Math.round(-s-v.left)+"px",this.icon.style.top=Math.round(-l-v.top)+"px"}return u},o.prototype._getAreaContainer=function(){var t=(0,u["default"])().get(u["default"].CURRENT_PRESENTER);return t.constructor===v["default"]?t.view.flipbook:t.view.currentWrapper?t.view.currentWrapper.content:null},o.prototype._placeArea=function(t,e){var i=this._getAreaContainer();if(i){var n=i.getBoundingClientRect(),o=n.right-n.left,r=n.bottom-n.top,a={x:e.left,y:e.top};a=g["default"].localToGlobal(t.getBoundingClientRect(),a),a=g["default"].globalToLocal(n,a);var s=0;a.x+this.areaWidth/2>o?s=o-(a.x+this.areaWidth/2):a.x-this.areaWidth/2<0&&(s=-(a.x-this.areaWidth/2));var l=a.y+e.iconHeight/2;a.y+e.iconHeight+this.areaHeight>r&&(l=a.y-e.iconHeight/2-this.areaHeight);var d={left:a.x-this.areaWidth/2+s,right:a.x+this.areaWidth/2+s,top:l,bottom:l+this.areaHeight};!this.model.isZoomed&&this.presenter.isActive&&(g["default"].isPointInsideRect({x:o-100,y:100},d)?d.left=o-100-this.areaWidth:g["default"].isPointInsideRect({x:o-100,y:r-100},d)?a.x>o-100?d.top=a.y-e.iconHeight/2-this.areaHeight-10:d.left=o-100-this.areaWidth:g["default"].isPointInsideRect({x:100,y:100},d)?d.left=100:g["default"].isPointInsideRect({x:100,y:r-100},d)&&(a.x<100?d.top=a.y-e.iconHeight/2-this.areaHeight-10:d.left=100)),this.noteRect&&(this.noteRect.style.top=d.top+"px",this.noteRect.style.left=d.left+"px")}},o.prototype._calculateSizes=function(){this.areaWidth=230,this.areaHeight=125,this.currentSize&&(this.areaWidth=Math.min(this.areaWidth,.8*this.currentSize.width),this.areaHeight=Math.min(this.areaHeight,.4*this.currentSize.height)),this.iconWidth=32,this.iconHeight=32},o.prototype._place=function(){if(this.container){this._calculateSizes();var t=this.getBorderHolder();if(t){var e=this._placeIcon(t);e&&this._placeArea(t,e)}}},o.prototype.getUserAgentInfo=function(){return(0,u["default"])().get(u["default"].USER_AGENT_INFO)},o.prototype.getLocaleProvider=function(){return(0,u["default"])().get(u["default"].LOCALE)},o.prototype.getNoteManager=function(){return(0,u["default"])().get(u["default"].NOTE_MANAGER)},o.prototype.contextMenu=function(){return(0,u["default"])().get(u["default"].CONTEXT_MENU)},o.prototype.getBookState=function(){return(0,u["default"])().get(u["default"].BOOK_STATE)},o.MINIMIZED_STATE="MINIMIZED_STATE",o.OPENED_STATE="OPENED_STATE",o.MOVING_STATE="MOVING_STATE",o.REMOVED_STATE="REMOVED_STATE",e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.pageNumber=e.pageNumber,this.linkModel=t,this.pageTable=e.pageTable,this.crossWide=e.crossWide,this.id=e.id,this.isZoomed=e.isZoomed}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r);o.prototype.getTitle=function(){var t=-1;if(this.linkModel.tooltipEnabled!==!1){if(!a["default"].isUndefined(this.linkModel.url))return t=this.linkModel.url.indexOf("?"),t>-1?this.linkModel.url.substr(0,t):this.linkModel.url;if(!a["default"].isUndefined(this.linkModel.id))return""+this.pageTable.getPageCaptionById(this.linkModel.id)}return""},o.prototype.isInternal=function(){return!a["default"].isUndefined(this.linkModel.id)},o.prototype.getUrl=function(){return this.linkModel.url?this.linkModel.url:this.linkModel.id?"fb-internal://"+this.linkModel.id:"#"},o.prototype.getTarget=function(){return this.linkModel.target||"_self"},o.prototype.getBackgroundColor=function(){return this.linkModel.color||"#75869C"},o.prototype.getZIndex=function(){return this.linkModel.zIndex||0},o.prototype.getAngle=function(){return this.linkModel.angle||0},o.prototype.shouldBeHighlightedOnHover=function(){return this.linkModel.highlightOnHover},o.prototype.shouldBeHighlightedOnFlip=function(){return this.linkModel.highlightOnFlip},o.prototype.getRect=function(){return{width:this.linkModel.rect[0],height:this.linkModel.rect[1],left:this.linkModel.rect[2],top:this.linkModel.rect[3]}},o.prototype.getPageNumber=function(){return this.pageNumber},o.prototype.getPageIndexById=function(t){return this.pageTable.getPageIndexById(t)+1},o.prototype.getUrlHeader=function(){var t=this.pageTable.getPageIdByIndex(this.pageNumber);return this.pageTable.getUrlHeaderById(t)},o.prototype.getUrlHeaderById=function(t){return this.pageTable.getUrlHeaderById(t)},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){a["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(14),a=n(r),s=i(71),l=n(s),d=i(4),h=n(d),u=i(2),c=n(u),p=i(19),f=n(p),g=i(9),m=i(5),v=n(m);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.getBookState=function(){return(0,c["default"])().get(c["default"].BOOK_STATE)},o.prototype.getVideoState=function(){return this.getBookState().getVideoState(this.model.getPageId(),this.model.videoModel.id)},o.prototype.stopVideo=function(){return this.getBookState().stop(this.model.getPageId(),this.model.videoModel.id)},o.prototype.startVideo=function(){return this.getBookState().start(this.model.getPageId(),this.model.videoModel.id)},o.prototype.init=function(){this.iframeId=this.model.getIframeId(),this.view=new l["default"](this).init(this.getViewData());var t=this;this.thumbnail=new Image,this.thumbnail.setAttribute("draggable",!1),this.thumbnail.setAttribute("ondragstart","return false;");var e=(0,v["default"])().getCrossOrigin();return e&&(this.thumbnail.crossOrigin=e),this.thumbnail.onload=function(){t.view.setThumbnail(t.thumbnail),t.set("state",g.LoaderState.LOADED),t.thumbnail=null},this.thumbnail.onerror=function(e){t.set("state",g.LoaderState.ERROR),t.thumbnail=null},this.thumbnail.src=this.model.getThumbnailUrl(),this.thumbnail.className="thumbnail",this.set("state",g.LoaderState.LOADING),this.view.on("videoOpened",this._initVideoApi,this),this.view.on("videoClosed",this._onVideoClose,this),this},o.prototype.getViewData=function(){return{browser:this.model.getBrowser(),rect:this.model.getRect(),originalWidth:this.model.getOriginalWidth(),originalHeight:this.model.getOriginalHeight(),zIndex:this.model.getZIndex(),provider:this.model.getProvider(),mode:this.model.getMode(),state:this.model.state,autoplay:this.model.videoModel.autoplay,highlightColor:this.model.getHighlightColor(),iframeId:this.iframeId}},o.prototype.stopSaveTime=function(){this.interval&&clearInterval(this.interval),this.interval=!1},o.prototype.startSaveTime=function(){if(this.stopSaveTime(),this.isActive&&this.getVideoState()===f["default"].VIDEO_PLAYING){var t=this;this.interval=setInterval(function(){t.player.getCurrentTime&&(0,v["default"])().getSessionStorage().setItem(t.model.videoModel.id,parseInt(t.player.getCurrentTime()))},250)}},o.prototype._initVideoApi=function(e){var i=this.model.getBrowser();if(i&&i.publisher)return void this.getApiProvider().trigger("video",{action:"publisher",url:this.model.getApiVideoUrl()});var n,o=this,r=this.model.getProvider(),a=function(t){o.view.trigger("ready")};if("youtube"===r){var s=function(){var i=function(e){n.getCurrentTime&&(e.data===t.YT.PlayerState.PLAYING&&(o.startVideo(),o._onVideoPlay(Math.round(1e3*n.getCurrentTime())/1e3),o.startSaveTime()),e.data===t.YT.PlayerState.PAUSED&&(o.stopVideo(),o._onVideoPause(Math.round(1e3*n.getCurrentTime())/1e3),o.stopSaveTime()),e.data===t.YT.PlayerState.ENDED&&(o.stopVideo(),o._onVideoStop(Math.round(1e3*n.getCurrentTime())/1e3),o.stopSaveTime()))},r=function(){o.player=n=new t.YT.Player(e),o.startSaveTime(),o.on("change:isActive",function(t){o.startSaveTime()}),n.addEventListener("onStateChange",i),n.addEventListener("onReady",a)};t.YT&&t.YT.Player?r():t.onYouTubeIframeAPIReady=function(){r()}};t.onYouTubeIframeAPIReady?s():h["default"].loadScript("https://www.youtube.com/iframe_api",s)}if("vimeo"===r){var l=function(){n=new t.Vimeo.Player(e),n.getVideoHeight().then(function(t){o.view.set("height",t),o.view.set("height",t)}),n.getVideoWidth().then(function(t){o.view.set("width",t),o.view.set("width",t)});try{}catch(i){console.error("vimeo api does not work now")}n.on("play",function(t){o.startVideo(),o._onVideoPlay(t.seconds)}),n.on("pause",function(t){o.stopVideo(),o._onVideoPause(t.seconds)}),n.on("ended",function(t){o.stopVideo(),o._onVideoStop(t.seconds)}),n.on("seeked",function(t){o._onVideoSeekTo(t.seconds)}),n.on("loaded",a),n.on("timeupdate",function(t){t&&(0,v["default"])().getSessionStorage().setItem(o.model.videoModel.id,parseInt(t.seconds))})};t.Vimeo&&t.Vimeo.Player?l():h["default"].loadScript("https://player.vimeo.com/api/player.js",l)}if("wistia"===r){var d=function(){var t={id:o.iframeId,onEmbedded:function(t){o.apiBound||(t.bind("play",function(){o.startVideo(),o._onVideoPlay(t.time())}),t.bind("pause",function(){o.stopVideo(),o._onVideoPause(t.time())}),t.bind("seek",function(t){o._onVideoSeekTo(t)}),t.bind("end",function(){o.stopVideo(),o._onVideoStop(t.time())}),t.bind("secondchange",function(t){t&&(0,v["default"])().getSessionStorage().setItem(o.model.videoModel.id,t)}),o.apiBound=!0)},onReady:function(){a()}};window._wq=window._wq||[],window._wq.push(t)};window.Wistia?d():h["default"].loadScript("https://fast.wistia.com/assets/external/E-v1.js",d)}},o.prototype._onVideoPlay=function(t){this.getApiProvider().trigger("video",{action:"play",url:this.model.getApiVideoUrl(),time:t.toFixed(0)})},
o.prototype._onVideoPause=function(t){this.getApiProvider().trigger("video",{action:"pause",url:this.model.getApiVideoUrl(),time:t.toFixed(0)})},o.prototype._onVideoStop=function(t){this.getApiProvider().trigger("video",{action:"stop",url:this.model.getApiVideoUrl(),time:t.toFixed(0)})},o.prototype._onVideoSeekTo=function(t){this.getApiProvider().trigger("video",{action:"seekTo",url:this.model.getApiVideoUrl(),time:t.toFixed(0)})},o.prototype._onVideoClose=function(){this.getApiProvider().trigger("video",{action:"close",url:this.model.getApiVideoUrl()})},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){l["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(13),l=n(s),d=i(18),h=n(d),u=i(0),c=n(u),p=i(4),f=n(p),g=i(2),m=n(g),v=i(19),y=n(v),b=i(72),w=n(b);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.isFullscreen=function(){return this.iframeContainer&&this.iframeContainer.fullScreen||this.iframeContainer.mozFullScreen||this.iframeContainer.webkitIsFullScreen||!!this.iframeContainer.msFullscreenElement},o.prototype.getBookState=function(){return(0,m["default"])().get(m["default"].BOOK_STATE)},o.prototype.createIFrame=function(t,e){if(this.iframeContainer||(this.iframeContainer=a["default"].createElement("iframe",{id:this.options.iframeId,"class":this.options.provider+"_embed",width:"100%",height:"100%",frameborder:0,allowfullscreen:"allowfullscreen",allow:"autoplay; fullscreen"})),this.options.browser.ie&&!this.firstLoaded){this.iframeContainer.style.visibility="hidden";var i=this;this.iframeContainer.onload=function(){this.style.visibility="visible",i.firstLoaded=!0}}this.iframeContainer.src=this.presenter.model.getVideoUrl(t,e)},o.prototype.createVideoButton=function(){if(!this.videoContainer){if(this.videoContainer=a["default"].createElement("div",{"class":"video",styles:{position:"absolute",width:"100%",height:"100%"}}),new t.Hammer(this.videoContainer,{}).on("tap",c["default"].bind(this._onVideoClick,this)),f["default"].addListener(this.videoContainer,"mousemove",function(t){t.stopPropagation()}),f["default"].addListener(this.videoContainer,"mousedown",function(t){t.stopPropagation()}),this.videoButton=a["default"].createElement("div",{"class":"playButton",styles:{"will-change":this.options.browser.safari?"opacity, transform":""}},this.videoContainer),this.updateThumbnail(),this.presenter.model.options.crossWide&&!this.presenter.model.options.isZoomed){var e=this,i=(0,m["default"])().get(m["default"].WIDE_HIGHLIGHTER),n=i.pushLink(this,this.presenter.model.options.pageNumber,this.presenter.model.options.id);n&&(this.reflection=n,n.reflection=this),this.videoContainer.onmouseover=this.videoButton.onmouseover=function(){a["default"].addClass(e.videoButton,"highlighted"),e.reflection&&a["default"].addClass(e.reflection.videoButton,"highlighted")},this.videoContainer.onmouseout=this.videoButton.onmouseout=function(){a["default"].removeClass(e.videoButton,"highlighted"),e.reflection&&a["default"].removeClass(e.reflection.videoButton,"highlighted")}}this.videoButton.innerHTML=w["default"]}},o.prototype.updateThumbnail=function(){if(this.thumbnail&&(this.presenter.model.videoModel.showImage||"dialog"!==this.options.mode)){this.videoContainer&&this.videoButton&&!this.thumbnail.parent&&this.videoContainer.insertBefore(this.thumbnail,this.videoButton);var t=this.presenter.model.getRect().width,e=this.thumbnail.naturalWidth,i=this.presenter.model.getRect().height,n=this.thumbnail.naturalHeight;if(!e||!n){var o=this;c["default"].defer(function(){o.updateThumbnail()})}var r=t/i>e/n;this.thumbnail.style.width=r?"100%":"auto",this.thumbnail.style.height=r?"auto":"100%",this.thumbnail.style.position="absolute";var a=r?t/e:i/n;r?this.thumbnail.style["margin-top"]=Math.floor(this.scaleFactor*(i-n*a)/2)+"px":this.thumbnail.style["margin-left"]=Math.floor(this.scaleFactor*(t-e*a)/2)+"px"}},o.prototype.setThumbnail=function(t){this.thumbnail=t,this.updateThumbnail()},o.prototype.init=function(t){var e=this;this.options={url:"",rect:null,zIndex:void 0,mode:"auto",provider:"youtube"},c["default"].extend(this.options,t);var i={position:"absolute",width:"100%",height:"100%"};return this.presenter.model.videoModel.showImage!==!1&&(i["background-color"]="#000000"),this.videoContainerSwitcher=a["default"].createElement("div",{"class":"video",styles:i}),c["default"].isUndefined(this.options.zIndex)||(this.videoContainerSwitcher.style.zIndex=this.options.zIndex),this.on("videoClosed",function(){"wistia"!==e.options.provider&&delete e.iframeContainer}),this.presenter.on("change:isActive",function(){this._place()},this),this._place(),this},o.prototype._onVideoClick=function(t){if(this.inDialog()){if(!this.options.browser.publisher){var e=function(){(0,h["default"])().lightbox&&i.width&&i.height&&(0,h["default"])()._sizing(!1)};this.createIFrame(!0,!1);var i=this;this.maxSizes=!1,(0,h["default"])().showFrame(this.iframeContainer,this),(0,h["default"])().once("closed",function(){this.trigger("videoClosed",this.iframeContainer)},this),this.on("change:width",e),this.on("change:height",e),e()}this.trigger("videoOpened",this.iframeContainer)}else this.addVideoWithImage();t.srcEvent.stopPropagation()},o.prototype.getDOMElement=function(){return this.videoContainerSwitcher},o.prototype.scale=function(t){l["default"].prototype.scale.call(this,t),this._place()},o.prototype.offset=function(t){l["default"].prototype.offset.call(this,t),this._place()},o.prototype.getRealHeight=function(){return(this.options.rect.height*this.scaleFactor).toFixed(2)},o.prototype.inDialog=function(){return"dialog"===this.options.mode||this.options.browser.safari||this.options.browser.publisher||this.getRealHeight()<144},o.prototype.isVideoPaused=function(){return this.options.autoplay&&this.presenter.getVideoState()===y["default"].VIDEO_STOPPED||!this.options.autoplay&&!(this.presenter.getVideoState()===y["default"].VIDEO_PLAYING)},o.prototype.addVideo=function(){this.videoContainerSwitcher.style["background-image"]="none",this.createIFrame(!0,!0),this.videoContainer&&this.videoContainerSwitcher===this.videoContainer.parentNode&&this.videoContainerSwitcher.removeChild(this.videoContainer),this.iframeContainer&&this.videoContainerSwitcher!==this.iframeContainer.parentNode&&(this.videoContainerSwitcher.appendChild(this.iframeContainer),this.trigger("videoOpened",this.iframeContainer))},o.prototype.removeVideo=function(){this.videoContainerSwitcher.style["background-image"]="none",this.iframeContainer&&this.videoContainerSwitcher===this.iframeContainer.parentNode&&(this.videoContainerSwitcher.removeChild(this.iframeContainer),this.trigger("videoClosed")),this.videoContainer&&this.videoContainerSwitcher===this.videoContainer.parentNode&&this.videoContainerSwitcher.removeChild(this.videoContainer)},o.prototype.addButtonWithImage=function(){this.createVideoButton(),this.videoContainer&&this.videoContainerSwitcher!==this.videoContainer.parentNode&&this.videoContainerSwitcher.appendChild(this.videoContainer),this.iframeContainer&&this.videoContainerSwitcher===this.iframeContainer.parentNode&&(this.videoContainerSwitcher.removeChild(this.iframeContainer),this.trigger("videoClosed"))},o.prototype.addVideoWithImage=function(){this.createIFrame(!0,!1),this.videoContainer&&this.videoContainerSwitcher===this.videoContainer.parentNode&&this.videoContainerSwitcher.removeChild(this.videoContainer),this.iframeContainer&&this.videoContainerSwitcher!==this.iframeContainer.parentNode&&(this.videoContainerSwitcher.appendChild(this.iframeContainer),this.trigger("videoOpened",this.iframeContainer))},o.prototype._place=function(){var t=this.options.rect;this.videoContainerSwitcher.style.width=(t.width*this.scaleFactor).toFixed(2)+"px",this.videoContainerSwitcher.style.height=this.getRealHeight()+"px",this.videoContainerSwitcher.style.left=((t.left+this.offsetFactor)*this.scaleFactor).toFixed(2)+"px",this.videoContainerSwitcher.style.top=(t.top*this.scaleFactor).toFixed(2)+"px",this.videoContainer&&(this.videoButton.style.maxWidth=Math.min(.5*t.width*this.scaleFactor,.5*t.height*this.scaleFactor).toFixed(0)+"px",this.videoButton.style.maxHeight=this.videoButton.style.maxWidth);var e=this.getBookState().getLastChanging();switch(this.updateThumbnail(),e){case y["default"].POSITION:case y["default"].NONE:!this.options.autoplay||this.inDialog()||this.isVideoPaused()?this.options.autoplay&&this.inDialog()?this.addButtonWithImage():this.options.autoplay&&!this.inDialog()&&this.isVideoPaused()?this.addButtonWithImage():this.addButtonWithImage():this.presenter.isActive?this.addVideo():this.removeVideo();break;case y["default"].ZOOM:case y["default"].FULLSCREEN:var i=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(i&&i.parentNode&&"contentfull-lightbox"===i.parentNode.className)return;!this.options.autoplay||this.inDialog()||this.isVideoPaused()?this.options.autoplay?this.addButtonWithImage():this.options.autoplay||this.inDialog()||this.isVideoPaused()?this.addButtonWithImage():this.presenter.isActive?this.addVideoWithImage():this.removeVideo():this.presenter.isActive?this.addVideoWithImage():this.removeVideo()}},e["default"]=o}).call(e,i(6))},function(t,e){t.exports='<svg width="64px" height="64px" viewBox="0 0 51 51" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="Group-3"><path d="M20.5144958,15.6748878 C20.3590804,15.5816386 20.1812439,15.5323808 20,15.5323808 C19.4477153,15.5323808 19,15.980096 19,16.5323808 L19,33.4676192 C19,33.6488632 19.0492578,33.8266996 19.1425071,33.982115 C19.4266552,34.4556953 20.0409155,34.6092603 20.5144958,34.3251122 L34.6271945,25.8574929 C34.7679441,25.7730432 34.8857419,25.6552454 34.9701917,25.5144958 C35.2543398,25.0409155 35.1007748,24.4266552 34.6271945,24.1425071 L20.5144958,15.6748878 Z" id="Rectangle-3" stroke="#FFFFFF" stroke-width="2" fill="transparent"></path></g></svg>'},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){if(this.videoModel=t,this.options=e,this.linkProps=i,this.videoModel.originalUrl){var n=this.getVideoInfo(this.videoModel.originalUrl);this.videoModel=l["default"].deepExtend(this.videoModel,n)}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(5),a=n(r),s=i(4),l=n(s);o.prototype.getStartFrom=function(){var t=this.videoModel.startFrom,e=(0,a["default"])().getSessionStorage().getItem(this.videoModel.id);return e&&(t=parseInt(e)),t},o.prototype.getVideoInfo=function(t){var e=/https?:\/\/(?:www\.)?youtu\.?be\/?(?:\.com\/)?(?:embed\/)?(?:watch\?v=)?([a-zA-Z_\-\d]*)(?:\?.*)?/,i=/https?:\/\/(?:www)?(?:player)?\.?(?:vimeo\.com\/)(?:video\/)?(\d*)\/?([a-zA-Z\d]*)?/,n=/https?:\/\/(.*)?(?:\.wistia\.com|fast\.wistia\.net)\/(?:medias|embed\/iframe)\/(.*)/,o=e.exec(t);if(o&&o.length>1)return{provider:"youtube",id:o[1]};var r=i.exec(t);if(r&&r.length>1)return{provider:"vimeo",id:r[1],accessKey:r[2]};var a=n.exec(t);if(a&&a.length>1){var s={provider:"wistia",id:a[2]};return a[1]&&(s.account=a[1]),s}},o.prototype.getVideoUrl=function(t,e){var i=this.videoModel.id,n=this.videoModel.provider,o=this.getStartFrom(),r={},a={},s="",l=function(t){var e=parseInt(t/3600,10)%24,i=parseInt(t/60,10)%60;t%=60;var n="";return e&&(n+=e+"h"),i&&(n+=i+"m"),n+=t+"s"};switch(n){case"youtube":s=this.videoModel.embedUrl?this.videoModel.embedUrl.split("#")[0].split("?")[0]:"https://www.youtube.com/embed/"+i,o?a.start=o:a.start=0,a.enablejsapi="1",a.version="3",a.rel="0",a.modestbranding="1",t&&(a.autoplay="1"),e&&(a.mute="1");break;case"vimeo":s=this.videoModel.embedUrl?this.videoModel.embedUrl.split("#")[0].split("?")[0]:"https://player.vimeo.com/video/"+i,o&&t?r.t=l(o):r.t=l(0),t&&(a.autoplay="1"),e&&(a.muted="1");break;case"wistia":s=this.videoModel.embedUrl?this.videoModel.embedUrl.split("#")[0].split("?")[0]:"https://fast.wistia.net/embed/iframe/"+i,o&&(a.time=l(o)),t&&(a.autoPlay="true"),e&&(a.silentAutoPlay="true"),a.googleAnalytics=!1;break;default:s=this.videoModel.url||i,o?a.start=o:a.start=0}var d=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")},h=d(a),u=d(r);return s+(h.length>0?"?"+h:"")+(u?"#"+u:"")},o.prototype.getApiVideoUrl=function(){var t=this.videoModel.id,e=this.videoModel.provider,i=this.videoModel.account,n=this.videoModel.accessKey,o="";switch(e){case"youtube":o="https://www.youtube.com/watch?v="+t;break;case"vimeo":o="https://vimeo.com/"+t,n&&(o+="/"+n);break;case"wistia":o=i?"https://"+i+".wistia.com/medias/"+t:this.videoModel.originalUrl.split("#")[0].split("?")[0];break;default:o=this.videoModel.originalUrl||t}return o},o.prototype.getRect=function(){return{width:this.videoModel.rect[0],height:this.videoModel.rect[1],left:this.videoModel.rect[2],top:this.videoModel.rect[3]}},o.prototype.getOriginalWidth=function(){return this.videoModel.width},o.prototype.getOriginalHeight=function(){return this.videoModel.height},o.prototype.getIframeId=function(){return this.videoModel.provider+"_"+this.videoModel.id+"_"+(1e3*Math.random()).toFixed(0)},o.prototype.getZIndex=function(){return this.videoModel.zIndex||0},o.prototype.getStartTime=function(){return this.videoModel.startFrom},o.prototype.getProvider=function(){return this.videoModel.provider},o.prototype.getBrowser=function(){return this.options?this.options.browser:void 0},o.prototype.getPageId=function(){return this.options?this.options.pageId:void 0},o.prototype.getMode=function(){return this.options.crossWide?"dialog":this.videoModel.mode||"auto"},o.prototype.getThumbnailUrl=function(){return this.videoModel.image?(0,a["default"])().translatePath("assets/common/pages-content/"+this.videoModel.image):""},o.prototype.getHighlightColor=function(){return this.linkProps.color},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){a["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(14),a=n(r),s=i(75),l=n(s);o.prototype=Object.create(a["default"].prototype),o.prototype.init=function(){return this.view=new l["default"](this).init(this.getViewData()),this},o.prototype.getViewData=function(){return{id:this.model.getId(),urls:this.getImageUrls(),rect:this.model.getRect(),popup:this.model.getPopup(),rotation:this.model.getRotation(),zIndex:this.model.getZIndex(),thumbnailUrl:this.getThumbnailUrl(),highlightOnHover:this.model.shouldBeHighlightedOnHover(),highlightOnFlip:this.model.shouldBeHighlightedOnFlip(),highlightColor:this.model.getHighlightColor(),showIcon:this.model.getShowIcon(),crossWide:this.model.getCrossWide(),pageId:this.model.getPageId(),browser:this.model.getBrowser(),isZoomed:this.model.isZoomed()}},o.prototype.getImageUrls=function(){return this.model.getImageUrls()},o.prototype.getThumbnailUrl=function(){return this.model.getThumbnailUrl()},o.prototype.onImageClick=function(){this.getApiProvider().trigger("image",{action:"click",url:this.model.getImageFileNames()[0]})},o.prototype.onImageLoaded=function(){this.getApiProvider().trigger("image",{action:"loaded",url:this.model.getImageFileNames()[0]})},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){c["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(10),l=n(s),d=i(0),h=n(d),u=i(13),c=n(u),p=i(4),f=n(p),g=i(18),m=n(g),v=i(76),y=n(v),b=i(2),w=n(b);o.prototype=Object.create(c["default"].prototype),o.prototype.init=function(e){var i={urls:[],rect:null,thumbnailUrl:"",popup:!0,rotation:0,zIndex:void 0,highlightOnHover:!0,highlightOnFlip:!0,highlightColor:"#3FC7FF",showIcon:!1,crossWide:!1},n=this;if(h["default"].extend(i,e),this.id=i.id,this.pageId=i.pageId,this.isZoomed=i.isZoomed,this.popup=i.popup,this.crossWide=i.crossWide,this.rect=i.rect,this.urls=i.urls,this.imageContainer=a["default"].createElement("div",{"class":"image"+(this.popup?"":" image-static")}),i.thumbnailUrl&&(this.imageThumbnail=a["default"].createElement("div",{"class":"image-inner"+(this.popup?" scale-on-hover":""),styles:{"background-image":"url('"+this.presenter.getThumbnailUrl()+"')"}},this.imageContainer)),this.popup&&(this.imageButton=a["default"].createElement("div",{"class":"playButton"+(i.showIcon?"":" hidden highlight-on-flip"),styles:{"will-change":i.browser.safari?"opacity, transform":""}},this.imageContainer),this.imageButton.innerHTML=y["default"]),h["default"].isUndefined(i.zIndex)||(this.imageContainer.style.zIndex=i.zIndex),h["default"].isUndefined(i.rotation)||(l["default"].origin(this.imageContainer,0,0),l["default"].rotate(this.imageContainer,i.rotation+"rad",0,0,1,!0)),this.popup&&(f["default"].addListener(this.imageContainer,"mousemove",function(t){t.stopPropagation()}),f["default"].addListener(this.imageContainer,"mousedown",function(t){t.stopPropagation()}),new t.Hammer(this.imageContainer,{}).on("tap",h["default"].bind(this._onImageClick,this)),this.crossWide&&!this.isZoomed)){var o=(0,w["default"])().get(w["default"].WIDE_HIGHLIGHTER),r=o.pushLink(this,this.pageId,this.id);r&&(this.reflection=r,r.reflection=this),this.imageContainer.onmouseover=this.imageButton.onmouseover=function(){a["default"].addClass(n.imageButton,"highlighted"),a["default"].addClass(n.reflection.imageButton,"highlighted"),a["default"].addClass(n.reflection.imageContainer,"reflected")},this.imageContainer.onmouseout=this.imageButton.onmouseout=function(){a["default"].removeClass(n.imageButton,"highlighted"),a["default"].removeClass(n.reflection.imageButton,"highlighted"),a["default"].removeClass(n.reflection.imageContainer,"reflected")}}return this},o.prototype._onImageClick=function(t){if(this.urls&&this.urls.length){var e=document.createElement("img"),i=this;e.src=this.presenter.getImageUrls()[0],e.style.width="100%",this.width=146,this.height=146,this.maxSizes=!0,(0,m["default"])().showFrame(e,this),this.presenter.onImageClick(),e.onload=function(){(0,m["default"])().lightbox&&(i.width=e.naturalWidth,i.height=e.naturalHeight,i.width&&i.height&&(0,m["default"])()._sizing(!0),i.presenter.onImageLoaded())}}t.srcEvent.stopPropagation()},o.prototype.getDOMElement=function(){return this.imageContainer},o.prototype.scale=function(t){c["default"].prototype.scale.call(this,t),this._place()},o.prototype.offset=function(t){c["default"].prototype.offset.call(this,t),this._place()},o.prototype._place=function(){if(this.imageContainer.style.width=(this.rect.width*this.scaleFactor).toFixed(0)+"px",this.imageContainer.style.height=(this.rect.height*this.scaleFactor).toFixed(0)+"px",this.imageContainer.style.left=((this.rect.left+this.offsetFactor)*this.scaleFactor).toFixed(0)+"px",this.imageContainer.style.top=(this.rect.top*this.scaleFactor).toFixed(0)+"px",this.imageButton){var t=Math.min(.5*this.rect.width*this.scaleFactor,.5*this.rect.height*this.scaleFactor).toFixed(0)+"px";this.imageButton.style.maxWidth=t,this.imageButton.style.maxHeight=t}},e["default"]=o}).call(e,i(6))},function(t,e){t.exports='<svg width="64px" height="64px" viewBox="0 0 51 51" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="Group-12" transform="translate(16.000000, 16.000000)"><circle id="Oval-4" stroke="#FFFFFF" stroke-width="2" cx="9" cy="9" r="8" fill="transparent"></circle><path d="M15,16 L19,20" id="Line-2" stroke="#FFFFFF" stroke-width="2" stroke-linecap="square"></path><polygon id="+" fill="#FFFFFF" points="9.90722656 8.27978516 12.8808594 8.27978516 12.8808594 9.56152344 9.90722656 9.56152344 9.90722656 12.9306641 8.54492188 12.9306641 8.54492188 9.56152344 5.57128906 9.56152344 5.57128906 8.27978516 8.54492188 8.27978516 8.54492188 5.16699219 9.90722656 5.16699219"></polygon></g></svg>'},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.model=t,this.linkProps=e}Object.defineProperty(e,"__esModule",{value:!0});var r=i(5),a=n(r),s=i(0),l=n(s);o.prototype.getId=function(){return this.model.id},o.prototype.getCrossWide=function(){return this.model.crossWide},o.prototype.getPageId=function(){return this.model.pageId},o.prototype.isZoomed=function(){return this.model.isZoomed},o.prototype.getImageUrls=function(){var t=[];if(this.model.urls)for(var e=0,i=this.model.urls.length;e<i;e++)t[e]=(0,a["default"])().translatePath("assets/common/pages-content/"+this.model.urls[e]);return t},o.prototype.getImageFileNames=function(){return this.model.urls},o.prototype.getThumbnailUrl=function(){return this.model.previewUrl?(0,a["default"])().translatePath("assets/common/pages-content/"+this.model.previewUrl):""},o.prototype.getPopup=function(){return!!l["default"].isUndefined(this.model.popup)||this.model.popup},o.prototype.getRotation=function(){return this.model.rotation||0},o.prototype.getZIndex=function(){return this.model.zIndex||0},o.prototype.getShowIcon=function(){return this.model.showIcon},o.prototype.getRect=function(){return{width:this.model.rect[0],height:this.model.rect[1],left:this.model.rect[2],top:this.model.rect[3]}},o.prototype.shouldBeHighlightedOnHover=function(){return this.linkProps.highlightOnHover},o.prototype.shouldBeHighlightedOnFlip=function(){return this.linkProps.highlightOnFlip},o.prototype.getHighlightColor=function(){return this.linkProps.color},o.prototype.getBrowser=function(){return this.model.browser},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){a["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(14),a=n(r),s=i(79),l=n(s);o.prototype=Object.create(a["default"].prototype),o.prototype.init=function(){return this.view=new l["default"](this).init(this.getViewData()),this},o.prototype.getViewData=function(){return{id:this.model.getId(),url:this.getGifUrl(),rect:this.model.getRect(),rotation:this.model.getRotation(),zIndex:this.model.getZIndex(),previewUrl:this.getPreviewUrl(),loop:this.model.getLoop(),autoplay:this.model.getAutoplay(),duration:this.model.getDuration(),crossWide:this.model.getCrossWide(),pageId:this.model.getPageId(),isZoomed:this.model.isZoomed(),browser:this.model.getBrowser(),highlightColor:this.model.getHighlightColor()}},o.prototype.getGifUrl=function(){return this.model.getGifUrl()},o.prototype.getPreviewUrl=function(){return this.model.getPreviewUrl()},o.prototype.onGifClicked=function(){this.getApiProvider().trigger("gif",{action:"click",url:this.model.getFileName()})},o.prototype.onGifLoaded=function(){this.getApiProvider().trigger("gif",{action:"loaded",url:this.model.getFileName()})},o.prototype.onGifUnloaded=function(){this.getApiProvider().trigger("gif",{action:"stop",url:this.model.getFileName()})},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){c["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(10),l=n(s),d=i(0),h=n(d),u=i(13),c=n(u),p=i(4),f=n(p),g=i(80),m=n(g),v=i(2),y=n(v),b=i(5),w=n(b),_=i(83),P=n(_),E=i(84),T=n(E),C=i(9);o.prototype=Object.create(c["default"].prototype),o.prototype.init=function(e){var i=this,n={url:"",rect:null,previewUrl:"",rotation:0,zIndex:void 0,autoplay:!1,loop:!0,duration:void 0,crossWide:!1};if(h["default"].extend(n,e),this.id=n.id,this.pageId=n.pageId,this.isZoomed=n.isZoomed,this.rect=n.rect,this.url=n.url,this.previewUrl=n.previewUrl,this.autoplay=n.autoplay,this.loop=n.loop,this.duration=n.duration,this.crossWide=n.crossWide,this.loaded=!1,this.crossOrigin=(0,w["default"])().getCrossOrigin(),this.spinner=new m["default"](20),this.gifContainer=a["default"].createElement("div",{"class":"gif"+(n.autoplay?" autoplay":"")}),this.preloader=a["default"].createElement("div",{"class":"gif-preloader"},this.gifContainer),n.previewUrl){var o=new Image;o.className="gif-preview",o.setAttribute("draggable",!1),o.setAttribute("ondragstart","return false;"),this.crossOrigin&&(o.crossOrigin=this.crossOrigin),o.onload=function(){i.presenter.set("state",C.LoaderState.LOADED)},o.onerror=function(){i.presenter.set("state",C.LoaderState.ERROR)},o.src=this.presenter.getPreviewUrl(),this.presenter.set("state",C.LoaderState.LOADING),this.gifContainer.appendChild(o)}if(this.gifButton=a["default"].createElement("div",{"class":"playButton",styles:{"will-change":n.browser.safari?"opacity, transform":""}},this.gifContainer),this.gifButton.innerHTML=P["default"],this.loop||(this.replay=a["default"].createElement("div",{"class":"gif-replay"},this.gifContainer),this.replay.innerHTML=T["default"]),h["default"].isUndefined(n.zIndex)||(this.gifContainer.style.zIndex=n.zIndex),h["default"].isUndefined(n.rotation)||(l["default"].origin(this.gifContainer,0,0),l["default"].rotate(this.gifContainer,n.rotation+"rad",0,0,1,!0)),f["default"].addListener(this.gifContainer,"mousemove",function(t){t.stopPropagation()}),f["default"].addListener(this.gifContainer,"mousedown",function(t){t.stopPropagation()}),new t.Hammer(this.gifContainer,{}).on("tap",h["default"].bind(this._onGifClick,this)),this.crossWide&&!this.isZoomed){var r=(0,y["default"])().get(y["default"].WIDE_HIGHLIGHTER),s=r.pushLink(this,this.pageId,this.id);s&&(this.reflection=s,s.reflection=this,new t.Hammer(this.reflection.gifContainer,{}).on("tap",h["default"].bind(this._onGifClick,this))),this.gifContainer.onmouseover=this.gifButton.onmouseover=function(){a["default"].addClass(i.gifButton,"highlighted"),a["default"].addClass(i.reflection.gifButton,"highlighted")},this.gifContainer.onmouseout=this.gifButton.onmouseout=function(){a["default"].removeClass(i.gifButton,"highlighted"),a["default"].removeClass(i.reflection.gifButton,"highlighted")}}return this.presenter.on("change:isActive",function(t){t&&this.autoplay?(this.started=!0,this._loadGif()):!t&&this.started&&(this._unloadGif(),this.started=!1)},this),this},o.prototype._onGifClick=function(t){this._gifStartStop(),this.reflection&&this.reflection._gifStartStop(),t.srcEvent.stopPropagation()},o.prototype._gifStartStop=function(){!this.url||this.loaded||a["default"].hasClass(this.gifContainer,"loading")?this.loop===!1&&a["default"].hasClass(this.gifContainer,"ended")?this._resetGif():(this.loaded||a["default"].hasClass(this.gifContainer,"loading"))&&this._unloadGif():(this.presenter.onGifClicked(),this._loadGif())},o.prototype._loadGif=function(){if(this.url){var t=this;this.img=document.createElement("img"),this.img.setAttribute("draggable",!1),this.img.setAttribute("ondragstart","return false;"),this.img.className="gif-image",this.img.onload=function(){t.presenter.onGifLoaded(),clearTimeout(t.preloaderTimeout),clearTimeout(t.delTimeout),a["default"].removeClass(t.gifContainer,"loading"),a["default"].addClass(t.gifContainer,"playing"),t.gifImage=a["default"].createElement("div",{"class":"gif-image"},t.gifContainer,"top"),t.imgWidth=t.img.naturalWidth,t.imgHeight=t.img.naturalHeight,t.imgRatio=Math.max(t.rect.width/t.imgWidth,t.rect.height/t.imgHeight),t.img.style.width=(t.imgWidth*t.imgRatio*t.scaleFactor).toFixed(0)+"px",t.img.style.height=(t.imgHeight*t.imgRatio*t.scaleFactor).toFixed(0)+"px",t.gifImage.appendChild(t.img),t.loaded=!0,t.spinner.stop(),t.loop===!1&&t.duration&&(t.loopTimeout=setTimeout(function(){a["default"].addClass(t.gifContainer,"ended")},t.duration+300))},this.crossOrigin&&(this.img.crossOrigin=this.crossOrigin),this.loop!==!1||this.duration?this.img.src=this.presenter.getGifUrl():this._getDuration(this.presenter.getGifUrl(),function(e,i){t.duration=i,t.img.src=e}),this.spinner.spin(this.preloader),this.preloaderTimeout=setTimeout(function(){a["default"].addClass(t.gifContainer,"loading")},200)}},o.prototype._unloadGif=function(){if(this.previewUrl&&this.gifContainer){var t=this;this.img&&this.img.src&&(this.img.removeAttribute("src"),this.img.onload=null),this.presenter.onGifUnloaded(),clearTimeout(this.preloaderTimeout),clearTimeout(this.loopTimeout),a["default"].removeClass(this.gifContainer,"loading"),a["default"].removeClass(this.gifContainer,"playing"),a["default"].removeClass(this.gifContainer,"autoplay"),a["default"].removeClass(this.gifContainer,"ended"),document.body.contains(this.gifImage)&&(this.delTimeout=setTimeout(function(){a["default"].del(t.gifImage)},200)),this.img=null,this.loaded=!1}},o.prototype._resetGif=function(){this._unloadGif(),this._loadGif()},o.prototype.getDOMElement=function(){return this.gifContainer},o.prototype._getDuration=function(t,e){f["default"].downloadFile(t,function(t){for(var i=new Uint8Array(t),n="",o=0,r=0;r<i.length;r++)if(n+=String.fromCharCode(i[r]),33===i[r]&&249===i[r+1]&&4===i[r+2]&&0===i[r+7]){var a=i[r+5]<<8|255&i[r+4];o+=a<2?10:a}e("data:image/gif;base64,"+btoa(n),10*o)})},o.prototype.scale=function(t){c["default"].prototype.scale.call(this,t),this._place()},o.prototype.offset=function(t){c["default"].prototype.offset.call(this,t),this._place()},o.prototype._place=function(){var t=Math.min(.5*this.rect.width*this.scaleFactor,.5*this.rect.height*this.scaleFactor).toFixed(0)+"px";this.gifContainer.style.width=(this.rect.width*this.scaleFactor).toFixed(2)+"px",this.gifContainer.style.height=(this.rect.height*this.scaleFactor).toFixed(2)+"px",this.gifContainer.style.left=((this.rect.left+this.offsetFactor)*this.scaleFactor).toFixed(2)+"px",this.gifContainer.style.top=(this.rect.top*this.scaleFactor).toFixed(2)+"px",this.img&&(this.img.style.width=(this.imgWidth*this.imgRatio*this.scaleFactor).toFixed(0)+"px",this.img.style.height=(this.imgHeight*this.imgRatio*this.scaleFactor).toFixed(0)+"px"),this.gifButton.style.maxWidth=t,this.gifButton.style.maxHeight=t},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=d["default"];return t=t||{},a["default"].isNumber(t)&&(t={scale:t/(2*(e.length+e.radius))}),a["default"].extend(e,t),new s.Spinner(e)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(81),l=i(82),d=n(l);e["default"]=o},function(t,e,i){"use strict";function n(t,e){return t/1e3*e}function o(t,e,i){var n=(t+1)/i.lines,o=e-n*i.direction;(o<0||o>1)&&(o+=i.direction);var r=i.trail/100,a=1-o/r;if(a<0)return i.opacity;var s=1-i.opacity;return a*s+i.opacity}function r(t,e){if(void 0!==t.style[e])return e;var i="ms"+e.charAt(0).toUpperCase()+e.slice(1);return void 0!==t.style[i]?i:""}function a(t,e){for(var i in e)t.style[r(t,i)||i]=e[i];return t}function s(t,e){return"string"==typeof t?t:t[e%t.length]}function l(t,e){var i=Math.round(e.corners*e.width*500)/1e3+"px",n="none";e.shadow===!0?n="0 2px 4px #000":"string"==typeof e.shadow&&(n=e.shadow);for(var o=d(n),r=0;r<e.lines;r++){var l=~~(360/e.lines*r+e.rotate),u=a(document.createElement("div"),{position:"absolute",top:-e.width/2+"px",width:e.length+e.width+"px",height:e.width+"px",background:s(e.fadeColor,r),borderRadius:i,transformOrigin:"left",transform:"rotate("+l+"deg) translateX("+e.radius+"px)"}),c=a(document.createElement("div"),{width:"100%",height:"100%",background:s(e.color,r),borderRadius:i,boxShadow:h(o,l),opacity:e.opacity});u.appendChild(c),t.appendChild(u)}}function d(t){for(var e=/^\s*([a-zA-Z]+\s+)?(-?\d+(\.\d+)?)([a-zA-Z]*)\s+(-?\d+(\.\d+)?)([a-zA-Z]*)(.*)$/,i=[],n=0,o=t.split(",");n<o.length;n++){var r=o[n],a=r.match(e);if(null!==a){var s=+a[2],l=+a[5],d=a[4],h=a[7];0!==s||d||(d=h),0!==l||h||(h=d),d===h&&i.push({prefix:a[1]||"",x:s,y:l,xUnits:d,yUnits:h,end:a[8]})}}return i}function h(t,e){for(var i=[],n=0,o=t;n<o.length;n++){var r=o[n],a=u(r.x,r.y,e);i.push(r.prefix+a[0]+r.xUnits+" "+a[1]+r.yUnits+r.end)}return i.join(", ")}function u(t,e,i){var n=i*Math.PI/180,o=Math.sin(n),r=Math.cos(n);return[Math.round(1e3*(t*r+e*o))/1e3,Math.round(1e3*(-t*o+e*r))/1e3]}Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"Spinner",function(){return f});var c=this&&this.__assign||Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];
for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},p={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",fadeColor:"transparent",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:"none",position:"absolute"},f=function(){function t(t){void 0===t&&(t={}),this.opts=c({},p,t)}return t.prototype.spin=function(t){var e=this;this.stop(),this.el=document.createElement("div"),this.el.className=this.opts.className,this.el.setAttribute("role","progressbar"),a(this.el,{position:this.opts.position,width:0,zIndex:this.opts.zIndex,left:this.opts.left,top:this.opts.top,transform:"scale("+this.opts.scale+")"}),t&&t.insertBefore(this.el,t.firstChild||null);var i,r;"undefined"!=typeof requestAnimationFrame?(i=requestAnimationFrame,r=function(){return performance.now()}):(i=function(t){return setTimeout(t,1e3/e.opts.fps)},r=function(){return Date.now()});var s,d=0,h=function(){var t=r();if(void 0===s&&(s=t-1),d+=n(t-s,e.opts.speed),s=t,d>1&&(d-=Math.floor(d)),e.el.childNodes.length===e.opts.lines)for(var a=0;a<e.opts.lines;a++){var l=o(a,d,e.opts);e.el.childNodes[a].childNodes[0].style.opacity=l.toString()}e.animateId=e.el?i(h):void 0};return l(this.el,this.opts),h(),this},t.prototype.stop=function(){return this.el&&("undefined"!=typeof requestAnimationFrame?cancelAnimationFrame(this.animateId):clearTimeout(this.animateId),this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=void 0),this},t}()},function(t,e){t.exports={lines:13,length:38,width:17,radius:45,scale:1,corners:1,color:"#ffffff",fadeColor:"transparent",opacity:.25,rotate:0,direction:1,speed:1,trail:60,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!0,position:"absolute"}},function(t,e){t.exports='<svg width="64px" height="64px" viewBox="0 0 51 51" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M22.875,29.5234375 C22.4635396,30.0598985 21.8932328,30.4661445 21.1640625,30.7421875 C20.4348922,31.0182305 19.6067755,31.15625 18.6796875,31.15625 C17.7265577,31.15625 16.8828162,30.9401063 16.1484375,30.5078125 C15.4140588,30.0755187 14.8476582,29.4570353 14.4492188,28.6523438 C14.0507793,27.8476522 13.8437501,26.9088595 13.828125,25.8359375 L13.828125,24.9453125 C13.828125,23.2265539 14.2395792,21.8841194 15.0625,20.9179688 C15.8854208,19.9518181 17.0338468,19.46875 18.5078125,19.46875 C19.7734438,19.46875 20.7786421,19.7812469 21.5234375,20.40625 C22.2682329,21.0312531 22.7161451,21.9322858 22.8671875,23.109375 L20.9296875,23.109375 C20.7109364,21.7395765 19.9166735,21.0546875 18.546875,21.0546875 C17.6614539,21.0546875 16.9882836,21.3736947 16.5273438,22.0117188 C16.0664039,22.6497428 15.8281251,23.5859313 15.8125,24.8203125 L15.8125,25.6953125 C15.8125,26.9244853 16.071612,27.8789029 16.5898438,28.5585938 C17.1080755,29.2382846 17.8281204,29.578125 18.75,29.578125 C19.7604217,29.578125 20.4791645,29.3489606 20.90625,28.890625 L20.90625,26.6640625 L18.5625,26.6640625 L18.5625,25.1640625 L22.875,25.1640625 L22.875,29.5234375 Z M27.223343,31 L25.254593,31 L25.254593,19.625 L27.223343,19.625 L27.223343,31 Z M36.2982485,26.1796875 L31.7201235,26.1796875 L31.7201235,31 L29.743561,31 L29.743561,19.625 L36.9701235,19.625 L36.9701235,21.21875 L31.7201235,21.21875 L31.7201235,24.6015625 L36.2982485,24.6015625 L36.2982485,26.1796875 Z" id="GIF" fill="#FFFFFF"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 70 70" version="1.1" x="0px" y="0px"><g transform="translate(185 -145)"><g><use xlink:href="#a" transform="matrix(0.5 0.866025 -0.866025 0.5 -141.691 145)"></use></g></g><defs><path id="a" d="M 5.88517 12.4278L 1.49014 9.96953C 0.712595 9.53462 -0.202612 10.2569 0.0396673 11.1142L 4.00639 25.1503C 4.15658 25.6817 4.70918 25.9908 5.24066 25.8406L 19.2767 21.8739C 20.134 21.6316 20.2704 20.4738 19.4929 20.0388L 14.6149 17.3105C 18.8092 10.2858 27.8821 7.90916 34.9915 12.0138C 42.1659 16.1559 44.624 25.3298 40.4819 32.5042C 36.3398 39.6786 27.1659 42.1367 19.9915 37.9946L 14.9915 46.6548C 26.9488 53.5584 42.2386 49.4615 49.1421 37.5042C 56.0457 25.5469 51.9488 10.2571 39.9915 3.35354C 28.0597 -3.5353 12.8096 0.529431 5.88517 12.4278Z"></path></defs></svg>'},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.model=t,this.linkProps=e}Object.defineProperty(e,"__esModule",{value:!0});var r=i(5),a=n(r);o.prototype.getId=function(){return this.model.id},o.prototype.getCrossWide=function(){return this.model.crossWide},o.prototype.getPageId=function(){return this.model.pageId},o.prototype.isZoomed=function(){return this.model.isZoomed},o.prototype.getGifUrl=function(){var t=this.model.loop===!1?"?rand="+(1e6*Math.random()).toFixed():"";return this.model.url?(0,a["default"])().translatePath("assets/common/pages-content/"+this.model.url+t):void 0},o.prototype.getPreviewUrl=function(){return this.model.previewUrl?(0,a["default"])().translatePath("assets/common/pages-content/"+this.model.previewUrl):void 0},o.prototype.getFileName=function(){return this.model.url},o.prototype.getRotation=function(){return this.model.rotation||0},o.prototype.getZIndex=function(){return this.model.zIndex||0},o.prototype.getRect=function(){return{width:this.model.rect[0],height:this.model.rect[1],left:this.model.rect[2],top:this.model.rect[3]}},o.prototype.getLoop=function(){return this.model.loop},o.prototype.getAutoplay=function(){return this.model.autoplay},o.prototype.getDuration=function(){return this.model.duration},o.prototype.getHighlightColor=function(){return this.linkProps.color},o.prototype.getBrowser=function(){return this.model.browser},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){a["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(29),a=n(r),s=i(4),l=n(s),d=i(3),h=n(d),u=i(0),c=n(u),p=i(2),f=n(p),g=i(87),m=i(8),v=n(m),y=i(5),b=n(y);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.init=function(t,e){var i=this;this.root=t;var n={startPage:1,totalPages:1,bookSizeProvider:null,contentProvider:null,rightToLeft:!1,hardcover:!1,coverColor:"red",flipCorner:!1,lightFlipCorner:!1,pageFlippingDuration:600,size:{width:640,height:480},notes:!0};c["default"].extend(n,e),this.options=n,this.elementId="flipbook",this.targetName="turnjs-flipping-book",this.lastPageNum=this.presenter.model.getPageTable().getPagesCount(),l["default"].renderTemplate(this.root,v["default"]["workspace-book"],{type:this.elementId,notesEnabled:n.notes,rtl:n.rightToLeft,localization:{addNote:(0,f["default"])().get(f["default"].LOCALE).get("NotesToolWindow.ADD_NOTE"),firstPage:n.rightToLeft?(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.LAST_PAGE_TIP"):(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.FIRST_PAGE_TIP"),lastPage:n.rightToLeft?(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.FIRST_PAGE_TIP"):(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.LAST_PAGE_TIP"),nextPage:n.rightToLeft?(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.PREV_PAGE_TIP"):(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.NEXT_PAGE_TIP"),previousPage:n.rightToLeft?(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.NEXT_PAGE_TIP"):(0,f["default"])().get(f["default"].LOCALE).get("NavigationPanel.PREV_PAGE_TIP")}}),this.presenter.model.on("CHANGE_NOTES_COMPONENT",function(t){t?h["default"].hasClass("icon-right-note","disabled")&&!(0,b["default"])().getLocalStorage().isStub&&h["default"].removeClass("icon-right-note","disabled"):h["default"].addClass("icon-right-note","disabled")},this),this.flipbook=h["default"].id(this.elementId),this.viewport=h["default"].id(this.elementId+"-viewport"),this.central=h["default"].id(this.elementId+"-viewport-central"),this._jqueryFlipbook=(0,g.$)("#"+this.elementId);var o=function(t){i.options.hardcover&&(t>=2?(0,g.$)("#"+i.elementId+" .front.cover.inside").addClass("fixed"):(0,g.$)("#"+i.elementId+" .front.cover.inside").removeClass("fixed"),t<i._jqueryFlipbook.turn("pages")?(0,g.$)("#"+i.elementId+" .back.cover.inside").addClass("fixed"):(0,g.$)("#"+i.elementId+" .back.cover.inside").removeClass("fixed"))},r=this.options.bookSizeProvider.getBookSize();if(this._jqueryFlipbook.turn({width:r.width,height:r.height,gradients:!0,acceleration:!1,autoCenter:!0,duration:n.pageFlippingDuration,ownPageSizeProvider:n.bookSizeProvider,direction:n.rightToLeft?"rtl":"ltr",elevation:50,pages:n.totalPages,page:n.startPage,when:{turning:function(t,e,n){i._onPageChanged(e,n),i._stopCorner(),i.options.hardcover&&(o(e),i._jqueryFlipbook.turn("resize")),i.presenter.onPageChanging()},pressed:function(){i._stopCorner(),i.presenter.onStartDrag()},outcorner:function(t,e){1===e&&i._startCorner()},overcorner:function(){i._stopCorner()},end:function(t,e,n){1===e.page&&i._startCorner(),n&&i.presenter.onEndDrag()},turned:function(t,e){1===e?i._startCorner():i._stopCorner(),i.presenter.onPageChanged()},missing:function(t,e){for(var n=0;n<e.length;n++)i.addPageContent(e[n])},folded:function(t,e,n){var o=h["default"].className("page-content");c["default"].each(o,function(t){t.style["pointer-events"]=1!==e.page&&e.page!==i.lastPageNum&&n?"none":"auto"})},range:function(t,e,n){var o=i._jqueryFlipbook.turn("pages"),r=[];i.options.hardcover&&o>0&&(r.push(1),o>1&&r.push(2),o>2&&(i._jqueryFlipbook.turn("pages")%2===0?(r.push(o-1),r.push(o)):r.push(o))),(0,f["default"])().get(f["default"].LOAD_MANAGER).setBookRange([e,n],r)}}}),this.options.hardcover){var a=this._jqueryFlipbook.turn("pages");a>0&&(this.addPageContent(1),a>1&&(this._frontInsideCover=this.addPageContent(2)),a>2&&(this._jqueryFlipbook.turn("pages")%2===0?(this._backInsideCover=this.addPageContent(a-1),this.addPageContent(a)):this._backInsideCover=this.addPageContent(a)),o(n.startPage))}this._initNavigationEvents(),this.zoomMode=!1,this.setFlipCorner(this.options.flipCorner)},o.prototype.setFlipCorner=function(t){this.options.flipCorner!==t&&(this.options.flipCorner=t,t?this._startCorner():this._stopCorner())},o.prototype._startCorner=function(){var t=this._jqueryFlipbook;if(this.options.flipCorner){clearTimeout(this.timeout),clearInterval(this.interval),clearInterval(this.interval2);var e=this;e._cornerActive!==!0&&(e._cornerActive=!0,e.timeout=setTimeout(function(){e.options.lightFlipCorner?e.interval=setInterval(function(){e._cornerActive!==!1&&((0,g.$)(t).turn("peel",e.isRightToLeft()?"bl":"br",void 0,!1),clearInterval(e.interval))},900):e.interval=setInterval(function(){e._cornerActive!==!1&&((0,g.$)(t).turn("peel",e.isRightToLeft()?"bl":"br"),e.interval2=setTimeout(function(){(0,g.$)(t).turn("peel",!1)},450))},900)},1100))}},o.prototype._stopCorner=function(){clearTimeout(this.timeout),clearInterval(this.interval),clearInterval(this.interval2),this._cornerActive=!1},o.prototype.getContainer=function(){return this.flipbook},o.prototype.goToPage=function(t){this._jqueryFlipbook.turn("page",t)},o.prototype.isFlipping=function(){return t.cornerClickSemafor===!0},o.prototype.isRightToLeft=function(){return"rtl"===this._jqueryFlipbook.turn("direction")},o.prototype.addPageContent=function(t){if(this._jqueryFlipbook.turn("hasPage",t))return(0,g.$)("#"+this.elementId+" .p"+t).get(0);var e=t%2!==0,i=h["default"].createElement("div",{});1===t&&h["default"].addClass(i,"first"),t===this._jqueryFlipbook.turn("pages")&&h["default"].addClass(i,"last");var n=this._jqueryFlipbook.turn("page"),o=[],r={},a=i;if(this.options.hardcover){switch(t){case 1:o=["hard","front","cover"];break;case 2:o=["hard","front","cover","inside"],n>=2&&o.push("fixed");break;case this._jqueryFlipbook.turn("pages")-1:e&&(o=["hard","back","cover","inside"],n<this._jqueryFlipbook.turn("pages")&&o.push("fixed"));break;case this._jqueryFlipbook.turn("pages"):o=["hard","back","cover"],e&&(o.push("inside"),r.backgroundColor=this.options.coverColor,n<this._jqueryFlipbook.turn("pages")&&h["default"].addClass(i,"fixed"))}if(o.indexOf("inside")!==-1){r.backgroundColor=this.options.coverColor;var s=this.options.bookSizeProvider.getBookSize(),l=this.options.bookSizeProvider.getPageSize(t),d=s.height-l.height,u=s.width/2-l.width,c=o.indexOf("front")===-1?0:u,p=o.indexOf("front")===-1?u:0;a=h["default"].createElement("div",{styles:{top:d/2+"px",bottom:d/2+"px",left:(this.isRightToLeft()?p:c)+"px",right:(this.isRightToLeft()?c:p)+"px",position:"absolute"}},i)}if(0===o.length){o=["own-size"];var f=this.options.bookSizeProvider.getPageSize(t-1);r.width=f.width+"px",r.height=f.height+"px"}}h["default"].addClass(i,o.join(" ")),h["default"].css(i,r);var m=this.options.contentProvider?this.options.contentProvider.getContentForPage(t):null;return m&&(m.dataset.type="content",a.appendChild(m)),this._jqueryFlipbook.turn("addPage",i,t),i},o.prototype.resize=function(){var t=this.options.bookSizeProvider.getBookSize();this._jqueryFlipbook.turn("size",t.width,t.height);var e=this.viewport.getBoundingClientRect();this.central.style.marginLeft=2*Math.floor(-t.width/4)+"px",this.central.style.marginTop=Math.floor(-t.height/2)+"px",this.central.style.top=Math.floor(e.height/2)+"px",this.central.style.left=Math.floor(e.width/2)+"px"},o.prototype._onPageChanged=function(t,e){var i=e[0]-1;i<0&&(i=0),this.presenter.goToPage(i)},o.prototype._initNavigationEvents=function(){function t(){var t=e.getNoteManager().containers,i=void 0;for(var n in t){var o=t[n];if(!e.isRightToLeft()&&o.presenter.isWide()&&n.indexOf("Right")>=0){i=o;break}if(e.isRightToLeft()&&o.presenter.isWide()&&n.indexOf("Left")>=0){i=o;break}i=i?parseInt(o.presenter.model.getPageNumber())>parseInt(i.presenter.model.getPageNumber())?o:i:o}var r=e.presenter.model.getBookModel(),a=r.noteData.getNotesOnPage(i.presenter.model.getPageId());if(i.presenter.view.parentObject){for(var s=r.getProps(),d=parseInt(s.bookSize.width,10),h=parseInt(s.bookSize.height,10),u=i.presenter.isWide()&&!e.isRightToLeft()?d:0,c=[],p=0;p<a.length;p++)c.push({left:parseInt(a[p].pX)-u,top:parseInt(a[p].pY)});var f=l["default"].findSpace(d,h,40,c);i.presenter.addNote({pX:f.left+u,pY:f.top})}}var e=this,i=(this.isRightToLeft()?".previous-button":".next-button")+" .btn-container",n=(this.isRightToLeft()?".next-button":".previous-button")+" .btn-container",o=this.isRightToLeft()?".icon-book-last":".icon-book-first",r=this.isRightToLeft()?".icon-book-first":".icon-book-last",a=(0,g.$)("#icon-right-note"),s=(0,g.$)("#icon-left-note");(0,g.$)(i).click(function(){e.set("textSelectionMode",!1),e.presenter.goToPage("next")}),(0,g.$)(n).click(function(){e.set("textSelectionMode",!1),e.presenter.goToPage("previous")}),a.click(function(){t()}),s.click(function(){t()}),(0,g.$)(o).click(function(){e.set("textSelectionMode",!1),e.presenter.goToPage("first")}),(0,g.$)(r).click(function(){e.set("textSelectionMode",!1),e.presenter.goToPage("last")})},o.prototype.setTextSelectionMode=function(t){t?h["default"].addClass(this.viewport,"allowSelect"):h["default"].removeClass(this.viewport,"allowSelect"),this._jqueryFlipbook.turn("disable",t)},o.prototype.setNextButtonVisible=function(t){var e=this.isRightToLeft()?".previous-button":".next-button";t?(0,g.$)(e).show():(0,g.$)(e).hide()},o.prototype.setPrevButtonVisible=function(t){var e=this.isRightToLeft()?".next-button":".previous-button";t?(0,g.$)(e).show():(0,g.$)(e).hide()},o.prototype.setLastAddNoteVisible=function(t){var e=this.isRightToLeft()?"#icon-right-note":"#icon-left-note";t?(0,g.$)(e).show():(0,g.$)(e).hide()},o.prototype.destroy=function(){this._stopCorner(),this._jqueryFlipbook.turn("destroy").remove(),h["default"].del("flipbook-viewport")},o.prototype.isAnimating=function(){return this._jqueryFlipbook.turn("animating")&&!this._cornerActive},o.prototype.getCurrentPagesDomElements=function(){var t=this,e={};return c["default"].each(this._jqueryFlipbook.turn("view"),function(i){i>0&&i<=t._jqueryFlipbook.turn("pages")&&(e[i]=(0,g.$)(".page-wrapper .p"+i).get(0))}),e},o.prototype.setCoverColor=function(t){this.options.coverColor=t,this._backInsideCover&&(this._backInsideCover.style.backgroundColor=t),this._frontInsideCover&&(this._frontInsideCover.style.backgroundColor=t)},o.prototype.getNoteManager=function(){return(0,f["default"])().get(f["default"].NOTE_MANAGER)},e["default"]=o}).call(e,i(6))},function(t,e){"use strict";function i(t){var e,i,n=z[t]={};for(t=t.split(/\s+/),e=0,i=t.length;e<i;e++)n[t[e]]=!0;return n}function n(t,e,i){if(void 0===i&&1===t.nodeType){var n="data-"+e.replace(W,"-$1").toLowerCase();if(i=t.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:D.isNumeric(i)?+i:F.test(i)?D.parseJSON(i):i)}catch(o){}D.data(t,e,i)}else i=void 0}return i}function o(t){for(var e in t)if(("data"!==e||!D.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function r(t,e,i){var n=e+"defer",o=e+"queue",r=e+"mark",a=D._data(t,n);!a||"queue"!==i&&D._data(t,o)||"mark"!==i&&D._data(t,r)||setTimeout(function(){D._data(t,o)||D._data(t,r)||(D.removeData(t,n,!0),a.fire())},0)}function a(){return!1}function s(){return!0}function l(t){return!t||!t.parentNode||11===t.parentNode.nodeType}function d(t,e,i){if(e=e||0,D.isFunction(e))return D.grep(t,function(t,n){var o=!!e.call(t,n,t);return o===i});if(e.nodeType)return D.grep(t,function(t,n){return t===e===i});if("string"==typeof e){var n=D.grep(t,function(t){return 1===t.nodeType});if(ut.test(e))return D.filter(e,n,!i);e=D.filter(e,n)}return D.grep(t,function(t,n){return D.inArray(t,e)>=0===i})}function h(t){var e=gt.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function u(t,e){return D.nodeName(t,"table")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function c(t,e){if(1===e.nodeType&&D.hasData(t)){var i,n,o,r=D._data(t),a=D._data(e,r),s=r.events;if(s){delete a.handle,a.events={};for(i in s)for(n=0,o=s[i].length;n<o;n++)D.event.add(e,i,s[i][n])}a.data&&(a.data=D.extend({},a.data))}}function p(t,e){var i;1===e.nodeType&&(e.clearAttributes&&e.clearAttributes(),e.mergeAttributes&&e.mergeAttributes(t),i=e.nodeName.toLowerCase(),"object"===i?e.outerHTML=t.outerHTML:"input"!==i||"checkbox"!==t.type&&"radio"!==t.type?"option"===i?e.selected=t.defaultSelected:"input"===i||"textarea"===i?e.defaultValue=t.defaultValue:"script"===i&&e.text!==t.text&&(e.text=t.text):(t.checked&&(e.defaultChecked=e.checked=t.checked),e.value!==t.value&&(e.value=t.value)),e.removeAttribute(D.expando),e.removeAttribute("_submit_attached"),e.removeAttribute("_change_attached"))}function f(t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName("*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll("*"):[]}function g(t){"checkbox"!==t.type&&"radio"!==t.type||(t.defaultChecked=t.checked)}function m(t){var e=(t.nodeName||"").toLowerCase();"input"===e?g(t):"script"!==e&&"undefined"!=typeof t.getElementsByTagName&&D.grep(t.getElementsByTagName("input"),g)}function v(t){var e=O.createElement("div");return kt.appendChild(e),e.innerHTML=t.outerHTML,e.firstChild}function y(t,e,i){var n="width"===e?t.offsetWidth:t.offsetHeight,o="width"===e?1:0,r=4;if(n>0){if("border"!==i)for(;o<r;o+=2)i||(n-=parseFloat(D.css(t,"padding"+Ht[o]))||0),"margin"===i?n+=parseFloat(D.css(t,i+Ht[o]))||0:n-=parseFloat(D.css(t,"border"+Ht[o]+"Width"))||0;return n+"px"}if(n=It(t,e),(n<0||null==n)&&(n=t.style[e]),zt.test(n))return n;if(n=parseFloat(n)||0,i)for(;o<r;o+=2)n+=parseFloat(D.css(t,"padding"+Ht[o]))||0,"padding"!==i&&(n+=parseFloat(D.css(t,"border"+Ht[o]+"Width"))||0),"margin"===i&&(n+=parseFloat(D.css(t,i+Ht[o]))||0);return n+"px"}function b(t){return function(e,i){if("string"!=typeof e&&(i=e,e="*"),D.isFunction(i))for(var n,o,r,a=e.toLowerCase().split(ie),s=0,l=a.length;s<l;s++)n=a[s],r=/^\+/.test(n),r&&(n=n.substr(1)||"*"),o=t[n]=t[n]||[],o[r?"unshift":"push"](i)}}function w(t,e,i,n,o,r){o=o||e.dataTypes[0],r=r||{},r[o]=!0;for(var a,s=t[o],l=0,d=s?s.length:0,h=t===ae;l<d&&(h||!a);l++)a=s[l](e,i,n),"string"==typeof a&&(!h||r[a]?a=void 0:(e.dataTypes.unshift(a),a=w(t,e,i,n,a,r)));return!h&&a||r["*"]||(a=w(t,e,i,n,"*",r)),a}function _(t,e){var i,n,o=D.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);n&&D.extend(!0,t,n)}function P(t,e,i,n){if(D.isArray(e))D.each(e,function(e,o){i||qt.test(t)?n(t,o):P(t+"["+("object"===("undefined"==typeof o?"undefined":M(o))?e:"")+"]",o,i,n)});else if(i||"object"!==D.type(e))n(t,e);else for(var o in e)P(t+"["+o+"]",e[o],i,n)}function E(t,e,i){var n,o,r,a,s=t.contents,l=t.dataTypes,d=t.responseFields;for(o in d)o in i&&(e[d[o]]=i[o]);for(;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("content-type"));if(n)for(o in s)if(s[o]&&s[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}if(r)return r!==l[0]&&l.unshift(r),i[r]}function T(t,e){t.dataFilter&&(e=t.dataFilter(e,t.dataType));var i,n,o,r,a,s,l,d,h=t.dataTypes,u={},c=h.length,p=h[0];for(i=1;i<c;i++){if(1===i)for(n in t.converters)"string"==typeof n&&(u[n.toLowerCase()]=t.converters[n]);if(r=p,p=h[i],"*"===p)p=r;else if("*"!==r&&r!==p){if(a=r+" "+p,s=u[a]||u["* "+p],!s){d=void 0;for(l in u)if(o=l.split(" "),(o[0]===r||"*"===o[0])&&(d=u[o[1]+" "+p])){l=u[l],l===!0?s=d:d===!0&&(s=l);break}}s||d||D.error("No conversion from "+a.replace(" "," to ")),s!==!0&&(e=s?s(e):d(l(e)))}}return e}function C(){try{return new window.XMLHttpRequest}catch(t){}}function A(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function x(){return setTimeout(S,0),ye=D.now()}function S(){ye=void 0}function k(t,e){var i={};return D.each(Pe.concat.apply([],Pe.slice(0,e)),function(){i[this]=t}),i}function I(t){if(!be[t]){var e=O.body,i=D("<"+t+">").appendTo(e),n=i.css("display");i.remove(),"none"!==n&&""!==n||(ge||(ge=O.createElement("iframe"),ge.frameBorder=ge.width=ge.height=0),e.appendChild(ge),me&&ge.createElement||(me=(ge.contentWindow||ge.contentDocument).document,me.write((D.support.boxModel?"<!doctype html>":"")+"<html><body>"),me.close()),i=me.createElement(t),me.body.appendChild(i),n=D.css(i,"display"),e.removeChild(ge)),be[t]=n}return be[t]}function L(t){return D.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}Object.defineProperty(e,"__esModule",{value:!0});var M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=window.document,N=window.navigator,B=window.location,D=function(){function t(){if(!r.isReady){try{O.documentElement.doScroll("left")}catch(e){return void setTimeout(t,1)}r.ready()}}var e,i,n,o,r=function B(t,i){return new B.fn.init(t,i,e)},a=window.jQuery,s=window.$,l=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,d=/\S/,h=/^\s+/,u=/\s+$/,c=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,p=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,m=/(?:^|:|,)(?:\s*\[)+/g,v=/(webkit)[ \/]([\w.]+)/,y=/(opera)(?:.*version)?[ \/]([\w.]+)/,b=/(msie) ([\w.]+)/,w=/(mozilla)(?:.*? rv:([\w.]+))?/,_=/-([a-z]|[0-9])/gi,P=/^-ms-/,E=function(t,e){return(e+"").toUpperCase()},T=N.userAgent,C=Object.prototype.toString,A=Object.prototype.hasOwnProperty,x=Array.prototype.push,S=Array.prototype.slice,k=String.prototype.trim,I=Array.prototype.indexOf,L={};return r.fn=r.prototype={constructor:r,init:function(t,e,i){var n,o,a,s;if(!t)return this;if(t.nodeType)return this.context=this[0]=t,this.length=1,this;if("body"===t&&!e&&O.body)return this.context=O,this[0]=O.body,this.selector=t,this.length=1,this;if("string"==typeof t){if(n="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:l.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1])return e=e instanceof r?e[0]:e,s=e?e.ownerDocument||e:O,a=c.exec(t),a?r.isPlainObject(e)?(t=[O.createElement(a[1])],r.fn.attr.call(t,e,!0)):t=[s.createElement(a[1])]:(a=r.buildFragment([n[1]],[s]),t=(a.cacheable?r.clone(a.fragment):a.fragment).childNodes),r.merge(this,t);if(o=O.getElementById(n[2]),o&&o.parentNode){if(o.id!==n[2])return i.find(t);this.length=1,this[0]=o}return this.context=O,this.selector=t,this}return r.isFunction(t)?i.ready(t):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),r.makeArray(t,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return S.call(this,0)},get:function(t){return null==t?this.toArray():t<0?this[this.length+t]:this[t]},pushStack:function(t,e,i){var n=this.constructor();return r.isArray(t)?x.apply(n,t):r.merge(n,t),n.prevObject=this,n.context=this.context,"find"===e?n.selector=this.selector+(this.selector?" ":"")+i:e&&(n.selector=this.selector+"."+e+"("+i+")"),n},each:function(t,e){return r.each(this,t,e)},ready:function(t){return r.bindReady(),n.add(t),this},eq:function(t){return t=+t,t===-1?this.slice(t):this.slice(t,t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(S.apply(this,arguments),"slice",S.call(arguments).join(","))},map:function(t){return this.pushStack(r.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:x,sort:[].sort,splice:[].splice},r.fn.init.prototype=r.fn,r.extend=r.fn.extend=function(){var t,e,i,n,o,a,s=arguments[0]||{},l=1,d=arguments.length,h=!1;for("boolean"==typeof s&&(h=s,s=arguments[1]||{},l=2),"object"===("undefined"==typeof s?"undefined":M(s))||r.isFunction(s)||(s={}),d===l&&(s=this,--l);l<d;l++)if(null!=(t=arguments[l]))for(e in t)i=s[e],n=t[e],s!==n&&(h&&n&&(r.isPlainObject(n)||(o=r.isArray(n)))?(o?(o=!1,a=i&&r.isArray(i)?i:[]):a=i&&r.isPlainObject(i)?i:{},s[e]=r.extend(h,a,n)):void 0!==n&&(s[e]=n));return s},r.extend({noConflict:function(t){return window.$===r&&(window.$=s),t&&window.jQuery===r&&(window.jQuery=a),r},isReady:!1,readyWait:1,holdReady:function(t){t?r.readyWait++:r.ready(!0)},ready:function(t){if(t===!0&&!--r.readyWait||t!==!0&&!r.isReady){if(!O.body)return setTimeout(r.ready,1);if(r.isReady=!0,t!==!0&&--r.readyWait>0)return;n.fireWith(O,[r]),r.fn.trigger&&r(O).trigger("ready").off("ready")}},bindReady:function(){if(!n){if(n=r.Callbacks("once memory"),"complete"===O.readyState)return setTimeout(r.ready,1);if(O.addEventListener)O.addEventListener("DOMContentLoaded",o,!1),window.addEventListener("load",r.ready,!1);else if(O.attachEvent){O.attachEvent("onreadystatechange",o),window.attachEvent("onload",r.ready);var e=!1;try{e=null==window.frameElement}catch(i){}O.documentElement.doScroll&&e&&t()}}},isFunction:function(t){return"function"===r.type(t)},isArray:Array.isArray||function(t){return"array"===r.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):L[C.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==r.type(t)||t.nodeType||r.isWindow(t))return!1;try{if(t.constructor&&!A.call(t,"constructor")&&!A.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var i;for(i in t);return void 0===i||A.call(t,i)},isEmptyObject:function(t){for(var e in t)return!1;return!0},error:function(t){throw new Error(t)},parseJSON:function(t){return"string"==typeof t&&t?(t=r.trim(t),window.JSON&&window.JSON.parse?window.JSON.parse(t):p.test(t.replace(f,"@").replace(g,"]").replace(m,""))?new Function("return "+t)():void r.error("Invalid JSON: "+t)):null},parseXML:function(t){if("string"!=typeof t||!t)return null;var e,i;try{window.DOMParser?(i=new DOMParser,e=i.parseFromString(t,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t))}catch(n){e=void 0}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||r.error("Invalid XML: "+t),e},noop:function(){},globalEval:function(t){t&&d.test(t)&&(window.execScript||function(t){window.eval.call(window,t)})(t)},camelCase:function(t){return t.replace(P,"ms-").replace(_,E)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toUpperCase()===e.toUpperCase()},each:function(t,e,i){var n,o=0,a=t.length,s=void 0===a||r.isFunction(t);if(i)if(s){for(n in t)if(e.apply(t[n],i)===!1)break}else for(;o<a&&e.apply(t[o++],i)!==!1;);else if(s){for(n in t)if(e.call(t[n],n,t[n])===!1)break}else for(;o<a&&e.call(t[o],o,t[o++])!==!1;);return t},trim:k?function(t){return null==t?"":k.call(t)}:function(t){return null==t?"":t.toString().replace(h,"").replace(u,"")},makeArray:function(t,e){var i=e||[];if(null!=t){var n=r.type(t);null==t.length||"string"===n||"function"===n||"regexp"===n||r.isWindow(t)?x.call(i,t):r.merge(i,t)}return i},inArray:function(t,e,i){var n;if(e){if(I)return I.call(e,t,i);for(n=e.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,e){var i=t.length,n=0;if("number"==typeof e.length)for(var o=e.length;n<o;n++)t[i++]=e[n];else for(;void 0!==e[n];)t[i++]=e[n++];return t.length=i,t},grep:function(t,e,i){var n,o=[];i=!!i;for(var r=0,a=t.length;r<a;r++)n=!!e(t[r],r),i!==n&&o.push(t[r]);return o},map:function(t,e,i){var n,o,a=[],s=0,l=t.length,d=t instanceof r||void 0!==l&&"number"==typeof l&&(l>0&&t[0]&&t[l-1]||0===l||r.isArray(t));if(d)for(;s<l;s++)n=e(t[s],s,i),null!=n&&(a[a.length]=n);else for(o in t)n=e(t[o],o,i),null!=n&&(a[a.length]=n);return a.concat.apply([],a)},guid:1,proxy:function D(t,e){if("string"==typeof e){var i=t[e];e=t,t=i}if(r.isFunction(t)){var n=S.call(arguments,2),D=function(){return t.apply(e,n.concat(S.call(arguments)))};return D.guid=t.guid=t.guid||D.guid||r.guid++,D}},access:function(t,e,i,n,o,a,s){var l,d=null==i,h=0,u=t.length;if(i&&"object"===("undefined"==typeof i?"undefined":M(i))){for(h in i)r.access(t,e,h,i[h],1,a,n);o=1}else if(void 0!==n){if(l=void 0===s&&r.isFunction(n),d&&(l?(l=e,e=function(t,e,i){return l.call(r(t),i)}):(e.call(t,n),e=null)),e)for(;h<u;h++)e(t[h],i,l?n.call(t[h],h,e(t[h],i)):n,s);o=1}return o?t:d?e.call(t):u?e(t[0],i):a},now:function(){return(new Date).getTime()},uaMatch:function(t){t=t.toLowerCase();var e=v.exec(t)||y.exec(t)||b.exec(t)||t.indexOf("compatible")<0&&w.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},sub:function(){function t(e,i){return new t.fn.init(e,i)}r.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(i,n){return n&&n instanceof r&&!(n instanceof t)&&(n=t(n)),r.fn.init.call(this,i,n,e)},t.fn.init.prototype=t.fn;var e=t(O);return t},browser:{}}),r.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(t,e){L["[object "+e+"]"]=e.toLowerCase()}),i=r.uaMatch(T),i.browser&&(r.browser[i.browser]=!0,r.browser.version=i.version),r.browser.webkit&&(r.browser.safari=!0),d.test(" ")&&(h=/^[\s\xA0]+/,u=/[\s\xA0]+$/),e=r(O),O.addEventListener?o=function(){O.removeEventListener("DOMContentLoaded",o,!1),r.ready()}:O.attachEvent&&(o=function(){"complete"===O.readyState&&(O.detachEvent("onreadystatechange",o),r.ready())}),r}(),z={};D.Callbacks=function(t){t=t?z[t]||i(t):{};var e,n,o,r,a,s,l=[],d=[],h=function p(e){var i,n,o,r;for(i=0,n=e.length;i<n;i++)o=e[i],r=D.type(o),"array"===r?p(o):"function"===r&&(t.unique&&c.has(o)||l.push(o))},u=function(i,h){for(h=h||[],e=!t.memory||[i,h],n=!0,o=!0,s=r||0,r=0,a=l.length;l&&s<a;s++)if(l[s].apply(i,h)===!1&&t.stopOnFalse){e=!0;break}o=!1,l&&(t.once?e===!0?c.disable():l=[]:d&&d.length&&(e=d.shift(),c.fireWith(e[0],e[1])))},c={add:function(){if(l){var t=l.length;h(arguments),o?a=l.length:e&&e!==!0&&(r=t,u(e[0],e[1]))}return this},remove:function(){if(l)for(var e=arguments,i=0,n=e.length;i<n;i++)for(var r=0;r<l.length&&(e[i]!==l[r]||(o&&r<=a&&(a--,r<=s&&s--),l.splice(r--,1),!t.unique));r++);
return this},has:function(t){if(l)for(var e=0,i=l.length;e<i;e++)if(t===l[e])return!0;return!1},empty:function(){return l=[],this},disable:function(){return l=d=e=void 0,this},disabled:function(){return!l},lock:function(){return d=void 0,e&&e!==!0||c.disable(),this},locked:function(){return!d},fireWith:function(i,n){return d&&(o?t.once||d.push([i,n]):t.once&&e||u(i,n)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c};var R=[].slice;D.extend({Deferred:function(t){var e,i=D.Callbacks("once memory"),n=D.Callbacks("once memory"),o=D.Callbacks("memory"),r="pending",a={resolve:i,reject:n,notify:o},s={done:i.add,fail:n.add,progress:o.add,state:function(){return r},isResolved:i.fired,isRejected:n.fired,then:function(t,e,i){return l.done(t).fail(e).progress(i),this},always:function(){return l.done.apply(l,arguments).fail.apply(l,arguments),this},pipe:function(t,e,i){return D.Deferred(function(n){D.each({done:[t,"resolve"],fail:[e,"reject"],progress:[i,"notify"]},function(t,e){var i,o=e[0],r=e[1];D.isFunction(o)?l[t](function(){i=o.apply(this,arguments),i&&D.isFunction(i.promise)?i.promise().then(n.resolve,n.reject,n.notify):n[r+"With"](this===l?n:this,[i])}):l[t](n[r])})}).promise()},promise:function(t){if(null==t)t=s;else for(var e in s)t[e]=s[e];return t}},l=s.promise({});for(e in a)l[e]=a[e].fire,l[e+"With"]=a[e].fireWith;return l.done(function(){r="resolved"},n.disable,o.lock).fail(function(){r="rejected"},i.disable,o.lock),t&&t.call(l,l),l},when:function(t){function e(t){return function(e){n[t]=arguments.length>1?R.call(arguments,0):e,--s||l.resolveWith(l,n)}}function i(t){return function(e){a[t]=arguments.length>1?R.call(arguments,0):e,l.notifyWith(d,a)}}var n=R.call(arguments,0),o=0,r=n.length,a=new Array(r),s=r,l=r<=1&&t&&D.isFunction(t.promise)?t:D.Deferred(),d=l.promise();if(r>1){for(;o<r;o++)n[o]&&n[o].promise&&D.isFunction(n[o].promise)?n[o].promise().then(e(o),l.reject,i(o)):--s;s||l.resolveWith(l,n)}else l!==t&&l.resolveWith(l,r?[t]:[]);return d}}),D.support=function(){var t,e,i,n,o,r,a,s,l,d,h,u=O.createElement("div");O.documentElement;if(u.setAttribute("className","t"),u.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",e=u.getElementsByTagName("*"),i=u.getElementsByTagName("a")[0],!e||!e.length||!i)return{};n=O.createElement("select"),o=n.appendChild(O.createElement("option")),r=u.getElementsByTagName("input")[0],t={leadingWhitespace:3===u.firstChild.nodeType,tbody:!u.getElementsByTagName("tbody").length,htmlSerialize:!!u.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.55/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===r.value,optSelected:o.selected,getSetAttribute:"t"!==u.className,enctype:!!O.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==O.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},D.boxModel=t.boxModel="CSS1Compat"===O.compatMode,r.checked=!0,t.noCloneChecked=r.cloneNode(!0).checked,n.disabled=!0,t.optDisabled=!o.disabled;try{delete u.test}catch(c){t.deleteExpando=!1}if(!u.addEventListener&&u.attachEvent&&u.fireEvent&&(u.attachEvent("onclick",function(){t.noCloneEvent=!1}),u.cloneNode(!0).fireEvent("onclick")),r=O.createElement("input"),r.value="t",r.setAttribute("type","radio"),t.radioValue="t"===r.value,r.setAttribute("checked","checked"),r.setAttribute("name","t"),u.appendChild(r),a=O.createDocumentFragment(),a.appendChild(u.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=r.checked,a.removeChild(r),a.appendChild(u),u.attachEvent)for(d in{submit:1,change:1,focusin:1})l="on"+d,h=l in u,h||(u.setAttribute(l,"return;"),h="function"==typeof u[l]),t[d+"Bubbles"]=h;return a.removeChild(u),a=n=o=u=r=null,D(function(){var e,i,n,o,r,a,l,d,c,p,f,g,m=O.getElementsByTagName("body")[0];m&&(l=1,g="padding:0;margin:0;border:",p="position:absolute;top:0;left:0;width:1px;height:1px;",f=g+"0;visibility:hidden;",d="style='"+p+g+"5px solid #000;",c="<div "+d+"display:block;'><div style='"+g+"0;display:block;overflow:hidden;'></div></div><table "+d+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",e=O.createElement("div"),e.style.cssText=f+"width:0;height:0;position:static;top:0;margin-top:"+l+"px",m.insertBefore(e,m.firstChild),u=O.createElement("div"),e.appendChild(u),u.innerHTML="<table><tr><td style='"+g+"0;display:none'></td><td>t</td></tr></table>",s=u.getElementsByTagName("td"),h=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=h&&0===s[0].offsetHeight,window.getComputedStyle&&(u.innerHTML="",a=O.createElement("div"),a.style.width="0",a.style.marginRight="0",u.style.width="2px",u.appendChild(a),t.reliableMarginRight=0===(parseInt((window.getComputedStyle(a,null)||{marginRight:0}).marginRight,10)||0)),"undefined"!=typeof u.style.zoom&&(u.innerHTML="",u.style.width=u.style.padding="1px",u.style.border=0,u.style.overflow="hidden",u.style.display="inline",u.style.zoom=1,t.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.style.overflow="visible",u.innerHTML="<div style='width:5px;'></div>",t.shrinkWrapBlocks=3!==u.offsetWidth),u.style.cssText=p+f,u.innerHTML=c,i=u.firstChild,n=i.firstChild,o=i.nextSibling.firstChild.firstChild,r={doesNotAddBorder:5!==n.offsetTop,doesAddBorderForTableAndCells:5===o.offsetTop},n.style.position="fixed",n.style.top="20px",r.fixedPosition=20===n.offsetTop||15===n.offsetTop,n.style.position=n.style.top="",i.style.overflow="hidden",i.style.position="relative",r.subtractsBorderForOverflowNotVisible=n.offsetTop===-5,r.doesNotIncludeMarginInBodyOffset=m.offsetTop!==l,window.getComputedStyle&&(u.style.marginTop="1%",t.pixelMargin="1%"!==(window.getComputedStyle(u,null)||{marginTop:0}).marginTop),"undefined"!=typeof e.style.zoom&&(e.style.zoom=1),m.removeChild(e),a=u=e=null,D.extend(t,r))}),t}();var F=/^(?:\{.*\}|\[.*\])$/,W=/([A-Z])/g;D.extend({cache:{},uuid:0,expando:"jQuery"+(D.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?D.cache[t[D.expando]]:t[D.expando],!!t&&!o(t)},data:function(t,e,i,n){if(D.acceptData(t)){var o,r,a,s=D.expando,l="string"==typeof e,d=t.nodeType,h=d?D.cache:t,u=d?t[s]:t[s]&&s,c="events"===e;if(u&&h[u]&&(c||n||h[u].data)||!l||void 0!==i)return u||(d?t[s]=u=++D.uuid:u=s),h[u]||(h[u]={},d||(h[u].toJSON=D.noop)),"object"!==("undefined"==typeof e?"undefined":M(e))&&"function"!=typeof e||(n?h[u]=D.extend(h[u],e):h[u].data=D.extend(h[u].data,e)),o=r=h[u],n||(r.data||(r.data={}),r=r.data),void 0!==i&&(r[D.camelCase(e)]=i),c&&!r[e]?o.events:(l?(a=r[e],null==a&&(a=r[D.camelCase(e)])):a=r,a)}},removeData:function(t,e,i){if(D.acceptData(t)){var n,r,a,s=D.expando,l=t.nodeType,d=l?D.cache:t,h=l?t[s]:s;if(d[h]){if(e&&(n=i?d[h]:d[h].data)){D.isArray(e)||(e in n?e=[e]:(e=D.camelCase(e),e=e in n?[e]:e.split(" ")));for(r=0,a=e.length;r<a;r++)delete n[e[r]];if(!(i?o:D.isEmptyObject)(n))return}(i||(delete d[h].data,o(d[h])))&&(D.support.deleteExpando||!d.setInterval?delete d[h]:d[h]=null,l&&(D.support.deleteExpando?delete t[s]:t.removeAttribute?t.removeAttribute(s):t[s]=null))}}},_data:function(t,e,i){return D.data(t,e,i,!0)},acceptData:function(t){if(t.nodeName){var e=D.noData[t.nodeName.toLowerCase()];if(e)return!(e===!0||t.getAttribute("classid")!==e)}return!0}}),D.fn.extend({data:function xe(t,e){var i,o,r,a,s,l=this[0],d=0,xe=null;if(void 0===t){if(this.length&&(xe=D.data(l),1===l.nodeType&&!D._data(l,"parsedAttrs"))){for(r=l.attributes,s=r.length;d<s;d++)a=r[d].name,0===a.indexOf("data-")&&(a=D.camelCase(a.substring(5)),n(l,a,xe[a]));D._data(l,"parsedAttrs",!0)}return xe}return"object"===("undefined"==typeof t?"undefined":M(t))?this.each(function(){D.data(this,t)}):(i=t.split(".",2),i[1]=i[1]?"."+i[1]:"",o=i[1]+"!",D.access(this,function(e){return void 0===e?(xe=this.triggerHandler("getData"+o,[i[0]]),void 0===xe&&l&&(xe=D.data(l,t),xe=n(l,t,xe)),void 0===xe&&i[1]?this.data(i[0]):xe):(i[1]=e,void this.each(function(){var n=D(this);n.triggerHandler("setData"+o,i),D.data(this,t,e),n.triggerHandler("changeData"+o,i)}))},null,e,arguments.length>1,null,!1))},removeData:function(t){return this.each(function(){D.removeData(this,t)})}}),D.extend({_mark:function(t,e){t&&(e=(e||"fx")+"mark",D._data(t,e,(D._data(t,e)||0)+1))},_unmark:function(t,e,i){if(t!==!0&&(i=e,e=t,t=!1),e){i=i||"fx";var n=i+"mark",o=t?0:(D._data(e,n)||1)-1;o?D._data(e,n,o):(D.removeData(e,n,!0),r(e,i,"mark"))}},queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=D._data(t,e),i&&(!n||D.isArray(i)?n=D._data(t,e,D.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=D.queue(t,e),n=i.shift(),o={};"inprogress"===n&&(n=i.shift()),n&&("fx"===e&&i.unshift("inprogress"),D._data(t,e+".run",o),n.call(t,function(){D.dequeue(t,e)},o)),i.length||(D.removeData(t,e+"queue "+e+".run",!0),r(t,e,"queue"))}}),D.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?D.queue(this[0],t):void 0===e?this:this.each(function(){var i=D.queue(this,t,e);"fx"===t&&"inprogress"!==i[0]&&D.dequeue(this,t)})},dequeue:function(t){return this.each(function(){D.dequeue(this,t)})},delay:function(t,e){return t=D.fx?D.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function i(){--s||o.resolveWith(r,[r])}"string"!=typeof t&&(e=t,t=void 0),t=t||"fx";for(var n,o=D.Deferred(),r=this,a=r.length,s=1,l=t+"defer",d=t+"queue",h=t+"mark";a--;)(n=D.data(r[a],l,void 0,!0)||(D.data(r[a],d,void 0,!0)||D.data(r[a],h,void 0,!0))&&D.data(r[a],l,D.Callbacks("once memory"),!0))&&(s++,n.add(i));return i(),o.promise(e)}});var H,U,j,V=/[\n\t\r]/g,q=/\s+/,G=/\r/g,X=/^(?:button|input)$/i,Y=/^(?:button|input|object|select|textarea)$/i,Q=/^a(?:rea)?$/i,Z=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,K=D.support.getSetAttribute;D.fn.extend({attr:function(t,e){return D.access(this,D.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){D.removeAttr(this,t)})},prop:function(t,e){return D.access(this,D.prop,t,e,arguments.length>1)},removeProp:function(t){return t=D.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})},addClass:function(t){var e,i,n,o,r,a,s;if(D.isFunction(t))return this.each(function(e){D(this).addClass(t.call(this,e,this.className))});if(t&&"string"==typeof t)for(e=t.split(q),i=0,n=this.length;i<n;i++)if(o=this[i],1===o.nodeType)if(o.className||1!==e.length){for(r=" "+o.className+" ",a=0,s=e.length;a<s;a++)~r.indexOf(" "+e[a]+" ")||(r+=e[a]+" ");o.className=D.trim(r)}else o.className=t;return this},removeClass:function(t){var e,i,n,o,r,a,s;if(D.isFunction(t))return this.each(function(e){D(this).removeClass(t.call(this,e,this.className))});if(t&&"string"==typeof t||void 0===t)for(e=(t||"").split(q),i=0,n=this.length;i<n;i++)if(o=this[i],1===o.nodeType&&o.className)if(t){for(r=(" "+o.className+" ").replace(V," "),a=0,s=e.length;a<s;a++)r=r.replace(" "+e[a]+" "," ");o.className=D.trim(r)}else o.className="";return this},toggleClass:function(t,e){var i="undefined"==typeof t?"undefined":M(t),n="boolean"==typeof e;return D.isFunction(t)?this.each(function(i){D(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var o,r=0,a=D(this),s=e,l=t.split(q);o=l[r++];)s=n?s:!a.hasClass(o),a[s?"addClass":"removeClass"](o);else"undefined"!==i&&"boolean"!==i||(this.className&&D._data(this,"__className__",this.className),this.className=this.className||t===!1?"":D._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(V," ").indexOf(e)>-1)return!0;return!1},val:function(t){var e,i,n,o=this[0];{if(arguments.length)return n=D.isFunction(t),this.each(function(i){var o,r=D(this);1===this.nodeType&&(o=n?t.call(this,i,r.val()):t,null==o?o="":"number"==typeof o?o+="":D.isArray(o)&&(o=D.map(o,function(t){return null==t?"":t+""})),e=D.valHooks[this.type]||D.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))});if(o)return e=D.valHooks[o.type]||D.valHooks[o.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(G,""):null==i?"":i)}}}),D.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,i,n,o,r=t.selectedIndex,a=[],s=t.options,l="select-one"===t.type;if(r<0)return null;for(i=l?r:0,n=l?r+1:s.length;i<n;i++)if(o=s[i],o.selected&&(D.support.optDisabled?!o.disabled:null===o.getAttribute("disabled"))&&(!o.parentNode.disabled||!D.nodeName(o.parentNode,"optgroup"))){if(e=D(o).val(),l)return e;a.push(e)}return l&&!a.length&&s.length?D(s[r]).val():a},set:function(t,e){var i=D.makeArray(e);return D(t).find("option").each(function(){this.selected=D.inArray(D(this).val(),i)>=0}),i.length||(t.selectedIndex=-1),i}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(t,e,i,n){var o,r,a,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return n&&e in D.attrFn?D(t)[e](i):"undefined"==typeof t.getAttribute?D.prop(t,e,i):(a=1!==s||!D.isXMLDoc(t),a&&(e=e.toLowerCase(),r=D.attrHooks[e]||(Z.test(e)?U:H)),void 0!==i?null===i?void D.removeAttr(t,e):r&&"set"in r&&a&&void 0!==(o=r.set(t,i,e))?o:(t.setAttribute(e,""+i),i):r&&"get"in r&&a&&null!==(o=r.get(t,e))?o:(o=t.getAttribute(e),null===o?void 0:o))},removeAttr:function(t,e){var i,n,o,r,a,s=0;if(e&&1===t.nodeType)for(n=e.toLowerCase().split(q),r=n.length;s<r;s++)o=n[s],o&&(i=D.propFix[o]||o,a=Z.test(o),a||D.attr(t,o,""),t.removeAttribute(K?o:i),a&&i in t&&(t[i]=!1))},attrHooks:{type:{set:function(t,e){if(X.test(t.nodeName)&&t.parentNode)D.error("type property can't be changed");else if(!D.support.radioValue&&"radio"===e&&D.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}},value:{get:function(t,e){return H&&D.nodeName(t,"button")?H.get(t,e):e in t?t.value:null},set:function(t,e,i){return H&&D.nodeName(t,"button")?H.set(t,e,i):void(t.value=e)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,e,i){var n,o,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return r=1!==a||!D.isXMLDoc(t),r&&(e=D.propFix[e]||e,o=D.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):Y.test(t.nodeName)||Q.test(t.nodeName)&&t.href?0:void 0}}}}),D.attrHooks.tabindex=D.propHooks.tabIndex,U={get:function(t,e){var i,n=D.prop(t,e);return n===!0||"boolean"!=typeof n&&(i=t.getAttributeNode(e))&&i.nodeValue!==!1?e.toLowerCase():void 0},set:function(t,e,i){var n;return e===!1?D.removeAttr(t,i):(n=D.propFix[i]||i,n in t&&(t[n]=!0),t.setAttribute(i,i.toLowerCase())),i}},K||(j={name:!0,id:!0,coords:!0},H=D.valHooks.button={get:function(t,e){var i;return i=t.getAttributeNode(e),i&&(j[e]?""!==i.nodeValue:i.specified)?i.nodeValue:void 0},set:function(t,e,i){var n=t.getAttributeNode(i);return n||(n=O.createAttribute(i),t.setAttributeNode(n)),n.nodeValue=e+""}},D.attrHooks.tabindex.set=H.set,D.each(["width","height"],function(t,e){D.attrHooks[e]=D.extend(D.attrHooks[e],{set:function(t,i){if(""===i)return t.setAttribute(e,"auto"),i}})}),D.attrHooks.contenteditable={get:H.get,set:function(t,e,i){""===e&&(e="false"),H.set(t,e,i)}}),D.support.hrefNormalized||D.each(["href","src","width","height"],function(t,e){D.attrHooks[e]=D.extend(D.attrHooks[e],{get:function(t){var i=t.getAttribute(e,2);return null===i?void 0:i}})}),D.support.style||(D.attrHooks.style={get:function(t){return t.style.cssText.toLowerCase()||void 0},set:function(t,e){return t.style.cssText=""+e}}),D.support.optSelected||(D.propHooks.selected=D.extend(D.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),D.support.enctype||(D.propFix.enctype="encoding"),D.support.checkOn||D.each(["radio","checkbox"],function(){D.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),D.each(["radio","checkbox"],function(){D.valHooks[this]=D.extend(D.valHooks[this],{set:function(t,e){if(D.isArray(e))return t.checked=D.inArray(D(t).val(),e)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*)?(?:\.(.+))?$/,tt=/(?:^|\s)hover(\.\S+)?\b/,et=/^key/,it=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,ot=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,rt=function(t){var e=ot.exec(t);return e&&(e[1]=(e[1]||"").toLowerCase(),e[3]=e[3]&&new RegExp("(?:^|\\s)"+e[3]+"(?:\\s|$)")),e},at=function(t,e){var i=t.attributes||{};return(!e[1]||t.nodeName.toLowerCase()===e[1])&&(!e[2]||(i.id||{}).value===e[2])&&(!e[3]||e[3].test((i["class"]||{}).value))},st=function(t){return D.event.special.hover?t:t.replace(tt,"mouseenter$1 mouseleave$1")};D.event={add:function(t,e,i,n,o){var r,a,s,l,d,h,u,c,p,f,g;if(3!==t.nodeType&&8!==t.nodeType&&e&&i&&(r=D._data(t))){for(i.handler&&(p=i,i=p.handler,o=p.selector),i.guid||(i.guid=D.guid++),s=r.events,s||(r.events=s={}),a=r.handle,a||(r.handle=a=function(t){return"undefined"==typeof D||t&&D.event.triggered===t.type?void 0:D.event.dispatch.apply(a.elem,arguments)},a.elem=t),e=D.trim(st(e)).split(" "),l=0;l<e.length;l++)d=J.exec(e[l])||[],h=d[1],u=(d[2]||"").split(".").sort(),g=D.event.special[h]||{},h=(o?g.delegateType:g.bindType)||h,g=D.event.special[h]||{},c=D.extend({type:h,origType:d[1],data:n,handler:i,guid:i.guid,selector:o,quick:o&&rt(o),namespace:u.join(".")},p),f=s[h],f||(f=s[h]=[],f.delegateCount=0,g.setup&&g.setup.call(t,n,u,a)!==!1||(t.addEventListener?t.addEventListener(h,a,!1):t.attachEvent&&t.attachEvent("on"+h,a))),g.add&&(g.add.call(t,c),c.handler.guid||(c.handler.guid=i.guid)),o?f.splice(f.delegateCount++,0,c):f.push(c),D.event.global[h]=!0;t=null}},global:{},remove:function(t,e,i,n,o){var r,a,s,l,d,h,u,c,p,f,g,m,v=D.hasData(t)&&D._data(t);if(v&&(c=v.events)){for(e=D.trim(st(e||"")).split(" "),r=0;r<e.length;r++)if(a=J.exec(e[r])||[],s=l=a[1],d=a[2],s){for(p=D.event.special[s]||{},s=(n?p.delegateType:p.bindType)||s,g=c[s]||[],h=g.length,d=d?new RegExp("(^|\\.)"+d.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,u=0;u<g.length;u++)m=g[u],!o&&l!==m.origType||i&&i.guid!==m.guid||d&&!d.test(m.namespace)||n&&n!==m.selector&&("**"!==n||!m.selector)||(g.splice(u--,1),m.selector&&g.delegateCount--,p.remove&&p.remove.call(t,m));0===g.length&&h!==g.length&&(p.teardown&&p.teardown.call(t,d)!==!1||D.removeEvent(t,s,v.handle),delete c[s])}else for(s in c)D.event.remove(t,s+e[r],i,n,!0);D.isEmptyObject(c)&&(f=v.handle,f&&(f.elem=null),D.removeData(t,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(t,e,i,n){if(!i||3!==i.nodeType&&8!==i.nodeType){var o,r,a,s,l,d,h,u,c,p,f=t.type||t,g=[];if(!nt.test(f+D.event.triggered)&&(f.indexOf("!")>=0&&(f=f.slice(0,-1),r=!0),f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),i&&!D.event.customEvent[f]||D.event.global[f]))if(t="object"===("undefined"==typeof t?"undefined":M(t))?t[D.expando]?t:new D.Event(f,t):new D.Event(f),t.type=f,t.isTrigger=!0,t.exclusive=r,t.namespace=g.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,d=f.indexOf(":")<0?"on"+f:"",i){if(t.result=void 0,t.target||(t.target=i),e=null!=e?D.makeArray(e):[],e.unshift(t),h=D.event.special[f]||{},!h.trigger||h.trigger.apply(i,e)!==!1){if(c=[[i,h.bindType||f]],!n&&!h.noBubble&&!D.isWindow(i)){for(p=h.delegateType||f,s=nt.test(p+f)?i:i.parentNode,l=null;s;s=s.parentNode)c.push([s,p]),l=s;l&&l===i.ownerDocument&&c.push([l.defaultView||l.parentWindow||window,p])}for(a=0;a<c.length&&!t.isPropagationStopped();a++)s=c[a][0],t.type=c[a][1],u=(D._data(s,"events")||{})[t.type]&&D._data(s,"handle"),u&&u.apply(s,e),u=d&&s[d],u&&D.acceptData(s)&&u.apply(s,e)===!1&&t.preventDefault();return t.type=f,n||t.isDefaultPrevented()||h._default&&h._default.apply(i.ownerDocument,e)!==!1||"click"===f&&D.nodeName(i,"a")||!D.acceptData(i)||d&&i[f]&&("focus"!==f&&"blur"!==f||0!==t.target.offsetWidth)&&!D.isWindow(i)&&(l=i[d],l&&(i[d]=null),D.event.triggered=f,i[f](),D.event.triggered=void 0,l&&(i[d]=l)),t.result}}else{o=D.cache;for(a in o)o[a].events&&o[a].events[f]&&D.event.trigger(t,e,o[a].handle.elem,!0)}}},dispatch:function(t){t=D.event.fix(t||window.event);var e,i,n,o,r,a,s,l,d,h,u=(D._data(this,"events")||{})[t.type]||[],c=u.delegateCount,p=[].slice.call(arguments,0),f=!t.exclusive&&!t.namespace,g=D.event.special[t.type]||{},m=[];if(p[0]=t,t.delegateTarget=this,!g.preDispatch||g.preDispatch.call(this,t)!==!1){if(c&&(!t.button||"click"!==t.type))for(o=D(this),o.context=this.ownerDocument||this,n=t.target;n!=this;n=n.parentNode||this)if(n.disabled!==!0){for(a={},l=[],o[0]=n,e=0;e<c;e++)d=u[e],h=d.selector,void 0===a[h]&&(a[h]=d.quick?at(n,d.quick):o.is(h)),a[h]&&l.push(d);l.length&&m.push({elem:n,matches:l})}for(u.length>c&&m.push({elem:this,matches:u.slice(c)}),e=0;e<m.length&&!t.isPropagationStopped();e++)for(s=m[e],t.currentTarget=s.elem,i=0;i<s.matches.length&&!t.isImmediatePropagationStopped();i++)d=s.matches[i],(f||!t.namespace&&!d.namespace||t.namespace_re&&t.namespace_re.test(d.namespace))&&(t.data=d.data,t.handleObj=d,r=((D.event.special[d.origType]||{}).handle||d.handler).apply(s.elem,p),void 0!==r&&(t.result=r,r===!1&&(t.preventDefault(),t.stopPropagation())));return g.postDispatch&&g.postDispatch.call(this,t),t.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,o,r=e.button,a=e.fromElement;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||O,n=i.documentElement,o=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?e.toElement:a),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[D.expando])return t;var e,i,n=t,o=D.event.fixHooks[t.type]||{},r=o.props?this.props.concat(o.props):this.props;for(t=D.Event(n),e=r.length;e;)i=r[--e],t[i]=n[i];return t.target||(t.target=n.srcElement||O),3===t.target.nodeType&&(t.target=t.target.parentNode),void 0===t.metaKey&&(t.metaKey=t.ctrlKey),o.filter?o.filter(t,n):t},special:{ready:{setup:D.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(t,e,i){D.isWindow(this)&&(this.onbeforeunload=i)},teardown:function(t,e){this.onbeforeunload===e&&(this.onbeforeunload=null)}}},simulate:function(t,e,i,n){var o=D.extend(new D.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?D.event.trigger(o,null,e):D.event.dispatch.call(e,o),o.isDefaultPrevented()&&i.preventDefault()}},D.event.handle=D.event.dispatch,D.removeEvent=O.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){t.detachEvent&&t.detachEvent("on"+e,i)},D.Event=function(t,e){return this instanceof D.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?s:a):this.type=t,e&&D.extend(this,e),this.timeStamp=t&&t.timeStamp||D.now(),void(this[D.expando]=!0)):new D.Event(t,e)},D.Event.prototype={preventDefault:function(){this.isDefaultPrevented=s;var t=this.originalEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=s;var t=this.originalEvent;t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()},isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a},D.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){D.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,o=t.relatedTarget,r=t.handleObj;r.selector;return o&&(o===n||D.contains(n,o))||(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),D.support.submitBubbles||(D.event.special.submit={setup:function(){return!D.nodeName(this,"form")&&void D.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,i=D.nodeName(e,"input")||D.nodeName(e,"button")?e.form:void 0;i&&!i._submit_attached&&(D.event.add(i,"submit._submit",function(t){t._submit_bubble=!0}),i._submit_attached=!0)})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&D.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return!D.nodeName(this,"form")&&void D.event.remove(this,"._submit")}}),D.support.changeBubbles||(D.event.special.change={setup:function(){return $.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(D.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),D.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1,D.event.simulate("change",this,t,!0))})),!1):void D.event.add(this,"beforeactivate._change",function(t){var e=t.target;$.test(e.nodeName)&&!e._change_attached&&(D.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||D.event.simulate("change",this.parentNode,t,!0)}),e._change_attached=!0)})},handle:function(t){var e=t.target;if(this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type)return t.handleObj.handler.apply(this,arguments)},teardown:function(){return D.event.remove(this,"._change"),$.test(this.nodeName)}}),D.support.focusinBubbles||D.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){D.event.simulate(e,t.target,D.event.fix(t),!0)};D.event.special[e]={setup:function(){0===i++&&O.addEventListener(t,n,!0)},teardown:function(){0===--i&&O.removeEventListener(t,n,!0)}}}),D.fn.extend({on:function(t,e,i,n,o){var r,s;if("object"===("undefined"==typeof t?"undefined":M(t))){"string"!=typeof e&&(i=i||e,e=void 0);for(s in t)this.on(s,e,i,t[s],o);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=a;else if(!n)return this;return 1===o&&(r=n,n=function(t){return D().off(t),r.apply(this,arguments)},n.guid=r.guid||(r.guid=D.guid++)),this.each(function(){D.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){if(t&&t.preventDefault&&t.handleObj){var n=t.handleObj;return D(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this}if("object"===("undefined"==typeof t?"undefined":M(t))){for(var o in t)this.off(o,e,t[o]);return this}return e!==!1&&"function"!=typeof e||(i=e,e=void 0),i===!1&&(i=a),this.each(function(){D.event.remove(this,t,i,e)})},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},live:function(t,e,i){return D(this.context).on(t,this.selector,e,i),this},die:function(t,e){return D(this.context).off(t,this.selector||"**",e),this},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1==arguments.length?this.off(t,"**"):this.off(e,t,i)},trigger:function(t,e){return this.each(function(){D.event.trigger(t,e,this)})},triggerHandler:function(t,e){if(this[0])return D.event.trigger(t,e,this[0],!0)},toggle:function(t){var e=arguments,i=t.guid||D.guid++,n=0,o=function(i){var o=(D._data(this,"lastToggle"+t.guid)||0)%n;return D._data(this,"lastToggle"+t.guid,o+1),i.preventDefault(),e[o].apply(this,arguments)||!1};for(o.guid=i;n<e.length;)e[n++].guid=i;return this.click(o)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),D.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){D.fn[e]=function(t,i){return null==i&&(i=t,t=null),arguments.length>0?this.on(e,null,t,i):this.trigger(e)},D.attrFn&&(D.attrFn[e]=!0),et.test(e)&&(D.event.fixHooks[e]=D.event.keyHooks),it.test(e)&&(D.event.fixHooks[e]=D.event.mouseHooks)}),function(){function t(t,e,i,o,r,a){for(var s=0,l=o.length;s<l;s++){var d=o[s];if(d){var h=!1;for(d=d[t];d;){if(d[n]===i){h=o[d.sizset];break}if(1!==d.nodeType||a||(d[n]=i,d.sizset=s),d.nodeName.toLowerCase()===e){h=d;break}d=d[t]}o[s]=h}}}function e(t,e,i,o,r,a){for(var s=0,l=o.length;s<l;s++){var d=o[s];if(d){var h=!1;for(d=d[t];d;){if(d[n]===i){h=o[d.sizset];break}if(1===d.nodeType)if(a||(d[n]=i,d.sizset=s),"string"!=typeof e){if(d===e){h=!0;break}}else if(u.filter(e,[d]).length>0){h=d;break}d=d[t]}o[s]=h}}}var i=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,n="sizcache"+(Math.random()+"").replace(".",""),o=0,r=Object.prototype.toString,a=!1,s=!0,l=/\\/g,d=/\r\n/g,h=/\W/;[0,0].sort(function(){return s=!1,0});var u=function(t,e,n,o){n=n||[],e=e||O;var a=e;if(1!==e.nodeType&&9!==e.nodeType)return[];if(!t||"string"!=typeof t)return n;var s,l,d,h,c,g,m,y,b=!0,w=u.isXML(e),P=[],E=t;do if(i.exec(""),s=i.exec(E),s&&(E=s[3],P.push(s[1]),s[2])){h=s[3];break}while(s);if(P.length>1&&f.exec(t))if(2===P.length&&p.relative[P[0]])l=_(P[0]+P[1],e,o);else for(l=p.relative[P[0]]?[e]:u(P.shift(),e);P.length;)t=P.shift(),p.relative[t]&&(t+=P.shift()),l=_(t,l,o);else if(!o&&P.length>1&&9===e.nodeType&&!w&&p.match.ID.test(P[0])&&!p.match.ID.test(P[P.length-1])&&(c=u.find(P.shift(),e,w),e=c.expr?u.filter(c.expr,c.set)[0]:c.set[0]),e)for(c=o?{expr:P.pop(),set:v(o)}:u.find(P.pop(),1!==P.length||"~"!==P[0]&&"+"!==P[0]||!e.parentNode?e:e.parentNode,w),l=c.expr?u.filter(c.expr,c.set):c.set,P.length>0?d=v(l):b=!1;P.length;)g=P.pop(),m=g,p.relative[g]?m=P.pop():g="",null==m&&(m=e),p.relative[g](d,m,w);else d=P=[];if(d||(d=l),d||u.error(g||t),"[object Array]"===r.call(d))if(b)if(e&&1===e.nodeType)for(y=0;null!=d[y];y++)d[y]&&(d[y]===!0||1===d[y].nodeType&&u.contains(e,d[y]))&&n.push(l[y]);else for(y=0;null!=d[y];y++)d[y]&&1===d[y].nodeType&&n.push(l[y]);else n.push.apply(n,d);else v(d,n);return h&&(u(h,a,n,o),u.uniqueSort(n)),n};u.uniqueSort=function(t){if(b&&(a=s,t.sort(b),a))for(var e=1;e<t.length;e++)t[e]===t[e-1]&&t.splice(e--,1);return t},u.matches=function(t,e){return u(t,null,null,e)},u.matchesSelector=function(t,e){return u(e,null,null,[t]).length>0},u.find=function(t,e,i){var n,o,r,a,s,d;if(!t)return[];for(o=0,r=p.order.length;o<r;o++)if(s=p.order[o],(a=p.leftMatch[s].exec(t))&&(d=a[1],a.splice(1,1),"\\"!==d.substr(d.length-1)&&(a[1]=(a[1]||"").replace(l,""),n=p.find[s](a,e,i),null!=n))){t=t.replace(p.match[s],"");break}return n||(n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):[]),
{set:n,expr:t}},u.filter=function(t,e,i,n){for(var o,r,a,s,l,d,h,c,f,g=t,m=[],v=e,y=e&&e[0]&&u.isXML(e[0]);t&&e.length;){for(a in p.filter)if(null!=(o=p.leftMatch[a].exec(t))&&o[2]){if(d=p.filter[a],h=o[1],r=!1,o.splice(1,1),"\\"===h.substr(h.length-1))continue;if(v===m&&(m=[]),p.preFilter[a])if(o=p.preFilter[a](o,v,i,m,n,y)){if(o===!0)continue}else r=s=!0;if(o)for(c=0;null!=(l=v[c]);c++)l&&(s=d(l,o,c,v),f=n^s,i&&null!=s?f?r=!0:v[c]=!1:f&&(m.push(l),r=!0));if(void 0!==s){if(i||(v=m),t=t.replace(p.match[a],""),!r)return[];break}}if(t===g){if(null!=r)break;u.error(t)}g=t}return v},u.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)};var c=u.getText=function(t){var e,i,n=t.nodeType,o="";if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;if("string"==typeof t.innerText)return t.innerText.replace(d,"");for(t=t.firstChild;t;t=t.nextSibling)o+=c(t)}else if(3===n||4===n)return t.nodeValue}else for(e=0;i=t[e];e++)8!==i.nodeType&&(o+=c(i));return o},p=u.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(t){return t.getAttribute("href")},type:function(t){return t.getAttribute("type")}},relative:{"+":function(t,e){var i="string"==typeof e,n=i&&!h.test(e),o=i&&!n;n&&(e=e.toLowerCase());for(var r,a=0,s=t.length;a<s;a++)if(r=t[a]){for(;(r=r.previousSibling)&&1!==r.nodeType;);t[a]=o||r&&r.nodeName.toLowerCase()===e?r||!1:r===e}o&&u.filter(e,t,!0)},">":function(t,e){var i,n="string"==typeof e,o=0,r=t.length;if(n&&!h.test(e)){for(e=e.toLowerCase();o<r;o++)if(i=t[o]){var a=i.parentNode;t[o]=a.nodeName.toLowerCase()===e&&a}}else{for(;o<r;o++)i=t[o],i&&(t[o]=n?i.parentNode:i.parentNode===e);n&&u.filter(e,t,!0)}},"":function(i,n,r){var a,s=o++,l=e;"string"!=typeof n||h.test(n)||(n=n.toLowerCase(),a=n,l=t),l("parentNode",n,s,i,a,r)},"~":function(i,n,r){var a,s=o++,l=e;"string"!=typeof n||h.test(n)||(n=n.toLowerCase(),a=n,l=t),l("previousSibling",n,s,i,a,r)}},find:{ID:function(t,e,i){if("undefined"!=typeof e.getElementById&&!i){var n=e.getElementById(t[1]);return n&&n.parentNode?[n]:[]}},NAME:function(t,e){if("undefined"!=typeof e.getElementsByName){for(var i=[],n=e.getElementsByName(t[1]),o=0,r=n.length;o<r;o++)n[o].getAttribute("name")===t[1]&&i.push(n[o]);return 0===i.length?null:i}},TAG:function(t,e){if("undefined"!=typeof e.getElementsByTagName)return e.getElementsByTagName(t[1])}},preFilter:{CLASS:function(t,e,i,n,o,r){if(t=" "+t[1].replace(l,"")+" ",r)return t;for(var a,s=0;null!=(a=e[s]);s++)a&&(o^(a.className&&(" "+a.className+" ").replace(/[\t\n\r]/g," ").indexOf(t)>=0)?i||n.push(a):i&&(e[s]=!1));return!1},ID:function(t){return t[1].replace(l,"")},TAG:function(t,e){return t[1].replace(l,"").toLowerCase()},CHILD:function(t){if("nth"===t[1]){t[2]||u.error(t[0]),t[2]=t[2].replace(/^\+|\s*/g,"");var e=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===t[2]&&"2n"||"odd"===t[2]&&"2n+1"||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=e[1]+(e[2]||1)-0,t[3]=e[3]-0}else t[2]&&u.error(t[0]);return t[0]=o++,t},ATTR:function(t,e,i,n,o,r){var a=t[1]=t[1].replace(l,"");return!r&&p.attrMap[a]&&(t[1]=p.attrMap[a]),t[4]=(t[4]||t[5]||"").replace(l,""),"~="===t[2]&&(t[4]=" "+t[4]+" "),t},PSEUDO:function(t,e,n,o,r){if("not"===t[1]){if(!((i.exec(t[3])||"").length>1||/^\w/.test(t[3]))){var a=u.filter(t[3],e,n,!0^r);return n||o.push.apply(o,a),!1}t[3]=u(t[3],null,null,e)}else if(p.match.POS.test(t[0])||p.match.CHILD.test(t[0]))return!0;return t},POS:function(t){return t.unshift(!0),t}},filters:{enabled:function(t){return t.disabled===!1&&"hidden"!==t.type},disabled:function(t){return t.disabled===!0},checked:function(t){return t.checked===!0},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},parent:function(t){return!!t.firstChild},empty:function(t){return!t.firstChild},has:function(t,e,i){return!!u(i[3],t).length},header:function(t){return/h\d/i.test(t.nodeName)},text:function(t){var e=t.getAttribute("type"),i=t.type;return"input"===t.nodeName.toLowerCase()&&"text"===i&&(e===i||null===e)},radio:function(t){return"input"===t.nodeName.toLowerCase()&&"radio"===t.type},checkbox:function(t){return"input"===t.nodeName.toLowerCase()&&"checkbox"===t.type},file:function(t){return"input"===t.nodeName.toLowerCase()&&"file"===t.type},password:function(t){return"input"===t.nodeName.toLowerCase()&&"password"===t.type},submit:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"submit"===t.type},image:function(t){return"input"===t.nodeName.toLowerCase()&&"image"===t.type},reset:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"_reset"===t.type},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},input:function(t){return/input|select|textarea|button/i.test(t.nodeName)},focus:function(t){return t===t.ownerDocument.activeElement}},setFilters:{first:function(t,e){return 0===e},last:function(t,e,i,n){return e===n.length-1},even:function(t,e){return e%2===0},odd:function(t,e){return e%2===1},lt:function(t,e,i){return e<i[3]-0},gt:function(t,e,i){return e>i[3]-0},nth:function(t,e,i){return i[3]-0===e},eq:function(t,e,i){return i[3]-0===e}},filter:{PSEUDO:function(t,e,i,n){var o=e[1],r=p.filters[o];if(r)return r(t,i,e,n);if("contains"===o)return(t.textContent||t.innerText||c([t])||"").indexOf(e[3])>=0;if("not"===o){for(var a=e[3],s=0,l=a.length;s<l;s++)if(a[s]===t)return!1;return!0}u.error(o)},CHILD:function(t,e){var i,o,r,a,s,l,d=e[1],h=t;switch(d){case"only":case"first":for(;h=h.previousSibling;)if(1===h.nodeType)return!1;if("first"===d)return!0;h=t;case"last":for(;h=h.nextSibling;)if(1===h.nodeType)return!1;return!0;case"nth":if(i=e[2],o=e[3],1===i&&0===o)return!0;if(r=e[0],a=t.parentNode,a&&(a[n]!==r||!t.nodeIndex)){for(s=0,h=a.firstChild;h;h=h.nextSibling)1===h.nodeType&&(h.nodeIndex=++s);a[n]=r}return l=t.nodeIndex-o,0===i?0===l:l%i===0&&l/i>=0}},ID:function(t,e){return 1===t.nodeType&&t.getAttribute("id")===e},TAG:function(t,e){return"*"===e&&1===t.nodeType||!!t.nodeName&&t.nodeName.toLowerCase()===e},CLASS:function(t,e){return(" "+(t.className||t.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(t,e){var i=e[1],n=u.attr?u.attr(t,i):p.attrHandle[i]?p.attrHandle[i](t):null!=t[i]?t[i]:t.getAttribute(i),o=n+"",r=e[2],a=e[4];return null==n?"!="===r:!r&&u.attr?null!=n:"="===r?o===a:"*="===r?o.indexOf(a)>=0:"~="===r?(" "+o+" ").indexOf(a)>=0:a?"!="===r?o!==a:"^="===r?0===o.indexOf(a):"$="===r?o.substr(o.length-a.length)===a:"|="===r&&(o===a||o.substr(0,a.length+1)===a+"-"):o&&n!==!1},POS:function(t,e,i,n){var o=e[2],r=p.setFilters[o];if(r)return r(t,i,e,n)}}},f=p.match.POS,g=function(t,e){return"\\"+(e-0+1)};for(var m in p.match)p.match[m]=new RegExp(p.match[m].source+/(?![^\[]*\])(?![^\(]*\))/.source),p.leftMatch[m]=new RegExp(/(^(?:.|\r|\n)*?)/.source+p.match[m].source.replace(/\\(\d+)/g,g));p.match.globalPOS=f;var v=function(t,e){return t=Array.prototype.slice.call(t,0),e?(e.push.apply(e,t),e):t};try{Array.prototype.slice.call(O.documentElement.childNodes,0)[0].nodeType}catch(y){v=function(t,e){var i=0,n=e||[];if("[object Array]"===r.call(t))Array.prototype.push.apply(n,t);else if("number"==typeof t.length)for(var o=t.length;i<o;i++)n.push(t[i]);else for(;t[i];i++)n.push(t[i]);return n}}var b,w;O.documentElement.compareDocumentPosition?b=function(t,e){return t===e?(a=!0,0):t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:1:t.compareDocumentPosition?-1:1}:(b=function(t,e){if(t===e)return a=!0,0;if(t.sourceIndex&&e.sourceIndex)return t.sourceIndex-e.sourceIndex;var i,n,o=[],r=[],s=t.parentNode,l=e.parentNode,d=s;if(s===l)return w(t,e);if(!s)return-1;if(!l)return 1;for(;d;)o.unshift(d),d=d.parentNode;for(d=l;d;)r.unshift(d),d=d.parentNode;i=o.length,n=r.length;for(var h=0;h<i&&h<n;h++)if(o[h]!==r[h])return w(o[h],r[h]);return h===i?w(t,r[h],-1):w(o[h],e,1)},w=function(t,e,i){if(t===e)return i;for(var n=t.nextSibling;n;){if(n===e)return-1;n=n.nextSibling}return 1}),function(){var t=O.createElement("div"),e="script"+(new Date).getTime(),i=O.documentElement;t.innerHTML="<a name='"+e+"'/>",i.insertBefore(t,i.firstChild),O.getElementById(e)&&(p.find.ID=function(t,e,i){if("undefined"!=typeof e.getElementById&&!i){var n=e.getElementById(t[1]);return n?n.id===t[1]||"undefined"!=typeof n.getAttributeNode&&n.getAttributeNode("id").nodeValue===t[1]?[n]:void 0:[]}},p.filter.ID=function(t,e){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return 1===t.nodeType&&i&&i.nodeValue===e}),i.removeChild(t),i=t=null}(),function(){var t=O.createElement("div");t.appendChild(O.createComment("")),t.getElementsByTagName("*").length>0&&(p.find.TAG=function(t,e){var i=e.getElementsByTagName(t[1]);if("*"===t[1]){for(var n=[],o=0;i[o];o++)1===i[o].nodeType&&n.push(i[o]);i=n}return i}),t.innerHTML="<a href='#'></a>",t.firstChild&&"undefined"!=typeof t.firstChild.getAttribute&&"#"!==t.firstChild.getAttribute("href")&&(p.attrHandle.href=function(t){return t.getAttribute("href",2)}),t=null}(),O.querySelectorAll&&!function(){var t=u,e=O.createElement("div"),i="__sizzle__";if(e.innerHTML="<p class='TEST'></p>",!e.querySelectorAll||0!==e.querySelectorAll(".TEST").length){u=function(e,n,o,r){if(n=n||O,!r&&!u.isXML(n)){var a=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(e);if(a&&(1===n.nodeType||9===n.nodeType)){if(a[1])return v(n.getElementsByTagName(e),o);if(a[2]&&p.find.CLASS&&n.getElementsByClassName)return v(n.getElementsByClassName(a[2]),o)}if(9===n.nodeType){if("body"===e&&n.body)return v([n.body],o);if(a&&a[3]){var s=n.getElementById(a[3]);if(!s||!s.parentNode)return v([],o);if(s.id===a[3])return v([s],o)}try{return v(n.querySelectorAll(e),o)}catch(l){}}else if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){var d=n,h=n.getAttribute("id"),c=h||i,f=n.parentNode,g=/^\s*[+~]/.test(e);h?c=c.replace(/'/g,"\\$&"):n.setAttribute("id",c),g&&f&&(n=n.parentNode);try{if(!g||f)return v(n.querySelectorAll("[id='"+c+"'] "+e),o)}catch(m){}finally{h||d.removeAttribute("id")}}}return t(e,n,o,r)};for(var n in t)u[n]=t[n];e=null}}(),function(){var t=O.documentElement,e=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector;if(e){var i=!e.call(O.createElement("div"),"div"),n=!1;try{e.call(O.documentElement,"[test!='']:sizzle")}catch(o){n=!0}u.matchesSelector=function(t,o){if(o=o.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!u.isXML(t))try{if(n||!p.match.PSEUDO.test(o)&&!/!=/.test(o)){var r=e.call(t,o);if(r||!i||t.document&&11!==t.document.nodeType)return r}}catch(a){}return u(o,null,null,[t]).length>0}}}(),function(){var t=O.createElement("div");t.innerHTML="<div class='test e'></div><div class='test'></div>",t.getElementsByClassName&&0!==t.getElementsByClassName("e").length&&(t.lastChild.className="e",1!==t.getElementsByClassName("e").length&&(p.order.splice(1,0,"CLASS"),p.find.CLASS=function(t,e,i){if("undefined"!=typeof e.getElementsByClassName&&!i)return e.getElementsByClassName(t[1])},t=null))}(),O.documentElement.contains?u.contains=function(t,e){return t!==e&&(!t.contains||t.contains(e))}:O.documentElement.compareDocumentPosition?u.contains=function(t,e){return!!(16&t.compareDocumentPosition(e))}:u.contains=function(){return!1},u.isXML=function(t){var e=(t?t.ownerDocument||t:0).documentElement;return!!e&&"HTML"!==e.nodeName};var _=function(t,e,i){for(var n,o=[],r="",a=e.nodeType?[e]:e;n=p.match.PSEUDO.exec(t);)r+=n[0],t=t.replace(p.match.PSEUDO,"");t=p.relative[t]?t+"*":t;for(var s=0,l=a.length;s<l;s++)u(t,a[s],o,i);return u.filter(r,o)};u.attr=D.attr,u.selectors.attrMap={},D.find=u,D.expr=u.selectors,D.expr[":"]=D.expr.filters,D.unique=u.uniqueSort,D.text=u.getText,D.isXMLDoc=u.isXML,D.contains=u.contains}();var lt=/Until$/,dt=/^(?:parents|prevUntil|prevAll)/,ht=/,/,ut=/^.[^:#\[\.,]*$/,ct=Array.prototype.slice,pt=D.expr.match.globalPOS,ft={children:!0,contents:!0,next:!0,prev:!0};D.fn.extend({find:function(t){var e,i,n=this;if("string"!=typeof t)return D(t).filter(function(){for(e=0,i=n.length;e<i;e++)if(D.contains(n[e],this))return!0});var o,r,a,s=this.pushStack("","find",t);for(e=0,i=this.length;e<i;e++)if(o=s.length,D.find(t,this[e],s),e>0)for(r=o;r<s.length;r++)for(a=0;a<o;a++)if(s[a]===s[r]){s.splice(r--,1);break}return s},has:function(t){var e=D(t);return this.filter(function(){for(var t=0,i=e.length;t<i;t++)if(D.contains(this,e[t]))return!0})},not:function(t){return this.pushStack(d(this,t,!1),"not",t)},filter:function(t){return this.pushStack(d(this,t,!0),"filter",t)},is:function(t){return!!t&&("string"==typeof t?pt.test(t)?D(t,this.context).index(this[0])>=0:D.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){var i,n,o=[],r=this[0];if(D.isArray(t)){for(var a=1;r&&r.ownerDocument&&r!==e;){for(i=0;i<t.length;i++)D(r).is(t[i])&&o.push({selector:t[i],elem:r,level:a});r=r.parentNode,a++}return o}var s=pt.test(t)||"string"!=typeof t?D(t,e||this.context):0;for(i=0,n=this.length;i<n;i++)for(r=this[i];r;){if(s?s.index(r)>-1:D.find.matchesSelector(r,t)){o.push(r);break}if(r=r.parentNode,!r||!r.ownerDocument||r===e||11===r.nodeType)break}return o=o.length>1?D.unique(o):o,this.pushStack(o,"closest",t)},index:function(t){return t?"string"==typeof t?D.inArray(this[0],D(t)):D.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(t,e){var i="string"==typeof t?D(t,e):D.makeArray(t&&t.nodeType?[t]:t),n=D.merge(this.get(),i);return this.pushStack(l(i[0])||l(n[0])?n:D.unique(n))},andSelf:function(){return this.add(this.prevObject)}}),D.each({parent:function Se(t){var Se=t.parentNode;return Se&&11!==Se.nodeType?Se:null},parents:function(t){return D.dir(t,"parentNode")},parentsUntil:function(t,e,i){return D.dir(t,"parentNode",i)},next:function(t){return D.nth(t,2,"nextSibling")},prev:function(t){return D.nth(t,2,"previousSibling")},nextAll:function(t){return D.dir(t,"nextSibling")},prevAll:function(t){return D.dir(t,"previousSibling")},nextUntil:function(t,e,i){return D.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return D.dir(t,"previousSibling",i)},siblings:function(t){return D.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return D.sibling(t.firstChild)},contents:function(t){return D.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:D.makeArray(t.childNodes)}},function(t,e){D.fn[t]=function(i,n){var o=D.map(this,e,i);return lt.test(t)||(n=i),n&&"string"==typeof n&&(o=D.filter(n,o)),o=this.length>1&&!ft[t]?D.unique(o):o,(this.length>1||ht.test(n))&&dt.test(t)&&(o=o.reverse()),this.pushStack(o,t,ct.call(arguments).join(","))}}),D.extend({filter:function(t,e,i){return i&&(t=":not("+t+")"),1===e.length?D.find.matchesSelector(e[0],t)?[e[0]]:[]:D.find.matches(t,e)},dir:function(t,e,i){for(var n=[],o=t[e];o&&9!==o.nodeType&&(void 0===i||1!==o.nodeType||!D(o).is(i));)1===o.nodeType&&n.push(o),o=o[e];return n},nth:function(t,e,i,n){e=e||1;for(var o=0;t&&(1!==t.nodeType||++o!==e);t=t[i]);return t},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var gt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",mt=/ jQuery\d+="(?:\d+|null)"/g,vt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,_t=/<|&#?\w+;/,Pt=/<(?:script|style)/i,Et=/<(?:script|object|embed|option|style)/i,Tt=new RegExp("<(?:"+gt+")[\\s/>]","i"),Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,At=/\/(java|ecma)script/i,xt=/^\s*<!(?:\[CDATA\[|\-\-)/,St={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},kt=h(O);St.optgroup=St.option,St.tbody=St.tfoot=St.colgroup=St.caption=St.thead,St.th=St.td,D.support.htmlSerialize||(St._default=[1,"div<div>","</div>"]),D.fn.extend({text:function(t){return D.access(this,function(t){return void 0===t?D.text(this):this.empty().append((this[0]&&this[0].ownerDocument||O).createTextNode(t))},null,t,arguments.length)},wrapAll:function(t){if(D.isFunction(t))return this.each(function(e){D(this).wrapAll(t.call(this,e))});if(this[0]){var e=D(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return D.isFunction(t)?this.each(function(e){D(this).wrapInner(t.call(this,e))}):this.each(function(){var e=D(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=D.isFunction(t);return this.each(function(i){D(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){D.nodeName(this,"body")||D(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.insertBefore(t,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this)});if(arguments.length){var t=D.clean(arguments);return t.push.apply(t,this.toArray()),this.pushStack(t,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this.nextSibling)});if(arguments.length){var t=this.pushStack(this,"after",arguments);return t.push.apply(t,D.clean(arguments)),t}},remove:function(t,e){for(var i,n=0;null!=(i=this[n]);n++)t&&!D.filter(t,[i]).length||(e||1!==i.nodeType||(D.cleanData(i.getElementsByTagName("*")),D.cleanData([i])),i.parentNode&&i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)for(1===t.nodeType&&D.cleanData(t.getElementsByTagName("*"));t.firstChild;)t.removeChild(t.firstChild);return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return D.clone(this,t,e)})},html:function(t){return D.access(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(mt,""):null;if("string"==typeof t&&!Pt.test(t)&&(D.support.leadingWhitespace||!vt.test(t))&&!St[(bt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(yt,"<$1></$2>");try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(D.cleanData(e.getElementsByTagName("*")),e.innerHTML=t);e=0}catch(o){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(t){return this[0]&&this[0].parentNode?D.isFunction(t)?this.each(function(e){var i=D(this),n=i.html();i.replaceWith(t.call(this,e,n))}):("string"!=typeof t&&(t=D(t).detach()),this.each(function(){var e=this.nextSibling,i=this.parentNode;D(this).remove(),e?D(e).before(t):D(i).append(t)})):this.length?this.pushStack(D(D.isFunction(t)?t():t),"replaceWith",t):this},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){var n,o,r,a,s=t[0],l=[];if(!D.support.checkClone&&3===arguments.length&&"string"==typeof s&&Ct.test(s))return this.each(function(){D(this).domManip(t,e,i,!0)});if(D.isFunction(s))return this.each(function(n){var o=D(this);t[0]=s.call(this,n,e?o.html():void 0),o.domManip(t,e,i)});if(this[0]){if(a=s&&s.parentNode,n=D.support.parentNode&&a&&11===a.nodeType&&a.childNodes.length===this.length?{fragment:a}:D.buildFragment(t,this,l),r=n.fragment,o=1===r.childNodes.length?r=r.firstChild:r.firstChild){e=e&&D.nodeName(o,"tr");for(var d=0,h=this.length,c=h-1;d<h;d++)i.call(e?u(this[d],o):this[d],n.cacheable||h>1&&d<c?D.clone(r,!0,!0):r)}l.length&&D.each(l,function(t,e){e.src?D.ajax({type:"GET",global:!1,url:e.src,async:!1,dataType:"script"}):D.globalEval((e.text||e.textContent||e.innerHTML||"").replace(xt,"/*$0*/")),e.parentNode&&e.parentNode.removeChild(e)})}return this}}),D.buildFragment=function(t,e,i){var n,o,r,a,s=t[0];return e&&e[0]&&(a=e[0].ownerDocument||e[0]),a.createDocumentFragment||(a=O),!(1===t.length&&"string"==typeof s&&s.length<512&&a===O&&"<"===s.charAt(0))||Et.test(s)||!D.support.checkClone&&Ct.test(s)||!D.support.html5Clone&&Tt.test(s)||(o=!0,r=D.fragments[s],r&&1!==r&&(n=r)),n||(n=a.createDocumentFragment(),D.clean(t,a,n,i)),o&&(D.fragments[s]=r?n:1),{fragment:n,cacheable:o}},D.fragments={},D.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){D.fn[t]=function(i){var n=[],o=D(i),r=1===this.length&&this[0].parentNode;if(r&&11===r.nodeType&&1===r.childNodes.length&&1===o.length)return o[e](this[0]),this;for(var a=0,s=o.length;a<s;a++){var l=(a>0?this.clone(!0):this).get();D(o[a])[e](l),n=n.concat(l)}return this.pushStack(n,t,o.selector)}}),D.extend({clone:function ke(t,e,i){var n,o,r,ke=D.support.html5Clone||D.isXMLDoc(t)||!Tt.test("<"+t.nodeName+">")?t.cloneNode(!0):v(t);if(!(D.support.noCloneEvent&&D.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||D.isXMLDoc(t)))for(p(t,ke),n=f(t),o=f(ke),r=0;n[r];++r)o[r]&&p(n[r],o[r]);if(e&&(c(t,ke),i))for(n=f(t),o=f(ke),r=0;n[r];++r)c(n[r],o[r]);return n=o=null,ke},clean:function(t,e,i,n){var o,r,a,s=[];e=e||O,"undefined"==typeof e.createElement&&(e=e.ownerDocument||e[0]&&e[0].ownerDocument||O);for(var l,d=0;null!=(l=t[d]);d++)if("number"==typeof l&&(l+=""),l){if("string"==typeof l)if(_t.test(l)){l=l.replace(yt,"<$1></$2>");var u,c=(bt.exec(l)||["",""])[1].toLowerCase(),p=St[c]||St._default,f=p[0],g=e.createElement("div"),v=kt.childNodes;for(e===O?kt.appendChild(g):h(e).appendChild(g),g.innerHTML=p[1]+l+p[2];f--;)g=g.lastChild;if(!D.support.tbody){var y=wt.test(l),b="table"!==c||y?"<table>"!==p[1]||y?[]:g.childNodes:g.firstChild&&g.firstChild.childNodes;for(a=b.length-1;a>=0;--a)D.nodeName(b[a],"tbody")&&!b[a].childNodes.length&&b[a].parentNode.removeChild(b[a])}!D.support.leadingWhitespace&&vt.test(l)&&g.insertBefore(e.createTextNode(vt.exec(l)[0]),g.firstChild),l=g.childNodes,g&&(g.parentNode.removeChild(g),v.length>0&&(u=v[v.length-1],u&&u.parentNode&&u.parentNode.removeChild(u)))}else l=e.createTextNode(l);var w;if(!D.support.appendChecked)if(l[0]&&"number"==typeof(w=l.length))for(a=0;a<w;a++)m(l[a]);else m(l);l.nodeType?s.push(l):s=D.merge(s,l)}if(i)for(o=function(t){return!t.type||At.test(t.type)},d=0;s[d];d++)if(r=s[d],n&&D.nodeName(r,"script")&&(!r.type||At.test(r.type)))n.push(r.parentNode?r.parentNode.removeChild(r):r);else{if(1===r.nodeType){var _=D.grep(r.getElementsByTagName("script"),o);s.splice.apply(s,[d+1,0].concat(_))}i.appendChild(r)}return s},cleanData:function(t){for(var e,i,n,o=D.cache,r=D.event.special,a=D.support.deleteExpando,s=0;null!=(n=t[s]);s++)if((!n.nodeName||!D.noData[n.nodeName.toLowerCase()])&&(i=n[D.expando])){if(e=o[i],e&&e.events){for(var l in e.events)r[l]?D.event.remove(n,l):D.removeEvent(n,l,e.handle);e.handle&&(e.handle.elem=null)}a?delete n[D.expando]:n.removeAttribute&&n.removeAttribute(D.expando),delete o[i]}}});var It,Lt,Mt,Ot=/alpha\([^)]*\)/i,Nt=/opacity=([^)]*)/,Bt=/([A-Z]|^ms)/g,Dt=/^[\-+]?(?:\d*\.)?\d+$/i,zt=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Rt=/^([\-+])=([\-+.\de]+)/,Ft=/^margin/,Wt={position:"absolute",visibility:"hidden",display:"block"},Ht=["Top","Right","Bottom","Left"];D.fn.css=function(t,e){return D.access(this,function(t,e,i){return void 0!==i?D.style(t,e,i):D.css(t,e)},t,e,arguments.length>1)},D.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=It(t,"opacity");return""===i?"1":i}return t.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":D.support.cssFloat?"cssFloat":"styleFloat"},style:function Ie(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,a=D.camelCase(e),Ie=t.style,s=D.cssHooks[a];if(e=D.cssProps[a]||a,void 0===i)return s&&"get"in s&&void 0!==(o=s.get(t,!1,n))?o:Ie[e];if(r="undefined"==typeof i?"undefined":M(i),"string"===r&&(o=Rt.exec(i))&&(i=+(o[1]+1)*+o[2]+parseFloat(D.css(t,e)),r="number"),!(null==i||"number"===r&&isNaN(i)||("number"!==r||D.cssNumber[a]||(i+="px"),s&&"set"in s&&void 0===(i=s.set(t,i)))))try{Ie[e]=i}catch(l){}}},css:function(t,e,i){var n,o;return e=D.camelCase(e),o=D.cssHooks[e],e=D.cssProps[e]||e,"cssFloat"===e&&(e="float"),o&&"get"in o&&void 0!==(n=o.get(t,!0,i))?n:It?It(t,e):void 0},swap:function(t,e,i){var n,o,r={};for(o in e)r[o]=t.style[o],t.style[o]=e[o];n=i.call(t);for(o in e)t.style[o]=r[o];return n}}),D.curCSS=D.css,O.defaultView&&O.defaultView.getComputedStyle&&(Lt=function(t,e){var i,n,o,r,a=t.style;return e=e.replace(Bt,"-$1").toLowerCase(),(n=t.ownerDocument.defaultView)&&(o=n.getComputedStyle(t,null))&&(i=o.getPropertyValue(e),""!==i||D.contains(t.ownerDocument.documentElement,t)||(i=D.style(t,e))),!D.support.pixelMargin&&o&&Ft.test(e)&&zt.test(i)&&(r=a.width,a.width=i,i=o.width,a.width=r),i}),O.documentElement.currentStyle&&(Mt=function(t,e){var i,n,o,r=t.currentStyle&&t.currentStyle[e],a=t.style;return null==r&&a&&(o=a[e])&&(r=o),zt.test(r)&&(i=a.left,n=t.runtimeStyle&&t.runtimeStyle.left,n&&(t.runtimeStyle.left=t.currentStyle.left),a.left="fontSize"===e?"1em":r,r=a.pixelLeft+"px",a.left=i,n&&(t.runtimeStyle.left=n)),""===r?"auto":r}),It=Lt||Mt,D.each(["height","width"],function(t,e){D.cssHooks[e]={get:function(t,i,n){if(i)return 0!==t.offsetWidth?y(t,e,n):D.swap(t,Wt,function(){return y(t,e,n)})},set:function(t,e){return Dt.test(e)?e+"px":e}}}),D.support.opacity||(D.cssHooks.opacity={get:function(t,e){return Nt.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,o=D.isNumeric(e)?"alpha(opacity="+100*e+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,e>=1&&""===D.trim(r.replace(Ot,""))&&(i.removeAttribute("filter"),n&&!n.filter)||(i.filter=Ot.test(r)?r.replace(Ot,o):r+" "+o)}}),D(function(){D.support.reliableMarginRight||(D.cssHooks.marginRight={get:function(t,e){return D.swap(t,{display:"inline-block"},function(){return e?It(t,"margin-right"):t.style.marginRight})}})}),D.expr&&D.expr.filters&&(D.expr.filters.hidden=function(t){var e=t.offsetWidth,i=t.offsetHeight;return 0===e&&0===i||!D.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||D.css(t,"display"))},D.expr.filters.visible=function(t){return!D.expr.filters.hidden(t)}),D.each({margin:"",padding:"",border:"Width"},function(t,e){D.cssHooks[t+e]={expand:function(i){var n,o="string"==typeof i?i.split(" "):[i],r={};for(n=0;n<4;n++)r[t+Ht[n]+e]=o[n]||o[n-2]||o[0];return r}}});var Ut,jt,Vt=/%20/g,qt=/\[\]$/,Gt=/\r?\n/g,Xt=/#.*$/,Yt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Qt=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Zt=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Kt=/^(?:GET|HEAD)$/,$t=/^\/\//,Jt=/\?/,te=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ee=/^(?:select|textarea)/i,ie=/\s+/,ne=/([?&])_=[^&]*/,oe=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,re=D.fn.load,ae={},se={},le=["*/"]+["*"];try{Ut=B.href}catch(de){Ut=O.createElement("a"),Ut.href="",Ut=Ut.href}jt=oe.exec(Ut.toLowerCase())||[],D.fn.extend({load:function(t,e,i){if("string"!=typeof t&&re)return re.apply(this,arguments);if(!this.length)return this;var n=t.indexOf(" ");if(n>=0){var o=t.slice(n,t.length);t=t.slice(0,n)}var r="GET";e&&(D.isFunction(e)?(i=e,e=void 0):"object"===("undefined"==typeof e?"undefined":M(e))&&(e=D.param(e,D.ajaxSettings.traditional),r="POST"));var a=this;return D.ajax({url:t,type:r,dataType:"html",data:e,complete:function(t,e,n){n=t.responseText,t.isResolved()&&(t.done(function(t){n=t}),a.html(o?D("<div>").append(n.replace(te,"")).find(o):n)),i&&a.each(i,[n,e,t])}}),this},serialize:function(){return D.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?D.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ee.test(this.nodeName)||Qt.test(this.type))}).map(function(t,e){var i=D(this).val();return null==i?null:D.isArray(i)?D.map(i,function(t,i){return{name:e.name,value:t.replace(Gt,"\r\n")}}):{name:e.name,value:i.replace(Gt,"\r\n")}}).get()}}),D.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(t,e){D.fn[e]=function(t){return this.on(e,t)}}),D.each(["get","post"],function(t,e){D[e]=function(t,i,n,o){return D.isFunction(i)&&(o=o||n,n=i,i=void 0),D.ajax({type:e,url:t,data:i,success:n,dataType:o})}}),D.extend({getScript:function(t,e){return D.get(t,void 0,e,"script")},getJSON:function(t,e,i){return D.get(t,e,i,"json")},ajaxSetup:function(t,e){return e?_(t,D.ajaxSettings):(e=t,t=D.ajaxSettings),_(t,e),t},ajaxSettings:{url:Ut,isLocal:Zt.test(jt[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":le},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":!0,"text json":D.parseJSON,"text xml":D.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:b(ae),ajaxTransport:b(se),ajax:function(t,e){function i(t,e,i,r){if(2!==b){b=2,s&&clearTimeout(s),a=void 0,o=r||"",_.readyState=t>0?4:0;var l,h,v,y,w,P=e,C=i?E(u,_,i):void 0;if(t>=200&&t<300||304===t)if(u.ifModified&&((y=_.getResponseHeader("Last-Modified"))&&(D.lastModified[n]=y),(w=_.getResponseHeader("Etag"))&&(D.etag[n]=w)),304===t)P="notmodified",l=!0;else try{h=T(u,C),P="success",l=!0}catch(A){P="parsererror",v=A}else v=P,P&&!t||(P="error",t<0&&(t=0));_.status=t,_.statusText=""+(e||P),l?f.resolveWith(c,[h,P,_]):f.rejectWith(c,[_,P,v]),_.statusCode(m),m=void 0,d&&p.trigger("ajax"+(l?"Success":"Error"),[_,u,l?h:v]),g.fireWith(c,[_,P]),d&&(p.trigger("ajaxComplete",[_,u]),--D.active||D.event.trigger("ajaxStop"))}}"object"===("undefined"==typeof t?"undefined":M(t))&&(e=t,t=void 0),e=e||{};var n,o,r,a,s,l,d,h,u=D.ajaxSetup({},e),c=u.context||u,p=c!==u&&(c.nodeType||c instanceof D)?D(c):D.event,f=D.Deferred(),g=D.Callbacks("once memory"),m=u.statusCode||{},v={},y={},b=0,_={readyState:0,setRequestHeader:function(t,e){if(!b){var i=t.toLowerCase();t=y[i]=y[i]||t,v[t]=e}return this},getAllResponseHeaders:function(){return 2===b?o:null},getResponseHeader:function(t){var e;if(2===b){if(!r)for(r={};e=Yt.exec(o);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return void 0===e?null:e},overrideMimeType:function(t){return b||(u.mimeType=t),this},abort:function(t){return t=t||"abort",a&&a.abort(t),i(0,t),this}};if(f.promise(_),_.success=_.done,_.error=_.fail,_.complete=g.add,_.statusCode=function(t){if(t){var e;if(b<2)for(e in t)m[e]=[m[e],t[e]];else e=t[_.status],_.then(e,e)}return this},u.url=((t||u.url)+"").replace(Xt,"").replace($t,jt[1]+"//"),u.dataTypes=D.trim(u.dataType||"*").toLowerCase().split(ie),null==u.crossDomain&&(l=oe.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]==jt[1]&&l[2]==jt[2]&&(l[3]||("http:"===l[1]?80:443))==(jt[3]||("http:"===jt[1]?80:443)))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=D.param(u.data,u.traditional)),
w(ae,u,e,_),2===b)return!1;if(d=u.global,u.type=u.type.toUpperCase(),u.hasContent=!Kt.test(u.type),d&&0===D.active++&&D.event.trigger("ajaxStart"),!u.hasContent&&(u.data&&(u.url+=(Jt.test(u.url)?"&":"?")+u.data,delete u.data),n=u.url,u.cache===!1)){var P=D.now(),C=u.url.replace(ne,"$1_="+P);u.url=C+(C===u.url?(Jt.test(u.url)?"&":"?")+"_="+P:"")}(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&_.setRequestHeader("Content-Type",u.contentType),u.ifModified&&(n=n||u.url,D.lastModified[n]&&_.setRequestHeader("If-Modified-Since",D.lastModified[n]),D.etag[n]&&_.setRequestHeader("If-None-Match",D.etag[n])),_.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+le+"; q=0.01":""):u.accepts["*"]);for(h in u.headers)_.setRequestHeader(h,u.headers[h]);if(u.beforeSend&&(u.beforeSend.call(c,_,u)===!1||2===b))return _.abort(),!1;for(h in{success:1,error:1,complete:1})_[h](u[h]);if(a=w(se,u,e,_)){_.readyState=1,d&&p.trigger("ajaxSend",[_,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){_.abort("timeout")},u.timeout));try{b=1,a.send(v,i)}catch(A){if(!(b<2))throw A;i(-1,A)}}else i(-1,"No Transport");return _},param:function(t,e){var i=[],n=function(t,e){e=D.isFunction(e)?e():e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=D.ajaxSettings.traditional),D.isArray(t)||t.jquery&&!D.isPlainObject(t))D.each(t,function(){n(this.name,this.value)});else for(var o in t)P(o,t[o],e,n);return i.join("&").replace(Vt,"+")}}),D.extend({active:0,lastModified:{},etag:{}});var he=D.now(),ue=/(\=)\?(&|$)|\?\?/i;D.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return D.expando+"_"+he++}}),D.ajaxPrefilter("json jsonp",function(t,e,i){var n="string"==typeof t.data&&/^application\/x\-www\-form\-urlencoded/.test(t.contentType);if("jsonp"===t.dataTypes[0]||t.jsonp!==!1&&(ue.test(t.url)||n&&ue.test(t.data))){var o,r=t.jsonpCallback=D.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a=window[r],s=t.url,l=t.data,d="$1"+r+"$2";return t.jsonp!==!1&&(s=s.replace(ue,d),t.url===s&&(n&&(l=l.replace(ue,d)),t.data===l&&(s+=(/\?/.test(s)?"&":"?")+t.jsonp+"="+r))),t.url=s,t.data=l,window[r]=function(t){o=[t]},i.always(function(){window[r]=a,o&&D.isFunction(a)&&window[r](o[0])}),t.converters["script json"]=function(){return o||D.error(r+" was not called"),o[0]},t.dataTypes[0]="json","script"}}),D.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(t){return D.globalEval(t),t}}}),D.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),D.ajaxTransport("script",function(t){if(t.crossDomain){var e,i=O.head||O.getElementsByTagName("head")[0]||O.documentElement;return{send:function(n,o){e=O.createElement("script"),e.async="async",t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,n){(n||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,i&&e.parentNode&&i.removeChild(e),e=void 0,n||o(200,"success"))},i.insertBefore(e,i.firstChild)},abort:function(){e&&e.onload(0,1)}}}});var ce,pe=!!window.ActiveXObject&&function(){for(var t in ce)ce[t](0,1)},fe=0;D.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&C()||A()}:C,function(t){D.extend(D.support,{ajax:!!t,cors:!!t&&"withCredentials"in t})}(D.ajaxSettings.xhr()),D.support.ajax&&D.ajaxTransport(function(t){if(!t.crossDomain||D.support.cors){var e;return{send:function(i,n){var o,r,a=t.xhr();if(t.username?a.open(t.type,t.url,t.async,t.username,t.password):a.open(t.type,t.url,t.async),t.xhrFields)for(r in t.xhrFields)a[r]=t.xhrFields[r];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(r in i)a.setRequestHeader(r,i[r])}catch(s){}a.send(t.hasContent&&t.data||null),e=function(i,r){var s,l,d,h,u;try{if(e&&(r||4===a.readyState))if(e=void 0,o&&(a.onreadystatechange=D.noop,pe&&delete ce[o]),r)4!==a.readyState&&a.abort();else{s=a.status,d=a.getAllResponseHeaders(),h={},u=a.responseXML,u&&u.documentElement&&(h.xml=u);try{h.text=a.responseText}catch(i){}try{l=a.statusText}catch(c){l=""}s||!t.isLocal||t.crossDomain?1223===s&&(s=204):s=h.text?200:404}}catch(p){r||n(-1,p)}h&&n(s,l,h,d)},t.async&&4!==a.readyState?(o=++fe,pe&&(ce||(ce={},D(window).unload(pe)),ce[o]=e),a.onreadystatechange=e):e()},abort:function(){e&&e(0,1)}}}});var ge,me,ve,ye,be={},we=/^(?:toggle|show|hide)$/,_e=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Pe=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];D.fn.extend({show:function(t,e,i){var n,o;if(t||0===t)return this.animate(k("show",3),t,e,i);for(var r=0,a=this.length;r<a;r++)n=this[r],n.style&&(o=n.style.display,D._data(n,"olddisplay")||"none"!==o||(o=n.style.display=""),(""===o&&"none"===D.css(n,"display")||!D.contains(n.ownerDocument.documentElement,n))&&D._data(n,"olddisplay",I(n.nodeName)));for(r=0;r<a;r++)n=this[r],n.style&&(o=n.style.display,""!==o&&"none"!==o||(n.style.display=D._data(n,"olddisplay")||""));return this},hide:function(t,e,i){if(t||0===t)return this.animate(k("hide",3),t,e,i);for(var n,o,r=0,a=this.length;r<a;r++)n=this[r],n.style&&(o=D.css(n,"display"),"none"===o||D._data(n,"olddisplay")||D._data(n,"olddisplay",o));for(r=0;r<a;r++)this[r].style&&(this[r].style.display="none");return this},_toggle:D.fn.toggle,toggle:function(t,e,i){var n="boolean"==typeof t;return D.isFunction(t)&&D.isFunction(e)?this._toggle.apply(this,arguments):null==t||n?this.each(function(){var e=n?t:D(this).is(":hidden");D(this)[e?"show":"hide"]()}):this.animate(k("toggle",3),t,e,i),this},fadeTo:function(t,e,i,n){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){function o(){r.queue===!1&&D._mark(this);var e,i,n,o,a,s,l,d,h,u,c,p=D.extend({},r),f=1===this.nodeType,g=f&&D(this).is(":hidden");p.animatedProperties={};for(n in t)if(e=D.camelCase(n),n!==e&&(t[e]=t[n],delete t[n]),(a=D.cssHooks[e])&&"expand"in a){s=a.expand(t[e]),delete t[e];for(n in s)n in t||(t[n]=s[n])}for(e in t){if(i=t[e],D.isArray(i)?(p.animatedProperties[e]=i[1],i=t[e]=i[0]):p.animatedProperties[e]=p.specialEasing&&p.specialEasing[e]||p.easing||"swing","hide"===i&&g||"show"===i&&!g)return p.complete.call(this);!f||"height"!==e&&"width"!==e||(p.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===D.css(this,"display")&&"none"===D.css(this,"float")&&(D.support.inlineBlockNeedsLayout&&"inline"!==I(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=p.overflow&&(this.style.overflow="hidden");for(n in t)o=new D.fx(this,p,n),i=t[n],we.test(i)?(c=D._data(this,"toggle"+n)||("toggle"===i?g?"show":"hide":0),c?(D._data(this,"toggle"+n,"show"===c?"hide":"show"),o[c]()):o[i]()):(l=_e.exec(i),d=o.cur(),l?(h=parseFloat(l[2]),u=l[3]||(D.cssNumber[n]?"":"px"),"px"!==u&&(D.style(this,n,(h||1)+u),d=(h||1)/o.cur()*d,D.style(this,n,d+u)),l[1]&&(h=("-="===l[1]?-1:1)*h+d),o.custom(d,h,u)):o.custom(d,i,""));return!0}var r=D.speed(e,i,n);return D.isEmptyObject(t)?this.each(r.complete,[!1]):(t=D.extend({},t),r.queue===!1?this.each(o):this.queue(r.queue,o))},stop:function(t,e,i){return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){function e(t,e,n){var o=e[n];D.removeData(t,n,!0),o.stop(i)}var n,o=!1,r=D.timers,a=D._data(this);if(i||D._unmark(!0,this),null==t)for(n in a)a[n]&&a[n].stop&&n.indexOf(".run")===n.length-4&&e(this,a,n);else a[n=t+".run"]&&a[n].stop&&e(this,a,n);for(n=r.length;n--;)r[n].elem!==this||null!=t&&r[n].queue!==t||(i?r[n](!0):r[n].saveState(),o=!0,r.splice(n,1));i&&o||D.dequeue(this,t)})}}),D.each({slideDown:k("show",1),slideUp:k("hide",1),slideToggle:k("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){D.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),D.extend({speed:function(t,e,i){var n=t&&"object"===("undefined"==typeof t?"undefined":M(t))?D.extend({},t):{complete:i||!i&&e||D.isFunction(t)&&t,duration:t,easing:i&&e||e&&!D.isFunction(e)&&e};return n.duration=D.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in D.fx.speeds?D.fx.speeds[n.duration]:D.fx.speeds._default,null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(t){D.isFunction(n.old)&&n.old.call(this),n.queue?D.dequeue(this,n.queue):t!==!1&&D._unmark(this)},n},easing:{linear:function(t){return t},swing:function(t){return-Math.cos(t*Math.PI)/2+.5}},timers:[],fx:function(t,e,i){this.options=e,this.elem=t,this.prop=i,e.orig=e.orig||{}}}),D.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(D.fx.step[this.prop]||D.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var t,e=D.css(this.elem,this.prop);return isNaN(t=parseFloat(e))?e&&"auto"!==e?e:0:t},custom:function(t,e,i){function n(t){return o.step(t)}var o=this,r=D.fx;this.startTime=ye||x(),this.end=e,this.now=this.start=t,this.pos=this.state=0,this.unit=i||this.unit||(D.cssNumber[this.prop]?"":"px"),n.queue=this.options.queue,n.elem=this.elem,n.saveState=function(){void 0===D._data(o.elem,"fxshow"+o.prop)&&(o.options.hide?D._data(o.elem,"fxshow"+o.prop,o.start):o.options.show&&D._data(o.elem,"fxshow"+o.prop,o.end))},n()&&D.timers.push(n)&&!ve&&(ve=setInterval(r.tick,r.interval))},show:function(){var t=D._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=t||D.style(this.elem,this.prop),this.options.show=!0,void 0!==t?this.custom(this.cur(),t):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),D(this.elem).show()},hide:function(){this.options.orig[this.prop]=D._data(this.elem,"fxshow"+this.prop)||D.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(t){var e,i,n,o=ye||x(),r=!0,a=this.elem,s=this.options;if(t||o>=s.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),s.animatedProperties[this.prop]=!0;for(e in s.animatedProperties)s.animatedProperties[e]!==!0&&(r=!1);if(r){if(null==s.overflow||D.support.shrinkWrapBlocks||D.each(["","X","Y"],function(t,e){a.style["overflow"+e]=s.overflow[t]}),s.hide&&D(a).hide(),s.hide||s.show)for(e in s.animatedProperties)D.style(a,e,s.orig[e]),D.removeData(a,"fxshow"+e,!0),D.removeData(a,"toggle"+e,!0);n=s.complete,n&&(s.complete=!1,n.call(a))}return!1}return s.duration==1/0?this.now=o:(i=o-this.startTime,this.state=i/s.duration,this.pos=D.easing[s.animatedProperties[this.prop]](this.state,i,0,1,s.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},D.extend(D.fx,{tick:function(){for(var t,e=D.timers,i=0;i<e.length;i++)t=e[i],t()||e[i]!==t||e.splice(i--,1);e.length||D.fx.stop()},interval:13,stop:function(){clearInterval(ve),ve=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(t){D.style(t.elem,"opacity",t.now)},_default:function(t){t.elem.style&&null!=t.elem.style[t.prop]?t.elem.style[t.prop]=t.now+t.unit:t.elem[t.prop]=t.now}}}),D.each(Pe.concat.apply([],Pe),function(t,e){e.indexOf("margin")&&(D.fx.step[e]=function(t){D.style(t.elem,e,Math.max(0,t.now)+t.unit)})}),D.expr&&D.expr.filters&&(D.expr.filters.animated=function(t){return D.grep(D.timers,function(e){return t===e.elem}).length});var Ee,Te=/^t(?:able|d|h)$/i,Ce=/^(?:body|html)$/i;Ee="getBoundingClientRect"in O.documentElement?function(t,e,i,n){try{n=t.getBoundingClientRect()}catch(o){}if(!n||!D.contains(i,t))return n?{top:n.top,left:n.left}:{top:0,left:0};var r=e.body,a=L(e),s=i.clientTop||r.clientTop||0,l=i.clientLeft||r.clientLeft||0,d=a.pageYOffset||D.support.boxModel&&i.scrollTop||r.scrollTop,h=a.pageXOffset||D.support.boxModel&&i.scrollLeft||r.scrollLeft,u=n.top+d-s,c=n.left+h-l;return{top:u,left:c}}:function(t,e,i){for(var n,o=t.offsetParent,r=t,a=e.body,s=e.defaultView,l=s?s.getComputedStyle(t,null):t.currentStyle,d=t.offsetTop,h=t.offsetLeft;(t=t.parentNode)&&t!==a&&t!==i&&(!D.support.fixedPosition||"fixed"!==l.position);)n=s?s.getComputedStyle(t,null):t.currentStyle,d-=t.scrollTop,h-=t.scrollLeft,t===o&&(d+=t.offsetTop,h+=t.offsetLeft,!D.support.doesNotAddBorder||D.support.doesAddBorderForTableAndCells&&Te.test(t.nodeName)||(d+=parseFloat(n.borderTopWidth)||0,h+=parseFloat(n.borderLeftWidth)||0),r=o,o=t.offsetParent),D.support.subtractsBorderForOverflowNotVisible&&"visible"!==n.overflow&&(d+=parseFloat(n.borderTopWidth)||0,h+=parseFloat(n.borderLeftWidth)||0),l=n;return"relative"!==l.position&&"static"!==l.position||(d+=a.offsetTop,h+=a.offsetLeft),D.support.fixedPosition&&"fixed"===l.position&&(d+=Math.max(i.scrollTop,a.scrollTop),h+=Math.max(i.scrollLeft,a.scrollLeft)),{top:d,left:h}},D.fn.offset=function(t){if(arguments.length)return void 0===t?this:this.each(function(e){D.offset.setOffset(this,t,e)});var e=this[0],i=e&&e.ownerDocument;return i?e===i.body?D.offset.bodyOffset(e):Ee(e,i,i.documentElement):null},D.offset={bodyOffset:function(t){var e=t.offsetTop,i=t.offsetLeft;return D.support.doesNotIncludeMarginInBodyOffset&&(e+=parseFloat(D.css(t,"marginTop"))||0,i+=parseFloat(D.css(t,"marginLeft"))||0),{top:e,left:i}},setOffset:function(t,e,i){var n=D.css(t,"position");"static"===n&&(t.style.position="relative");var o,r,a=D(t),s=a.offset(),l=D.css(t,"top"),d=D.css(t,"left"),h=("absolute"===n||"fixed"===n)&&D.inArray("auto",[l,d])>-1,u={},c={};h?(c=a.position(),o=c.top,r=c.left):(o=parseFloat(l)||0,r=parseFloat(d)||0),D.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(u.top=e.top-s.top+o),null!=e.left&&(u.left=e.left-s.left+r),"using"in e?e.using.call(t,u):a.css(u)}},D.fn.extend({position:function(){if(!this[0])return null;var t=this[0],e=this.offsetParent(),i=this.offset(),n=Ce.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(D.css(t,"marginTop"))||0,i.left-=parseFloat(D.css(t,"marginLeft"))||0,n.top+=parseFloat(D.css(e[0],"borderTopWidth"))||0,n.left+=parseFloat(D.css(e[0],"borderLeftWidth"))||0,{top:i.top-n.top,left:i.left-n.left}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||O.body;t&&!Ce.test(t.nodeName)&&"static"===D.css(t,"position");)t=t.offsetParent;return t})}}),D.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i=/Y/.test(e);D.fn[t]=function(n){return D.access(this,function(t,n,o){var r=L(t);return void 0===o?r?e in r?r[e]:D.support.boxModel&&r.document.documentElement[n]||r.document.body[n]:t[n]:void(r?r.scrollTo(i?D(r).scrollLeft():o,i?o:D(r).scrollTop()):t[n]=o)},t,n,arguments.length,null)}}),D.each({Height:"height",Width:"width"},function(t,e){var i="client"+t,n="scroll"+t,o="offset"+t;D.fn["inner"+t]=function(){var t=this[0];return t?t.style?parseFloat(D.css(t,e,"padding")):this[e]():null},D.fn["outer"+t]=function(t){var i=this[0];return i?i.style?parseFloat(D.css(i,e,t?"margin":"border")):this[e]():null},D.fn[e]=function(t){return D.access(this,function(t,e,r){var a,s,l,d;return D.isWindow(t)?(a=t.document,s=a.documentElement[i],D.support.boxModel&&s||a.body&&a.body[i]||s):9===t.nodeType?(a=t.documentElement,a[i]>=a[n]?a[i]:Math.max(t.body[n],a[n],t.body[o],a[o])):void 0===r?(l=D.css(t,e),d=parseFloat(l),D.isNumeric(d)?d:l):void D(t).css(e,r)},e,t,arguments.length,null)}}),function(t){function e(t,e,i){if(i[0]&&"object"!=M(i[0])){if(e[i[0]])return e[i[0]].apply(t,Array.prototype.slice.call(i,1));throw f(i[0]+" is not a method or property")}return e.init.apply(t,i)}function i(t,e,i,n){return{css:{position:"absolute",top:t,left:e,overflow:n||"hidden",zIndex:i||"auto"}}}function n(t,e,i,n,o){var a=1-o,s=a*a*a,l=o*o*o;return r(Math.round(s*t.x+3*o*a*a*e.x+3*o*o*a*i.x+l*n.x),Math.round(s*t.y+3*o*a*a*e.y+3*o*o*a*i.y+l*n.y))}function o(t){return t/_*180}function r(t,e){return{x:t,y:e}}function a(){var t;if(t=/AppleWebkit\/([0-9\.]+)/i.exec(N.userAgent)){var e=parseFloat(t[1]);return e>534.3}return!0}function s(t,e,i){return v&&i?" translate3d("+t+"px,"+e+"px, 0px) ":" translate("+t+"px, "+e+"px) "}function l(t){return" rotate("+t+"deg) "}function d(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function h(){for(var t=["Moz","Webkit","Khtml","O","ms"],e=t.length,i="";e--;)t[e]+"Transform"in O.body.style&&(i="-"+t[e].toLowerCase()+"-");return i}function u(){var t,e=O.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in i)if(void 0!==e.style[t])return i[t]}function c(t,e,i,n,o){var a,s=[];if("-webkit-"==b){for(a=0;a<o;a++)s.push("color-stop("+n[a][0]+", "+n[a][1]+")");t.css({"background-image":"-webkit-gradient(linear, "+e.x+"% "+e.y+"%,"+i.x+"% "+i.y+"%, "+s.join(",")+" )"})}else{e={x:e.x/100*t.width(),y:e.y/100*t.height()},i={x:i.x/100*t.width(),y:i.y/100*t.height()};var l=i.x-e.x,d=i.y-e.y,h=Math.atan2(d,l),u=h-Math.PI/2,c=Math.abs(t.width()*Math.sin(u))+Math.abs(t.height()*Math.cos(u)),p=Math.sqrt(d*d+l*l),f=r(i.x<e.x?t.width():0,i.y<e.y?t.height():0),g=Math.tan(h),m=-1/g,v=(m*f.x-f.y-g*e.x+e.y)/(m-g),y={x:v,y:m*v-m*f.x+f.y},w=Math.sqrt(Math.pow(y.x-e.x,2)+Math.pow(y.y-e.y,2));for(a=0;a<o;a++)s.push(" "+n[a][1]+" "+100*(w+p*n[a][0])/c+"%");t.css({"background-image":b+"linear-gradient("+-h+"rad,"+s.join(",")+")"})}}function p(e,i,n){var o=t.Event(e);return i.trigger(o,n),o.isDefaultPrevented()?"prevented":o.isPropagationStopped()?"stopped":""}function f(t){function e(t){this.name="TurnJsError",this.message=t}return e.prototype=new Error,e.prototype.constructor=e,new e(t)}function g(t){var e={top:0,left:0};do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e}function m(){return N.userAgent.indexOf("MSIE 9.0")==-1}var v,y,b="",w="4.1.0",_=Math.PI,P=_/2,E="ontouchstart"in window,T=E?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},C={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br","l","r"]},A=["single","double"],x=["ltr","rtl"],S={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null,ownPageSizeProvider:null},k={cornerSize:100},I=6,L={init:function(e){v="WebKitCSSMatrix"in window||"MozPerspective"in O.body.style,y=a(),b=h();var i,n=0,o=this.data(),r=this.children();if(e=t.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},S,e),o.opts=e,o.pageObjs={},o.pages={},o.pageWrap={},o.pageZoom={},o.pagePlace={},o.pageMv=[],o.zoom=1,o.totalPages=e.pages||0,o.eventHandlers={touchStart:t.proxy(L._touchStart,this),touchMove:t.proxy(L._touchMove,this),touchEnd:t.proxy(L._touchEnd,this),start:t.proxy(L._eventStart,this)},e.when)for(i in e.when)d(i,e.when)&&this.bind(i,e.when[i]);for(this.css({position:"absolute",width:e.width,height:e.height}),this.turn("display",e.display),""!==e.direction&&this.turn("direction",e.direction),v&&!E&&e.acceleration&&this.transform(s(0,0,!0)),i=0;i<r.length;i++)"1"!=t(r[i]).attr("ignore")&&this.turn("addPage",r[i],++n);return t(this).bind(T.down,o.eventHandlers.touchStart).bind("end",L._eventEnd).bind("pressed",L._eventPressed).bind("released",L._eventReleased).bind("flip",L._flip),t(this).parent().bind("start",o.eventHandlers.start),t(O).bind(T.move,o.eventHandlers.touchMove).bind(T.up,o.eventHandlers.touchEnd),this.turn("page",e.page),o.done=!0,this},addPage:function(e,i){var n,o,r=!1,a=this.data(),s=a.totalPages+1;if(a.destroying)return!1;if((n=/\bp([0-9]+)\b/.exec(t(e).attr("class")))&&(i=parseInt(n[1],10)),i){if(i==s)r=!0;else if(i>s)throw f('Page "'+i+'" cannot be inserted')}else i=s,r=!0;return i>=1&&i<=s&&(o="double"==a.display?i%2?" odd":" even":"",a.done&&this.turn("stop"),i in a.pageObjs&&L._movePages.call(this,i,1),r&&(a.totalPages=s),a.pageObjs[i]=t(e).css({"float":"left"}).addClass("page p"+i+o),!m()&&a.pageObjs[i].hasClass("hard")&&a.pageObjs[i].removeClass("hard"),L._addPageContent.call(this,i),L._removeFromDOM.call(this)),this},_addPageContent:function(e){var i=this.data(),n=i.pageObjs[e];if(n)if(L._necessPage.call(this,e)){if(!i.pageWrap[e]){i.pageWrap[e]=t("<div/>",{"class":"page-wrapper",page:e,css:{position:"absolute",overflow:"hidden"}}),this.append(i.pageWrap[e]),i.pagePlace[e]||(i.pagePlace[e]=e,i.pageObjs[e].appendTo(i.pageWrap[e]));var o=L._pageSize.call(this,e,!0);n.css({width:o.width,height:o.height}),i.pageWrap[e].css(o)}i.pagePlace[e]==e&&L._makeFlip.call(this,e)}else i.pagePlace[e]=0,i.pageObjs[e]&&i.pageObjs[e].remove()},hasPage:function(t){return d(t,this.data().pageObjs)},center:function(e){var i=this.data(),n=t(this).turn("size"),o=0;if(!i.noCenter){if("double"==i.display){var r=this.turn("view",e||i.tpage||i.page);"ltr"==i.direction?r[0]?r[1]||(o+=n.width/4):o-=n.width/4:r[0]?r[1]||(o-=n.width/4):o+=n.width/4}o=Math.round(o),t(this).css({marginLeft:o})}return this},destroy:function(){var e=this,i=this.data(),n=["end","first","flip","last","pressed","released","start","turning","turned","zooming","missing"];if("prevented"!=p("destroying",this))return i.destroying=!0,t.each(n,function(t,i){e.unbind(i)}),i.eventHandlers&&i.eventHandlers.start&&this.parent().unbind("start",i.eventHandlers.start),i.eventHandlers&&i.eventHandlers.touchMove&&i.eventHandlers.touchEnd&&t(O).unbind(T.move,i.eventHandlers.touchMove).unbind(T.up,i.eventHandlers.touchEnd),this.turn("removePage","*"),i.fparent&&i.fparent.remove(),i.shadow&&i.shadow.remove(),this.removeData(),i=null,this},is:function(){return"object"==M(this.data().pages)},zoom:function(e){var i=this.data();if("number"==typeof e){if(e<.001||e>100)throw f(e+" is not a value for zoom");if("prevented"==p("zooming",this,[e,i.zoom]))return this;var n=this.turn("size"),o=this.turn("view"),r=1/i.zoom,a=Math.round(n.width*r*e),s=Math.round(n.height*r*e);i.zoom=e,t(this).turn("stop").turn("size",a,s),i.opts.autoCenter&&this.turn("center"),L._updateShadow.call(this);for(var l=0;l<o.length;l++)o[l]&&i.pageZoom[o[l]]!=i.zoom&&(this.trigger("zoomed",[o[l],o,i.pageZoom[o[l]],i.zoom]),i.pageZoom[o[l]]=i.zoom);return this}return i.zoom},_pageSize:function(t,e){var i=this.data(),n={};if("single"==i.display)n.width=this.width(),n.height=this.height(),e&&(n.top=0,n.left=0,n.right="auto");else{var o=Math.floor(this.width()/2),r=this.height();if(i.pageObjs[t].hasClass("own-size"))if(i.opts.ownPageSizeProvider){var a=i.opts.ownPageSizeProvider.getPageSize(t);n.width=a.width,n.height=a.height}else n.width=i.pageObjs[t].width(),n.height=i.pageObjs[t].height();else n.width=o,n.height=r;if(e){var s=t%2;n.top=(r-n.height)/2,"ltr"==i.direction?(n[s?"right":"left"]=o-n.width,n[s?"left":"right"]="auto"):(n[s?"left":"right"]=o-n.width,n[s?"right":"left"]="auto")}}return n},_makeFlip:function(t){var e=this.data();if(!e.pages[t]&&e.pagePlace[t]==t){var i="single"==e.display,n=t%2;e.pages[t]=e.pageObjs[t].css(L._pageSize.call(this,t)).flip({page:t,next:n||i?t+1:t-1,turn:this}).flip("disable",e.disabled),L._setPageLoc.call(this,t),e.pageZoom[t]=e.zoom}return e.pages[t]},_makeRange:function(){var t,e,i=this.data();if(!(i.totalPages<1))for(e=this.turn("range"),t=e[0];t<=e[1];t++)L._addPageContent.call(this,t)},range:function(t){var e,i,n,o,r=this.data();if(t=t||r.tpage||r.page||1,o=L._view.call(this,t),t<1||t>r.totalPages)throw f('"'+t+'" is not a valid page');return o[1]=o[1]||o[0],o[0]>=1&&o[1]<=r.totalPages?(e=Math.floor((I-2)/2),r.totalPages-o[1]>o[0]?(i=Math.min(o[0]-1,e),n=2*e-i):(n=Math.min(r.totalPages-o[1],e),i=2*e-n)):(i=I-1,n=I-1),[Math.max(1,o[0]-i),Math.min(r.totalPages,o[1]+n)]},_necessPage:function(t){if(0===t)return!0;var e=this.turn("range");return this.data().pageObjs[t].hasClass("fixed")||t>=e[0]&&t<=e[1]},_removeFromDOM:function(){var t,e=this.data();for(t in e.pageWrap)d(t,e.pageWrap)&&!L._necessPage.call(this,t)&&L._removePageFromDOM.call(this,t)},_removePageFromDOM:function(t){var e=this.data();if(e.pages[t]){var i=e.pages[t].data();B._moveFoldingPage.call(e.pages[t],!1),i.f&&i.f.fwrapper&&i.f.fwrapper.remove(),e.pages[t].removeData(),e.pages[t].remove(),delete e.pages[t]}e.pageObjs[t]&&e.pageObjs[t].remove(),e.pageWrap[t]&&(e.pageWrap[t].remove(),delete e.pageWrap[t]),L._removeMv.call(this,t),delete e.pagePlace[t],delete e.pageZoom[t]},removePage:function(t){var e=this.data();if("*"==t){if(t=e.totalPages>0){for(this.turn("stop"),t=e.totalPages;t>0;t--)e.pageObjs[t]&&(L._removePageFromDOM.call(this,t),delete e.pageObjs[t]),L._movePages.call(this,t,-1),e.page=null;e.totalPages=0,L._makeRange.call(this),this.turn("update")}}else{if(t<1||t>e.totalPages)throw f("The page "+t+" doesn't exist");e.pageObjs[t]&&(this.turn("stop"),L._removePageFromDOM.call(this,t),delete e.pageObjs[t]),L._movePages.call(this,t,-1),e.totalPages=e.totalPages-1,e.page>e.totalPages?(e.page=null,L._fitPage.call(this,e.totalPages)):(L._makeRange.call(this),this.turn("update"))}return this},_movePages:function(t,e){var i,n=this,o=this.data(),r="single"==o.display,a=function(t){var i=t+e,a=i%2,s=a?" odd ":" even ";o.pageObjs[t]&&(o.pageObjs[i]=o.pageObjs[t].removeClass("p"+t+" odd even").addClass("p"+i+s)),o.pagePlace[t]&&o.pageWrap[t]&&(o.pagePlace[i]=i,o.pageObjs[i].hasClass("fixed")?o.pageWrap[i]=o.pageWrap[t].attr("page",i):o.pageWrap[i]=o.pageWrap[t].css(L._pageSize.call(n,i,!0)).attr("page",i),o.pages[t]&&(o.pages[i]=o.pages[t].flip("options",{page:i,next:r||a?i+1:i-1})),e&&(delete o.pages[t],delete o.pagePlace[t],delete o.pageZoom[t],delete o.pageObjs[t],delete o.pageWrap[t]))};if(e>0)for(i=o.totalPages;i>=t;i--)a(i);else for(i=t;i<=o.totalPages;i++)a(i)},display:function(e){var i=this.data(),n=i.display;if(void 0===e)return n;if(t.inArray(e,A)==-1)throw f('"'+e+'" is not a value for display');switch(e){case"single":i.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),i.pageObjs[0]=t("<div />",{"class":"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":i.pageObjs[0]&&(this.turn("stop").css({overflow:""}),i.pageObjs[0].remove(),delete i.pageObjs[0]),this.removeClass("shadow")}if(i.display=e,n){var o=this.turn("size");L._movePages.call(this,1,0),this.turn("size",o.width,o.height).turn("update")}return this},direction:function(e){var i=this.data();if(void 0===e)return i.direction;if(e=e.toLowerCase(),t.inArray(e,x)==-1)throw f('"'+e+'" is not a value for direction');return"rtl"==e&&t(this).attr("dir","ltr").css({direction:"ltr"}),i.direction=e,i.done&&this.turn("size",t(this).width(),t(this).height()),this},animating:function(){return this.data().pageMv.length>0},corner:function D(){var D,t,e=this.data();for(t in e.pages)if(d(t,e.pages)&&(D=e.pages[t].flip("corner")))return D;return!1},data:function(){return this.data()},disable:function(e){var i,n=this.data(),o=this.turn("view");n.disabled=void 0===e||e===!0;for(i in n.pages)d(i,n.pages)&&n.pages[i].flip("disable",!!n.disabled||t.inArray(parseInt(i,10),o)==-1);return this},disabled:function(t){return void 0===t?this.data().disabled===!0:this.turn("disable",t)},size:function(t,e){if(void 0===t||void 0===e)return{width:this.width(),height:this.height()};this.turn("stop");var i,n,o=this.data(),r=Math.floor("double"==o.display)?t/2:t;this.css({width:t,height:e}),o.pageObjs[0]&&o.pageObjs[0].css({width:r,height:e});for(i in o.pageWrap)d(i,o.pageWrap)&&(n=L._pageSize.call(this,i,!0),o.pageObjs[i].css({width:n.width,height:n.height}),o.pageWrap[i].css(n),o.pages[i]&&o.pages[i].css({width:n.width,height:n.height}));return this.turn("resize"),this},resize:function(){var t,e=this.data();for(e.pages[0]&&(e.pageWrap[0].css({left:-this.width()}),e.pages[0].flip("resize",!0)),t=1;t<=e.totalPages;t++)e.pages[t]&&e.pages[t].flip("resize",!0);L._updateShadow.call(this),e.opts.autoCenter&&this.turn("center")},_removeMv:function(t){var e,i=this.data();for(e=0;e<i.pageMv.length;e++)if(i.pageMv[e]==t)return i.pageMv.splice(e,1),!0;return!1},_addMv:function(t){var e=this.data();L._removeMv.call(this,t),e.pageMv.push(t)},_view:function(t){var e=this.data();return t=t||e.page,"double"==e.display?t%2?[t-1,t]:[t,t+1]:[t]},view:function z(t){var e=this.data(),z=L._view.call(this,t);return"double"==e.display?[z[0]>0?z[0]:0,z[1]<=e.totalPages?z[1]:0]:[z[0]>0&&z[0]<=e.totalPages?z[0]:0]},stop:function(t,e){if(this.turn("animating")){var i,n,o,r=this.data();for(r.tpage&&(r.page=r.tpage,delete r.tpage),i=0;i<r.pageMv.length;i++)r.pageMv[i]&&r.pageMv[i]!==t&&(o=r.pages[r.pageMv[i]],n=o.data().f.opts,o.flip("hideFoldedPage",e),e||B._moveFoldingPage.call(o,!1),n.force&&(n.next=n.page%2===0?n.page-1:n.page+1,delete n.force))}return this.turn("update"),this},pages:function(t){var e=this.data();if(t){if(t<e.totalPages)for(var i=e.totalPages;i>t;i--)this.turn("removePage",i);return e.totalPages=t,L._fitPage.call(this,e.page),this}return e.totalPages},_missing:function(t){var e=this.data();if(!(e.totalPages<1)){var i,n=this.turn("range",t),o=[];for(i=n[0];i<=n[1];i++)e.pageObjs[i]||o.push(i);o.length>0&&this.trigger("missing",[o]),this.trigger("range",n)}},_fitPage:function(t){var e=this.data(),i=this.turn("view",t);if(L._missing.call(this,t),e.pageObjs[t]){e.page=t,this.turn("stop");for(var n=0;n<i.length;n++)i[n]&&e.pageZoom[i[n]]!=e.zoom&&(this.trigger("zoomed",[i[n],i,e.pageZoom[i[n]],e.zoom]),e.pageZoom[i[n]]=e.zoom);L._removeFromDOM.call(this),L._makeRange.call(this),L._updateShadow.call(this),this.trigger("turned",[t,i]),this.turn("update"),e.opts.autoCenter&&this.turn("center")}},_turnPage:function(e){var i,n,o=this.data(),r=o.pagePlace[e],a=this.turn("view"),s=this.turn("view",e);if(o.page!=e){var l=o.page;if("prevented"==p("turning",this,[e,s]))return void(l==o.page&&t.inArray(r,o.pageMv)!=-1&&o.pages[r].flip("hideFoldedPage",!0));t.inArray(1,s)!=-1&&this.trigger("first"),t.inArray(o.totalPages,s)!=-1&&this.trigger("last")}"single"==o.display?(i=a[0],n=s[0]):a[1]&&e>a[1]?(i=a[1],n=s[0]):a[0]&&e<a[0]&&(i=a[0],n=s[1]);var d=o.opts.turnCorners.split(","),h=o.pages[i].data().f,u=h.opts,c=h.point;L._missing.call(this,e),o.pageObjs[e]&&(this.turn("stop"),o.page=e,L._makeRange.call(this),o.tpage=n,u.next!=n&&(u.next=n,u.force=!0),this.turn("update"),h.point=c,"hard"==h.effect?"ltr"==o.direction?o.pages[i].flip("turnPage",e>i?"r":"l"):o.pages[i].flip("turnPage",e>i?"l":"r"):"ltr"==o.direction?o.pages[i].flip("turnPage",d[e>i?1:0]):o.pages[i].flip("turnPage",d[e>i?0:1]))},page:function(e){var i=this.data();if(void 0===e)return i.page;if(!i.disabled&&!i.destroying){if(e=parseInt(e,10),e>0&&e<=i.totalPages)return e!=i.page&&(i.done&&t.inArray(e,this.turn("view"))==-1?L._turnPage.call(this,e):L._fitPage.call(this,e)),this;throw f("The page "+e+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,L._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,L._view.call(this,this.data().page).shift()-1))},peel:function(t,e,i){var n=this.data(),o=this.turn("view");if(e=void 0===e||e===!0,i=i!==!1,t===!1)this.turn("stop",null,e);else if("single"==n.display)n.pages[n.page].flip("peel",t,e,i);else{var r;r="ltr"==n.direction?t.indexOf("l")!=-1?o[0]:o[1]:t.indexOf("l")!=-1?o[1]:o[0],n.pages[r]&&n.pages[r].flip("peel",t,e,i)}return this},_addMotionPage:function(){var e=t(this).data().f.opts,i=e.turn;i.data();L._addMv.call(i,e.page)},_eventStart:function(t,e,i){var n=e.turn.data(),o=n.pageZoom[e.page];return t.isDefaultPrevented()?void L._updateShadow.call(e.turn):(o&&o!=n.zoom&&(e.turn.trigger("zoomed",[e.page,e.turn.turn("view",e.page),o,n.zoom]),n.pageZoom[e.page]=n.zoom),"single"==n.display&&i&&("l"==i.charAt(1)&&"ltr"==n.direction||"r"==i.charAt(1)&&"rtl"==n.direction?(e.next=e.next<e.page?e.next:e.page-1,
e.force=!0):e.next=e.next>e.page?e.next:e.page+1),L._addMotionPage.call(t.target),void L._updateShadow.call(e.turn))},_eventEnd:function(e,i,n){var o=t(e.target),r=(o.data().f,i.turn),a=r.data();if(n){var s=a.tpage||a.page;s!=i.next&&s!=i.page||(delete a.tpage,L._fitPage.call(r,s||i.next,!0))}else L._removeMv.call(r,i.page),L._updateShadow.call(r),r.turn("update")},timeout:null,_eventPressed:function(e){window.cornerClickSemafor=!0,clearTimeout(this.timeout),this.timeout=setTimeout(function(){window.cornerClickSemafor=!1},600);var i=t(e.target).data().f,n=i.opts.turn,o=n.data();o.pages;return o.mouseAction=!0,n.turn("update"),i.time=(new Date).getTime()},_eventReleased:function(e,i){var n,o=t(e.target),r=o.data().f,a=r.opts.turn,s=a.data();n="single"==s.display?"br"==i.corner||"tr"==i.corner?i.x<o.width()/2:i.x>o.width()/2:i.x<0||i.x>o.width(),((new Date).getTime()-r.time<200||n)&&(e.preventDefault(),L._turnPage.call(a,r.opts.next)),s.mouseAction=!1},_flip:function(e){e.stopPropagation();var i=t(e.target).data().f.opts;i.turn.trigger("turn",[i.next]),i.turn.data().opts.autoCenter&&i.turn.turn("center",i.next)},_touchStart:function(){var t=this.data();for(var e in t.pages)if(d(e,t.pages)&&B._eventStart.apply(t.pages[e],arguments)===!1)return!1},_touchMove:function(){var t=this.data();for(var e in t.pages)d(e,t.pages)&&B._eventMove.apply(t.pages[e],arguments)},_touchEnd:function(){var t=this.data();for(var e in t.pages)d(e,t.pages)&&B._eventEnd.apply(t.pages[e],arguments)},calculateZ:function(t){var e,i,n,o,r,a=this,s=this.data(),l=this.turn("view"),d=l[0]||l[1],h=t.length-1,u={pageZ:{},partZ:{},pageV:{}},c=function(t){var e=a.turn("view",t);e[0]&&(u.pageV[e[0]]=!0),e[1]&&(u.pageV[e[1]]=!0)};for(e=0;e<=h;e++)i=t[e],n=s.pages[i].data().f.opts.next,o=s.pagePlace[i],c(i),c(n),r=s.pagePlace[n]==n?n:i,u.pageZ[r]=s.totalPages-Math.abs(d-r),u.partZ[o]=2*s.totalPages-h+e;return u},update:function(){var e,i=this.data();if(this.turn("animating")&&0!==i.pageMv[0]){var n,o,r=this.turn("calculateZ",i.pageMv),a=this.turn("corner"),s=this.turn("view"),l=this.turn("view",i.tpage);for(e in i.pageWrap)d(e,i.pageWrap)&&(o=i.pageObjs[e].hasClass("fixed"),i.pageWrap[e].css({display:r.pageV[e]||o?"":"none",zIndex:((i.pageObjs[e].hasClass("hard")?r.partZ[e]:r.pageZ[e])||(o?-1:0))+3}),(n=i.pages[e])&&(n.flip("z",r.partZ[e]||null),r.pageV[e]&&n.flip("resize"),i.tpage?n.flip("hover",!1).flip("disable",t.inArray(parseInt(e,10),i.pageMv)==-1&&e!=l[0]&&e!=l[1]):n.flip("hover",a===!1).flip("disable",e!=s[0]&&e!=s[1])))}else for(e in i.pageWrap)if(d(e,i.pageWrap)){var h=L._setPageLoc.call(this,e);i.pages[e]&&i.pages[e].flip("disable",i.disabled||1!=h).flip("hover",!0).flip("z",null)}return this},_updateShadow:function(){var e,n,o,r=this.data(),a=this.width(),s=this.height(),l="single"==r.display?a:Math.floor(a/2);e=this.turn("view"),r.shadow||(r.shadow=t("<div />",{"class":"shadow",css:i(0,0,0).css}).appendTo(this));for(var d=0;d<r.pageMv.length&&(e[0]&&e[1]);d++)e=this.turn("view",r.pages[r.pageMv[d]].data().f.opts.next),n=this.turn("view",r.pageMv[d]),e[0]=e[0]&&n[0],e[1]=e[1]&&n[1];switch(o=e[0]?e[1]?3:"ltr"==r.direction?2:1:"ltr"==r.direction?1:2){case 1:r.shadow.css({width:l,height:s,top:0,left:l});break;case 2:r.shadow.css({width:l,height:s,top:0,left:0});break;case 3:r.shadow.css({width:a,height:s,top:0,left:0})}},_setPageLoc:function(t){var e=this.data(),i=this.turn("view"),n=0;if(t==i[0]||t==i[1]?n=1:("single"==e.display&&t==i[0]+1||"double"==e.display&&t==i[0]-2||t==i[1]+2)&&(n=2),!this.turn("animating"))switch(n){case 1:e.pageWrap[t].css({zIndex:e.totalPages,display:""});break;case 2:e.pageWrap[t].css({zIndex:e.totalPages-1,display:""});break;case 0:e.pageWrap[t].css({zIndex:2,display:e.pageObjs[t].hasClass("fixed")?"":"none"})}return n},options:function(e){if(void 0===e)return this.data().opts;var i=this.data();if(t.extend(i.opts,e),e.pages&&this.turn("pages",e.pages),e.page&&this.turn("page",e.page),e.display&&this.turn("display",e.display),e.direction&&this.turn("direction",e.direction),e.width&&e.height&&this.turn("size",e.width,e.height),e.when)for(var n in e.when)d(n,e.when)&&this.unbind(n).bind(n,e.when[n]);return this},version:function(){return w}},B={init:function(t){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",t),B._addPageWrapper.call(this),this},setData:function(e){var i=this.data();return i.f=t.extend(i.f,e),this},options:function(e){var i=this.data().f;return e?(B.setData.call(this,{opts:t.extend({},i.opts||k,e)}),this):i.opts},z:function(t){var e=this.data().f;return e.opts["z-index"]=t,e.fwrapper&&e.fwrapper.css({zIndex:t||parseInt(e.parent.css("z-index"),10)||2}),this},_cAllowed:function(){var t=this.data().f,e=t.opts.page,i=t.opts.turn.data(),n=e%2;return"hard"==t.effect?"ltr"==i.direction?[n?"r":"l"]:[n?"l":"r"]:"single"==i.display?1==e?"ltr"==i.direction?C.forward:C.backward:e==i.totalPages?"ltr"==i.direction?C.backward:C.forward:C.all:"ltr"==i.direction?C[n?"forward":"backward"]:C[n?"backward":"forward"]},_cornerActivated:function(e){var i=this.data().f,n=this.width(),o=this.height(),r={x:e.x,y:e.y,corner:""},a=i.opts.cornerSize;if(r.x<=0||r.y<=0||r.x>=n||r.y>=o)return!1;var s=B._cAllowed.call(this);switch(i.effect){case"hard":if(r.x>n-a)r.corner="r";else{if(!(r.x<a))return!1;r.corner="l"}break;case"sheet":if(r.y<a)r.corner+="t";else{if(!(r.y>=o-a))return!1;r.corner+="b"}if(r.x<=a)r.corner+="l";else{if(!(r.x>=n-a))return!1;r.corner+="r"}}return!(!r.corner||t.inArray(r.corner,s)==-1)&&r},_isIArea:function(t){var e=this.data().f.parent.offset();return t=E&&t.originalEvent?t.originalEvent.touches[0]:t,B._cornerActivated.call(this,{x:t.pageX-e.left,y:t.pageY-e.top})},_c:function(t,e,i){switch(e=e||0,i=i||e,t){case"tl":return r(e,i);case"tr":return r(this.width()-e,i);case"bl":return r(e,this.height()-i);case"br":return r(this.width()-e,this.height()-i);case"l":return r(e,0);case"r":return r(this.width()-e,0)}},_c2:function(t){switch(t){case"tl":return r(2*this.width(),0);case"tr":return r(-this.width(),0);case"bl":return r(2*this.width(),this.height());case"br":return r(-this.width(),this.height());case"l":return r(2*this.width(),0);case"r":return r(-this.width(),0)}},_foldingPage:function(){var t=this.data().f;if(t){var e=t.opts;return e.turn?(t=e.turn.data(),"single"==t.display?e.next>1||e.page>1?t.pageObjs[0]:null:t.pageObjs[e.next]):void 0}},_backGradient:function(){var e=this.data().f,n=e.opts.turn.data(),o=n.opts.gradients&&("single"==n.display||2!=e.opts.page&&e.opts.page!=n.totalPages-1);return o&&!e.bshadow&&(e.bshadow=t("<div/>",i(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(e.parent)),o},type:function(){return this.data().f.effect},resize:function(t){var e=this.data().f,i=e.opts.turn.data(),n=this.width(),o=this.height();switch(e.effect){case"hard":t&&(e.wrapper.css({width:n,height:o}),e.fpage.css({width:n,height:o}),i.opts.gradients&&(e.ashadow.css({width:n,height:o}),e.bshadow.css({width:n,height:o})));break;case"sheet":if(t){var r=Math.round(Math.sqrt(Math.pow(n,2)+Math.pow(o,2)));e.wrapper.css({width:r,height:r}),e.fwrapper.css({width:r,height:r}).children(":first-child").css({width:n,height:o}),e.fpage.css({width:n,height:o}),i.opts.gradients&&e.ashadow.css({transform:"translateZ(0)",width:n,height:o}),B._backGradient.call(this)&&e.bshadow.css({width:n,height:o})}if(e.parent.is(":visible")){var a=g(e.parent[0]);e.fwrapper.css({top:a.top,left:a.left}),a=g(e.opts.turn[0]),e.fparent.css({top:-a.top,left:-a.left})}this.flip("z",e.opts["z-index"])}},_addPageWrapper:function(){var e=this.data().f,n=e.opts.turn.data(),o=this.parent();if(e.parent=o,!e.wrapper)switch(e.effect){case"hard":var r={};r[b+"transform-style"]="preserve-3d",r[b+"backface-visibility"]="hidden",e.wrapper=t("<div/>",i(0,0,2)).css(r).appendTo(o).prepend(this),e.fpage=t("<div/>",i(0,0,1)).css(r).appendTo(o),n.opts.gradients&&(e.ashadow=t("<div/>",i(0,0,0)).hide().appendTo(o),e.bshadow=t("<div/>",i(0,0,0)));break;case"sheet":var a=this.width(),s=this.height();Math.round(Math.sqrt(Math.pow(a,2)+Math.pow(s,2)));if(e.fparent=e.opts.turn.data().fparent,!e.fparent){var l=t("<div/>",{css:{"pointer-events":"none"}}).hide();l.data().flips=0,l.css(i(0,0,"auto","visible").css).appendTo(e.opts.turn),e.opts.turn.data().fparent=l,e.fparent=l}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),e.wrapper=t("<div/>",i(0,0,this.css("z-index"))).appendTo(o).prepend(this),e.fwrapper=t("<div/>",i(o.offset().top,o.offset().left)).hide().appendTo(e.fparent),e.fpage=t("<div/>",i(0,0,0,"visible")).css({cursor:"default",overflow:"hidden"}).appendTo(e.fwrapper),n.opts.gradients&&(e.ashadow=t("<div/>",i(0,0,1)).appendTo(e.fpage)),B.setData.call(this,e)}B.resize.call(this,!0)},_fold:function(t){var e=this.data().f,i=e.opts.turn.data(),n=B._c.call(this,t.corner),a=this.width(),d=this.height();switch(e.effect){case"hard":"l"==t.corner?t.x=Math.min(Math.max(t.x,0),2*a):t.x=Math.max(Math.min(t.x,a),-a);var h,u,p,f,g,m=i.totalPages,v=e.opts["z-index"]||m,w={overflow:"visible"},E=n.x?(n.x-t.x)/a:t.x/a,T=90*E,C=T<90;switch(t.corner){case"l":f="0% 50%",g="100% 50%",C?(h=0,u=e.opts.next-1>0,p=1):(h="100%",u=e.opts.page+1<m,p=0);break;case"r":f="100% 50%",g="0% 50%",T=-T,a=-a,C?(h=0,u=e.opts.next+1<m,p=0):(h="-100%",u=1!=e.opts.page,p=1)}w[b+"perspective-origin"]=g,e.wrapper.transform("rotateY("+T+"deg)translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",g),e.fpage.transform("translateX("+a+"px) rotateY("+(180+T)+"deg)",f),e.parent.css(w),C?(E=-E+1,e.wrapper.css({zIndex:v+1}),e.fpage.css({zIndex:v})):(E-=1,e.wrapper.css({zIndex:v}),e.fpage.css({zIndex:v+1})),i.opts.gradients&&(u?e.ashadow.css({display:"",left:h,backgroundColor:"rgba(0,0,0,"+.5*E+")"}).transform("rotateY(0deg)"):e.ashadow.hide(),e.bshadow.css({opacity:-E+1}),C?e.bshadow.parent()[0]!=e.wrapper[0]&&e.bshadow.appendTo(e.wrapper):e.bshadow.parent()[0]!=e.fpage[0]&&e.bshadow.appendTo(e.fpage),c(e.bshadow,r(100*p,0),r(100*(-p+1),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var A,x,S,k,I,L,M,O=this,N=0,D=0,z=r(0,0),R=r(0,0),F=r(0,0),W=B._foldingPage.call(this),H=(Math.tan(D),i.opts.acceleration),U=e.wrapper.height(),j="t"==t.corner.substr(0,1),V="l"==t.corner.substr(1,1),q=function X(){var e=r(0,0),s=r(0,0);e.x=n.x?n.x-t.x:t.x,y?e.y=n.y?n.y-t.y:t.y:e.y=0,s.x=V?a-e.x/2:t.x+e.x/2,s.y=e.y/2;var l=P-Math.atan2(e.y,e.x),h=l-Math.atan2(s.y,s.x),u=Math.max(0,Math.sin(h)*Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2)));if(N=o(l),F=r(u*Math.sin(l),u*Math.cos(l)),l>P&&(F.x=F.x+Math.abs(F.y*e.y/e.x),F.y=0,Math.round(F.x*Math.tan(_-l))<d))return t.y=Math.sqrt(Math.pow(d,2)+2*s.x*e.x),j&&(t.y=d-t.y),X();if(l>P){var c=_-l,p=U-d/Math.sin(c);z=r(Math.round(p*Math.cos(c)),Math.round(p*Math.sin(c))),V&&(z.x=-z.x),j&&(z.y=-z.y)}A=Math.round(F.y/Math.tan(l)+F.x);var f=a-A,g=f*Math.cos(2*l),m=f*Math.sin(2*l);if(R=r(Math.round(V?f-g:A+g),Math.round(j?m:d-m)),i.opts.gradients){I=f*Math.sin(l);var v=B._c2.call(O,t.corner),b=Math.sqrt(Math.pow(v.x-t.x,2)+Math.pow(v.y-t.y,2))/a;M=Math.sin(P*(b>1?2-b:b)),L=Math.min(b,1),k=I>100?(I-100)/I:0,x=r(I*Math.sin(l)/a*100,I*Math.cos(l)/d*100),B._backGradient.call(O)&&(S=r(1.2*I*Math.sin(l)/a*100,1.2*I*Math.cos(l)/d*100),V||(S.x=100-S.x),j||(S.y=100-S.y))}return F.x=Math.round(F.x),F.y=Math.round(F.y),!0},G=function(t,n,o,h){var u=["0","auto"],p=(a-U)*o[0]/100,f=(d-U)*o[1]/100,g={left:u[n[0]],top:u[n[1]],right:u[n[2]],bottom:u[n[3]]},m={},v=90!=h&&h!=-90?V?-1:1:0,y=o[0]+"% "+o[1]+"%";O.css(g).transform(l(h)+s(t.x+v,t.y,H),y),e.fpage.css(g).transform(l(h)+s(t.x+R.x-z.x-a*o[0]/100,t.y+R.y-z.y-d*o[1]/100,H)+l((180/h-2)*h),y),e.wrapper.transform(s(-t.x+p-v,-t.y+f,H)+l(-h),y),e.fwrapper.transform(s(-t.x+z.x+p,-t.y+z.y+f,H)+l(-h),y),i.opts.gradients&&(o[0]&&(x.x=100-x.x),o[1]&&(x.y=100-x.y),m["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*M+")",W.css(m),c(e.ashadow,r(V?100:0,j?0:100),r(x.x,x.y),[[k,"rgba(0,0,0,0)"],[.8*(1-k)+k,"rgba(0,0,0,"+.2*L+")"],[1,"rgba(255,255,255,"+.2*L+")"]],3,D),B._backGradient.call(O)&&c(e.bshadow,r(V?0:100,j?0:100),r(S.x,S.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*L+")"],[1,"rgba(0,0,0,0)"]],3))};switch(t.corner){case"l":break;case"r":break;case"tl":t.x=Math.max(t.x,1),q(),G(F,[1,0,0,1],[100,0],N);break;case"tr":t.x=Math.min(t.x,a-1),q(),G(r(-F.x,F.y),[0,0,0,1],[0,0],-N);break;case"bl":t.x=Math.max(t.x,1),q(),G(r(F.x,-F.y),[1,1,0,0],[100,100],-N);break;case"br":t.x=Math.min(t.x,a-1),q(),G(r(-F.x,-F.y),[0,1,1,0],[0,100],N)}}e.point=t},_moveFoldingPage:function(t){var e=this.data().f;if(e){var i=e.opts.turn,n=i.data(),o=n.pagePlace;if(t){var r=e.opts.next;if(o[r]!=e.opts.page){e.folding&&B._moveFoldingPage.call(this,!1);var a=B._foldingPage.call(this);a.appendTo(e.fpage),o[r]=e.opts.page,e.folding=r}i.turn("update")}else if(e.folding){if(n.pages[e.folding]){var s=n.pages[e.folding].data().f;n.pageObjs[e.folding].appendTo(s.wrapper)}else n.pageWrap[e.folding]&&n.pageObjs[e.folding].appendTo(n.pageWrap[e.folding]);e.folding in o&&(o[e.folding]=e.folding),delete e.folding}}},_showFoldedPage:function(t,e){this.context.classList.add("folded");var i=B._foldingPage.call(this),n=this.data(),o=n.f,r=o.visible;if(this.trigger("folded",[o.opts,!0]),i){if(!r||!o.point||o.point.corner!=t.corner){var a="hover"==o.status||"peel"==o.status||o.opts.turn.data().mouseAction?t.corner:null;if(r=!1,"prevented"==p("start",this,[o.opts,a]))return!1}if(e){var s=this,l=o.point&&o.point.corner==t.corner?o.point:B._c.call(this,t.corner,1);this.animatef({from:[l.x,l.y],to:[t.x,t.y],duration:400,frame:function(e){t.x=Math.round(e[0]),t.y=Math.round(e[1]),B._fold.call(s,t)}})}else B._fold.call(this,t),n.effect&&!n.effect.turning&&this.animatef(!1);if(!r)switch(o.effect){case"hard":o.visible=!0,B._moveFoldingPage.call(this,!0),o.fpage.show(),o.opts.shadows&&o.bshadow.show();break;case"sheet":o.visible=!0,o.fparent.show().data().flips++,B._moveFoldingPage.call(this,!0),o.fwrapper.show(),o.bshadow&&o.bshadow.show()}return!0}return!1},hide:function(){var t=this.data().f,e=t.opts.turn.data(),i=B._foldingPage.call(this);switch(t.effect){case"hard":e.opts.gradients&&(t.bshadowLoc=0,t.bshadow.remove(),t.ashadow.hide()),t.wrapper.transform(""),t.fpage.hide();break;case"sheet":0===--t.fparent.data().flips&&t.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),t.wrapper.transform(""),t.fwrapper.hide(),t.bshadow&&t.bshadow.hide(),i.transform("")}return t.visible=!1,this},hideFoldedPage:function(t){var e=this.data().f;if(e.point){var i=this,o=e.point,a=function(){e.point=null,e.status="",i.flip("hide"),i.trigger("end",[e.opts,!1]),i.context.classList.remove("folded"),i.trigger("folded",[e.opts,!1])};if(t){var s=B._c.call(this,o.corner),l="t"==o.corner.substr(0,1),d=l?Math.min(0,o.y-s.y)/2:Math.max(0,o.y-s.y)/2,h=r(o.x,o.y+d),u=r(s.x,s.y-d);this.animatef({from:0,to:1,frame:function(t){var e=n(o,h,u,s,t);o.x=e.x,o.y=e.y,B._fold.call(i,o)},complete:a,duration:800,hiding:!0})}else this.animatef(!1),a()}},turnPage:function(t){var e=this,i=this.data().f,o=i.opts.turn.data();t={corner:i.corner?i.corner.corner:t||B._cAllowed.call(this)[0]};var r=i.point||B._c.call(this,t.corner,i.opts.turn?o.opts.elevation:0),a=B._c2.call(this,t.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(i){var o=n(r,r,a,a,i);t.x=o.x,t.y=o.y,B._showFoldedPage.call(e,t)},complete:function(){e.trigger("end",[i.opts,!0])},duration:o.opts.duration,turning:!0}),i.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(t){var e=this.data().f,i=e.opts.turn;if(!e.corner&&!e.disabled&&!this.flip("isTurning")&&e.opts.page==i.data().pagePlace[e.opts.page]){if(e.corner=B._isIArea.call(this,t),e.corner&&B._foldingPage.call(this))return this.trigger("pressed",[e.point]),B._showFoldedPage.call(this,e.corner),!1;e.corner=null}},_eventMove:function(t){var e=this.data().f;if(!e.disabled)if(t=E?t.originalEvent.touches:[t],e.corner){var i=e.parent.offset();e.corner.x=t[0].pageX-i.left,e.corner.y=t[0].pageY-i.top,B._showFoldedPage.call(this,e.corner)}else if(e.hover&&!this.data().effect&&this.is(":visible")){var n=B._isIArea.call(this,t[0]);if(n){if("sheet"==e.effect&&2==n.corner.length||"hard"==e.effect){e.status="hover";var o=B._c.call(this,n.corner,e.opts.cornerSize/2);n.x=o.x,n.y=o.y,B._showFoldedPage.call(this,n,!0)}p("overcorner",this,[this.data().pageId])}else"hover"==e.status&&(e.status="",B.hideFoldedPage.call(this,!0),p("outcorner",this,[this.data().pageId]))}},_eventEnd:function(){var t=this.data().f,e=t.corner;!t.disabled&&e&&"prevented"!=p("released",this,[t.point||e])&&B.hideFoldedPage.call(this,!0),t.corner=null},disable:function(t){return B.setData.call(this,{disabled:t}),this},hover:function(t){return B.setData.call(this,{hover:t}),this},peel:function(e,i,n){var o=this.data().f;if(e){if(t.inArray(e,C.all)==-1)throw f("Corner "+e+" is not permitted");if(t.inArray(e,B._cAllowed.call(this))!=-1){var r=60+15*(n?Math.random():1),a=.65*(o.opts.cornerSize/2*(n?Math.random():1)+o.opts.cornerSize/4),s=Math.round(a*Math.sin(r*Math.PI/180)),l=Math.round(a*Math.cos(r*Math.PI/180)),d=B._c.call(this,e,s,l);o.status="peel",B._showFoldedPage.call(this,{corner:e,x:d.x,y:d.y},i)}}else o.status="",B.hideFoldedPage.call(this,i);return this}};window.requestAnim=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),t.extend(t.fn,{flip:function(){return e(t(this[0]),B,arguments)},turn:function(){return e(t(this[0]),L,arguments)},transform:function(t,e){var i={};return e&&(i[b+"transform-origin"]=e),i[b+"transform"]=t,this.css(i)},animatef:function(e){var i=this.data();if(i.effect&&i.effect.stop(),e){e.to.length||(e.to=[e.to]),e.from.length||(e.from=[e.from]);for(var n=[],o=e.to.length,r=!0,a=this,s=(new Date).getTime(),l=function h(){if(i.effect&&r){for(var t=[],l=Math.min(e.duration,(new Date).getTime()-s),d=0;d<o;d++)t.push(i.effect.easing(1,l,e.from[d],n[d],e.duration));e.frame(1==o?t[0]:t),l==e.duration?(delete i.effect,a.data(i),e.complete&&e.complete()):window.requestAnim(h)}},d=0;d<o;d++)n.push(e.to[d]-e.from[d]);i.effect=t.extend({stop:function(){r=!1},easing:function(t,e,i,n,o){return n*Math.sqrt(1-(e=e/o-1)*e)+i}},e),this.data(i),l()}else delete i.effect}}),t.isTouch=E,t.mouseEvents=T,t.cssPrefix=h,t.cssTransitionEnd=u,t.findPos=g}(D);var Ae=D;e.jQuery=D,e.$=Ae},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){var n=function o(t,e){return e=e||0,d["default"].isUndefined(t)?e:o(t.parent,e+1)};this.id="id"+b++,this.level=n(t),this.parent=t,this.title=e,this.page=i}function r(t,e,i,n,o){this.rootElement=t,this.browser=n,this.toc=i,this.listenTo(this.toc,"change:children",this._tocChanged),this.pager=e,this.lastTarget=null,this.listenTo(this.pager,"change:state",this.scanTOCforCurrentPage),(0,p["default"])().get(p["default"].API).on("turned",this.pageTurned,this),(0,p["default"])().get(p["default"].API).on("zoomed",this.pageTurned,this),(0,p["default"])().get(p["default"].API).on("unzoomed",this.pageTurned,this),this.render();var r=this,a=function(t){if(40===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("down");else if(38===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("up");else if(39===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootElement.querySelector(".selected");if(null===e)return;var i=!!e.querySelector("span.icon");if(!i||s["default"].hasClass(e.parentNode,"opened"))return;e.querySelector("span.icon").click()}else if(37===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootElement.querySelector(".selected");if(null===e)return;var i=!!e.querySelector("span.icon");if(!i||!s["default"].hasClass(e.parentNode,"opened"))return;e.querySelector("span.icon").click()}else if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootElement.querySelector(".selected");if(null===e)return;e.click(),e.querySelector(".toc-item-title").click(),s["default"].removeClass(e,"selected")}};o&&this.rootElement.focus(),this.rootElement.addEventListener("keydown",a),this.rootElement.addEventListener("blur",function(){s["default"].removeClass(r.rootElement.querySelector(".selected"),"selected")})}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),s=n(a),l=i(0),d=n(l),h=i(1),u=n(h),c=i(2),p=n(c),f=i(4),g=n(f),m=i(7),v=(n(m),i(89)),y=n(v),b=0;o.prototype.push=function(t){d["default"].has(this,"children")||(this.children=[]),this.children.push(t)},r.prototype=new u["default"],r.prototype.constructor=r,r.prototype._changeSelected=function(t){var e,i,n,o=this.rootElement.querySelector(".selected")||this.rootElement.querySelector(".active");if(e=null===o?this.rootElement.querySelector("li.toc-item"):o.parentNode,"up"===t)if(i=e.previousSibling,null===i){if(i=e.parentNode.parentNode,!s["default"].hasClass(i,"toc-item"))return}else s["default"].hasClass(i,"opened")&&(i=i.querySelector("ul").lastChild);else i=s["default"].hasClass(e,"opened")?e.querySelector("li"):e.nextSibling,null===i&&(i=e.parentNode.parentNode,i=s["default"].hasClass(i,"opened")?i.nextSibling:null);if(null!==i){n=i.childNodes[0],null!==o&&(s["default"].removeClass(o,"selected"),o.id="",o.setAttribute("aria-selected","false"),this.rootElement.setAttribute("aria-activedescendant","")),s["default"].addClass(n,"selected");var r="selected-item"+Math.random();n.id=r,n.setAttribute("aria-selected","true"),this.rootElement.setAttribute("aria-activedescendant",r),this._updateScroll(!0)}},r.prototype.destructor=function(){this.stopListening(this.toc,"change:children",this._tocChanged),this.stopListening(this.pager,"change:state",this.scanTOCforCurrentPage),(0,p["default"])().get(p["default"].API).off("turned",this.pageTurned,this),(0,p["default"])().get(p["default"].API).off("zoomed",this.pageTurned,this),(0,p["default"])().get(p["default"].API).off("unzoomed",this.pageTurned,this)},r.prototype.getApiProvider=function(){return(0,p["default"])().get(p["default"].API)},r.prototype._generateTOCStructure=function(){this.tocStructure=new o,this.dictionary=[];var t=this,e=function n(t,e){return t.parent&&(t.parent===e||n(t.parent,e))},i=function r(i,n){for(var a in n)if(n.hasOwnProperty(a)){var s=n[a],l=new o(i,s.title,s.page);i.push(l),t.dictionary.hasOwnProperty(l.page)?e(l,t.dictionary[l.page])&&(t.dictionary[l.page]=l):t.dictionary[l.page]=l,r(l,s.children)}};i(this.tocStructure,this.toc.children)},r.prototype._tocChanged=function(){this.render()},r.prototype.render=function(){s["default"].clear(this.rootElement);var t=this.toc;if(t.enabled!==!1&&t.children&&t.children.length>0){var e=this;this._generateTOCStructure(),this.generateTOCSubLevel(this.tocStructure.children,this.rootElement,0),this.scanTOCforCurrentPage(this.pager.getState()),this.setActiveCounter=0,d["default"].defer(function(){e.trigger("change:height")})}},r.prototype._goToPage=function(t,e){this._setActiveElement(t,!1);var i=this.pager.pageTable.getPageIdByIndex(e.page-1);this.getApiProvider().trigger("link",{type:"internal",pageToUrl:this.pager.pageTable.getUrlHeaderById(i),pageUrl:this.pager.pageTable.getUrlHeaderById(this.pager.state.leftPage||this.pager.state.rightPage),source:"toc"}),s["default"].removeClass(this.rootElement.querySelector(".selected"),"selected"),this.trigger("change:page",{pageIndex:e.page-1,target:"toc"})},r.prototype._openChild=function(e,i,n,o){if(e.querySelector(".toc-sub-item-ul")||this.generateTOCSubLevel(i.children,e,i.level),e.className.indexOf("opened")!==-1){if(o)return;s["default"].removeClass(e,"opened"),s["default"].removeClass(n,"icon-down-arrow"),s["default"].addClass(n,"icon-"+(t.RTL?"left":"right")+"-arrow")}else s["default"].addClass(e,"opened"),s["default"].removeClass(n,"icon-"+(t.RTL?"left":"right")+"-arrow"),s["default"].addClass(n,"icon-down-arrow");this.trigger("change:height")},r.prototype.generateTOCSubLevel=function(e,i,n){var o=this,r=s["default"].createElement("ul",{"class":0===n?"toc-item":"toc-sub-item-ul",role:"listbox"},i);d["default"].each(e,function(e){var i=s["default"].createElement("li",{"class":"toc-item"},r),a={};a["padding-"+(t.RTL?"right":"left")]=n<=2?20*n+"px":"60px";var l=s["default"].createElement("p",{"class":"list-item toc-item-p p"+e.page+" "+e.id,styles:a,role:"option"},i),h=s["default"].createElement("span",{"class":"icon"},l),u=s["default"].createElement("span",{"class":"toc-item-title",styles:{width:n<=2?214-20*n+"px":"154px"}},l);s["default"].setText(u,g["default"].decodeEntities(e.title));var c=y["default"].getDirection(e.title);if("rtl"===c||"bidi"===c){var p=document.createAttribute("dir");p.value="rtl",u.setAttributeNode(p)}d["default"].isEmpty(e.children)?l.addEventListener("click",function(){o._goToPage(l,e)}):(s["default"].addClass(h,"icon-"+(t.RTL?"left":"right")+"-arrow"),h.addEventListener("click",function(){o._openChild(i,e,h,!1)}),u.addEventListener("click",function(){o._openChild(i,e,h,!0),o._goToPage(l,e)}))},this)},r.prototype.pageTurned=function(){this.scanTOCforCurrentPage(this.pager.getState())},r.prototype.scanTOCforCurrentPage=function(t,e,i,n){function o(t){if(!d["default"].isUndefined(t.page)){var e,i,n;d["default"].isUndefined(t.parent)||o(t.parent),n=a.rootElement.querySelector("."+t.id),n&&(e=n.parentNode,i=n.querySelector(".icon"),d["default"].isEmpty(t.children)||a._openChild(e,t,i,!0))}}function r(t){"Internet Explorer"!==a.browser.name&&o(t),a.rootElement.querySelector("."+t.id)&&a._setActiveElement(a.rootElement.querySelector("."+t.id),!0)}var a=this;if(e)return void(this.lastTarget=n);if(this.lastTarget){if(!d["default"].isUndefined(this.lastTarget)&&"toc"===this.lastTarget)return void(this.lastTarget=null);this.lastTarget=null}d["default"].defer(d["default"].bind(function(t){var e=d["default"].isUndefined(t.rightPage)?Number.MIN_SAFE_INTEGER:this.pager.pageTable.getPageIndexById(t.rightPage)+1,i=d["default"].isUndefined(t.leftPage)?Number.MIN_SAFE_INTEGER:this.pager.pageTable.getPageIndexById(t.leftPage)+1;t.zoomMode||e!==i||e===Number.MIN_SAFE_INTEGER||e++;var n=Math.max(e,i),o=!1;if(n!==Number.MIN_SAFE_INTEGER)for(var s=n;s>0;s--)if(!d["default"].isUndefined(this.dictionary[s])){r(this.dictionary[s]),o=!0;break}o||a._setActiveElement()},this),t)},r.prototype._setActiveElement=function(t,e){for(var i=this,n=this.rootElement.querySelectorAll(".active"),o=!1,r=0,a=n.length;r<a;r++)t===n[r]?o=!0:s["default"].removeClass(n[r],"active");!o&&t&&(this.setActiveCounter++,d["default"].defer(function(){i.setActiveCounter--,0===i.setActiveCounter&&(s["default"].addClass(t,"active"),e&&i._updateScroll())}))},r.prototype._updateScroll=function(t){t=t||!1,d["default"].defer(d["default"].bind(function(){var e=t?this.rootElement.querySelector(".selected"):s["default"].className("toc-item-p active",this.rootElement)[0];d["default"].isUndefined(e)||(this.trigger("scroll:toElement",{el:e,speed:this.firstTimeScrolled?t?1500:500:0}),this.firstTimeScrolled=!0)},this))},e["default"]=r}).call(e,i(6))},function(t,e,i){(function(){function t(t){if("undefined"==typeof t)throw new Error("TypeError missing argument");if("string"!=typeof t)throw new Error("TypeError getDirection expects strings");if(""===t)return h;if(t.indexOf(r)>-1&&t.indexOf(a)>-1)return d;if(t.indexOf(r)>-1)return s;if(t.indexOf(a)>-1)return l;var e=i(t,l),n=i(t,s);return e&&n?d:n?s:e?l:h}function i(t,e){var i,o,r,a,d=!1,h=!1,c=!1;for(c=t.search(/[0-9]/)>-1,t=t.replace(/[\s\n\0\f\t\v\'\"\-0-9\+\?\!]+/gm,""),i=0;i<t.length;i++){o=t.charAt(i),a=!1;for(r in u)u.hasOwnProperty(r)&&n(o,u[r][0],u[r][1])&&(d=!0,a=!0);a===!1&&(h=!0)}return e===l?d:e===s?h||!d&&c:void 0}function n(t,e,i){var n=t.charCodeAt(0),o=parseInt(e,16),r=parseInt(i,16);return n>o&&n<r}function o(){String.prototype.getDirection=function(){return t(this.valueOf())}}var r="‎",a="‏",s="ltr",l="rtl",d="bidi",h="",u={Hebrew:["0590","05FF"],Arabic:["0600","06FF"],NKo:["07C0","07FF"],Syriac:["0700","074F"],Thaana:["0780","07BF"],Tifinagh:["2D30","2D7F"]};e.getDirection=t,e.patch=o}).call(this)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){var r=this;this.rootView=t,this.toolHeader=a["default"].id("tool-header"),this.provider=i,this.pager=e,this.resultsOnPage=20,this.preloader=null,this.searchResultsCountPanel=null,this.scrollView=null,this.listView=null,this.resultsShown=!1,this.resultsOffset=0,this.oldResults=[],this.createSearchInputBlock(o),this.createSubHeader2(),this.createPreloader(),this.createList(),this.provider.loadSearchIndex(),this.showResults(!0),this.provider.on("change:query",function(){l["default"].defer(function(){r.showResults()})});var s=function(t){if(40===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("down");else if(38===t.keyCode)t.preventDefault(),t.stopPropagation(),r._changeSelected("up");else if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var e=r.rootView.querySelector(".selected");if(null===e)return;e.click()}};this.rootView.addEventListener("keydown",s),this.rootView.addEventListener("blur",function(){a["default"].removeClass(r.rootView.querySelector(".selected"),"selected")})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(4),c=n(u),p=i(7),f=(n(p),i(2)),g=n(f),m=i(24);n(m);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype._changeSelected=function(t){var e,i,n,o=this.rootView.querySelector(".selected");null===o?i=this.rootView.querySelector(".search-item"):(e=o.parentNode,i="up"===t?e.previousSibling:e.nextSibling),null!==i&&(n=i.childNodes[0],a["default"].removeClass(o,"selected"),a["default"].addClass(n,"selected"),this._updateScroll())},o.prototype._updateScroll=function(){l["default"].defer(l["default"].bind(function(){this.trigger("change:height");var t=this.rootView.querySelector(".selected");l["default"].isUndefined(t)||(this.trigger("scroll:toElement",{el:t,speed:this.firstTimeScrolled?1500:0}),this.firstTimeScrolled=!0)},this))},o.prototype.getApiProvider=function(){return(0,g["default"])().get(g["default"].API)},o.prototype.getLocaleProvider=function(){return(0,g["default"])().get(g["default"].LOCALE)},o.prototype.createSubHeader1=function(){var t=a["default"].createElement("div",{"class":"search-sub-header subheader"},this.rootView);a["default"].setText(t,this.getLocaleProvider().get("SearchToolWindow.SEARCH_RESULTS"))},o.prototype.createSearchInputBlock=function(t){var e,i=this,n=a["default"].createElement("div",{"class":"search-input-block"},this.toolHeader),o=a["default"].createElement("button",{"class":"btn icon icon-search",tabindex:"0"},n),r=a["default"].createElement("input",{},a["default"].createElement("label",{},n));r.placeholder=this.getLocaleProvider().get("SearchToolWindow.QUERY_PLACEHOLDER"),r.value=this.provider.query,t&&r.focus(),a["default"].createElement("div",{styles:{clear:"both"}},n);var s=function(){i.provider.set("query",r.value)};r.addEventListener("keydown",function(t){13===t.keyCode&&s()}),r.addEventListener("input",function(){clearTimeout(e),i.provider.isIndexLoaded()&&r.value.length>=i.provider.getMinimumQueryLength()?e=setTimeout(function(){s()},500):l["default"].isEmpty(r.value)&&(i.off("scroll",i._onScroll),i.provider.query="",a["default"].addClass(i.searchResultsCountPanel,"empty-result"),a["default"].setText(i.searchResultsCount,""),a["default"].clear(i.listView),l["default"].defer(function(){i.trigger("change:height")}))}),o.addEventListener("click",s),this.provider.on("change:query",function(){r.value!==i.provider.query&&(r.value=i.provider.query)})},o.prototype.createSubHeader2=function(){this.searchResultsCountPanel=a["default"].createElement("div",{"class":"search-sub-header subheader"
},this.toolHeader),this.searchResultsCount=a["default"].createElement("span",{"class":"search-results-count"},this.searchResultsCountPanel),this.livePreloader=a["default"].createElement("div",{"class":"search-live-preloader"},this.searchResultsCountPanel),a["default"].createElement("div",{"class":"dot"},this.livePreloader)},o.prototype.createPreloader=function(){this.preloader=a["default"].createElement("div",{"class":"search-preloader"},this.rootView);for(var t=a["default"].createElement("div",{"class":"preloader-dots"},this.preloader),e=0;e<5;e++)a["default"].createElement("div",{"class":"dot"},t)},o.prototype.createList=function(){this.listView=a["default"].createElement("ul",{"class":"search-ul"},this.rootView)},o.prototype.showResults=function(t){return a["default"].removeClass(this.searchResultsCountPanel,"empty-result"),this.provider.isQueryValid()?(l["default"].isUndefined(this.provider.getResultsCountSync())&&(this.resultsShown||a["default"].removeClass(this.preloader,"hidden"),a["default"].addClass(this.scrollView,"hidden"),a["default"].setText(this.searchResultsCount,this.getLocaleProvider().get("SearchToolWindow.SEARCH_IN_PROGRESS"))),this.renderResults(0,this.resultsOnPage,!0),void(this.resultsOffset=0)):(a["default"].addClass(this.preloader,"hidden"),a["default"].addClass(this.livePreloader,"hidden"),a["default"].removeClass(this.scrollView,"hidden"),void(l["default"].isEmpty(this.provider.query)&&t?(a["default"].addClass(this.searchResultsCountPanel,"empty-result"),a["default"].setText(this.searchResultsCount,"")):(a["default"].removeClass(this.searchResultsCountPanel,"empty-result"),a["default"].setText(this.searchResultsCount,this.getLocaleProvider().get("SearchToolWindow.MIN_WORD_ERRROR",{0:this.provider.getMinimumQueryLength()})))))},o.prototype.renderResults=function(t,e,i){function n(t,e){d.trigger("change:page",{pageId:t.pageId+"",target:"search"}),d.setElementActive(e)}function o(t,e){var i;i=l["default"].isUndefined(e)?a["default"].createElement("li",{"class":"search-item p"+t.pageId+"-"+t.relevance},d.listView):a["default"].createElement("li",{"class":"search-item p"+t.pageId+"-"+t.relevance},d.listView,"before",e);var o=a["default"].createElement("p",{"class":"list-item search-item-p p"+t.pageId},i),s=a["default"].createElement("span",{"class":"search-item-title",styles:{width:"214px"}},o);s.innerHTML="<b>"+c["default"].cleanString(d.getLocaleProvider().get("SearchToolWindow.PAGE_NUMBER",{0:d.pager.pageTable.getPageCaptionById(t.pageId+"")}))+":</b> "+t.text+r(t.count),o.addEventListener("click",l["default"].partial(n,t,o))}function r(t){return t>1?'<span class="search-item-more">...'+c["default"].cleanString(d.getLocaleProvider().get("SearchToolWindow.MORE_RESULTS",{0:t-1}))+"</span>":""}function s(t){var e=a["default"].className("search-item p"+t.pageId+"-"+t.relevance,d.listView)[0],i=e.firstChild;i.removeEventListener("click",l["default"].partial(n,t,i)),a["default"].del(e)}var d=this;this.provider.getResultsAsync(t,e,function(t,e){i&&(a["default"].addClass(d.preloader,"hidden"),a["default"].removeClass(d.livePreloader,"hidden"),a["default"].removeClass(d.scrollView,"hidden")),d.off("scroll",d._onScroll),l["default"].isEmpty(t)&&(d.resultsShown=!1,a["default"].clear(d.listView),d.trigger("scroll:toTop"));var n=l["default"].difference(t,d.oldResults),r=l["default"].difference(d.oldResults,t);if(!d.resultsShown||n.length===t.length||n.length>d.resultsOnPage/2?(i&&(a["default"].clear(d.listView),d.trigger("scroll:toTop")),l["default"].each(t,function(t){o(t)})):(l["default"].each(n,function(e,i){var n,r=l["default"].indexOf(t,e);r<d.oldResults.length&&(n=a["default"].className("search-item p"+d.oldResults[r-i].pageId+"-"+d.oldResults[r-i].relevance)[0]),o(e,n)}),l["default"].each(r,function(t){s(t)})),d.resultsShown=!0,d.oldResults=t,(d.resultsOffset+1)*d.resultsOnPage<d.provider.getResultsCountSync()&&d.on("scroll",d._onScroll),e===!0){a["default"].addClass(d.livePreloader,"hidden"),d.oldResults=[];var h=d.provider.getResultsCountSync();h>0?a["default"].setText(d.searchResultsCount,d.getLocaleProvider().get("SearchToolWindow.PAGES_FOUND",{0:h})):a["default"].setText(d.searchResultsCount,d.getLocaleProvider().get("SearchToolWindow.NOTHING_FOUND"))}l["default"].defer(function(){d.trigger("change:height")})})},o.prototype._onScroll=function(){function t(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}var e=this.listView.childNodes,i=e[e.length-5];t(i)&&(this.resultsOffset++,this.renderResults(this.resultsOffset,this.resultsOnPage))},o.prototype.setElementActive=function(t){a["default"].removeClass(this.listView.querySelector(".active"),"active"),l["default"].defer(function(){a["default"].addClass(t,"active")})},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){this.pager=e,this.slideshow=o,this.properties=i,this.sound=n,this.fullscreen=!1,this.rootElement=a["default"].createElement("div",{"class":"bottom-toolbar-frame"},t,"top"),this.getLocaleProvider().onAndChange("change:BottomMenu",this._initBottomMenu,this),this.pager.on("change:rtl",this._initBottomMenu,this),this.slideshow.on("change:isActive",this._toggleSlideshow,this);var r=this,s=function(t){t?a["default"].removeClass(r.rootElement,"hidden"):a["default"].addClass(r.rootElement,"hidden")};this.properties.onAndChange("change:components.bottomBar",function(t){s(t)})}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(1),l=n(s),d=i(0),h=n(d),u=i(7),c=n(u),p=i(2),f=n(p),g=i(8),m=n(g),v=i(5),y=n(v);o.prototype=new l["default"],o.constructor=o,o.prototype._initBottomMenu=function(){this.rootElement.innerHTML=m["default"]["workspace-bottom-menu"]({zoomIcon:this.pager.getState().zoomMode?"icon-zoomout":"icon-zoomin",slideshowIcon:this.pager.slideshow?"icon-slideshow-pause":"icon-slideshow",fullscreenIcon:this.fullscreen?"icon-fullscreen-out":"icon-fullscreen",localization:{toc:this.getLocaleProvider().get("BottomMenu.TOC_TIP"),thumbnails:this.getLocaleProvider().get("BottomMenu.THUMBNAILS_TIP"),social:this.getLocaleProvider().get("BottomMenu.PERMALINK_TIP"),textSelection:this.getLocaleProvider().get("BottomMenu.SELECT_BUTTON_TIP"),print:this.getLocaleProvider().get("BottomMenu.PRINT_TIP"),download:this.getLocaleProvider().get("BottomMenu.SAVE_TIP"),sound:this.getLocaleProvider().get("BottomMenu.SOUND_BUTTON_TIP"),notes:this.getLocaleProvider().get("BottomMenu.NOTES_BUTTON_TIP"),fullscreen:this.fullscreen?this.getLocaleProvider().get("BottomMenu.NORMAL_BUTTON_TIP"):this.getLocaleProvider().get("BottomMenu.FULLSCREEN_BUTTON_TIP"),zoom:this.pager.getState().zoomMode?this.getLocaleProvider().get("BottomMenu.UNZOOM_BUTTON_TIP"):this.getLocaleProvider().get("BottomMenu.ZOOM_BUTTON_TIP"),firstPage:this.pager.isRtl()?this.getLocaleProvider().get("NavigationPanel.LAST_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.FIRST_PAGE_TIP"),lastPage:this.pager.isRtl()?this.getLocaleProvider().get("NavigationPanel.FIRST_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.LAST_PAGE_TIP"),nextPage:this.pager.isRtl()?this.getLocaleProvider().get("NavigationPanel.PREV_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.NEXT_PAGE_TIP"),previousPage:this.pager.isRtl()?this.getLocaleProvider().get("NavigationPanel.NEXT_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.PREV_PAGE_TIP"),slideshow:this.slideshow.isActive?this.getLocaleProvider().get("NavigationPanel.PAUSE_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.PLAY_PAGE_TIP")}}),this._initComponents()},o.prototype.getLocaleProvider=function(){return(0,f["default"])().get(f["default"].LOCALE)},o.prototype.getRootElement=function(){return this.rootElement},o.prototype._initComponents=function(){this._initButtons(),this._initNavigation(),this._initSlideshow()},o.prototype._initNavigation=function(){var t=a["default"].id("first-page"),e=a["default"].id("prev-page"),i=a["default"].id("next-page"),n=a["default"].id("last-page"),o=new c["default"](t,{}),r=new c["default"](e,{}),s=new c["default"](i,{}),l=new c["default"](n,{}),d=this;o.on("tap",h["default"].throttle(function(){d.pager.isRtl()?d.pager.goToLast():d.pager.goToFirst()},500)),r.on("tap",h["default"].throttle(function(){d.pager.isRtl()?d.pager.goForward():d.pager.goBackward()},500)),s.on("tap",h["default"].throttle(function(){d.pager.isRtl()?d.pager.goBackward():d.pager.goForward()},500)),l.on("tap",h["default"].throttle(function(){d.pager.isRtl()?d.pager.goToFirst():d.pager.goToLast()},500));var u=function(o){var r=[t,e,i,n],s=a["default"].id("icon-book-first"),l=a["default"].id("icon-book-last");if(o){a["default"].addClass(s,"hidden-component"),a["default"].addClass(l,"hidden-component");for(var d=0;d<r.length;d++)a["default"].removeClass(r[d],"hidden-component")}else{a["default"].removeClass(s,"hidden-component"),a["default"].removeClass(l,"hidden-component");for(var d=0;d<r.length;d++)a["default"].addClass(r[d],"hidden-component")}};this.properties.onAndChange("change:components.navigation",function(t){u(t)})},o.prototype._initSlideshow=function(){var t=this,e=a["default"].id("slideshow"),i=new c["default"](e,{});i.on("tap",function(){t.slideshow.toggle()});var n=function(i){i?a["default"].removeClass(e,"hidden-component"):(a["default"].addClass(e,"hidden-component"),t.pager.set("slideshow",!1)),t._validateDividersVisibility()};this.properties.components.slideshow.onAndChange("change:enabled",function(t){n(t)})},o.prototype._initButtons=function(){var t=this,e=a["default"].id("toc"),i=a["default"].id("thumbnails"),n=a["default"].id("social"),o=a["default"].id("notes"),r=a["default"].id("text-selection"),s=a["default"].id("print"),l=a["default"].id("download"),d=a["default"].id("sound"),u=a["default"].id("fullscreen"),c=a["default"].id("zoom-page"),p=function(e,i){var n=e.className.indexOf("hidden-component")===-1;n!==i&&(i?a["default"].removeClass(e,"hidden-component"):a["default"].addClass(e,"hidden-component"),t._validateDividersVisibility())};e.addEventListener("click",function(){t.trigger("tap:toc")}),this.properties.cast("toc"),this.properties.toc.onAndChange("change:enabled change:children",function(){var t=this.properties.toc;p(e,t.enabled!==!1&&t.children&&t.children.length>0)},this),i.addEventListener("click",function(){t.trigger("tap:thumbnails")}),this.properties.onAndChange("change:components.thumbnails",function(t){p(i,t)}),n.addEventListener("click",function(){t.trigger("tap:social")}),this.properties.on("change:components.share",function(t){p(n,t)}),p(n,this.properties.components.share),o.addEventListener("click",function(){t.trigger("tap:notes")}),this.properties.on("change:components.notes",function(t){p(o,t&&!(0,y["default"])().getLocalStorage().isStub)}),p(o,this.properties.components.notes&&!(0,y["default"])().getLocalStorage().isStub),r.addEventListener("click",function(){t.trigger("tap:textSelection")}),this.properties.onAndChange("change:components.textSelection",function(t){p(r,t)}),s.addEventListener("click",function(){t.trigger("tap:print")}),this.properties.onAndChange("change:components.print",function(t){p(s,t)}),l.addEventListener("click",function(){t.trigger("tap:download")}),this.properties.on("change:downloads",function(t){p(l,!h["default"].isUndefined(t)&&!h["default"].isEmpty(t)&&h["default"].has(t,"enabled")&&t.enabled)}),p(l,!h["default"].isUndefined(this.properties.downloads)&&!h["default"].isEmpty(this.properties.downloads)&&h["default"].has(this.properties.downloads,"enabled")&&this.properties.downloads.enabled),d.addEventListener("click",function(){t.trigger("tap:sound")});var f=function(){var t=!!this.sound&&this.sound.canWork;p(d,t)};this.properties.cast("sound"),this.properties.sound.onAndChange("change:enabled",f,this),this.sound&&this.sound.on("change:canWork",f,this),u.addEventListener("click",function(){t.trigger("tap:fullscreen")}),this.properties.onAndChange("change:components.fullscreen",function(t){p(u,t)}),c.addEventListener("click",h["default"].throttle(function(){t.pager.toggleZoomMode()},1500,{leading:!0,trailing:!1})),this.pager.on("change:state",function(e){a["default"].removeClass(c,"icon-zoomout"),a["default"].removeClass(c,"icon-zoomin"),a["default"].addClass(c,e.zoomMode?"icon-zoomout":"icon-zoomin"),c.title=e.zoomMode?t.getLocaleProvider().get("BottomMenu.UNZOOM_BUTTON_TIP"):t.getLocaleProvider().get("BottomMenu.ZOOM_BUTTON_TIP")}),this.properties.on("change:components.zoom",function(t){p(c,t)}),p(c,this.properties.components.zoom),this._validateDividersVisibility()},o.prototype._validateDividersVisibility=function(){var t=a["default"].className("group1",this.rootElement),e=a["default"].className("group2",this.rootElement),i=a["default"].className("group3",this.rootElement),n=a["default"].className("group4",this.rootElement),o=a["default"].id("divider1"),r=a["default"].id("divider2"),s=a["default"].id("divider3"),l=function(t,e){if(0===t.length||0===e.length)return!1;for(var i,n=!1,o=!1,r=0;r<t.length;r++)i=t[r],n=n||i.className.indexOf("hidden-component")===-1;for(r=0;r<e.length;r++)i=e[r],o=o||i.className.indexOf("hidden-component")===-1;return n&&o};l(t,e)?a["default"].removeClass(o,"hidden-component"):a["default"].addClass(o,"hidden-component"),l(e,i)?a["default"].removeClass(r,"hidden-component"):a["default"].addClass(r,"hidden-component"),l(i,n)?a["default"].removeClass(s,"hidden-component"):a["default"].addClass(s,"hidden-component")},o.prototype._toggleSlideshow=function(t){var e=a["default"].id("slideshow");a["default"].removeClass(e,"icon-slideshow-pause"),a["default"].removeClass(e,"icon-slideshow"),a["default"].addClass(e,t?"icon-slideshow-pause":"icon-slideshow"),e.title=t?this.getLocaleProvider().get("NavigationPanel.PAUSE_PAGE_TIP"):this.getLocaleProvider().get("NavigationPanel.PLAY_PAGE_TIP")},o.prototype.toggleFullscreen=function(t){var e=a["default"].id("fullscreen");a["default"].removeClass(e,"icon-fullscreen-out"),a["default"].removeClass(e,"icon-fullscreen"),a["default"].addClass(e,t?"icon-fullscreen-out":"icon-fullscreen"),this.fullscreen=t,e.title=t?this.getLocaleProvider().get("BottomMenu.NORMAL_BUTTON_TIP"):this.getLocaleProvider().get("BottomMenu.FULLSCREEN_BUTTON_TIP")},o.prototype.toggleSound=function(t){var e=a["default"].id("sound");a["default"].removeClass(e,"icon-sound"),a["default"].removeClass(e,"icon-mute"),a["default"].addClass(e,t?"icon-mute":"icon-sound")},o.prototype.toogleTextSelectionMode=function(t){var e=a["default"].id("text-selection");a["default"].removeClass(e,"toggled"),t&&a["default"].addClass(e,"toggled")},o.prototype.destructor=function(){this.rootElement&&a["default"].del(this.rootElement)},e["default"]=o},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(e,i,n,o,r,a,l){this.isBottomOpaque=!1,this.isBottomJustify=!1,this.container=e,this.flipbookContainer=r,this.bodyContainer=a,this.bottomMenu=n,this.topBar=o,this.props=i,this.skinConfig=l,this.fbLogo=!1,this.slidePresenter=null,this.rootElement=s["default"].createElement("div",{"class":"logo-frame hidden",id:"logo-frame",role:"banner"},e),this.properties=i.logoLink,this.link=s["default"].createElement("a",{role:"button"},this.rootElement),this.img=s["default"].createElement("img",{draggable:!1},this.link);var h=(0,p["default"])().getCrossOrigin();h&&(this.img.crossOrigin=h);var c=this;this.windowSizeChange=function(){d["default"].defer(function(){c.resetLogoPosition()})},t.addEventListener("resize",this.windowSizeChange),this.img.onload=function(){c.resetLogoPosition()},this.props.on("change:logoLink",this._onPropertiesChange,this),this.props.on("change:components.bottomBar change:components.topBar",this.resetLogoPosition,this),(0,u["default"])().on("change:"+u["default"].CURRENT_PRESENTER,this.slideModeChange,this),(0,u["default"])().has(u["default"].CURRENT_PRESENTER)&&this.slideModeChange((0,u["default"])().get(u["default"].CURRENT_PRESENTER)),this.skinConfig.on("change:top-left-icon-color change:top-right-icon-color change:bottom-left-icon-color change:bottom-right-icon-color",function(){this._onPropertiesChange()},this),this._onPropertiesChange(),(0,u["default"])().get(u["default"].API).addMethod("getDefaultLogoUrl",this.getDataUrl)}function r(t){return t.width>=b&&t.height>=b?t:void 0}Object.defineProperty(e,"__esModule",{value:!0});var a=i(3),s=n(a),l=i(0),d=n(l),h=i(2),u=n(h),c=i(5),p=n(c),f=i(93),g=n(f),m=i(31),v=n(m),y=10,b=10;o.prototype.constructor=o,o.prototype.destructor=function(){t.removeEventListener("resize",this.windowSizeChange),(0,u["default"])().off("change:"+u["default"].CURRENT_PRESENTER,this.slideModeChange,this),(0,u["default"])().get(u["default"].CURRENT_PRESENTER).view.off("zoomAnimation:end",this.resetLogoPosition,this),(0,u["default"])().get(u["default"].CURRENT_PRESENTER).view.off("slideAnimation:end",this.resetLogoPosition,this),this.props.off("change:logoLink",this._onPropertiesChange,this),this.props.off("change:components.bottomBar change:components.topBar",this.resetLogoPosition,this),this.img.onload=null,this.slidePresenter=null,this.rootElement&&s["default"].del(this.rootElement)},o.prototype.slideModeChange=function(t,e){t&&t.constructor===v["default"]?this.slidePresenter=t:this.slidePresenter=null,e&&(e.view.off("zoomAnimation:end",this.resetLogoPosition,this),e.view.off("slideAnimation:end",this.resetLogoPosition,this)),t.view.on("zoomAnimation:end",this.resetLogoPosition,this),t.view.on("slideAnimation:end",this.resetLogoPosition,this)},o.prototype.windowSizeChange=function(){},o.prototype.getLocaleProvider=function(){return(0,u["default"])().get(u["default"].LOCALE)},o.prototype.getImage=function(){var t=this.properties.image;if(!t&&this.properties.url&&this.properties.url.toLowerCase().indexOf("flippingbook.com")!==-1){this.fbLogo=!0,this.top?(s["default"].addClass(this.bodyContainer,"logo-top"),s["default"].removeClass(this.bodyContainer,"logo-bottom")):(s["default"].addClass(this.bodyContainer,"logo-bottom"),s["default"].removeClass(this.bodyContainer,"logo-top"));var e=s["default"].createElement("div");e.innerHTML=g["default"];var i=e.childNodes[0],n=this.skinConfig[(this.top?"top":"bottom")+"-"+(this.left?"left":"right")+"-icon-color"],o=this.left?"":"translate(64.12)";i.querySelector("#made-with-group").setAttribute("transform",o),i.querySelector("#fb-logo-main").setAttribute("fill",n),i.querySelector("#fb-logo-main").setAttribute("fill-opacity","1"),this.fbLogo={width:i.width.baseVal.value,height:i.height.baseVal.value},t="data:image/svg+xml;base64,"+btoa(e.innerHTML),e=null}return t},o.prototype._onPropertiesChange=function(t){d["default"].isUndefined(t)||(this.properties=t),d["default"].isUndefined(this.properties.position)&&(this.properties.position="bottom-right"),this.top=this.properties.position.indexOf("top")!==-1,this.left=this.properties.position.indexOf("left")!==-1;var e=this.properties.url;d["default"].isEmpty(e)?(s["default"].removeClass(this.rootElement,"linked"),this.rootElement.appendChild(this.img),this.link.href="",this.img.removeAttribute("alt"),this.img.removeAttribute("title")):(s["default"].addClass(this.rootElement,"linked"),this.link.appendChild(this.img),this.link.href=e,this.getLocaleProvider().onAndChange("change:TopMenu.EXTERNAL_LINK_TIP",function(){var t=this.getLocaleProvider().get("TopMenu.EXTERNAL_LINK_TIP",{0:e}),i=t.indexOf("?");i>-1&&(t=t.substr(0,i)),this.img.alt=this.img.title=t},this)),this.link.target=this.properties.target;var i=this.getImage();if(d["default"].isEmpty(i))s["default"].addClass(this.rootElement,"hidden"),this.img.removeAttribute("src");else{var n=i.indexOf("data:image")!==-1?i:(0,p["default"])().translatePath(i);s["default"].removeClass(this.rootElement,"hidden"),this.img.src=n}},o.prototype.updateMenuClasses=function(t){this.isBottomOpaque=void 0!==d["default"].find(t,function(t){return"opaqueBottom"===t}),this.isBottomJustify=void 0!==d["default"].find(t,function(t){return"justifyBottom"===t}),this.resetLogoPosition()},o.prototype.resetLogoPosition=function(){var t=this._initRects(),e=t.filter(function(t){return"mini_mode"===t.placement}),i=this._sortRects(t),n=this.getImage();e.length>0&&!d["default"].isEmpty(n)?(this._placeLogo(e[0]),s["default"].removeClass(this.rootElement,"hidden")):i.length>0&&!d["default"].isEmpty(n)?(this._placeLogo(i[0]),s["default"].removeClass(this.rootElement,"hidden")):s["default"].addClass(this.rootElement,"hidden")},o.prototype._placeLogo=function(t){var e=this.img.naturalWidth,i=this.img.naturalHeight,n=this.rootElement.style;switch(!this.fbLogo||0!==e&&0!==i||(e=this.fbLogo.width,i=this.fbLogo.height),this.img.height=Math.floor(i*t.scale),this.img.width=Math.floor(e*t.scale),t.placement){case"corner":case"mini_mode":case"above_bottom_menu":n.top=t.rect.top?t.rect.top+"px":"",n.bottom=t.rect.bottom?t.rect.bottom+"px":"",n.left=t.rect.left?t.rect.left+"px":"",n.right=t.rect.right?t.rect.right+"px":"",n.zIndex=1;break;case"inside_bottom_menu":n.top=t.rect.top+Math.floor((t.rect.height-this.img.height)/2)+"px",n.bottom="",n.left=t.rect.left?t.rect.left+"px":"",n.right=t.rect.right?t.rect.right+"px":"",n.zIndex=4}},o.prototype._sortRects=function(t){return t.sort(function(t,e){var i=["inside_bottom_menu","corner","above_bottom_menu"];return t.scale===e.scale?i.indexOf(t.placement)-i.indexOf(e.placement):e.scale-t.scale})},o.prototype._initRects=function(){var t=this._getRect(this.bottomMenu),e=this._getRect(this.topBar),i=this._getRect(this.flipbookContainer),n=d["default"].findWhere(s["default"].className("bottom-toolbar"),{localName:"div"}),o=this._getRect(n),r={x:0,y:0,width:i.width,height:i.height};r.y=e?e.height:r.y,r.width=Math.round(r.width/2),r.x=(i.width-r.width)/2;var a=[];if(s["default"].hasClass(this.bodyContainer,"mini")){var l=this._getMiniModeRect(i);if(!d["default"].isUndefined(l)){var h=this._calculateScale(l);a.push({rect:l,scale:h,placement:"mini_mode"})}return a}if(this.top)if(this.left){var u=this._getTopLeftRect(r,e);if(!d["default"].isUndefined(u)){var c=this._calculateScale(u);a.push({rect:u,scale:c,placement:"corner"})}}else{var p=this._getTopRightRect(r,e);if(!d["default"].isUndefined(p)){var f=this._calculateScale(p);a.push({rect:p,scale:f,placement:"corner"})}}else{var g=this._getAboveBottomMenuRect(r,t,i);if(!d["default"].isUndefined(g)){var m=this._calculateScale(g);a.push({rect:g,scale:m,placement:"above_bottom_menu"})}if(!this.isBottomOpaque&&!this.isBottomJustify||!this.props.components.bottomBar){if(this.left){var v=this._getBottomLeftRect(r,o);if(!d["default"].isUndefined(v)){var y=this._calculateScale(v);a.push({rect:v,scale:y,placement:"corner"})}}else{var b=this._getBottomRightRect(r,o,t);if(!d["default"].isUndefined(b)){var w=this._calculateScale(b);a.push({rect:b,scale:w,placement:"corner"})}}var _=this._getInsideBottomMenuRect(o,t);if(!d["default"].isUndefined(_)){var P=this._calculateScale(_);a.push({rect:_,scale:P,placement:"inside_bottom_menu"})}}}return a},o.prototype._calculateScale=function(t){var e=this.img.naturalHeight,i=this.img.naturalWidth,n=t.height,o=t.width,r=1,a=1;!this.fbLogo||0!==i&&0!==e||(i=this.fbLogo.width,e=this.fbLogo.height),e>n&&(r=n/e),i>o&&(a=o/i);var s=Math.min(a,r,1);return s},o.prototype._getBottomRightRect=function(t,e,i){var n=Math.floor(t.height/2)-y,o=i?i.width-Math.max(e.x+e.width,t.x+t.width)-y:t.x-y;return r({width:o,height:n,right:y,bottom:y})},o.prototype._getBottomLeftRect=function(t,e){var i=Math.floor(t.height/2)-y,n=e?Math.min(e.x,t.x)-y:t.x-y;return r({left:y,width:n,height:i,bottom:y})},o.prototype._getTopRightRect=function(t,e){var i=e?e.height+y:y,n=Math.floor(t.height/2)-y,o=t.x-y;return r({top:i,width:o,height:n,right:y})},o.prototype._getTopLeftRect=function(t,e){var i=e?e.height+y:y,n=Math.floor(t.height/2)-y,o=t.x-y;return r({left:y,top:i,width:o,height:n})},o.prototype._getInsideBottomMenuRect=function(t,e){if(!d["default"].isUndefined(e)){var i=e.y,n=e.height,o=(e.width-t.width)/2-2*y;if(this.left)var a=y;else var s=y;return r({width:o,height:n,top:i,left:a,right:s})}},o.prototype._getAboveBottomMenuRect=function(t,e,i){if(!d["default"].isUndefined(e)){var n=Math.floor(t.y+t.height/2+y),o=e.y-n-y,a=i.width-t.x-t.width-2*y,s=e.height+y;if(this.left)var l=y;else var h=y;return r({width:a,height:o,bottom:s,left:l,right:h})}},o.prototype._getMiniModeRect=function(t){var e={};switch(e.height=t.height-2*y,e.width=Math.floor(t.width/4-y),this.properties.position){case"top-left":e.top=e.left=y;break;case"top-right":e.top=e.right=y;break;case"bottom-right":e.right=e.bottom=y;break;case"bottom-left":e.left=e.bottom=y}return r(e)},o.prototype.getDataUrl=function(){return"data:image/svg+xml;base64,"+btoa(g["default"])},o.prototype._getRect=function(t,e){e=e||this.container;var i=t.getBoundingClientRect(),n=e.getBoundingClientRect();if(0!==i.width&&0!==n.width)return{x:i.left-n.left,y:i.top-n.top,width:i.width,height:i.height}},e["default"]=o}).call(e,i(6))},function(t,e){t.exports='<svg version="1.1" width="119px" height="30px" viewBox="0 0 119 30" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g id="fb-logo-main" fill="#272f37" fill-opacity=".8"><g id="logo-group" transform="translate(0,12)"><path id="flippingbook" d="m27.102 14.062c0 0.29021-0.23302 0.52552-0.52491 0.52552h-1.0523c-0.29014 0-0.52491-0.23566-0.52491-0.52552v-11.011c0-0.3549 0.301-0.52587 0.49688-0.52587h6.3378c0.28909 0 0.52351 0.23252 0.52351 0.52413v1.05c0 0.28916-0.23652 0.52378-0.52351 0.52378h-4.6247c-0.05957 0-0.10792 0.045455-0.10792 0.1028v2.679c0 0.056643 0.04695 0.1028 0.10547 0.1028h3.8356c0.29084 0 0.52666 0.23252 0.52666 0.52378v1.05c0 0.28951-0.23372 0.52413-0.52666 0.52413h-3.8356c-0.05817 0-0.10547 0.046853-0.10547 0.10559zm8.6726-11.538c0-0.28846-0.23512-0.52378-0.52526-0.52378l-1.0523 0.13112c-0.39561 0.048951-0.52491 0.23462-0.52491 0.52378 0 0-0.0063 9.8014 0 9.8336-0.0063 1.3689 1.1266 2.1042 2.1024 2.0986 0.97553-0.0056 0.52806 0.0056 0.52806 0.0056 0.28663-6.99e-4 0.52281-0.24021 0.52281-0.52937v-1.1755c0-0.23007-0.18747-0.3993-0.38755-0.3993h-0.26981c-0.22812 0-0.38159-0.16538-0.39351-0.37413zm2.8905 0.52517c0-0.57937 0.472-1.049 1.0512-1.049 0.58062 0 1.0512 0.47098 1.0512 1.049 0 0.57937-0.47165 1.049-1.0512 1.049-0.58062 0-1.0512-0.47063-1.0512-1.049zm0.52526 2.3601h1.0523c0.28979 0 0.52491 0.18357 0.52491 0.52657v8.1252c0 0.29056-0.23302 0.52622-0.52491 0.52622h-1.0523c-0.29014 0-0.52526-0.23601-0.52526-0.52622v-8.1252c0-0.29091 0.14051-0.52657 0.52526-0.52657zm3.6817 2.8385c-0.0014 0.015385-0.0021 0.031119-0.0021 0.046853v8.6521c0 0.29021 0.23512 0.52518 0.52491 0.52518h1.0523c0.29224 0 0.52526-0.23496 0.52526-0.52518v-2.4846c0.48602 0.24685 1.0253 0.38741 1.5782 0.38741h0.25965c1.7457 0 3.1551-1.4087 3.1551-3.1469v-3.4087c0-1.736-1.4118-3.1469-3.1533-3.1469h-0.78842c-1.7433 0-3.1537 1.4077-3.1537 3.1444v-0.36434c0 0.10315 7.01e-4 0.21014 0.0021 0.32063zm2.1003 0.043706c0-0.72273 0.58833-1.3087 1.314-1.3087h0.26245c0.72569 0 1.3144 0.58916 1.3144 1.3087v3.414c0 0.72273-0.58868 1.3084-1.3144 1.3084h-0.26245c-0.72569 0-1.314-0.58916-1.314-1.3084zm6.8347-0.043706c-0.0014 0.015385-0.0021 0.031119-0.0021 0.046853v8.6521c0 0.29021 0.23512 0.52518 0.52526 0.52518h1.0519c0.29224 0 0.52526-0.23496 0.52526-0.52518v-2.4846c0.48636 0.24685 1.0253 0.38741 1.5782 0.38741h0.26c1.7454 0 3.1551-1.4087 3.1551-3.1469v-3.4087c0-1.736-1.4121-3.1469-3.1537-3.1469h-0.78842c-1.7433 0-3.1537 1.4077-3.1537 3.1444v-0.36434c0 0.10315 7.01e-4 0.21014 0.0021 0.32063zm2.1003 0.043706c0-0.72273 0.58833-1.3087 1.3144-1.3087h0.2621c0.72604 0 1.3144 0.58916 1.3144 1.3087v3.414c0 0.72273-0.58868 1.3084-1.3144 1.3084h-0.2621c-0.72604 0-1.3144-0.58916-1.3144-1.3084zm6.8326-5.2423c0-0.57937 0.472-1.049 1.0512-1.049 0.58062 0 1.0512 0.47098 1.0512 1.049 0 0.57937-0.47165 1.049-1.0512 1.049-0.58027 0-1.0512-0.47063-1.0512-1.049zm0.52526 2.3601h1.0523c0.28979 0 0.52491 0.18357 0.52491 0.52657v8.1252c0 0.29056-0.23302 0.52622-0.52491 0.52622h-1.0523c-0.29014 0-0.52526-0.23601-0.52526-0.52622v-8.1252c0-0.29091 0.16539-0.52657 0.52526-0.52657zm4.2049 9.178h1.0519c0.14086 0 0.26806-0.0542 0.36162-0.14301 0.10092-0.09685 0.16364-0.23287 0.16364-0.38322v-5.7671c0-0.72413 0.58833-1.3112 1.3144-1.3112h0.2621c0.72569 0 1.3144 0.58811 1.3144 1.3094v5.2427l3.51e-4 0.53706c-0.0011 0.28916 0.23302 0.52378 0.52316 0.52238l1.0533-0.0045c0.29224-0.0014 0.52526-0.23706 0.52526-0.52657v-5.7693c0-1.7385-1.4118-3.1469-3.1533-3.1469h-0.78842c-0.48847 0-0.95065 0.11049-1.3627 0.30769-0.06553-0.029371-0.13771-0.045455-0.21375-0.045455h-1.0519c-0.29224 0-0.52526 0.23566-0.52526 0.52657v8.1252c0 0.14546 0.05922 0.27762 0.15488 0.37273 0.09391 0.09476 0.22531 0.1535 0.37038 0.1535zm15.773-6.5811-0.0039 0.28741c0-1.7364-1.4104-3.1444-3.1533-3.1444h-0.78842c-1.7415 0-3.153 1.4108-3.153 3.1469v3.4091c0 1.7378 1.409 3.1469 3.1547 3.1469h0.25965c0.60025 0 1.0764-0.10524 1.5944-0.39301 0 1.0853-0.82486 1.5524-1.5891 1.5678-1.2941 0.02622-1.9041-0.71818-2.0275-0.81713-0.12334-0.09895-0.25545-0.13986-0.41173 0l-0.71938 0.79091c-0.1279 0.13322-0.19658 0.35944-0.01647 0.57727 0 0 1.1202 1.1692 2.9101 1.1563 0.08164-3.5e-4 0.11423-3.5e-4 0.26491 0 2.3586 8e-3 3.66-1.5762 3.6681-4.128 7e-3 -2.1458-0.0074-4.1126-0.0081-4.7413 0.0098-0.33427 0.01892-0.57238 0.01892-0.85874zm-2.1056 0.28741c0-0.72273-0.58833-1.3087-1.314-1.3087h-0.26246c-0.72569 0-1.314 0.58951-1.314 1.3087v3.414c0 0.72273 0.58833 1.3087 1.314 1.3087h0.26246c0.72569 0 1.314-0.58916 1.314-1.3087zm9.4578 6.2937c1.8883 0 3.4179-1.5262 3.4179-3.4087 0-1.2612-0.6861-2.3619-1.7061-2.9514 0.79472-0.57133 1.3119-1.5031 1.3119-2.5556 0-1.7381-1.4114-3.1469-3.1526-3.1469h-4.3377c-0.29224 0-0.52526 0.23566-0.52526 0.52622v11.01c0 0.29056 0.23512 0.52587 0.52526 0.52587h0.52631zm-0.26175-4.9822c0.79858 0 1.4458 0.6472 1.4458 1.4423 0 0.7965-0.6493 1.442-1.4458 1.442h-2.5212c-0.05887 0-0.10652-0.0451-0.10652-0.10245v-2.6794c0-0.056643 0.04555-0.10245 0.10652-0.10245zm-0.39491-5.2448c0.87146 0 1.5779 0.70629 1.5779 1.5734 0 0.86888-0.70642 1.5734-1.5779 1.5734h-2.1249c-0.05957 0-0.10792-0.044406-0.10792-0.1049v-2.9371c0-0.058042 0.0466-0.1049 0.10792-0.1049zm5.6514 3.9336c0-1.7381 1.41-3.1469 3.1533-3.1469h0.78842c1.7419 0 3.1537 1.4108 3.1537 3.1469v3.4087c0 1.7381-1.4104 3.1469-3.1537 3.1469h-0.78842c-1.7415 0-3.1533-1.4108-3.1533-3.1469zm2.1021-0.00245c0-0.72273 0.58868-1.3087 1.3144-1.3087h0.26246c0.72569 0 1.314 0.58916 1.314 1.3087v3.414c0 0.72273-0.58833 1.3084-1.314 1.3084h-0.26246c-0.72569 0-1.3144-0.58916-1.3144-1.3084zm6.3073 0.00245c0-1.7381 1.4104-3.1469 3.1533-3.1469h0.78877c1.7415 0 3.1533 1.4108 3.1533 3.1469v3.4087c0 1.7381-1.4104 3.1469-3.1533 3.1469h-0.78877c-1.7415 0-3.1533-1.4108-3.1533-3.1469zm2.0762-0.00245c0-0.72273 0.58834-1.3087 1.314-1.3087h0.26245c0.7257 0 1.314 0.58916 1.314 1.3087v3.414c0 0.72273-0.58833 1.3084-1.314 1.3084h-0.26245c-0.72569 0-1.314-0.58916-1.314-1.3084zm11.949 5.9755c0.0943 0.11259 0.28664 0.32273 0.431 0.32273h1.8407c0.25019 0 0.31046-0.28636 0.21445-0.40944l-3.7847-4.5668c1.9115-1.2273 2.7384-3.5902 2.7735-3.8038 0.035-0.21364-0.0445-0.38706-0.33183-0.38706h-1.3585c-0.37774 0-0.3921 0.2958-0.51404 0.50734-0.1223 0.21154-0.56906 1.8066-2.5173 2.7259l-3.5e-4 -5.8664c-3.5e-4 -0.29056-0.23547-0.52483-0.52561-0.52483h-1.0512c-0.3483 0-0.52561 0.26084-0.52561 0.52483l3.5e-4 11.277c0 0.28986 0.23513 0.52378 0.52526 0.52378h1.0519c0.29223 0 0.52525-0.23426 0.52525-0.52378v-3.6671z"></path><path id="logo" d="m0.0096011 15.686c-0.0063073-0.0479-0.009461-0.0965-0.009461-0.14546v-13.433c0-0.098601 0.013666-0.19545 0.038194-0.28636 0.19027-1.0196 1.0845-1.7941 2.1617-1.801 0.33534-0.0013986 0.65421 0.070979 0.94014 0.20245l5.9485 3.072-0.0042-0.0014c0.019968-0.011887 0.15698-0.10175 0.21024-0.13007l5.7162-2.9608c0.28558-0.13182 0.60445-0.20455 0.93979-0.2028 1.1479 0.0073427 2.0874 0.88636 2.1907 2.0031 0.0063 0.047902 0.0095 0.096154 0.0095 0.14545v13.433c0 0.0993-0.01332 0.1958-0.03819 0.28706-0.19062 1.0192-1.0845 1.7941-2.1617 1.8003-0.33534 0.0021-0.65421-0.07028-0.93979-0.20175l-5.9447-3.0703c-0.019623 0.01154-0.15733 0.10105-0.21024 0.12937l-5.7162 2.9612c-0.28593 0.13182-0.60445 0.2042-0.93979 0.20245-1.1479-0.007692-2.087-0.88601-2.1907-2.0031m2.8337-0.54685 5.1335-2.6654c0.50003-0.31434 0.82521-0.87657 0.80594-1.508-0.00946-0.29965-0.095311-0.57972-0.23863-0.82063l-7.008e-4 3.49e-4 0.00456-0.0031-0.75548-1.3298c-0.38159-0.58287-0.61216-1.2745-0.63564-2.021-0.019623-0.6486 0.11914-1.2654 0.38159-1.8133l0.00771 0.0049-4.7032-2.4129c-0.052562-0.021334-0.11073-0.033571-0.1717-0.033571-0.25194 0-0.45763 0.20455-0.45763 0.45664v1.4448h-7.008e-4v8.8332h7.008e-4v1.4451c0 0.25175 0.20569 0.45594 0.45798 0.45594 0.060971 0 0.11879-0.01119 0.1717-0.03322m13.094-0.44405v-1.4444h0.0011v-8.8332h-0.0011v-1.4444c0-0.2528-0.20534-0.45629-0.45798-0.45629-0.06097 0-0.11879 0.011189-0.17135 0.032867l-5.1338 2.6657c-0.49968 0.31364-0.82521 0.87622-0.80594 1.508 0.00946 0.29965 0.09496 0.57972 0.23898 0.82063l7.008e-4 -3.496e-4 -0.00491 0.0021 0.75513 1.3304c0.38194 0.58322 0.61286 1.2748 0.63599 2.021 0.01997 0.64895-0.11914 1.2654-0.38229 1.8136l4.6962 2.408c0.05256 0.02098 0.11073 0.03322 0.1717 0.03322 0.25229 0 0.45763-0.2049 0.45763-0.45699"></path></g><g id="made-with-group"><path id="made-with" d="m1.0254 2.6602 0.029297 0.70312c0.46485-0.54688 1.0918-0.82031 1.8809-0.82031 0.88672 0 1.4902 0.33984 1.8105 1.0195 0.21094-0.30469 0.48535-0.55078 0.82324-0.73828 0.33789-0.1875 0.7373-0.28125 1.1982-0.28125 1.3906 0 2.0977 0.73632 2.1211 2.209v4.248h-1.084v-4.1836c0-0.45313-0.10351-0.79199-0.31055-1.0166s-0.55468-0.33691-1.043-0.33691c-0.40235 0-0.73633 0.12012-1.002 0.36035-0.26563 0.24024-0.41992 0.56347-0.46289 0.96973v4.207h-1.0898v-4.1543c0-0.92188-0.45117-1.3828-1.3535-1.3828-0.71094 0-1.1973 0.30273-1.459 0.9082v4.6289h-1.084v-6.3398zm13.524 6.3398c-0.0625-0.125-0.11328-0.34765-0.15234-0.66797-0.50391 0.52344-1.1055 0.78516-1.8047 0.78516-0.625 0-1.1377-0.17676-1.5381-0.53027-0.40039-0.35352-0.60059-0.80176-0.60059-1.3447 0-0.66016 0.25097-1.1728 0.75293-1.5381 0.50196-0.36524 1.208-0.54785 2.1182-0.54785h1.0547v-0.49805c0-0.37891-0.11328-0.68066-0.33984-0.90527s-0.56054-0.33691-1.002-0.33691c-0.38672 0-0.71094 0.097655-0.97266 0.29297-0.26172 0.19531-0.39258 0.43164-0.39258 0.70898h-1.0898c0-0.31641 0.1123-0.62207 0.33691-0.91699 0.22461-0.29492 0.5293-0.52832 0.91406-0.7002 0.38477-0.17188 0.80762-0.25781 1.2686-0.25781 0.73047 0 1.3027 0.18262 1.7168 0.54785 0.41406 0.36524 0.62891 0.86816 0.64453 1.5088v2.918c0 0.58203 0.07422 1.0449 0.22266 1.3887v0.09375zm-1.7988-0.82617c0.33984 0 0.66211-0.08789 0.9668-0.26367 0.30469-0.17578 0.52539-0.4043 0.66211-0.68555v-1.3008h-0.84961c-1.3281 0-1.9922 0.38867-1.9922 1.166 0 0.33985 0.11328 0.60547 0.33984 0.79688 0.22656 0.19141 0.51758 0.28711 0.87305 0.28711zm4.2607-2.3965c0-0.97266 0.23047-1.7549 0.69141-2.3467 0.46094-0.5918 1.0644-0.8877 1.8105-0.8877 0.74219 0 1.3301 0.2539 1.7637 0.76172v-3.3047h1.084v9h-0.99609l-0.05273-0.67969c-0.4336 0.53125-1.0371 0.79688-1.8105 0.79688-0.73438 0-1.333-0.30078-1.7959-0.90234-0.4629-0.60157-0.69434-1.3867-0.69434-2.3555zm1.084 0.12305c0 0.71875 0.14844 1.2812 0.44531 1.6875 0.29688 0.40625 0.70703 0.60938 1.2305 0.60938 0.6875 0 1.1895-0.30859 1.5059-0.92578v-2.9121c-0.32422-0.59766-0.82226-0.89648-1.4941-0.89648-0.53125 0-0.94531 0.20508-1.2422 0.61523-0.29688 0.41016-0.44531 1.0176-0.44531 1.8223zm8.6904 3.2168c-0.85938 0-1.5586-0.28222-2.0977-0.84668-0.53907-0.56446-0.80859-1.3193-0.80859-2.2646v-0.19922c0-0.62891 0.12012-1.1904 0.36035-1.6846 0.24024-0.49414 0.57617-0.88086 1.0078-1.1602 0.43164-0.2793 0.89941-0.41895 1.4033-0.41895 0.82422 0 1.4648 0.27148 1.9219 0.81445 0.45703 0.54297 0.68555 1.3203 0.68555 2.332v0.45117h-4.2949c0.01563 0.625 0.19824 1.1299 0.54785 1.5146 0.34961 0.38477 0.79394 0.57715 1.333 0.57715 0.38281 0 0.70703-0.078124 0.97266-0.23438 0.26563-0.15625 0.49805-0.36328 0.69726-0.62109l0.66211 0.51562c-0.53125 0.81641-1.3281 1.2246-2.3906 1.2246zm-0.13477-5.6836c-0.4375 0-0.80469 0.15918-1.1016 0.47754-0.29688 0.31836-0.48047 0.76465-0.55078 1.3389h3.1758v-0.082031c-0.031251-0.55078-0.17969-0.97754-0.44531-1.2803s-0.625-0.4541-1.0781-0.4541zm12.67 4.0723 1.2188-4.8457h1.084l-1.8457 6.3398h-0.87891l-1.541-4.8047-1.5 4.8047h-0.87891l-1.8398-6.3398h1.0781l1.248 4.7461 1.4766-4.7461h0.87305zm4.6943 1.4941h-1.084v-6.3398h1.084zm-1.1719-8.0215c0-0.17578 0.05371-0.32422 0.16113-0.44531 0.10742-0.12109 0.2666-0.18164 0.47754-0.18164 0.21094 0 0.37109 0.060546 0.48047 0.18164 0.10938 0.12109 0.16406 0.26953 0.16406 0.44531 0 0.17578-0.05469 0.32227-0.16406 0.43945-0.10938 0.11719-0.26953 0.17578-0.48047 0.17578-0.21094 0-0.37012-0.058593-0.47754-0.17578-0.10742-0.11719-0.16113-0.26367-0.16113-0.43945zm4.4892 0.14648v1.5352h1.1836v0.83789h-1.1836v3.9316c0 0.25391 0.05273 0.44434 0.1582 0.57129 0.10547 0.12695 0.28516 0.19043 0.53906 0.19043 0.125 0 0.29687-0.023437 0.51562-0.070312v0.87891c-0.28516 0.078125-0.5625 0.11719-0.83203 0.11719-0.48438 0-0.84961-0.14648-1.0957-0.43945s-0.36914-0.70898-0.36914-1.248v-3.9316h-1.1543v-0.83789h1.1543v-1.5352zm3.6454 2.3027c0.48047-0.58985 1.1055-0.88477 1.875-0.88477 1.3398 0 2.0156 0.75585 2.0273 2.2676v4.1895h-1.084v-4.1953c-0.003906-0.45703-0.1084-0.79492-0.31348-1.0137-0.20508-0.21875-0.52441-0.32812-0.95801-0.32812-0.35156 0-0.66016 0.093749-0.92578 0.28125-0.26563 0.1875-0.47266 0.43359-0.62109 0.73828v4.5176h-1.084v-9h1.084z"></path></g></g></g></svg>';
},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.x=t,this.y=e}function r(t){s["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(29),s=n(a),l=i(4),d=n(l),h=i(10),u=n(h),c=i(0),p=n(c),f=i(16),g=n(f),m=i(3),v=n(m),y=i(7),b=n(y),w=i(2),_=n(w),P={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};r.prototype=new s["default"],r.prototype.constructor=r,r.prototype.init=function(t,e){var i={contentProvider:null,unitSizeProvider:null,animate:null};if(p["default"].extend(i,e),this._genDOM(t),this.unitPageSizeProvider=i.unitSizeProvider,i.animate?this.zoomFactor=i.animate.from:this.zoomFactor=i.zoom||this._calcZoomFactorToFitWidth(this.unitPageSizeProvider.getUnitPageSize()),this.contentProvider=i.contentProvider,this.globalWidth=this.mainContainer.clientWidth,this.globalHeight=this.mainContainer.clientHeight,this.dragSliderCenter=!1,this.maxPullSize=this.globalWidth/7,this.currentPageCorner=new o(0,0),this.leftPageCorner=new o(0,0),this.rightPageCorner=new o(0,0),this.contentCorner=new o(0,0),this.leftContentCorner=new o(0,0),this.rightContentCorner=new o(0,0),this.contentCornerStore=new o(0,0),this.currentPageCornerStore=new o(0,0),this.on("slideAnimation:start",function(){this.presenter.onStartDrag()},this),this.on("slideAnimation:end",function(){this.presenter.onPageChanged()},this),this.on("zoomAnimation:start",function(){this.presenter.freeze()},this),this.on("zoomAnimation:end",function(){this.presenter.unfreeze()},this),this._newWrapper("current"),this._newWrapper("right"),this._newWrapper("left"),this._bindCurrentWrapperDOM(),this._setCurrentWrapperPosition(),this.container=t,i.animate){var n=i.animate.to||this._calcZoomFactorToFitWidth(this.unitPageSizeProvider.getUnitPageSize());this.setZoomValue(n,p["default"].isObject(i.animate.center)?i.animate.center:null,i.animate.duration)}},r.prototype.getDOMElement=function(){return this.zoomFrame},r.prototype.getZoomValue=function(){return this.zoomFactor},r.prototype.setZoomValue=function(t,e,i,n){if(i=i||0,this.zoomFactor!==t||p["default"].isObject(e)){var o=this.zoomFactor||1;n||(this.zoomFactor=t),this._scaleCurrentWrapper(t/o,p["default"].isObject(e)?e:null,i,n),this.trigger("zoom",t,o)}},r.prototype._genDOM=function(t){var e=this,i=v["default"].createElement("div",{id:"zoom-frame","class":"zoom-frame"},t);this.zoomFrame=i,this.mainContainer=v["default"].createElement("div",{id:"zoom-body","class":"zoom-body"},i),this.leftArrow=v["default"].createElement("button",{"class":"slide-arrow icon icon-book-prev",tabindex:"0"},"zoom-frame","top"),this.rightArrow=v["default"].createElement("button",{"class":"slide-arrow icon icon-book-next",tabindex:"0"},"zoom-frame"),this.leftArrow.addEventListener("click",p["default"].throttle(function(){e.presenter.goLeft(!0)},800,{leading:!0})),this.rightArrow.addEventListener("click",p["default"].throttle(function(){e.presenter.goRight(!0)},800,{leading:!0}))},r.prototype.setLeftArrowVisible=function(t){this.leftArrow.style.display=t?"inline-block":"none"},r.prototype.setRightArrowVisible=function(t){this.rightArrow.style.display=t?"inline-block":"none"},r.prototype.getContainer=function(){return this.mainContainer},r.prototype._newWrapper=function(t,e){e=e||null,t=t||"right";var i=v["default"].createElement("div",{"class":"wrapper"});i.dataset.position=t;var n;this.contentProvider&&(n=this.contentProvider.getContentForPage(t,e));var o=this.unitPageSizeProvider.getUnitPageSize(),r={width:o.width*this.zoomFactor,height:o.height*this.zoomFactor};n&&n.isWide()&&(r.height=r.height/2),r.height=Math.round(r.height),r.width=Math.round(r.width);var a=v["default"].createElement("div",{"class":"slide-content",styles:{width:r.width+"px",height:r.height+"px",position:"absolute",overflow:"hidden"}},i);n&&(a.appendChild(n.getViewElement()),n.resize(r),n.sendContentSizeThr1("zoomPage")),"left"===t?this.mainContainer.insertBefore(i,this.mainContainer.getElementsByTagName("div")[0]):this.mainContainer.appendChild(i),this[t+"Wrapper"]={container:i,content:a,contentObject:n,hammer:new b["default"](a,{prevent_default:!0})},this[t+"Wrapper"].hammer.add(new b["default"].Pan({direction:b["default"].DIRECTION_ALL,threshold:0})),n&&p["default"].defer(function(){var t=i.getBoundingClientRect();n.sendContentSizeThr2("zoomRect",t.width,t.height)})},r.prototype.getCurrentWrappers=function(){var t=this,e={};return p["default"].each(["left","current","right"],function(i){t[i+"Wrapper"]&&t[i+"Wrapper"].contentObject&&(e[i]=t[i+"Wrapper"].content)}),e},r.prototype._bindCurrentWrapperDOM=function(){this._bindCurrentWrapperDragEvent(),this._initSizes(0)},r.prototype._unbindCurrentWrapperDOM=function(){P[g["default"].prefixed("transition")]&&this.currentWrapper.container.removeEventListener(P[g["default"].prefixed("transition")],this._animationEnd),this._unbindCurrentWrapperDragEv()},r.prototype._setCurrentWrapperPosition=function(){var t=this.currentWrapper.content;this.leftWrapper&&this.leftWrapper.contentObject||v["default"].addClass(t,"left"),this.rightWrapper&&this.rightWrapper.contentObject||v["default"].addClass(t,"right")},r.prototype._bindCurrentWrapperDragEvent=function(){var t=this;this._tapStart=function(e){var i={deltaX:e.deltaX,deltaY:e.deltaY};t._startRender.call(t,i),i=null},this._tapMove=function(e){if(!window.FBPublication.moveLock){var i={deltaX:e.deltaX,deltaY:e.deltaY};t._render.call(t,i,0,e.noMomentum)}},this._tapEnd=function(e){var i={deltaX:e.deltaX,deltaY:e.deltaY};t._stopRender.call(t,i),i=null},this.currentWrapper.hammer.on("panstart",this._tapStart),this.currentWrapper.hammer.on("pan",this._tapMove),this.currentWrapper.hammer.on("panend",this._tapEnd);var e,i={deltaX:0,deltaY:0,noMomentum:!0};this._onWheel=function(n){n.preventDefault&&n.preventDefault();var o=d["default"].normalizeWheel(n);e||t._tapStart(i),clearTimeout(e),e=setTimeout(function(){t._tapEnd(i),e=void 0,i.deltaX=0,i.deltaY=0},250),i.deltaX-=o.pixelX,i.deltaY-=o.pixelY,t._tapMove(i)},d["default"].onWheel(this.currentWrapper.container,this._onWheel)},r.prototype._unbindCurrentWrapperDragEv=function(){this.currentWrapper.hammer.off("panstart",this._tapStart),this.currentWrapper.hammer.off("pan",this._tapMove),this.currentWrapper.hammer.off("panend",this._tapEnd),d["default"].removeOnWheel(this.currentWrapper.container,this._onWheel)},r.prototype._onWheel=function(){},r.prototype._tapStart=function(){},r.prototype._tapMove=function(){},r.prototype._tapEnd=function(){},r.prototype._calcZoomFactorToFitWidth=function(t){return this.mainContainer.getBoundingClientRect().width/t.width},r.prototype._calcZoomFactorToCoverScreen=function(t){var e=this.mainContainer.getBoundingClientRect(),i=e.width,n=e.height,o=i/n,r=t.width/t.height,a=o<r?t.width*n/t.height:i;return a/t.width},r.prototype.resize=function(){this.globalWidth=this.mainContainer.clientWidth,this.globalHeight=this.mainContainer.clientHeight;var t=this.unitPageSizeProvider.getUnitPageSize(),e=t.width*this.zoomFactor/this.currentWrapper.content.getBoundingClientRect().width;this._scaleCurrentWrapper(e)},r.prototype._goToLeft=function(){this._unbindCurrentWrapperDOM(),this.mainContainer.removeChild(this.leftWrapper.container),this.leftWrapper=this.currentWrapper,this.currentWrapper=this.rightWrapper,this._newWrapper("right"),this._bindCurrentWrapperDOM(),this._setCurrentWrapperPosition()},r.prototype._goToRight=function(){this._unbindCurrentWrapperDOM(),this.mainContainer.removeChild(this.rightWrapper.container),this.rightWrapper=this.currentWrapper,this.currentWrapper=this.leftWrapper,this._newWrapper("left"),this._bindCurrentWrapperDOM(),this._setCurrentWrapperPosition()},r.prototype.goToPage=function(t,e,i){var n=this;i="undefined"==typeof i?400:i,e?(v["default"].del(this.rightWrapper.content),v["default"].del(this.rightWrapper.container),this._newWrapper("right",t),this.once("slideAnimation:end",function(){v["default"].del(this.leftWrapper.content),v["default"].del(this.leftWrapper.container),this._newWrapper("left"),this._initSizes(0)},this),p["default"].delay(function(){n.left(i)},100)):(v["default"].del(this.leftWrapper.content),v["default"].del(this.leftWrapper.container),this._newWrapper("left",t),this.once("slideAnimation:end",function(){v["default"].del(this.rightWrapper.content),v["default"].del(this.rightWrapper.container),this._newWrapper("right"),this._initSizes(0)}),p["default"].delay(function(){n.right(i)},100)),this._initSizes(0)},r.prototype.right=function(t){t="undefined"==typeof t?100:t+1,this.trigger("slideAnimation:start"),this._stopRender(!1,t,"right")},r.prototype.left=function(t){t="undefined"==typeof t?100:t+1,this.trigger("slideAnimation:start"),this._stopRender(!1,t,"left")},r.prototype.getBookState=function(){return(0,_["default"])().get(_["default"].BOOK_STATE)},r.prototype._scaleCurrentWrapper=function(t,e,i,n){t=t||this.zoomFactor,n=n||!1,this._unbindCurrentWrapperDOM(),i=i||0;var r=this.currentWrapper.content.getBoundingClientRect(),a=this.currentWrapper.container.getBoundingClientRect();n?this.dragSliderCenter?e=this.dragSliderCenter:(e=e||new o(a.left+a.width/2-r.left,a.top+a.height/2-r.top),e=this._comeOutCorrection(e.x,e.y,t<1?1/this.zoomFactor:t),this.dragSliderCenter=e):this.dragSliderCenter?(e=this.dragSliderCenter,this.dragSliderCenter=!1):(e=e||new o(a.left+a.width/2-r.left,a.top+a.height/2-r.top),e=this._comeOutCorrection(e.x,e.y,t)),this.transformStore=u["default"].parseTranslate(this.currentWrapper.content.style[g["default"].prefixedCSS("transform")]);var s=this.transformStore.translate.x,l=this.transformStore.translate.y;u["default"].origin(this.currentWrapper.content,e.x,e.y),u["default"].transition(this.currentWrapper.content,i,"transform"),this.currentWrapper.content.style[g["default"].prefixedCSS("transition-timing-function")]="cubic-bezier(0.7, 0, 0.27, 1)",this.currentWrapper.content.style[g["default"].prefixedCSS("transform")]="translate3d("+s+"px,"+l+"px, 0px) scale("+t+")",n||(this.trigger("zoomAnimation:start"),p["default"].delay(p["default"].bind(function(){this.getBookState().startChangingZoom(),this.trigger("zoomAnimation:end");var t=this.currentWrapper.content.getBoundingClientRect().top-this.currentWrapper.container.getBoundingClientRect().top,e=this.currentWrapper.content.getBoundingClientRect().left-this.currentWrapper.container.getBoundingClientRect().left,i=this.currentWrapper.container;this._newWrapper("current"),p["default"].delay(function(){v["default"].del(i)},50),v["default"].del(this.rightWrapper.container),v["default"].del(this.leftWrapper.container),this._newWrapper("left"),this._newWrapper("right"),this._initSizes(0,new o(e,t)),this._bindCurrentWrapperDOM(),this._setCurrentWrapperPosition(),this.getBookState().endChangingZoom()},this),1.2*i||10))},r.prototype._initSizes=function(t,e){t=t||0,e=e||new o(0,0),this.leftPageCorner.x=-this.globalWidth,this.rightPageCorner.x=this.globalWidth,this.deltaWidth=this.currentWrapper.content.clientWidth-this.globalWidth,this.deltaHeight=this.currentWrapper.content.clientHeight-this.globalHeight;var i=u["default"].parseTranslate(this.currentWrapper.content.style[g["default"].prefixedCSS("transform")]);this.contentCorner.x=i.translate.x+e.x,this.contentCorner.y=i.translate.y+e.y,i=null,0===this.contentCorner.x&&this.deltaWidth<0&&(this.contentCorner.x=-this.deltaWidth/2),this.leftContentCorner.x=-(this.leftWrapper.content.clientWidth-this.globalWidth),this.leftContentCorner.y=0,this.rightContentCorner.x=0,this.rightContentCorner.y=0,this.contentCornerStore.x=0,this.contentCornerStore.y=0,this.currentPageCornerStore.x=0,this.currentPageCornerStore.y=0,this._setCorners(),this._render(!1),this._stopRender(!1,t,"stop")},r.prototype._setCorners=function(){var t=this.leftWrapper.content.clientWidth-this.globalWidth,e=this.rightWrapper.content.clientWidth-this.globalWidth,i=this.leftWrapper.content.clientHeight-this.globalHeight,n=this.rightWrapper.content.clientHeight-this.globalHeight,o=1;t<0?this.leftContentCorner.x+=t/2:this.leftContentCorner.x-=o,e<0?this.rightContentCorner.x-=e/2:this.rightContentCorner.x+=o,i<0?this.leftContentCorner.y-=i/2:this.leftContentCorner.y+=o,n<0?this.rightContentCorner.y-=n/2:this.rightContentCorner.y+=o,u["default"].translate(this.leftWrapper.content,this.leftContentCorner.x,this.leftContentCorner.y),u["default"].translate(this.rightWrapper.content,this.rightContentCorner.x,this.rightContentCorner.y)},r.prototype._render=function(t,e,i){e=e||0,i=i||!1;var n,o,r=this.contentCorner,a=this.contentCornerStore,s=this.currentPageCornerStore,l=this.currentPageCorner,d=this.deltaWidth,h=this.deltaHeight;t&&(r.x=a.x+t.deltaX,r.y=a.y+t.deltaY),n=r.x-s.x,o=r.y-s.y,h<0?(r.y=Math.abs(h)/2,l.y=0):o>0?(t||(r.y=l.y),r.y=l.y+(i?0:r.y/3)):Math.abs(o)>h?(t||(r.y=l.y-h),r.y=l.y-h+(i?0:(r.y+h)/3)):l.y=s.y,d<0?(l.x=r.x-Math.abs(d)/2,r.x=Math.abs(d)/2):n>0?(l.x=r.x,r.x=0):Math.abs(n)>d?(l.x=r.x+d,r.x=-d):l.x=s.x,this.leftPageCorner.x=l.x-this.globalWidth,this.rightPageCorner.x=l.x+this.globalWidth,this.leftPageCorner.y=l.y,this.rightPageCorner.y=l.y,this._setStyles(e)},r.prototype._setStyles=function(t,e){t=t||0,e=e||"cubic-bezier(0,0,1,1)";var i=this.leftWrapper.container,n=this.currentWrapper.container,o=this.rightWrapper.container,r=this.currentWrapper.content,a=g["default"].prefixedCSS("transition-timing-function");u["default"].transition(i,t,"transform"),u["default"].transition(n,t,"transform"),u["default"].transition(o,t,"transform"),u["default"].transition(r,t,"transform"),i.style[a]=e,n.style[a]=e,o.style[a]=e,r.style[a]=e,u["default"].translate(i,this.leftPageCorner.x,this.leftPageCorner.y),u["default"].translate(n,this.currentPageCorner.x,this.currentPageCorner.y),u["default"].translate(o,this.rightPageCorner.x,this.rightPageCorner.y),u["default"].translate(r,Math.round(this.contentCorner.x),Math.round(this.contentCorner.y))},r.prototype._startRender=function(t){this.contentCornerStore.x=this.contentCorner.x,this.contentCornerStore.y=this.contentCorner.y,this.currentPageCornerStore.x=this.currentPageCorner.x,this.currentPageCornerStore.y=this.currentPageCorner.y,this.trigger("slideAnimation:start"),this._render(t)},r.prototype._stopRender=function(t,e,i){e="undefined"==typeof e?400:e,i=i||!1;var n=this;if("stop"!==i&&(this.currentPageCorner.x<0&&Math.abs(this.currentPageCorner.x)>this.maxPullSize||"left"===i)){var o=this.rightWrapper.content.childNodes.length;if(!i&&!o)return void this._render(!1,e);this._animationEnd=function(){i||n.presenter.goRight(),n._goToLeft.call(n),n.trigger("slideAnimation:end")},P[g["default"].prefixed("transition")]?this.currentWrapper.container.addEventListener(P[g["default"].prefixed("transition")],this._animationEnd):p["default"].delay(this._animationEnd,e),this.contentCorner.x=-(this.globalWidth+this.deltaWidth),this.deltaWidth<0&&(this.contentCorner.x+=this.deltaWidth/2)}else if("stop"!==i&&(this.currentPageCorner.x>0&&Math.abs(this.currentPageCorner.x)>this.maxPullSize||"right"===i)){var r=this.leftWrapper.content.childNodes.length;if(!i&&!r)return void this._render(!1,e);this._animationEnd=function(){i||n.presenter.goLeft(),n._goToRight.call(n),n.trigger("slideAnimation:end")},P[g["default"].prefixed("transition")]?this.currentWrapper.container.addEventListener(P[g["default"].prefixed("transition")],this._animationEnd):p["default"].delay(this._animationEnd,e),this.contentCorner.x=this.globalWidth,this.deltaWidth<0&&(this.contentCorner.x-=this.deltaWidth/2)}t&&this.presenter.onEndDrag(),this._render(!1,e)},r.prototype._comeOutCorrection=function(t,e,i){var n=this.currentWrapper.content.getBoundingClientRect(),r=this.currentWrapper.container.getBoundingClientRect(),a={width:n.width,height:n.height,top:n.top-r.top,left:n.left-r.left},s={width:n.width*i,height:n.height*i,top:a.top-(e*i-e),left:a.left-(t*i-t)};if(s.width<r.width){s.left=(r.width-s.width)/2+r.left;var l=s.left-n.left;t=l/(1-i)}else s.left>0?t=a.left/(i-1):s.left+s.width<r.width&&(t=a.width-(r.width-(a.left+a.width))/(i-1));if(s.height<r.height){s.top=(r.height-s.height)/2+r.top;var d=s.top-n.top;e=d/(1-i)}else s.top>0?e=a.top/(i-1):s.top+s.height<r.height&&(e=a.height-(r.height-(a.top+a.height))/(i-1));return new o(t,e)},r.prototype.destroy=function(){v["default"].del("zoom-frame")},e["default"]=r},function(t,e,i){"use strict";(function(t){function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.container=e||a["default"].tag("body"),this.pager=t,this.pagesForPrint=[],this.isReadyToPrint=!0,this.crossOrigin=(0,c["default"])().getCrossOrigin(),this.on("change:pagesForPrint",this._preparePrintData,this),this.pager.on("change:state",this._onPagerStateChange,this),this._onPagerStateChange(this.pager.getState())}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(0),l=n(s),d=i(1),h=n(d),u=i(5),c=n(u);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype._onPagerStateChange=function(){},o.prototype.getPagesForPrintByState=function(t){var e=[t.leftPage,t.rightPage],i=this;if(e=l["default"].filter(e,function(t){return!(l["default"].isUndefined(t)||l["default"].isNull(t))}),e.length>0){if(1===e.length)return[this.pager.pageTable.getPageIndexById(e[0])];if(e[0]===e[1]){var n=this.pager.pageTable.getPageIndexById(e[0]);return[n,n+1]}return l["default"].map(e,function(t){return i.pager.pageTable.getPageIndexById(t)})}return[]},o.prototype.print=function(t){t&&(this.set("pagesForPrint",t),this.isReadyToPrint?this._print():this.once("change:isReadyToPrint",this._print,this))},o.prototype._print=function(){this.isReadyToPrint&&t.print()},o.prototype.reset=function(){this.set("isReadyToPrint",!1),a["default"].del("print-view"),this._onPagerStateChange(this.pager.getState())},o.prototype._preparePrintData=function(t){var e,i=this;if(0!==t.length){this.isReadyToPrint=!1,a["default"].id("print-view")?(e=a["default"].id("print-view"),e.innerHTML=""):e=a["default"].createElement("div",{"class":"print-view",id:"print-view"},this.container);var n=[],o=function(t,o){var r=t.getProperty("wide"),s=a["default"].createElement("div",{"class":"page-container"},e),l=function(t){n.push(t.id),n.length===i.pagesForPrint.length&&i.set("isReadyToPrint",!0)},d=a["default"].createElement("img",{styles:{width:r?"200%":"100%",height:"100%",display:"block","margin-left":r&&o?"-100%":"0"}},s);i.crossOrigin&&(d.crossOrigin=i.crossOrigin),d.onload=function(){if(t.getProperty("textLayer")){var e=a["default"].createElement("img",{styles:{width:r?"200%":"100%",position:"absolute",top:0,left:r&&o?"-100%":"0",display:"block"}},s,"after",d);i.crossOrigin&&(e.crossOrigin=i.crossOrigin),e.onload=function(){l(t)},e.src=t.getTextLayerUrl(!0)}else l(t)},d.src=t.getSubstrateUrl(!0),a["default"].createElement("div",{"class":"page-break"},s)};l["default"].each(t,function(t){var e=!1,n=i.pager.pageTable.getStructure()[t];l["default"].isNull(n)&&(e=!0,n=i.pager.pageTable.getPageIdByIndex(t)),o(i.pager.pageTable.getPageModel(n),e)})}},e["default"]=o}).call(e,i(6))},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n,o){this.noteData=o,window.noteData=this.noteData,this.props=t,this.workspaceProperties=e,this.flipDisabled=!this.workspaceProperties.components.book.flip,this.pager=i,this.zoomScaleValue=null,this.zoomChangeAnimation=!1,this.isReady=!1,this.searchQuery="",this.textSelectionMode=!1,this.isSearchActive=!1,this.searchCharactersLimit=e.search&&e.search.searchCharactersLimit?e.search.searchCharactersLimit:1,this.browser=n}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(0),l=n(s);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.getPageTable=function(){return this.getPager().pageTable},o.prototype.getPager=function(){return this.pager},o.prototype.hasPages=function(){var t=this.getPageTable().getStructure();return!l["default"].isUndefined(t)&&t.length>0},o.prototype.getProps=function(){return this.props},o.prototype.getWorkspaceProperties=function(){return this.workspaceProperties},o.prototype.setZoomScaleValue=function(t){this.set("zoomScaleValue",t)},o.prototype.setSearchQuery=function(t){this.set("textSelectionMode",!1),t=t||"",this.set("searchQuery",t),""!==t?this.set("isSearchActive",!0):this.set("isSearchActive",!1)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.model=t,this.model.getPager().on("change:state",this._onPagerStateChange,this),this.model.getProps().on("change:rightToLeft change:hardcover change:bookSize change:pageFlippingDuration",function(){this.currentPresenter&&(this.currentPresenter.destroy(),this._changePresenterTo(this._createPresenter().init(this.container)))},this),this.model.getWorkspaceProperties().on("change:bookSize",function(){this.currentPresenter&&(this.currentPresenter.destroy(),this._changePresenterTo(this._createPresenter().init(this.container)))},this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(1),l=n(s),d=i(31),h=n(d),u=i(11),c=n(u),p=i(98),f=n(p),g=i(99),m=n(g),v=i(100),y=n(v),b=i(2),w=n(b);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.destructor=function(){a["default"].isFunction(this.currentPresenter.destructor)&&this.currentPresenter.destructor()},o.prototype.getBookState=function(){return(0,w["default"])().get(w["default"].BOOK_STATE)},o.prototype.init=function(t){this.container=t;var e=this;return this._onPageActivate=function(t){e._notify("onPageActivate",t)},this._onPageChanged=function(t){e._notify("onPageChanged",t),e.getBookState().endChangingPosition()},this._onPageChanging=function(t){e._notify("onPageChanging",t)},this._onStartDrag=function(t){e._notify("onStartDrag",t)},this._onEndDrag=function(t){e._notify("onEndDrag",t)},this.model.hasPages()&&(this.currentPresenter=this._initPresenter(this._createPresenter().init(t))),this},o.prototype.resize=function(t){this.currentPresenter&&this.currentPresenter.resize(t)},o.prototype._onPagerStateChange=function(t,e,i,n){if(this.currentPresenter){var o,r,s,l=this;t.zoomMode!==e.zoomMode?(this.getBookState().startChangingZoom(e,t),this.model.getPager().freeze(this),a["default"].each(a["default"].uniq([e.leftPage,e.rightPage]),function(t){t&&l.currentPresenter.onPageDeactivate(t)}),r=this._createPresenter(),t.zoomMode?(s={target:n},o=new y["default"](this.model.getPager(),this.currentPresenter,r)):(s={pageId:e.leftPage},o=new m["default"](this.model.getPager(),this.currentPresenter,r)),o.once("end",function(t){this.clear(),l.model.getPager().unfreeze(l),l._changePresenterTo(r.init(l.container,t)),l._notify("zoomTransitionEnd"),l.getBookState().endChangingZoom()}),o.start(this.container,s)):(this.getBookState().startChangingPosition(e,t),this.currentPresenter.onPagerStateChange(t,e,i,n))}},o.prototype._createPresenter=function(){var t;return t=this.model.getPager().getState().zoomMode||this.model.flipDisabled?new h["default"](this.model):new c["default"](new f["default"](this.model)),(0,w["default"])().set(w["default"].CURRENT_PRESENTER,t),t},o.prototype._notify=function(t,e){this.trigger(t,e)},o.prototype._changePresenterTo=function(t){this.currentPresenter&&this._destroyCurrentPresenter(),this._initPresenter(t),this.currentPresenter=t,this._notify("onPresenterChanged")},o.prototype._destroyCurrentPresenter=function(){this.currentPresenter&&(this.stopListening(this.currentPresenter,"onPageActivate",this._onPageActivate),this.stopListening(this.currentPresenter,"onPageChanged",this._onPageChanged),this.stopListening(this.currentPresenter,"onPageChanging",this._onPageChanging),this.stopListening(this.currentPresenter,"onStartDrag",this._onStartDrag),this.stopListening(this.currentPresenter,"onEndDrag",this._onEndDrag),a["default"].isFunction(this.currentPresenter.destructor)&&this.currentPresenter.destructor())},o.prototype._initPresenter=function(t){return this.listenTo(t,"onPageActivate",this._onPageActivate),this.listenTo(t,"onPageChanged",this._onPageChanged),this.listenTo(t,"onPageChanging",this._onPageChanging),this.listenTo(t,"onStartDrag",this._onStartDrag),this.listenTo(t,"onEndDrag",this._onEndDrag),t},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this.bookModel=t,this.bookModel.getProps().on("all",this._trigger,this),this.bookModel.getWorkspaceProperties().on("change:components.notes",this._triggerNotes,this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=Object.create(a["default"].prototype),o.prototype.getBookModel=function(){return this.bookModel},o.prototype.getPager=function(){return this.bookModel.getPager()},o.prototype.getPageTable=function(){return this.bookModel.getPageTable()},o.prototype.isHardcover=function(){return this.bookModel.props.hardcover},o.prototype.getHardcoverSize=function(){return this.isHardcover()?10:0},o.prototype.getCoverColor=function(){return this.bookModel.props.hardcoverColor},o.prototype.getPadding=function(){return(100-this.bookModel.workspaceProperties.bookSize)/100},o.prototype.getNotesEnabled=function(){return this.bookModel.workspaceProperties.components.notes===!0},o.prototype.getBookSize=function(){return this.bookModel.props.bookSize},o.prototype.getPagesCount=function(){return this.getPageTable().getPagesCount()},o.prototype.getFlippingDuration=function(){return 1e3*this.bookModel.props.pageFlippingDuration},o.prototype.getFlipCorner=function(){return this.bookModel.props.flipCorner},o.prototype.isFirstPageState=function(t){return this.getPager().isFirstPage(t)},o.prototype.isLastPageState=function(t){return this.getPager().isLastPage(t)},o.prototype.isFrontInsideCoverPageState=function(t){return!!this.isHardcover()&&(t=t||this.getPager().getState(),!!t.leftPage&&1===this.getPageTable().getPageIndexById(t.leftPage))},o.prototype.isBackInsideCoverPageState=function(t){if(!this.isHardcover())return!1;if(t=t||this.getPager().getState(),!t.leftPage)return!1;var e=this.getPageTable().getPageIndexById(t.leftPage),i=this.getPagesCount()-1;return e===i-1||e===i-2},o.prototype.hasBackOutsideCover=function(){return this.isHardcover()*this.getPagesCount()%2===0},o.prototype.getBrowser=function(){return this.bookModel.browser},o.prototype._triggerNotes=function(t){this._trigger("CHANGE_NOTES_COMPONENT",t)},o.prototype._trigger=function(t,e,i){this.trigger(t,e,i)},o.prototype.destroy=function(){this.bookModel.getProps().off("all",this._trigger,this),this.bookModel.getWorkspaceProperties().off("change:components.notes",this._triggerNotes,this)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this.pager=t,this.turnJSPresenter=i,this.slidePresenter=e,this.zoomOutDuration=400,this.animationDuration=400,this.animationDelay=40}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(10),l=n(s),d=i(0),h=n(d),u=i(16),c=n(u),p=i(32),f=n(p);o.prototype=new f["default"],o.prototype.constructor=o,o.prototype.start=function(t,e){this.container=t,this.slidePresenter.pre_destroy();var i=this,n=e.pageId,o=this.pager.isRtl(),r=this.pager.pageTable.getPageModel(n),a=r.getProperty("wide"),s=this.pager.pageTable.getPageIndexById(n);this.turnJSPresenter.bookSizeProvider.setRect(t.getBoundingClientRect());var d=this.turnJSPresenter.bookSizeProvider.getPageSize(s+1),u=a?2:1;this.slidePresenter.setZoomValue(d.width/this.slidePresenter.getUnitPageSize().width*u,null,400,!a),h["default"].delay(function(){var e,r=i.pager.getState(),s=i.animationDelay;if(!a){var u=i.slidePresenter.getDataForTransitionStart();r.leftPage===n?(i.leftPage=i._clonePage(u.current,d),i.leftPage.style.zIndex=2,e=o?u.left:u.right,e&&(i.rightPage=i._clonePage(e,d,u.current.getBoundingClientRect()),i.rightPage.style.zIndex=1)):(e=o?u.right:u.left,e&&(i.leftPage=i._clonePage(e,d,u.current.getBoundingClientRect()),i.leftPage.style.zIndex=1),i.rightPage=i._clonePage(u.current,d),i.rightPage.style.zIndex=2),i.leftPage&&i.rightPage&&(t.appendChild(i.leftPage),t.appendChild(i.rightPage),h["default"].delay(function(){var t=o?-1:1;l["default"].changeOnlyTranslate(i.leftPage,.5*-d.width*t),l["default"].changeOnlyTranslate(i.rightPage,.5*d.width*t)},i.animationDelay),s=1.4*i.animationDuration)}h["default"].delay(function(){i._end()},s),h["default"].delay(function(){i.slidePresenter.destroy()},i.animationDelay)},1.25*this.zoomOutDuration)},o.prototype._clonePage=function(t,e,i){var i=i||t.getBoundingClientRect(),e=e||t.getBoundingClientRect(),n=this.container.getBoundingClientRect(),o=t.cloneNode(!0);return a["default"].css(o,{position:"absolute",top:i.top-n.top+"px",left:i.left-n.left+"px"}),o.style[c["default"].prefixedCSS("transform")]="translate3d(0px, 0px, 0px) scale("+e.width/t.offsetWidth+")",o.style.overflow="hidden",l["default"].origin(o,0,0),l["default"].transition(o,this.animationDuration,"transform"),o},o.prototype._end=function(){this.trigger("end",this.outputOpts)},o.prototype.clear=function(){this.leftPage&&this.leftPage.parentNode&&a["default"].del(this.leftPage),this.rightPage&&this.rightPage.parentNode&&a["default"].del(this.rightPage)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){this.pager=t,this.turnJSPresenter=e,this.slidePresenter=i,this.outputOpts={animate:{from:1,duration:500}},this.animationDelay=40,this.animationTime=400}Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a=n(r),s=i(10),l=n(s),d=i(32),h=n(d),u=i(0),c=n(u);o.prototype=new h["default"],o.prototype.constructor=o,o.prototype.start=function(t,e){this.container=t,e.target&&e.target.center&&(this.outputOpts.animate.center=e.target.center),this.startTransitionData=this.turnJSPresenter.getDataForTransitionStart();var i,n,o=this.turnJSPresenter.model.getPageTable(),r=this.turnJSPresenter.model.getPager(),a=o.getPageIndexById(r.getState().leftPage),s=o.getPageModel(r.getState().leftPage),d=s.getProperty("wide"),h=o.getPagesCount(),u=this;r.isRtl()?(i=a%2===0?a:a+1,n=a%2===0?a-1:a):(i=a%2===0?a-1:a,n=a%2===0?a:a+1);var p=this.turnJSPresenter.bookSizeProvider.getPageSize(a+1);this.outputOpts.animate.fromRect=p,0===a||a===h-1?c["default"].delay(function(){u._end()},this.animationDelay):(this.leftClone=this._clonePage(i),this.rightClone=this._clonePage(n),a===i?(this.leftClone.style.zIndex=2,this.rightClone.style.zIndex=1):(this.leftClone.style.zIndex=1,this.rightClone.style.zIndex=2),t.appendChild(this.leftClone),t.appendChild(this.rightClone),d?(p.width*=2,this.outputOpts.animate.fromRect=p):c["default"].delay(function(){l["default"].translate(u.leftClone,.5*p.width),l["default"].translate(u.rightClone,.5*-p.width)},this.animationDelay),c["default"].delay(function(){u._end()},1.4*this.animationTime)),c["default"].delay(function(){u.turnJSPresenter.destroy()},this.animationDelay)},o.prototype._clonePage=function(t){var e=this.startTransitionData[t],i=e.getBoundingClientRect(),n=this.container.getBoundingClientRect(),o=e.cloneNode(!0);return l["default"].transition(o,this.animationTime,"transform"),a["default"].css(o,{position:"absolute",top:i.top-n.top+"px",left:i.left-n.left+"px",backgroundColor:""}),o},o.prototype._end=function(){this.trigger("end",this.outputOpts)},o.prototype.clear=function(){this.leftClone&&a["default"].del(this.leftClone),this.rightClone&&a["default"].del(this.rightClone)},e["default"]=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=document.attachEvent,o=!1;if(!n){var r=function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};return function(e){return t(e)}}(),a=function(){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(e){return t(e)}}(),s=function(t){var e=t.__resizeTriggers__,i=e.firstElementChild,n=e.lastElementChild,o=i.firstElementChild;
n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,o.style.width=i.offsetWidth+1+"px",o.style.height=i.offsetHeight+1+"px",i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight},l=function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height},d=function(t){var e=this;s(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=r(function(){l(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach(function(i){i.call(e,t)}))})},h=!1,u="animation",c="",p="animationstart",f="Webkit Moz O ms".split(" "),g="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="",v=document.createElement("fakeelement");if(void 0!==v.style.animationName&&(h=!0),h===!1)for(var y=0;y<f.length;y++)if(void 0!==v.style[f[y]+"AnimationName"]){m=f[y],u=m+"Animation",c="-"+m.toLowerCase()+"-",p=g[y],h=!0;break}var b="resizeanim",w="@"+c+"keyframes "+b+" { from { opacity: 0; } to { opacity: 0; } } ",_=c+"animation: 1ms "+b+"; "}var P=function(){if(!o){var t=(w?w:"")+".resize-triggers { "+(_?_:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',e=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),e.appendChild(i),o=!0}},E=function(t,e,i){if(n)t.attachEvent("onresize",e);else{if(!t.__resizeTriggers__){var o=getComputedStyle(t).position;"static"!=o||i||(t.style.position="relative"),P(),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),s(t),t.addEventListener("scroll",d,!0),p&&t.__resizeTriggers__.addEventListener(p,function(e){e.animationName==b&&s(t)})}t.__resizeListeners__.push(e)}},T=function(t,e){n?t.detachEvent("onresize",e):(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),t.__resizeListeners__.length||(t.removeEventListener("scroll",d),t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)))};e.addResizeListener=E,e.removeResizeListener=T},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i){if(this.isActive=!1,this.pager=e,this.properties=t,this.bookPresenter=i,t.auto&&t.enabled){var n=this;this.on("change:isReady",function(){h["default"].defer(function(){n.start(!0)})})}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r),s=i(2),l=n(s),d=i(0),h=n(d);o.prototype=new a["default"],o.prototype.constructor=o,o.prototype.getApiProvider=function(){return(0,l["default"])().get(l["default"].API)},o.prototype.next=function(t){if(this.isActive){var e=this.pager.getState();if(e.zoomMode!==this.zoomMode)return void this.stop();if(!this.pager.goForward("slideshow")){if(!this.properties.loop&&!t)return void this.stop();this.pager.goToFirst("slideshow")}this.bookPresenter.once("onPageChanged",function(){if(this.isActive){var t=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.next()},this.properties.interval)}},this)}},o.prototype.tryToStopByInteruptors=function(t){"slideshow"!=this.pager.initiator&&this.stop()},o.prototype.start=function(t){if(this.properties.enabled)if(this.zoomMode=this.pager.getState().zoomMode,this.pager.on("change:state",this.tryToStopByInteruptors,this),this.set("isActive",!0),this.getApiProvider().trigger("slideshow",{action:"start"}),t){var e=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.next()},this.properties.interval)}else this.next(!0)},o.prototype.stop=function(){this.timeout&&clearTimeout(this.timeout),this.pager.off("change:state",this.tryToStopByInteruptors,this),this.set("isActive",!1),this.getApiProvider().trigger("slideshow",{action:"stop"});this.pager.getState()},o.prototype.toggle=function(){this.isActive?this.stop():this.start()},e["default"]=o},function(t,e,i){"use strict";function n(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}function o(t,e){for(var i=e.slice(0,e.length-1),n=0;n<i.length;n++)i[n]=t[i[n].toLowerCase()];return i}function r(t){t||(t=""),t=t.replace(/\s/g,"");for(var e=t.split(","),i=e.lastIndexOf("");i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}function a(t,e){for(var i=t.length>=e.length?t:e,n=t.length>=e.length?e:t,o=!0,r=0;r<i.length;r++)n.indexOf(i[r])===-1&&(o=!1);return o}function s(t){A=t||"all"}function l(){return A||"all"}function d(){return _.slice(0)}function h(t){var e=t.target||t.srcElement,i=e.tagName;return!("INPUT"===i||"SELECT"===i||"TEXTAREA"===i||e.isContentEditable)}function u(t){return"string"==typeof t&&(t=S(t)),_.indexOf(t)!==-1}function c(t,e){var i=void 0,n=void 0;t||(t=l());for(var o in T)if(Object.prototype.hasOwnProperty.call(T,o))for(i=T[o],n=0;n<i.length;)i[n].scope===t?i.splice(n,1):n++;l()===t&&s(e||"all")}function p(t){var e=t.keyCode||t.which||t.charCode,i=_.indexOf(e);if(i>=0&&_.splice(i,1),t.key&&"meta"===t.key.toLowerCase()&&_.splice(0,_.length),93!==e&&224!==e||(e=91),e in E){E[e]=!1;for(var n in w)w[n]===e&&(v[n]=!1)}}function f(t,e,i){var n=r(t),s=void 0,d=[],h=void 0;"function"==typeof e&&(i=e,e="all");for(var u=0;u<n.length;u++){if(s=n[u].split("+"),s.length>1&&(d=o(w,s)),t=s[s.length-1],t="*"===t?"*":S(t),e||(e=l()),!T[t])return;for(var c=0;c<T[t].length;c++){h=T[t][c];var p=!i||h.method===i;p&&h.scope===e&&a(h.mods,d)&&(T[t][c]={})}}}function g(t,e,i){var n=void 0;if(e.scope===i||"all"===e.scope){n=e.mods.length>0;for(var o in E)Object.prototype.hasOwnProperty.call(E,o)&&(!E[o]&&e.mods.indexOf(+o)>-1||E[o]&&e.mods.indexOf(+o)===-1)&&(n=!1);(0!==e.mods.length||E[16]||E[18]||E[17]||E[91])&&!n&&"*"!==e.shortcut||e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}function m(t){var e=T["*"],i=t.keyCode||t.which||t.charCode;if(_.indexOf(i)===-1&&_.push(i),93!==i&&224!==i||(i=91),i in E){E[i]=!0;for(var n in w)w[n]===i&&(v[n]=!0);if(!e)return}for(var o in E)Object.prototype.hasOwnProperty.call(E,o)&&(E[o]=t[P[o]]);if(v.filter.call(this,t)){var r=l();if(e)for(var a=0;a<e.length;a++)e[a].scope===r&&("keydown"===t.type&&!e[a].keyup||"keyup"===t.type&&e[a].keyup)&&g(t,e[a],r);if(i in T)for(var s=0;s<T[i].length;s++)if(("keydown"===t.type&&!T[i][s].keyup||"keyup"===t.type&&T[i][s].keyup)&&T[i][s].key){for(var d=T[i][s].key.split("+"),h=[],u=0;u<d.length;u++)h.push(S(d[u]));h=h.sort(),h.join("")===_.sort().join("")&&g(t,T[i][s],r)}}}function v(t,e,i){var a=r(t),s=[],l="all",d=document,h=0;for(void 0===i&&"function"==typeof e&&(i=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(l=e.scope),e.element&&(d=e.element)),"string"==typeof e&&(l=e);h<a.length;h++)t=a[h].split("+"),s=[],t.length>1&&(s=o(w,t)),t=t[t.length-1],t="*"===t?"*":S(t),t in T||(T[t]=[]),T[t].push({keyup:e.keyup,scope:l,mods:s,shortcut:a[h],method:i,key:a[h]});"undefined"==typeof d||x||(x=!0,n(d,"keydown",function(t){m(t)}),n(d,"keyup",function(t){m(t),p(t)}))}Object.defineProperty(e,"__esModule",{value:!0});for(var y="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0,b={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,"⇪":20,",":188,".":190,"/":191,"`":192,"-":y?173:189,"=":y?61:187,";":y?59:186,"'":222,"[":219,"]":221,"\\":220},w={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":y?224:91,cmd:y?224:91,command:y?224:91},_=[],P={16:"shiftKey",18:"altKey",17:"ctrlKey"},E={16:!1,18:!1,17:!1},T={},C=1;C<20;C++)b["f"+C]=111+C;P[y?224:91]="metaKey",E[y?224:91]=!1;var A="all",x=!1,S=function(t){return b[t.toLowerCase()]||w[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)},k={setScope:s,getScope:l,deleteScope:c,getPressedKeyCodes:d,isPressed:u,filter:h,unbind:f};for(var I in k)Object.prototype.hasOwnProperty.call(k,I)&&(v[I]=k[I]);if("undefined"!=typeof window){var L=window.hotkeys;v.noConflict=function(t){return t&&window.hotkeys===v&&(window.hotkeys=L),v},window.hotkeys=v}e["default"]=v},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(15),l=n(s),d=i(105),h=n(d);o.prototype=new l["default"],o.prototype.constructor=o,o.prototype.getNewLocale=function(t,e){var i=t?t:[],n=e?e:h["default"]?h["default"].locales:[],o=h["default"]?h["default"].substitutes:{},r="en";if(n&&n.length>0&&(r=n[0]),i){for(var s in o)if(o.hasOwnProperty(s)){var l=a["default"].indexOf(i,s);l>=0&&(i[l]=o[s])}for(var d=0;d<i.length;d++)if(a["default"].indexOf(n,i[d])>=0){r=i[d];break}}return r},o.prototype.getFontConfig=function(){if(this.locale&&h["default"].fonts){var t=a["default"].filter(h["default"].fonts,function(t){return a["default"].indexOf(t.locales,this.locale)!==-1},this);if(t.length>0)return t[0]}},o.prototype.isLocaleRTL=function(){return!(!this.locale||!h["default"].rtl)&&a["default"].indexOf(h["default"].rtl,this.locale)!==-1},o.prototype.set=function(t,e,i){for(var n=t.split("."),o=this,r=0;r<n.length-1;r++)o.hasOwnProperty(n[r])||(o[n[r]]={}),o=o[n[r]];l["default"].prototype.set.call(this,t,e,i)},o.prototype.setLanguage=function(t,e){this.reset(t),this.locale=e},o.prototype.cast=function(){console.error("Please, don't cast members of FBL10n instance")},o.prototype.get=function(t,e){for(var i=t.split("."),n=this,o=0;o<i.length;o++){if(!n.hasOwnProperty(i[o]))return t;n=n[i[o]]}var r=n,s=!1;if(a["default"].isString(r)){for(var l in e)e.hasOwnProperty(l)&&(a["default"].isNumber(e[l])&&!s&&(r=this.pluralize(r,e[l]),s=!0),r=r.replace(new RegExp("%\\{"+l+"\\}","g"),e[l]));return r}return t},o.prototype.pluralize=function(t,e){function i(t){var e,i,n,o={};for(e in t)if(t.hasOwnProperty(e)){i=t[e];for(n in i)i.hasOwnProperty(n)&&(o[i[n]]=e)}return o}function n(t){var e=i(h);return e[t]||e.en}function o(t,e){return d[n(t)](e)}function r(t){var e=/^\s+|\s+$/g;return t.replace(e,"")}var a,s,l,d={chinese:function(){return 0},german:function(t){return 1!==t?1:0},french:function(t){return t>1?1:0},russian:function(t){return t%10===1&&t%100!==11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},polish:function(t){return 1===t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}},h={chinese:["ar","ja","ko","tr","zh"],german:["de","en","es","fi","he","it","nl","no","pt","sv"],french:["fr"],russian:["ru"],polish:["pl"]};return null!==e&&t?(s=t.split("|"),l=s[o(this.locale,e)]||s[0],a=r(l)):a=t,a},e["default"]=o},function(t,e){t.exports={locales:["en","ar","de","es","fi","fr","he","it","ja","nl","no","pl","pt","ru","sv","tr","zh"],substitutes:{nb:"no",nn:"no",be:"ru"},rtl:["ar","he"],fonts:[{locales:["de","en","es","fi","fr","it","nl","no","pl","pt","sv","tr"],"font-family":"Open Sans",subset:"latin-ext","font-weight-bold":"800","font-weight-normal":"600"},{locales:["ar"],"font-family":"Cairo",subset:"arabic","font-weight-bold":"700","font-weight-normal":"600"},{locales:["he"],"font-family":"Rubik",subset:"hebrew","font-weight-bold":"700","font-weight-normal":"500"},{locales:["ru"],"font-family":"Open Sans",subset:"cyrillic,cyrillic-ext","font-weight-bold":"800","font-weight-normal":"600"}]}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,i,n){this._pager=t,this._pageTable=this._pager.pageTable,this._resourceProvider=e,this._maxLoadingCount=n||8,this._loaderQueue=new u["default"],this._pool=new d["default"](i),this._loaderDictionary=new p["default"],this._loadingCount=0;var o=this;this._onResourceStateChanged=function(t){o._resourceProvider.off(t.id);var e=o._loaderDictionary.get(t.id);o._updateModel(t);for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];n.preloaderHack=!1,n.getState()===s.LoaderState.UNREADY&&(t.state===g.READY?(n.ready(),o._loaderQueue.push(n),o._tryLoad()):n.setError("wrong resource state for  "+n.hash()))}}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(9),l=i(107),d=n(l),h=i(108),u=n(h),c=i(109),p=n(c),f=window.FBPublication.PageResourceType,g=window.FBPublication.PageResourceState;o.prototype._hash=function(t,e,i){return t+"_"+e+"_"+i},o.prototype.destructor=function(){this._loaderDictionary.destructor(),this._loaderQueue.destructor()},o.prototype._updateModel=function(t){if(!a["default"].isEmpty(t.pageInfo)){var e=this._pageTable,i=e.getPageModel(t.id).getPropertyModel();a["default"].each(t.pageInfo,function(t,e){i.set(e,t)})}},o.prototype.getPageId=function(t){var e=this._pageTable;return e.getPageIdByIndex(t-1)},o.prototype.setBookRange=function(t,e,i){i=i!==!1;var n=this._pager.getState();if(this._currentPages=[],n.leftPage&&this._currentPages.push(n.leftPage),n.rightPage&&this._currentPages.push(n.rightPage),this._pageExclude=e,i&&(this._pageExclude=this._pageExclude.map(this.getPageId,this)),t&&2===t.length){var o,r=[];for(o=t[0];o<=t[1];o++){var s=i?this.getPageId(o):o;0!==r.length&&r[r.length-1]===s||r.push(s)}for(o=0;o<r.length;o++)this._pageExclude.push(r[o])}(!this.lastRange||a["default"].difference(this._pageExclude,this.lastRange).length>0)&&(this._loaderQueue.setBookRange(this._pageExclude,this._currentPages),this._tryLoad()),this.lastRange=this._pageExclude},o.prototype.setVisibleThRange=function(t,e){t=t<0?0:t;var i=a["default"].range(t+1,e+2).map(this.getPageId,this);this._loaderQueue.sortVisibleTh(i)},o.prototype._getUrl=function(t,e,i){var n=this._pageTable.getPageModel(t);if(n){var o;switch(e){case f.SVG:n.getProperty("vectorText")&&(o=n.getSVGLayerUrl());break;case f.PAGE_TEXT:case f.ZOOM_PAGE_TEXT:n.getProperty("textLayer")&&(o=n.getTextLayerUrl(i));break;case f.PAGE_SUBSTRATE:case f.ZOOM_PAGE_SUBSTRATE:o=n.getSubstrateUrl(i);break;case f.THUMBNAIL:o=n.getThumbnailUrl()}return o}},o.prototype.getPageLoader=function(t,e,i){var n=this._loaderDictionary.get(t,e,i),o=this._hash(t,e,i),r=this._pageTable.getPageModel(t),a=this._getUrl(t,e,i);if(a){if(n){if(!n.url()||n.url()===a)return n.uses++,n;this._loaderDictionary.free(n),this._pool.free(n)}var s=this._resourceProvider.getInfo(t);switch(r.isStub()&&(s.state=g.READY),n=this._pool.get(),n.setHash(t,e,i),n.unready(),this._loaderDictionary.push(n),s.state){case g.UNREADY:this._resourceProvider.on(t,this._onResourceStateChanged);break;case g.READY:"undefined"!=typeof s.pageInfo||r.isStub()?(this._updateModel(s),n.ready(),this._loaderQueue.push(n),this._tryLoad()):(n.preloaderHack=!0,this._resourceProvider.on(t,this._onResourceStateChanged));break;default:throw this._loaderDictionary.free(n),this._pool.free(n),new Error("resource "+o+" has "+s+"state")}return n.uses++,n}},o.prototype.freeze=function(){if(!a["default"].isUndefined(this._isFreezed))throw new Error("Publication is freezed already");this._isFreezed=!0},o.prototype.unfreeze=function(){if(this._isFreezed!==!0)throw new Error("Publication is not freezed yet");delete this._isFreezed,this._tryLoad()},o.prototype._tryLoad=function(){if(this._loadingCount<this._maxLoadingCount&&!this._loaderQueue.isEmpty()&&a["default"].isUndefined(this._isFreezed)){var t=this._loaderQueue.shift();this._loadingCount++;var e=function(){this._loadingCount--,this._tryLoad()},i=function(t){console.error(t),this._loadingCount--,this._tryLoad()},n=this._getUrl(t.id(),t.type(),t.size());t.setUrl(n),t.once(s.LoaderEvent.LOADED,e,this),t.once(s.LoaderEvent.ERROR,i,this),t.load()}},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t){this._cls=t,this._pool=[]}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r);o.prototype.constructor=o,o.prototype.destructor=function(){var t;for(t in this._pool){var e=this._pool[t];a["default"].isFunction(e.destructor)&&e.destructor()}delete this._pool},o.prototype.get=function(){return 0===this._pool.length&&this._pool.push(new this._cls),this._pool.pop()},o.prototype.free=function(t){a["default"].isFunction(t.free)&&t.free(),this._pool.push(t)},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){this._currentFifo=[],this._thumbFifo=[],this._bookFifo=[],this._waitingBookFifo=[],this._otherFifo=[]}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=window.FBPublication.PageResourceType;o.prototype.constructor=o,o.prototype.destructor=function(){var t;for(t in this._otherFifo){var e=this._otherFifo[t];a["default"].isFunction(e.destructor)&&e.destructor()}for(t in this._waitingBookFifo){var e=this._waitingBookFifo[t];a["default"].isFunction(e.destructor)&&e.destructor()}for(t in this._bookFifo){var e=this._bookFifo[t];a["default"].isFunction(e.destructor)&&e.destructor()}for(t in this._thumbFifo){var e=this._thumbFifo[t];a["default"].isFunction(e.destructor)&&e.destructor()}for(t in this._currentFifo){var e=this._currentFifo[t];a["default"].isFunction(e.destructor)&&e.destructor()}},o.prototype.isEmpty=function(){return 0===this._currentFifo.length&&0===this._thumbFifo.length&&0===this._bookFifo.length&&0===this._otherFifo.length},o.prototype.push=function(t){switch(t.type()){case s.SVG:case s.PAGE_TEXT:case s.ZOOM_PAGE_TEXT:case s.PAGE_SUBSTRATE:case s.ZOOM_PAGE_SUBSTRATE:this._currentFifo.indexOf(t)<0&&this._bookFifo.indexOf(t)<0&&this._waitingBookFifo.indexOf(t)<0&&this._bookFifo.push(t);break;case s.THUMBNAIL:this._currentFifo.indexOf(t)<0&&this._thumbFifo.indexOf(t)<0&&this._otherFifo.indexOf(t)<0&&this._thumbFifo.push(t);break;default:this._otherFifo.indexOf(t)<0&&this._otherFifo.push(t)}},o.prototype.shift=function(){if(this._currentFifo.length>0)return this._currentFifo.shift();if(this._thumbFifo.length>0)return this._thumbFifo.shift();if(this._bookFifo.length>0)return this._bookFifo.shift();if(this._otherFifo.length>0)return this._otherFifo.shift();throw new Error("LoaderQueue is empty.")},o.prototype.sortVisibleTh=function(t){function e(e){var i=e.id();return t.indexOf(i)>=0}function i(t){return!e(t)}var n=this._thumbFifo.filter(e);this._thumbFifo=this._thumbFifo.filter(i);var o=this._otherFifo.filter(e);this._otherFifo=this._otherFifo.filter(i),this._thumbFifo=[].concat(n,o,this._thumbFifo)},o.prototype.setBookRange=function(t,e){function i(e){var i=e.id(),n=t.indexOf(i);return n>=0}function n(e){if(e.type()!==s.THUMBNAIL)return!0;var i=e.id(),n=t.indexOf(i);return n>=0}function o(t){var i=t.id(),n=e.indexOf(i);return n>=0}function r(t){if(t.type()!==s.THUMBNAIL)return!0;var i=t.id(),n=e.indexOf(i);return n>=0}function a(t){return!i(t)}function l(t){return!n(t)}function d(t){return!o(t)}function h(t){return!r(t)}var u=this._currentFifo.filter(h);this._currentFifo=this._currentFifo.filter(r),this._otherFifo=this._otherFifo.concat(u);var c=this._otherFifo.filter(n);this._otherFifo=this._otherFifo.filter(l),this._thumbFifo=this._thumbFifo.concat(c);var p=this._thumbFifo.filter(l);this._thumbFifo=this._thumbFifo.filter(n),this._otherFifo=this._otherFifo.concat(p);var f=this._thumbFifo.filter(r);this._thumbFifo=this._thumbFifo.filter(h),this._currentFifo=this._currentFifo.concat(f);var g=this._currentFifo.filter(d);this._currentFifo=this._currentFifo.filter(o),this._waitingBookFifo=this._waitingBookFifo.concat(g);var m=this._waitingBookFifo.filter(i);this._waitingBookFifo=this._waitingBookFifo.filter(a),this._bookFifo=this._bookFifo.concat(m);var v=this._bookFifo.filter(a);this._bookFifo=this._bookFifo.filter(i),this._waitingBookFifo=this._waitingBookFifo.concat(v);var y=this._bookFifo.filter(o);this._bookFifo=this._bookFifo.filter(d),this._currentFifo=this._currentFifo.concat(y)},o.prototype.log=function(t){console.info(t+"-log: \ncur: "+this._currentFifo.toString()+"; \nth: "+this._thumbFifo.toString()+"; \nwait: "+this._waitingBookFifo.toString()+"; \nbook: "+this._bookFifo.toString()+"; \nother: "+this._otherFifo.toString()+"\n\n")},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){this._dictionary={}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r);o.prototype.constructor=o,o.prototype.destructor=function(){for(var t in this._dictionary){var e=this._dictionary[t];a["default"].isFunction(e.destructor)&&e.destructor()}},o.prototype.push=function(t){this._dictionary.hasOwnProperty(t.id())||(this._dictionary[t.id()]={}),this._dictionary[t.id()][t.type()+"_"+t.size()]=t},o.prototype.free=function(t){this._dictionary.hasOwnProperty(t.id())||(this._dictionary[t.id()]={}),this._dictionary[t.id()].hasOwnProperty(t.type()+"_"+t.size())&&delete this._dictionary[t.id()][t.type()+"_"+t.size()]},o.prototype.get=function(t,e,i){if(this._dictionary.hasOwnProperty(t)){var n=this._dictionary[t];return i=i||0,a["default"].isUndefined(e)?n:a["default"].isUndefined(i)?n[e]:n[e+"_"+i]}},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){this.containers={},this.unlockCorners()}Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),a=n(r);o.prototype=new a["default"],o.prototype.constructor=o,o.TOP_LEFT="tl",o.TOP_RIGHT="tr",o.BOTTOM_LEFT="bl",o.BOTTOM_RIGHT="br",o.prototype.unlockCorners=function(){window.FBPublication.hasOwnProperty("lockedCorner")||(window.FBPublication.lockedCorner={}),window.FBPublication.lockedCorner[o.TOP_LEFT]=!1,window.FBPublication.lockedCorner[o.TOP_RIGHT]=!1,window.FBPublication.lockedCorner[o.BOTTOM_LEFT]=!1,window.FBPublication.lockedCorner[o.BOTTOM_RIGHT]=!1},o.prototype.lockCorner=function(t){console.log("lockCorner",t),window.FBPublication.lockedCorner[t]=!0},o.prototype.clickOnWindowItem=function(t,e){this.trigger("clickOnWindowItem:"+t+":"+e)},o.prototype.clickOnIconItem=function(t,e){this.trigger("clickOnIconItem",{pageId:t,noteId:e})},o.prototype.registerContentContainer=function(t,e,i,n){this.containers[t+e]={pageId:t,container:i,presenter:n}},o.prototype.unregisterContentContainer=function(t,e){delete this.containers[t+e]},e["default"]=o},function(t,e){t.exports={toc:{enabled:!0},downloads:{enabled:!1,allPagesVisible:!0,currentPagesVisible:!1},sound:{background:{loop:!0,volume:30},flip:{enabled:!0,volume:25,hard:["blow.mp3"],soft:["flip2.mp3","flip3.mp3","flip4.mp3"]},enabled:!0},print:{currentPagesVisible:!0,selectedPagesVisible:!0},search:{path:"/searchtext.xml",exactMatch:!1,searchCharactersLimit:1,enabled:!1},bookSize:95,components:{book:{flip:!0,slide:!0},notes:!0,bottomBar:!0,zoom:!0,navigation:!1,topBar:!0,embed:!1,fullscreen:!0,print:!0,thumbnails:!0,share:!0,textSelection:!1,slideshow:{enabled:!1,auto:!1,loop:!1,interval:3e3},paginator:{enabled:!0,totalPagesVisible:!0},copyright:{enabled:!1,url:"",target:"_blank",label:""}},thumbType:"AUTO",cookieNotice:{enabled:!1}}},function(t,e){t.exports={links:{color:"#40C6FF",target:"_blank",highlightOnFlip:!0,highlightOnHover:!0},search:{color:"#FFE921"},hardcover:!1,hardcoverColor:"#5a5f63",flipCorner:!0,rightToLeft:!1,numerationOffset:0,pageFlippingDuration:.8,shadowDepth:2,pages:{defaults:{width:0,height:0,thFormat:"",textLayer:!0,substrateFormat:"",substrateZoomFormat:"",stub:!1,slideDelay:2,backgroundColor:"#FFFFFF",wide:!1,pageResize:"FIT",shadowDepth:-1}}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(){a["default"].constructor.call(this)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(9),a=n(r),s=i(5),l=n(s);o.prototype=Object.create(a["default"].prototype),o.prototype.constructor=o,o.prototype.load=function(){if(!this.destructed){if(this._state!==r.LoaderState.READY)throw new Error(this.hash()+this._history+"Can't load loader with status "+this._state);this._state=r.LoaderState.LOADING;var t=this,e=new Image,i=(0,l["default"])().getCrossOrigin();i&&(e.crossOrigin=i),e.onload=function(){t.destructed||(t._state=r.LoaderState.LOADED,t.trigger(r.LoaderEvent.DATA_IS_READY),t.trigger(r.LoaderEvent.LOADED,t),e=null)},e.onerror=function(i){t.destructed||(t._state=r.LoaderState.ERROR,t.trigger(r.LoaderEvent.ERROR,{url:t._url,errorMsg:i}),e=null)},e.src=this._url,this._loadedData=this._url,this.trigger(r.LoaderEvent.LOADING)}},o.prototype.isDataReady=function(){return this._state>=r.LoaderState.LOADED},o.prototype.toString=function(){return this.hash()},e["default"]=o},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){this.browser=t,a["default"].isUndefined(e)||a["default"].extend(this.params,e)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),a=n(r),s=i(1),l=n(s);o.prototype.constructor=o,o.prototype=new l["default"],o.prototype._formatSize=function(t){var e=t/1048576;return e=e<1?e<.1?(1024*e).toFixed(0)+" KB":e.toFixed(2)+" MB":e<100?e.toFixed(1)+" MB":e.toFixed(0)+" MB"},o.prototype.params={maxWidth:800,honorMarginPadding:!0,honorColor:!1,properties:null,showModal:!0,frameId:"vpJS",border:!0,htmlData:""},o.prototype.PDF="pdf",o.prototype.IMAGE="image",o.prototype.print=function(t,e){function i(){n.focus(),n.contentWindow.print(),e(!0)}document.getElementsByTagName("body")[0].appendChild(this.printFrame);var n=document.getElementById(this.params.frameId);this.printFrame.onload=function(){i()}},o.prototype.setPdfPrintingSupport=function(t){this.pdfSupported=t},o.prototype.isPdfPrintingSupport=function(){return this.pdfSupported!==!1&&!this.browser.firefox&&!this.browser.ie&&!this.browser.msedge},o.prototype.printPdf=function(t,e){if(!a["default"].isFunction(e))return void console.error("callback must be a function");this.init(this.PDF);var i=this;this.xmlHTTP&&this.xmlHTTP.abort(),this.xmlHTTP=new XMLHttpRequest,this.xmlHTTP.open("GET",t),this.xmlHTTP.responseType="arraybuffer","onprogress"in this.xmlHTTP&&(i.xmlHTTP.onprogress=function(t){t.lengthComputable&&i.trigger("progress",t)}),this.xmlHTTP.onload=function(t){i.trigger("loaded",t);var n=new Blob([this.response],{type:"application/pdf"}),o=window.URL.createObjectURL(n);i.printFrame.setAttribute("src",o),i.print(i.PDF,e),i.xmlHTTP=null},this.xmlHTTP.send()},o.prototype.reset=function(){this.xmlHTTP&&this.xmlHTTP.abort(),this.xmlHTTP=void 0},o.prototype.init=function(t){var e=document.getElementById(this.params.frameId);e&&e.parentNode.removeChild(e),this.printFrame=document.createElement("iframe"),this.printFrame.setAttribute("style","display:none;"),this.printFrame.setAttribute("id",this.params.frameId),t!==this.PDF&&(this.printFrame.srcdoc="<html><head></head><body></body></html>"),this.printFriendlyElement="max-width: "+this.params.maxWidth+"px !important;"+this.params.font_size+" !important;",this.bodyStyle="font-family:"+this.params.font+" !important; font-size: "+this.params.font_size+" !important; width:100%;",this.headerStyle="font-weight:300;"},e["default"]=o},function(t,e,i){"use strict";function n(){this.wideLinks=[]}Object.defineProperty(e,"__esModule",{value:!0}),n.prototype.constructor=n,n.prototype.pushContent=function(t){if(this.content&&t&&this.content.presenter.model.pageModel.id===t.presenter.model.pageModel.id){var e=this.content;return this.content=null,e}return this.content=t,null},n.prototype.pushLink=function(t,e,i){var n=e+"-"+i;if(this.wideLinks[n]&&t){var o=this.wideLinks[n];return delete this.wideLinks[n],o}return this.wideLinks[n]=t,null},e["default"]=n}]);